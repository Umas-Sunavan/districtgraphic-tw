(self.webpackChunkdistrictgraphic_tw=self.webpackChunkdistrictgraphic_tw||[]).push([[179],{8255:t=>{function e(t){return Promise.resolve().then(()=>{var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}e.keys=()=>[],e.resolve=e,e.id=8255,t.exports=e},5366:(t,e,n)=>{"use strict";n.d(e,{deG:()=>sn,tb:()=>dl,AFp:()=>al,ip1:()=>sl,CZH:()=>ol,hGG:()=>sc,z2F:()=>Xl,sBO:()=>na,Sil:()=>Cl,_Vd:()=>Mo,EJc:()=>ml,SBq:()=>Po,qLn:()=>_i,vpe:()=>Ha,gxx:()=>ts,tBr:()=>Tn,XFs:()=>D,OlP:()=>rn,zs3:()=>ms,ZZ4:()=>Xo,aQg:()=>$o,soG:()=>fl,YKP:()=>da,v3s:()=>$l,h0i:()=>ha,PXZ:()=>jl,R0b:()=>Ml,FiY:()=>Sn,Lbi:()=>hl,g9A:()=>ul,Qsj:()=>Io,FYo:()=>Ro,JOm:()=>wi,Tiy:()=>ko,q3G:()=>di,tp0:()=>Mn,EAV:()=>tc,Rgc:()=>aa,dDg:()=>Il,DyG:()=>on,q4F:()=>zo,GfV:()=>Oo,s_b:()=>fa,ifc:()=>k,eFA:()=>Wl,G48:()=>Vl,Gpc:()=>p,X6Q:()=>Bl,_c5:()=>ic,VLi:()=>Ol,c2e:()=>pl,zSh:()=>ns,wAp:()=>ho,vHH:()=>g,EiD:()=>ui,mCW:()=>Zn,qzn:()=>On,JVY:()=>Fn,pB0:()=>Vn,eBb:()=>Hn,L6k:()=>Un,LAX:()=>Bn,cg1:()=>lo,Tjo:()=>nc,kL8:()=>co,yhl:()=>zn,dqk:()=>H,sIi:()=>Ss,CqO:()=>Vs,QGY:()=>Hs,F4k:()=>Bs,RDi:()=>St,AaK:()=>u,z3N:()=>kn,qOj:()=>ys,TTD:()=>vt,_Bn:()=>Co,xp6:()=>sr,uIk:()=>Ps,ekj:()=>Xs,Suo:()=>tl,Xpm:()=>$,lG2:()=>rt,Yz7:()=>x,cJS:()=>b,oAB:()=>et,Yjl:()=>st,Y36:()=>Is,_UZ:()=>Fs,qZA:()=>zs,TgZ:()=>Os,EpF:()=>Us,n5z:()=>Qe,Ikx:()=>ro,LFG:()=>bn,$8M:()=>tn,NdJ:()=>Gs,CRH:()=>el,kcU:()=>ge,O4$:()=>me,oxw:()=>qs,ALo:()=>Na,lcZ:()=>ka,xi3:()=>Oa,Q6J:()=>Ns,VKq:()=>Da,WLB:()=>Pa,iGM:()=>Qa,MAs:()=>Rs,CHM:()=>Gt,LSH:()=>pi,kYT:()=>nt,YNc:()=>Ls,_uU:()=>to,Oqu:()=>eo,hij:()=>no,AsE:()=>io,Gf:()=>Ka});var i=n(5959),r=n(7570),s=n(8318),o=n(1906),a=n(1055);function l(t){for(let e in t)if(t[e]===l)return e;throw Error("Could not find renamed property on target object.")}function c(t,e){for(const n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function u(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(u).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const n=e.indexOf("\n");return-1===n?e:e.substring(0,n)}function h(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const d=l({__forward_ref__:l});function p(t){return t.__forward_ref__=p,t.toString=function(){return u(this())},t}function f(t){return m(t)?t():t}function m(t){return"function"==typeof t&&t.hasOwnProperty(d)&&t.__forward_ref__===p}class g extends Error{constructor(t,e){super(function(t,e){return`${t?`NG0${t}: `:""}${e}`}(t,e)),this.code=t}}function y(t){return"string"==typeof t?t:null==t?"":String(t)}function v(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():y(t)}function _(t,e){const n=e?` in ${e}`:"";throw new g("201",`No provider for ${v(t)} found${n}`)}function x(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function b(t){return{providers:t.providers||[],imports:t.imports||[]}}function w(t){return C(t,S)||C(t,E)}function C(t,e){return t.hasOwnProperty(e)?t[e]:null}function T(t){return t&&(t.hasOwnProperty(M)||t.hasOwnProperty(A))?t[M]:null}const S=l({"\u0275prov":l}),M=l({"\u0275inj":l}),E=l({ngInjectableDef:l}),A=l({ngInjectorDef:l});var D=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}({});let P;function L(t){const e=P;return P=t,e}function R(t,e,n){const i=w(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&D.Optional?null:void 0!==e?e:void _(u(t),"Injector")}function I(t){return{toString:t}.toString()}var N=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}({}),k=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}({});const O="undefined"!=typeof globalThis&&globalThis,z="undefined"!=typeof window&&window,F="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,U="undefined"!=typeof global&&global,H=O||U||z||F,B={},V=[],G=l({"\u0275cmp":l}),j=l({"\u0275dir":l}),W=l({"\u0275pipe":l}),q=l({"\u0275mod":l}),Z=l({"\u0275loc":l}),Y=l({"\u0275fac":l}),X=l({__NG_ELEMENT_ID__:l});let J=0;function $(t){return I(()=>{const e={},n={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===N.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||V,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||k.Emulated,id:"c",styles:t.styles||V,_:null,setInput:null,schemas:t.schemas||null,tView:null},i=t.directives,r=t.features,s=t.pipes;return n.id+=J++,n.inputs=it(t.inputs,e),n.outputs=it(t.outputs),r&&r.forEach(t=>t(n)),n.directiveDefs=i?()=>("function"==typeof i?i():i).map(Q):null,n.pipeDefs=s?()=>("function"==typeof s?s():s).map(K):null,n})}function Q(t){return ot(t)||function(t){return t[j]||null}(t)}function K(t){return function(t){return t[W]||null}(t)}const tt={};function et(t){return I(()=>{const e={type:t.type,bootstrap:t.bootstrap||V,declarations:t.declarations||V,imports:t.imports||V,exports:t.exports||V,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(tt[t.id]=t.type),e})}function nt(t,e){return I(()=>{const n=at(t,!0);n.declarations=e.declarations||V,n.imports=e.imports||V,n.exports=e.exports||V})}function it(t,e){if(null==t)return B;const n={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),n[r]=i,e&&(e[r]=s)}return n}const rt=$;function st(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function ot(t){return t[G]||null}function at(t,e){const n=t[q]||null;if(!n&&!0===e)throw new Error(`Type ${u(t)} does not have '\u0275mod' property.`);return n}const lt=20,ct=10;function ut(t){return Array.isArray(t)&&"object"==typeof t[1]}function ht(t){return Array.isArray(t)&&!0===t[1]}function dt(t){return 0!=(8&t.flags)}function pt(t){return 2==(2&t.flags)}function ft(t){return 1==(1&t.flags)}function mt(t){return null!==t.template}function gt(t,e){return t.hasOwnProperty(Y)?t[Y]:null}class yt{constructor(t,e,n){this.previousValue=t,this.currentValue=e,this.firstChange=n}isFirstChange(){return this.firstChange}}function vt(){return _t}function _t(t){return t.type.prototype.ngOnChanges&&(t.setInput=bt),xt}function xt(){const t=wt(this),e=null==t?void 0:t.current;if(e){const n=t.previous;if(n===B)t.previous=e;else for(let t in e)n[t]=e[t];t.current=null,this.ngOnChanges(e)}}function bt(t,e,n,i){const r=wt(t)||function(t,e){return t.__ngSimpleChanges__=e}(t,{previous:B,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[n],l=o[a];s[a]=new yt(l&&l.currentValue,e,o===B),t[i]=e}function wt(t){return t.__ngSimpleChanges__||null}vt.ngInherit=!0;const Ct="http://www.w3.org/2000/svg";let Tt;function St(t){Tt=t}function Mt(t){return!!t.listen}const Et={createRenderer:(t,e)=>void 0!==Tt?Tt:"undefined"!=typeof document?document:void 0};function At(t){for(;Array.isArray(t);)t=t[0];return t}function Dt(t,e){return At(e[t])}function Pt(t,e){return At(e[t.index])}function Lt(t,e){return t.data[e]}function Rt(t,e){return t[e]}function It(t,e){const n=e[t];return ut(n)?n:n[0]}function Nt(t){return 4==(4&t[2])}function kt(t){return 128==(128&t[2])}function Ot(t,e){return null==e?null:t[e]}function zt(t){t[18]=0}function Ft(t,e){t[5]+=e;let n=t,i=t[3];for(;null!==i&&(1===e&&1===n[5]||-1===e&&0===n[5]);)i[5]+=e,n=i,i=i[3]}const Ut={lFrame:le(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ht(){return Ut.bindingsEnabled}function Bt(){return Ut.lFrame.lView}function Vt(){return Ut.lFrame.tView}function Gt(t){return Ut.lFrame.contextLView=t,t[8]}function jt(){let t=Wt();for(;null!==t&&64===t.type;)t=t.parent;return t}function Wt(){return Ut.lFrame.currentTNode}function qt(t,e){const n=Ut.lFrame;n.currentTNode=t,n.isParent=e}function Zt(){return Ut.lFrame.isParent}function Yt(){return Ut.isInCheckNoChangesMode}function Xt(t){Ut.isInCheckNoChangesMode=t}function Jt(){const t=Ut.lFrame;let e=t.bindingRootIndex;return-1===e&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function $t(){return Ut.lFrame.bindingIndex}function Qt(){return Ut.lFrame.bindingIndex++}function Kt(t){const e=Ut.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function te(t,e){const n=Ut.lFrame;n.bindingIndex=n.bindingRootIndex=t,ee(e)}function ee(t){Ut.lFrame.currentDirectiveIndex=t}function ne(){return Ut.lFrame.currentQueryIndex}function ie(t){Ut.lFrame.currentQueryIndex=t}function re(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function se(t,e,n){if(n&D.SkipSelf){let i=e,r=t;for(;i=i.parent,!(null!==i||n&D.Host||(i=re(r),null===i)||(r=r[15],10&i.type)););if(null===i)return!1;e=i,t=r}const i=Ut.lFrame=ae();return i.currentTNode=e,i.lView=t,!0}function oe(t){const e=ae(),n=t[1];Ut.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function ae(){const t=Ut.lFrame,e=null===t?null:t.child;return null===e?le(t):e}function le(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function ce(){const t=Ut.lFrame;return Ut.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const ue=ce;function he(){const t=ce();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function de(){return Ut.lFrame.selectedIndex}function pe(t){Ut.lFrame.selectedIndex=t}function fe(){const t=Ut.lFrame;return Lt(t.tView,t.selectedIndex)}function me(){Ut.lFrame.currentNamespace=Ct}function ge(){Ut.lFrame.currentNamespace=null}function ye(t,e){for(let n=e.directiveStart,i=e.directiveEnd;n<i;n++){const e=t.data[n].type.prototype,{ngAfterContentInit:i,ngAfterContentChecked:r,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=e;i&&(t.contentHooks||(t.contentHooks=[])).push(-n,i),r&&((t.contentHooks||(t.contentHooks=[])).push(n,r),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(n,r)),s&&(t.viewHooks||(t.viewHooks=[])).push(-n,s),o&&((t.viewHooks||(t.viewHooks=[])).push(n,o),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(n,o)),null!=a&&(t.destroyHooks||(t.destroyHooks=[])).push(n,a)}}function ve(t,e,n){be(t,e,3,n)}function _e(t,e,n,i){(3&t[2])===n&&be(t,e,n,i)}function xe(t,e){let n=t[2];(3&n)===e&&(n&=2047,n+=1,t[2]=n)}function be(t,e,n,i){const r=null!=i?i:-1,s=e.length-1;let o=0;for(let a=void 0!==i?65535&t[18]:0;a<s;a++)if("number"==typeof e[a+1]){if(o=e[a],null!=i&&o>=i)break}else e[a]<0&&(t[18]+=65536),(o<r||-1==r)&&(we(t,n,e,a),t[18]=(4294901760&t[18])+a+2),a++}function we(t,e,n,i){const r=n[i]<0,s=n[i+1],o=t[r?-n[i]:n[i]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{s.call(o)}finally{}}}else try{s.call(o)}finally{}}const Ce=-1;class Te{constructor(t,e,n){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=n}}function Se(t,e,n){const i=Mt(t);let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const o=n[r++],a=n[r++],l=n[r++];i?t.setAttribute(e,a,l,o):e.setAttributeNS(o,a,l)}else{const o=s,a=n[++r];Ee(o)?i&&t.setProperty(e,o,a):i?t.setAttribute(e,o,a):e.setAttribute(o,a),r++}}return r}function Me(t){return 3===t||4===t||6===t}function Ee(t){return 64===t.charCodeAt(0)}function Ae(t,e){if(null===e||0===e.length);else if(null===t||0===t.length)t=e.slice();else{let n=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?n=r:0===n||De(t,n,r,null,-1===n||2===n?e[++i]:null)}}return t}function De(t,e,n,i,r){let s=0,o=t.length;if(-1===e)o=-1;else for(;s<t.length;){const n=t[s++];if("number"==typeof n){if(n===e){o=-1;break}if(n>e){o=s-1;break}}}for(;s<t.length;){const e=t[s];if("number"==typeof e)break;if(e===n){if(null===i)return void(null!==r&&(t[s+1]=r));if(i===t[s+1])return void(t[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),null!==i&&t.splice(s++,0,i),null!==r&&t.splice(s++,0,r)}function Pe(t){return t!==Ce}function Le(t){return 32767&t}function Re(t,e){let n=t>>16,i=e;for(;n>0;)i=i[15],n--;return i}let Ie=!0;function Ne(t){const e=Ie;return Ie=t,e}let ke=0;function Oe(t,e){const n=Fe(t,e);if(-1!==n)return n;const i=e[1];i.firstCreatePass&&(t.injectorIndex=e.length,ze(i.data,t),ze(e,null),ze(i.blueprint,null));const r=Ue(t,e),s=t.injectorIndex;if(Pe(r)){const t=Le(r),n=Re(r,e),i=n[1].data;for(let r=0;r<8;r++)e[s+r]=n[t+r]|i[t+r]}return e[s+8]=r,s}function ze(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Fe(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function Ue(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let n=0,i=null,r=e;for(;null!==r;){const t=r[1],e=t.type;if(i=2===e?t.declTNode:1===e?r[6]:null,null===i)return Ce;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return Ce}function He(t,e,n){!function(t,e,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(X)&&(i=n[X]),null==i&&(i=n[X]=ke++);const r=255&i;e.data[t+(r>>5)]|=1<<r}(t,e,n)}function Be(t,e,n){if(n&D.Optional)return t;_(e,"NodeInjector")}function Ve(t,e,n,i){if(n&D.Optional&&void 0===i&&(i=null),0==(n&(D.Self|D.Host))){const r=t[9],s=L(void 0);try{return r?r.get(e,i,n&D.Optional):R(e,i,n&D.Optional)}finally{L(s)}}return Be(i,e,n)}function Ge(t,e,n,i=D.Default,r){if(null!==t){const s=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(X)?t[X]:void 0;return"number"==typeof e?e>=0?255&e:We:e}(n);if("function"==typeof s){if(!se(e,t,i))return i&D.Host?Be(r,n,i):Ve(e,n,i,r);try{const t=s(i);if(null!=t||i&D.Optional)return t;_(n)}finally{ue()}}else if("number"==typeof s){let r=null,o=Fe(t,e),a=Ce,l=i&D.Host?e[16][6]:null;for((-1===o||i&D.SkipSelf)&&(a=-1===o?Ue(t,e):e[o+8],a!==Ce&&Je(i,!1)?(r=e[1],o=Le(a),e=Re(a,e)):o=-1);-1!==o;){const t=e[1];if(Xe(s,o,t.data)){const t=qe(o,e,n,r,i,l);if(t!==je)return t}a=e[o+8],a!==Ce&&Je(i,e[1].data[o+8]===l)&&Xe(s,o,e)?(r=t,o=Le(a),e=Re(a,e)):o=-1}}}return Ve(e,n,i,r)}const je={};function We(){return new $e(jt(),Bt())}function qe(t,e,n,i,r,s){const o=e[1],a=o.data[t+8],l=Ze(a,o,n,null==i?pt(a)&&Ie:i!=o&&0!=(3&a.type),r&D.Host&&s===a);return null!==l?Ye(e,o,l,a):je}function Ze(t,e,n,i,r){const s=t.providerIndexes,o=e.data,a=1048575&s,l=t.directiveStart,c=s>>20,u=r?a+c:t.directiveEnd;for(let h=i?a:a+c;h<u;h++){const t=o[h];if(h<l&&n===t||h>=l&&t.type===n)return h}if(r){const t=o[l];if(t&&mt(t)&&t.type===n)return l}return null}function Ye(t,e,n,i){let r=t[n];const s=e.data;if(r instanceof Te){const o=r;o.resolving&&function(t,e){throw new g("200",`Circular dependency in DI detected for ${t}`)}(v(s[n]));const a=Ne(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?L(o.injectImpl):null;se(t,i,D.Default);try{r=t[n]=o.factory(void 0,s,t,i),e.firstCreatePass&&n>=i.directiveStart&&function(t,e,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(i){const i=_t(e);(n.preOrderHooks||(n.preOrderHooks=[])).push(t,i),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,i)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-t,r),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t,s))}(n,s[n],e)}finally{null!==l&&L(l),Ne(a),o.resolving=!1,ue()}}return r}function Xe(t,e,n){return!!(n[e+(t>>5)]&1<<t)}function Je(t,e){return!(t&D.Self||t&D.Host&&e)}class $e{constructor(t,e){this._tNode=t,this._lView=e}get(t,e){return Ge(this._tNode,this._lView,t,void 0,e)}}function Qe(t){return I(()=>{const e=t.prototype.constructor,n=e[Y]||Ke(e),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const t=r[Y]||Ke(r);if(t&&t!==n)return t;r=Object.getPrototypeOf(r)}return t=>new t})}function Ke(t){return m(t)?()=>{const e=Ke(f(t));return e&&e()}:gt(t)}function tn(t){return function(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const n=t.attrs;if(n){const t=n.length;let i=0;for(;i<t;){const r=n[i];if(Me(r))break;if(0===r)i+=2;else if("number"==typeof r)for(i++;i<t&&"string"==typeof n[i];)i++;else{if(r===e)return n[i+1];i+=2}}}return null}(jt(),t)}const en="__parameters__";function nn(t,e,n){return I(()=>{const i=function(t){return function(...e){if(t){const n=t(...e);for(const t in n)this[t]=n[t]}}}(e);function r(...t){if(this instanceof r)return i.apply(this,t),this;const e=new r(...t);return n.annotation=e,n;function n(t,n,i){const r=t.hasOwnProperty(en)?t[en]:Object.defineProperty(t,en,{value:[]})[en];for(;r.length<=i;)r.push(null);return(r[i]=r[i]||[]).push(e),t}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class rn{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=x({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}const sn=new rn("AnalyzeForEntryComponents"),on=Function;function an(t,e){void 0===e&&(e=t);for(let n=0;n<t.length;n++){let i=t[n];Array.isArray(i)?(e===t&&(e=t.slice(0,n)),an(i,e)):e!==t&&e.push(i)}return e}function ln(t,e){t.forEach(t=>Array.isArray(t)?ln(t,e):e(t))}function cn(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function un(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function hn(t,e,n){let i=pn(t,e);return i>=0?t[1|i]=n:(i=~i,function(t,e,n,i){let r=t.length;if(r==e)t.push(n,i);else if(1===r)t.push(i,t[0]),t[0]=n;else{for(r--,t.push(t[r-1],t[r]);r>e;)t[r]=t[r-2],r--;t[e]=n,t[e+1]=i}}(t,i,e,n)),i}function dn(t,e){const n=pn(t,e);if(n>=0)return t[1|n]}function pn(t,e){return function(t,e,n){let i=0,r=t.length>>1;for(;r!==i;){const n=i+(r-i>>1),s=t[n<<1];if(e===s)return n<<1;s>e?r=n:i=n+1}return~(r<<1)}(t,e)}const fn={},mn=/\n/gm,gn="__source",yn=l({provide:String,useValue:l});let vn;function _n(t){const e=vn;return vn=t,e}function xn(t,e=D.Default){if(void 0===vn)throw new Error("inject() must be called from an injection context");return null===vn?R(t,void 0,e):vn.get(t,e&D.Optional?null:void 0,e)}function bn(t,e=D.Default){return(P||xn)(f(t),e)}function wn(t){const e=[];for(let n=0;n<t.length;n++){const i=f(t[n]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let t,n=D.Default;for(let e=0;e<i.length;e++){const r=i[e],s=r.__NG_DI_FLAG__;"number"==typeof s?-1===s?t=r.token:n|=s:t=r}e.push(bn(t,n))}else e.push(bn(i))}return e}function Cn(t,e){return t.__NG_DI_FLAG__=e,t.prototype.__NG_DI_FLAG__=e,t}const Tn=Cn(nn("Inject",t=>({token:t})),-1),Sn=Cn(nn("Optional"),8),Mn=Cn(nn("SkipSelf"),4);let En;function An(t){var e;return(null===(e=function(){if(void 0===En&&(En=null,H.trustedTypes))try{En=H.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(e){}return En}())||void 0===e?void 0:e.createHTML(t))||t}class Dn{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Pn extends Dn{getTypeName(){return"HTML"}}class Ln extends Dn{getTypeName(){return"Style"}}class Rn extends Dn{getTypeName(){return"Script"}}class In extends Dn{getTypeName(){return"URL"}}class Nn extends Dn{getTypeName(){return"ResourceURL"}}function kn(t){return t instanceof Dn?t.changingThisBreaksApplicationSecurity:t}function On(t,e){const n=zn(t);if(null!=n&&n!==e){if("ResourceURL"===n&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===e}function zn(t){return t instanceof Dn&&t.getTypeName()||null}function Fn(t){return new Pn(t)}function Un(t){return new Ln(t)}function Hn(t){return new Rn(t)}function Bn(t){return new In(t)}function Vn(t){return new Nn(t)}class Gn{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(An(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class jn{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const e=this.inertDocument.createElement("body");t.appendChild(e)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=An(t),e;const n=this.inertDocument.createElement("body");return n.innerHTML=An(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(t){const e=t.attributes;for(let i=e.length-1;0<i;i--){const n=e.item(i).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||t.removeAttribute(n)}let n=t.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Wn=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,qn=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Zn(t){return(t=String(t)).match(Wn)||t.match(qn)?t:"unsafe:"+t}function Yn(t){const e={};for(const n of t.split(","))e[n]=!0;return e}function Xn(...t){const e={};for(const n of t)for(const t in n)n.hasOwnProperty(t)&&(e[t]=!0);return e}const Jn=Yn("area,br,col,hr,img,wbr"),$n=Yn("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Qn=Yn("rp,rt"),Kn=Xn(Qn,$n),ti=Xn(Jn,Xn($n,Yn("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Xn(Qn,Yn("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Kn),ei=Yn("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),ni=Yn("srcset"),ii=Xn(ei,ni,Yn("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Yn("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ri=Yn("script,style,template");class si{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,n=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?n=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,n&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let t=this.checkClobberedElement(e,e.nextSibling);if(t){e=t;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!ti.hasOwnProperty(e))return this.sanitizedSomething=!0,!ri.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const n=t.attributes;for(let r=0;r<n.length;r++){const t=n.item(r),e=t.name,s=e.toLowerCase();if(!ii.hasOwnProperty(s)){this.sanitizedSomething=!0;continue}let o=t.value;ei[s]&&(o=Zn(o)),ni[s]&&(i=o,o=(i=String(i)).split(",").map(t=>Zn(t.trim())).join(", ")),this.buf.push(" ",e,'="',li(o),'"')}var i;return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();ti.hasOwnProperty(e)&&!Jn.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(li(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const oi=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,ai=/([^\#-~ |!])/g;function li(t){return t.replace(/&/g,"&amp;").replace(oi,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(ai,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let ci;function ui(t,e){let n=null;try{ci=ci||function(t){const e=new jn(t);return function(){try{return!!(new window.DOMParser).parseFromString(An(""),"text/html")}catch(t){return!1}}()?new Gn(e):e}(t);let i=e?String(e):"";n=ci.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=n.innerHTML,n=ci.getInertBodyElement(i)}while(i!==s);return An((new si).sanitizeChildren(hi(n)||n))}finally{if(n){const t=hi(n)||n;for(;t.firstChild;)t.removeChild(t.firstChild)}}}function hi(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var di=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}({});function pi(t){const e=function(){const t=Bt();return t&&t[12]}();return e?e.sanitize(di.URL,t)||"":On(t,"URL")?kn(t):Zn(y(t))}function fi(t,e){t.__ngContext__=e}function mi(t){const e=function(t){return t.__ngContext__||null}(t);return e?Array.isArray(e)?e:e.lView:null}function gi(t){return t.ngDebugContext}function yi(t){return t.ngOriginalError}function vi(t,...e){t.error(...e)}class _i{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),n=this._findContext(t),i=function(t){return t.ngErrorLogger||vi}(t);i(this._console,"ERROR",t),e&&i(this._console,"ORIGINAL ERROR",e),n&&i(this._console,"ERROR CONTEXT",n)}_findContext(t){return t?gi(t)?gi(t):this._findContext(yi(t)):null}_findOriginalError(t){let e=yi(t);for(;e&&yi(e);)e=yi(e);return e}}const xi=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(H))();function bi(t){return t instanceof Function?t():t}var wi=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}({});function Ci(t,e){return(void 0)(t,e)}function Ti(t){const e=t[3];return ht(e)?e[3]:e}function Si(t){return Ei(t[13])}function Mi(t){return Ei(t[4])}function Ei(t){for(;null!==t&&!ht(t);)t=t[4];return t}function Ai(t,e,n,i,r){if(null!=i){let s,o=!1;ht(i)?s=i:ut(i)&&(o=!0,i=i[0]);const a=At(i);0===t&&null!==n?null==r?ki(e,n,a):Ni(e,n,a,r||null,!0):1===t&&null!==n?Ni(e,n,a,r||null,!0):2===t?function(t,e,n){const i=zi(t,e);i&&function(t,e,n,i){Mt(t)?t.removeChild(e,n,i):e.removeChild(n)}(t,i,e,n)}(e,a,o):3===t&&e.destroyNode(a),null!=s&&function(t,e,n,i,r){const s=n[7];s!==At(n)&&Ai(e,t,i,s,r);for(let o=ct;o<n.length;o++){const r=n[o];Gi(r[1],r,t,e,i,s)}}(e,t,s,n,r)}}function Di(t,e,n){return Mt(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function Pi(t,e){const n=t[9],i=n.indexOf(e),r=e[3];1024&e[2]&&(e[2]&=-1025,Ft(r,-1)),n.splice(i,1)}function Li(t,e){if(t.length<=ct)return;const n=ct+e,i=t[n];if(i){const s=i[17];null!==s&&s!==t&&Pi(s,i),e>0&&(t[n-1][4]=i[4]);const o=un(t,ct+e);Gi(i[1],r=i,r[11],2,null,null),r[0]=null,r[6]=null;const a=o[19];null!==a&&a.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-129}var r;return i}function Ri(t,e){if(!(256&e[2])){const n=e[11];Mt(n)&&n.destroyNode&&Gi(t,e,n,3,null,null),function(t){let e=t[13];if(!e)return Ii(t[1],t);for(;e;){let n=null;if(ut(e))n=e[13];else{const t=e[10];t&&(n=t)}if(!n){for(;e&&!e[4]&&e!==t;)ut(e)&&Ii(e[1],e),e=e[3];null===e&&(e=t),ut(e)&&Ii(e[1],e),n=e&&e[4]}e=n}}(e)}}function Ii(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function(t,e){let n;if(null!=t&&null!=(n=t.destroyHooks))for(let i=0;i<n.length;i+=2){const t=e[n[i]];if(!(t instanceof Te)){const e=n[i+1];if(Array.isArray(e))for(let n=0;n<e.length;n+=2){const i=t[e[n]],r=e[n+1];try{r.call(i)}finally{}}else try{e.call(t)}finally{}}}}(t,e),function(t,e){const n=t.cleanup,i=e[7];let r=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const t=n[s+1],o="function"==typeof t?t(e):At(e[t]),a=i[r=n[s+2]],l=n[s+3];"boolean"==typeof l?o.removeEventListener(n[s],a,l):l>=0?i[r=l]():i[r=-l].unsubscribe(),s+=2}else{const t=i[r=n[s+1]];n[s].call(t)}if(null!==i){for(let t=r+1;t<i.length;t++)(0,i[t])();e[7]=null}}(t,e),1===e[1].type&&Mt(e[11])&&e[11].destroy();const n=e[17];if(null!==n&&ht(e[3])){n!==e[3]&&Pi(n,e);const i=e[19];null!==i&&i.detachView(t)}}}function Ni(t,e,n,i,r){Mt(t)?t.insertBefore(e,n,i,r):e.insertBefore(n,i,r)}function ki(t,e,n){Mt(t)?t.appendChild(e,n):e.appendChild(n)}function Oi(t,e,n,i,r){null!==i?Ni(t,e,n,i,r):ki(t,e,n)}function zi(t,e){return Mt(t)?t.parentNode(e):e.parentNode}function Fi(t,e,n,i){const r=function(t,e,n){return function(t,e,n){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return n[0];if(2&i.flags){const e=t.data[i.directiveStart].encapsulation;if(e===k.None||e===k.Emulated)return null}return Pt(i,n)}(t,e.parent,n)}(t,i,e),s=e[11],o=function(t,e,n){return function(t,e,n){return 40&t.type?Pt(t,n):null}(t,0,n)}(i.parent||e[6],0,e);if(null!=r)if(Array.isArray(n))for(let a=0;a<n.length;a++)Oi(s,r,n[a],o,!1);else Oi(s,r,n,o,!1)}function Ui(t,e){if(null!==e){const n=e.type;if(3&n)return Pt(e,t);if(4&n)return Bi(-1,t[e.index]);if(8&n){const n=e.child;if(null!==n)return Ui(t,n);{const n=t[e.index];return ht(n)?Bi(-1,n):At(n)}}if(32&n)return Ci(e,t)()||At(t[e.index]);{const n=Hi(t,e);return null!==n?Array.isArray(n)?n[0]:Ui(Ti(t[16]),n):Ui(t,e.next)}}return null}function Hi(t,e){return null!==e?t[16][6].projection[e.projection]:null}function Bi(t,e){const n=ct+t+1;if(n<e.length){const t=e[n],i=t[1].firstChild;if(null!==i)return Ui(t,i)}return e[7]}function Vi(t,e,n,i,r,s,o){for(;null!=n;){const a=i[n.index],l=n.type;if(o&&0===e&&(a&&fi(At(a),i),n.flags|=4),64!=(64&n.flags))if(8&l)Vi(t,e,n.child,i,r,s,!1),Ai(e,t,r,a,s);else if(32&l){const o=Ci(n,i);let l;for(;l=o();)Ai(e,t,r,l,s);Ai(e,t,r,a,s)}else 16&l?ji(t,e,i,n,r,s):Ai(e,t,r,a,s);n=o?n.projectionNext:n.next}}function Gi(t,e,n,i,r,s){Vi(n,i,t.firstChild,e,r,s,!1)}function ji(t,e,n,i,r,s){const o=n[16],a=o[6].projection[i.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)Ai(e,t,r,a[l],s);else Vi(t,e,a,o[3],r,s,!0)}function Wi(t,e,n){Mt(t)?t.setAttribute(e,"style",n):e.style.cssText=n}function qi(t,e,n){Mt(t)?""===n?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n):e.className=n}function Zi(t,e,n){let i=t.length;for(;;){const r=t.indexOf(e,n);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const n=e.length;if(r+n===i||t.charCodeAt(r+n)<=32)return r}n=r+1}}const Yi="ng-template";function Xi(t,e,n){let i=0;for(;i<t.length;){let r=t[i++];if(n&&"class"===r){if(r=t[i],-1!==Zi(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Ji(t){return 4===t.type&&t.value!==Yi}function $i(t,e,n){return e===(4!==t.type||n?t.value:Yi)}function Qi(t,e,n){let i=4;const r=t.attrs||[],s=function(t){for(let e=0;e<t.length;e++)if(Me(t[e]))return e;return t.length}(r);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!$i(t,l,n)||""===l&&1===e.length){if(Ki(i))return!1;o=!0}}else{const c=8&i?l:e[++a];if(8&i&&null!==t.attrs){if(!Xi(t.attrs,c,n)){if(Ki(i))return!1;o=!0}continue}const u=tr(8&i?"class":l,r,Ji(t),n);if(-1===u){if(Ki(i))return!1;o=!0;continue}if(""!==c){let t;t=u>s?"":r[u+1].toLowerCase();const e=8&i?t:null;if(e&&-1!==Zi(e,c,0)||2&i&&c!==t){if(Ki(i))return!1;o=!0}}}}else{if(!o&&!Ki(i)&&!Ki(l))return!1;if(o&&Ki(l))continue;o=!1,i=l|1&i}}return Ki(i)||o}function Ki(t){return 0==(1&t)}function tr(t,e,n,i){if(null===e)return-1;let r=0;if(i||!n){let n=!1;for(;r<e.length;){const i=e[r];if(i===t)return r;if(3===i||6===i)n=!0;else{if(1===i||2===i){let t=e[++r];for(;"string"==typeof t;)t=e[++r];continue}if(4===i)break;if(0===i){r+=4;continue}}r+=n?1:2}return-1}return function(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){const i=t[n];if("number"==typeof i)return-1;if(i===e)return n;n++}return-1}(e,t)}function er(t,e,n=!1){for(let i=0;i<e.length;i++)if(Qi(t,e[i],n))return!0;return!1}function nr(t,e){return t?":not("+e.trim()+")":e}function ir(t){let e=t[0],n=1,i=2,r="",s=!1;for(;n<t.length;){let o=t[n];if("string"==typeof o)if(2&i){const e=t[++n];r+="["+o+(e.length>0?'="'+e+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""===r||Ki(o)||(e+=nr(s,r),r=""),i=o,s=s||!Ki(i);n++}return""!==r&&(e+=nr(s,r)),e}const rr={};function sr(t){or(Vt(),Bt(),de()+t,Yt())}function or(t,e,n,i){if(!i)if(3==(3&e[2])){const i=t.preOrderCheckHooks;null!==i&&ve(e,i,n)}else{const i=t.preOrderHooks;null!==i&&_e(e,i,0,n)}pe(n)}function ar(t,e){return t<<17|e<<2}function lr(t){return t>>17&32767}function cr(t){return 2|t}function ur(t){return(131068&t)>>2}function hr(t,e){return-131069&t|e<<2}function dr(t){return 1|t}function pr(t,e){const n=t.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],s=n[i+1];if(-1!==s){const n=t.data[s];ie(r),n.contentQueries(2,e[s],s)}}}function fr(t,e,n,i,r,s,o,a,l,c){const u=e.blueprint.slice();return u[0]=r,u[2]=140|i,zt(u),u[3]=u[15]=t,u[8]=n,u[10]=o||t&&t[10],u[11]=a||t&&t[11],u[12]=l||t&&t[12]||null,u[9]=c||t&&t[9]||null,u[6]=s,u[16]=2==e.type?t[16]:u,u}function mr(t,e,n,i,r){let s=t.data[e];if(null===s)s=function(t,e,n,i,r){const s=Wt(),o=Zt(),a=t.data[e]=function(t,e,n,i,r,s){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,e,i,r);return null===t.firstChild&&(t.firstChild=a),null!==s&&(o?null==s.child&&null!==a.parent&&(s.child=a):null===s.next&&(s.next=a)),a}(t,e,n,i,r),Ut.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const t=function(){const t=Ut.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();s.injectorIndex=null===t?-1:t.injectorIndex}return qt(s,!0),s}function gr(t,e,n,i){if(0===n)return-1;const r=e.length;for(let s=0;s<n;s++)e.push(i),t.blueprint.push(i),t.data.push(null);return r}function yr(t,e,n){oe(e);try{const i=t.viewQuery;null!==i&&qr(1,i,n);const r=t.template;null!==r&&xr(t,e,r,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&pr(t,e),t.staticViewQueries&&qr(2,t.viewQuery,n);const s=t.components;null!==s&&function(t,e){for(let n=0;n<e.length;n++)Br(t,e[n])}(e,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0),i}finally{e[2]&=-5,he()}}function vr(t,e,n,i){const r=e[2];if(256==(256&r))return;oe(e);const s=Yt();try{zt(e),Ut.lFrame.bindingIndex=t.bindingStartIndex,null!==n&&xr(t,e,n,2,i);const o=3==(3&r);if(!s)if(o){const n=t.preOrderCheckHooks;null!==n&&ve(e,n,null)}else{const n=t.preOrderHooks;null!==n&&_e(e,n,0,null),xe(e,0)}if(function(t){for(let e=Si(t);null!==e;e=Mi(e)){if(!e[2])continue;const t=e[9];for(let e=0;e<t.length;e++){const n=t[e],i=n[3];0==(1024&n[2])&&Ft(i,1),n[2]|=1024}}}(e),function(t){for(let e=Si(t);null!==e;e=Mi(e))for(let t=ct;t<e.length;t++){const n=e[t],i=n[1];kt(n)&&vr(i,n,i.template,n[8])}}(e),null!==t.contentQueries&&pr(t,e),!s)if(o){const n=t.contentCheckHooks;null!==n&&ve(e,n)}else{const n=t.contentHooks;null!==n&&_e(e,n,1),xe(e,1)}!function(t,e){const n=t.hostBindingOpCodes;if(null!==n)try{for(let t=0;t<n.length;t++){const i=n[t];if(i<0)pe(~i);else{const r=i,s=n[++t],o=n[++t];te(s,r),o(2,e[r])}}}finally{pe(-1)}}(t,e);const a=t.components;null!==a&&function(t,e){for(let n=0;n<e.length;n++)Ur(t,e[n])}(e,a);const l=t.viewQuery;if(null!==l&&qr(2,l,i),!s)if(o){const n=t.viewCheckHooks;null!==n&&ve(e,n)}else{const n=t.viewHooks;null!==n&&_e(e,n,2),xe(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),s||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,Ft(e[3],-1))}finally{he()}}function _r(t,e,n,i){const r=e[10],s=!Yt(),o=Nt(e);try{s&&!o&&r.begin&&r.begin(),o&&yr(t,e,i),vr(t,e,n,i)}finally{s&&!o&&r.end&&r.end()}}function xr(t,e,n,i,r){const s=de(),o=2&i;try{pe(-1),o&&e.length>lt&&or(t,e,lt,Yt()),n(i,r)}finally{pe(s)}}function br(t,e,n){Ht()&&(function(t,e,n,i){const r=n.directiveStart,s=n.directiveEnd;t.firstCreatePass||Oe(n,e),fi(i,e);const o=n.initialInputs;for(let a=r;a<s;a++){const i=t.data[a],s=mt(i);s&&kr(e,n,i);const l=Ye(e,t,a,n);fi(l,e),null!==o&&Or(0,a-r,l,i,0,o),s&&(It(n.index,e)[8]=l)}}(t,e,n,Pt(n,e)),128==(128&n.flags)&&function(t,e,n){const i=n.directiveStart,r=n.directiveEnd,s=n.index,o=Ut.lFrame.currentDirectiveIndex;try{pe(s);for(let n=i;n<r;n++){const i=t.data[n],r=e[n];ee(n),null===i.hostBindings&&0===i.hostVars&&null===i.hostAttrs||Pr(i,r)}}finally{pe(-1),ee(o)}}(t,e,n))}function wr(t,e,n=Pt){const i=e.localNames;if(null!==i){let r=e.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?n(e,t):t[o];t[r++]=a}}}function Cr(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Tr(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Tr(t,e,n,i,r,s,o,a,l,c){const u=lt+i,h=u+r,d=function(t,e){const n=[];for(let i=0;i<e;i++)n.push(i<t?null:rr);return n}(u,h),p="function"==typeof c?c():c;return d[1]={type:t,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:e,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1}}function Sr(t,e,n,i){const r=Yr(e);null===n?r.push(i):(r.push(n),t.firstCreatePass&&Xr(t).push(i,r.length-1))}function Mr(t,e,n){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(e,r):n[i]=[e,r]}return n}function Er(t,e,n,i,r,s,o,a){const l=Pt(e,n);let c,u=e.inputs;var h;!a&&null!=u&&(c=u[i])?($r(t,n,c,i,r),pt(e)&&function(t,e){const n=It(e,t);16&n[2]||(n[2]|=64)}(n,e.index)):3&e.type&&(i="class"===(h=i)?"className":"for"===h?"htmlFor":"formaction"===h?"formAction":"innerHtml"===h?"innerHTML":"readonly"===h?"readOnly":"tabindex"===h?"tabIndex":h,r=null!=o?o(r,e.value||"",i):r,Mt(s)?s.setProperty(l,i,r):Ee(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function Ar(t,e,n,i){let r=!1;if(Ht()){const s=function(t,e,n){const i=t.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];er(n,o.selectors,!1)&&(r||(r=[]),He(Oe(n,e),t,o.type),mt(o)?(Lr(t,n),r.unshift(o)):r.push(o))}return r}(t,e,n),o=null===i?null:{"":-1};if(null!==s){r=!0,Ir(n,t.data.length,s.length);for(let t=0;t<s.length;t++){const e=s[t];e.providersResolver&&e.providersResolver(e)}let i=!1,a=!1,l=gr(t,e,s.length,null);for(let r=0;r<s.length;r++){const c=s[r];n.mergedAttrs=Ae(n.mergedAttrs,c.hostAttrs),Nr(t,n,e,l,c),Rr(l,c,o),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128);const u=c.type.prototype;!i&&(u.ngOnChanges||u.ngOnInit||u.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n.index),i=!0),a||!u.ngOnChanges&&!u.ngDoCheck||((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n.index),a=!0),l++}!function(t,e){const n=e.directiveEnd,i=t.data,r=e.attrs,s=[];let o=null,a=null;for(let l=e.directiveStart;l<n;l++){const t=i[l],n=t.inputs,c=null===r||Ji(e)?null:zr(n,r);s.push(c),o=Mr(n,l,o),a=Mr(t.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(e.flags|=16),o.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=s,e.inputs=o,e.outputs=a}(t,n)}o&&function(t,e,n){if(e){const i=t.localNames=[];for(let t=0;t<e.length;t+=2){const r=n[e[t+1]];if(null==r)throw new g("301",`Export of name '${e[t+1]}' not found!`);i.push(e[t],r)}}}(n,i,o)}return n.mergedAttrs=Ae(n.mergedAttrs,n.attrs),r}function Dr(t,e,n,i,r,s){const o=s.hostBindings;if(o){let n=t.hostBindingOpCodes;null===n&&(n=t.hostBindingOpCodes=[]);const s=~e.index;(function(t){let e=t.length;for(;e>0;){const n=t[--e];if("number"==typeof n&&n<0)return n}return 0})(n)!=s&&n.push(s),n.push(i,r,o)}}function Pr(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function Lr(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Rr(t,e,n){if(n){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)n[e.exportAs[i]]=t;mt(e)&&(n[""]=t)}}function Ir(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Nr(t,e,n,i,r){t.data[i]=r;const s=r.factory||(r.factory=gt(r.type)),o=new Te(s,mt(r),null);t.blueprint[i]=o,n[i]=o,Dr(t,e,0,i,gr(t,n,r.hostVars,rr),r)}function kr(t,e,n){const i=Pt(e,t),r=Cr(n),s=t[10],o=Vr(t,fr(t,r,null,n.onPush?64:16,i,e,s,s.createRenderer(i,n),null,null));t[e.index]=o}function Or(t,e,n,i,r,s){const o=s[e];if(null!==o){const t=i.setInput;for(let e=0;e<o.length;){const r=o[e++],s=o[e++],a=o[e++];null!==t?i.setInput(n,a,r,s):n[s]=a}}}function zr(t,e){let n=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,t[r],e[i+1])),i+=2}else i+=2;else i+=4}return n}function Fr(t,e,n,i){return new Array(t,!0,!1,e,null,0,i,n,null,null)}function Ur(t,e){const n=It(e,t);if(kt(n)){const t=n[1];80&n[2]?vr(t,n,t.template,n[8]):n[5]>0&&Hr(n)}}function Hr(t){for(let n=Si(t);null!==n;n=Mi(n))for(let t=ct;t<n.length;t++){const e=n[t];if(1024&e[2]){const t=e[1];vr(t,e,t.template,e[8])}else e[5]>0&&Hr(e)}const e=t[1].components;if(null!==e)for(let n=0;n<e.length;n++){const i=It(e[n],t);kt(i)&&i[5]>0&&Hr(i)}}function Br(t,e){const n=It(e,t),i=n[1];!function(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}(i,n),yr(i,n,n[8])}function Vr(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function Gr(t){for(;t;){t[2]|=64;const e=Ti(t);if(0!=(512&t[2])&&!e)return t;t=e}return null}function jr(t,e,n){const i=e[10];i.begin&&i.begin();try{vr(t,e,t.template,n)}catch(r){throw Jr(e,r),r}finally{i.end&&i.end()}}function Wr(t){!function(t){for(let e=0;e<t.components.length;e++){const n=t.components[e],i=mi(n),r=i[1];_r(r,i,r.template,n)}}(t[8])}function qr(t,e,n){ie(0),e(t,n)}const Zr=(()=>Promise.resolve(null))();function Yr(t){return t[7]||(t[7]=[])}function Xr(t){return t.cleanup||(t.cleanup=[])}function Jr(t,e){const n=t[9],i=n?n.get(_i,null):null;i&&i.handleError(e)}function $r(t,e,n,i,r){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=e[o],c=t.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Qr(t,e,n){const i=Dt(e,t);!function(t,e,n){Mt(t)?t.setValue(e,n):e.textContent=n}(t[11],i,n)}function Kr(t,e,n){let i=n?t.styles:null,r=n?t.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const t=e[o];"number"==typeof t?s=t:1==s?r=h(r,t):2==s&&(i=h(i,t+": "+e[++o]+";"))}n?t.styles=i:t.stylesWithoutHost=i,n?t.classes=r:t.classesWithoutHost=r}const ts=new rn("INJECTOR",-1);class es{get(t,e=fn){if(e===fn){const e=new Error(`NullInjectorError: No provider for ${u(t)}!`);throw e.name="NullInjectorError",e}return e}}const ns=new rn("Set Injector scope."),is={},rs={};let ss;function os(){return void 0===ss&&(ss=new es),ss}function as(t,e=null,n=null,i){return new ls(t,n,e||os(),i)}class ls{constructor(t,e,n,i=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const r=[];e&&ln(e,n=>this.processProvider(n,t,e)),ln([t],t=>this.processInjectorType(t,[],r)),this.records.set(ts,hs(void 0,this));const s=this.records.get(ns);this.scope=null!=s?s.value:null,this.source=i||("object"==typeof t?null:u(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=fn,n=D.Default){this.assertNotDestroyed();const i=_n(this);try{if(!(n&D.SkipSelf)){let e=this.records.get(t);if(void 0===e){const n=("function"==typeof(r=t)||"object"==typeof r&&r instanceof rn)&&w(t);e=n&&this.injectableDefInScope(n)?hs(cs(t),is):null,this.records.set(t,e)}if(null!=e)return this.hydrate(t,e)}return(n&D.Self?os():this.parent).get(t,e=n&D.Optional&&e===fn?null:e)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(u(t)),i)throw s;return function(t,e,n,i){const r=t.ngTempTokenPath;throw e[gn]&&r.unshift(e[gn]),t.message=function(t,e,n,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=u(e);if(Array.isArray(e))r=e.map(u).join(" -> ");else if("object"==typeof e){let t=[];for(let n in e)if(e.hasOwnProperty(n)){let i=e[n];t.push(n+":"+("string"==typeof i?JSON.stringify(i):u(i)))}r=`{${t.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${t.replace(mn,"\n  ")}`}("\n"+t.message,r,n,i),t.ngTokenPath=r,t.ngTempTokenPath=null,t}(s,t,"R3InjectorError",this.source)}throw s}finally{_n(i)}var r}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((e,n)=>t.push(u(n))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(t,e,n){if(!(t=f(t)))return!1;let i=T(t);const r=null==i&&t.ngModule||void 0,s=void 0===r?t:r,o=-1!==n.indexOf(s);if(void 0!==r&&(i=T(r)),null==i)return!1;if(null!=i.imports&&!o){let t;n.push(s);try{ln(i.imports,i=>{this.processInjectorType(i,e,n)&&(void 0===t&&(t=[]),t.push(i))})}finally{}if(void 0!==t)for(let e=0;e<t.length;e++){const{ngModule:n,providers:i}=t[e];ln(i,t=>this.processProvider(t,n,i||V))}}this.injectorDefTypes.add(s);const a=gt(s)||(()=>new s);this.records.set(s,hs(a,is));const l=i.providers;if(null!=l&&!o){const e=t;ln(l,t=>this.processProvider(t,e,l))}return void 0!==r&&void 0!==t.providers}processProvider(t,e,n){let i=ps(t=f(t))?t:f(t&&t.provide);const r=function(t,e,n){return ds(t)?hs(void 0,t.useValue):hs(us(t),is)}(t);if(ps(t)||!0!==t.multi)this.records.get(i);else{let e=this.records.get(i);e||(e=hs(void 0,is,!0),e.factory=()=>wn(e.multi),this.records.set(i,e)),i=t,e.multi.push(t)}this.records.set(i,r)}hydrate(t,e){var n;return e.value===is&&(e.value=rs,e.value=e.factory()),"object"==typeof e.value&&e.value&&null!==(n=e.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=f(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function cs(t){const e=w(t),n=null!==e?e.factory:gt(t);if(null!==n)return n;if(t instanceof rn)throw new Error(`Token ${u(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const e=t.length;if(e>0){const n=function(t,e){const n=[];for(let i=0;i<t;i++)n.push("?");return n}(e);throw new Error(`Can't resolve all parameters for ${u(t)}: (${n.join(", ")}).`)}const n=function(t){const e=t&&(t[S]||t[E]);if(e){const n=function(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),e}return null}(t);return null!==n?()=>n.factory(t):()=>new t}(t);throw new Error("unreachable")}function us(t,e,n){let i;if(ps(t)){const e=f(t);return gt(e)||cs(e)}if(ds(t))i=()=>f(t.useValue);else if((r=t)&&r.useFactory)i=()=>t.useFactory(...wn(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))i=()=>bn(f(t.useExisting));else{const e=f(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return gt(e)||cs(e);i=()=>new e(...wn(t.deps))}var r;return i}function hs(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function ds(t){return null!==t&&"object"==typeof t&&yn in t}function ps(t){return"function"==typeof t}const fs=function(t,e,n){return function(t,e=null,n=null,i){const r=as(t,e,n,i);return r._resolveInjectorDefTypes(),r}({name:n},e,t,n)};let ms=(()=>{class t{static create(t,e){return Array.isArray(t)?fs(t,e,""):fs(t.providers,t.parent,t.name||"")}}return t.THROW_IF_NOT_FOUND=fn,t.NULL=new es,t.\u0275prov=x({token:t,providedIn:"any",factory:()=>bn(ts)}),t.__NG_ELEMENT_ID__=-1,t})();function gs(t,e){ye(mi(t)[1],jt())}function ys(t){let e=Object.getPrototypeOf(t.type.prototype).constructor,n=!0;const i=[t];for(;e;){let r;if(mt(t))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Error("Directives cannot inherit Components");r=e.\u0275dir}if(r){if(n){i.push(r);const e=t;e.inputs=vs(t.inputs),e.declaredInputs=vs(t.declaredInputs),e.outputs=vs(t.outputs);const n=r.hostBindings;n&&bs(t,n);const s=r.viewQuery,o=r.contentQueries;if(s&&_s(t,s),o&&xs(t,o),c(t.inputs,r.inputs),c(t.declaredInputs,r.declaredInputs),c(t.outputs,r.outputs),mt(r)&&r.data.animation){const e=t.data;e.animation=(e.animation||[]).concat(r.data.animation)}}const e=r.features;if(e)for(let i=0;i<e.length;i++){const r=e[i];r&&r.ngInherit&&r(t),r===ys&&(n=!1)}}e=Object.getPrototypeOf(e)}!function(t){let e=0,n=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Ae(r.hostAttrs,n=Ae(n,r.hostAttrs))}}(i)}function vs(t){return t===B?{}:t===V?[]:t}function _s(t,e){const n=t.viewQuery;t.viewQuery=n?(t,i)=>{e(t,i),n(t,i)}:e}function xs(t,e){const n=t.contentQueries;t.contentQueries=n?(t,i,r)=>{e(t,i,r),n(t,i,r)}:e}function bs(t,e){const n=t.hostBindings;t.hostBindings=n?(t,i)=>{e(t,i),n(t,i)}:e}let ws=null;function Cs(){if(!ws){const t=H.Symbol;if(t&&t.iterator)ws=t.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const n=t[e];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(ws=n)}}}return ws}class Ts{constructor(t){this.wrapped=t}static wrap(t){return new Ts(t)}static unwrap(t){return Ts.isWrapped(t)?t.wrapped:t}static isWrapped(t){return t instanceof Ts}}function Ss(t){return!!Ms(t)&&(Array.isArray(t)||!(t instanceof Map)&&Cs()in t)}function Ms(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Es(t,e,n){return t[e]=n}function As(t,e,n){return!Object.is(t[e],n)&&(t[e]=n,!0)}function Ds(t,e,n,i){const r=As(t,e,n);return As(t,e+1,i)||r}function Ps(t,e,n,i){const r=Bt();return As(r,Qt(),e)&&(Vt(),function(t,e,n,i,r,s){const o=Pt(t,e);!function(t,e,n,i,r,s,o){if(null==s)Mt(t)?t.removeAttribute(e,r,n):e.removeAttribute(r);else{const a=null==o?y(s):o(s,i||"",r);Mt(t)?t.setAttribute(e,r,a,n):n?e.setAttributeNS(n,r,a):e.setAttribute(r,a)}}(e[11],o,s,t.value,n,i,r)}(fe(),r,t,e,n,i)),Ps}function Ls(t,e,n,i,r,s,o,a){const l=Bt(),c=Vt(),u=t+lt,h=c.firstCreatePass?function(t,e,n,i,r,s,o,a,l){const c=e.consts,u=mr(e,t,4,o||null,Ot(c,a));Ar(e,n,u,Ot(c,l)),ye(e,u);const h=u.tViews=Tr(2,u,i,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c);return null!==e.queries&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}(u,c,l,e,n,i,r,s,o):c.data[u];qt(h,!1);const d=l[11].createComment("");Fi(c,l,d,h),fi(d,l),Vr(l,l[u]=Fr(d,l,d,h)),ft(h)&&br(c,l,h),null!=o&&wr(l,h,a)}function Rs(t){return Rt(Ut.lFrame.contextLView,lt+t)}function Is(t,e=D.Default){const n=Bt();return null===n?bn(t,e):Ge(jt(),n,f(t),e)}function Ns(t,e,n){const i=Bt();return As(i,Qt(),e)&&Er(Vt(),fe(),i,t,e,i[11],n,!1),Ns}function ks(t,e,n,i,r){const s=r?"class":"style";$r(t,n,e.inputs[s],s,i)}function Os(t,e,n,i){const r=Bt(),s=Vt(),o=lt+t,a=r[11],l=r[o]=Di(a,e,Ut.lFrame.currentNamespace),c=s.firstCreatePass?function(t,e,n,i,r,s,o){const a=e.consts,l=mr(e,t,2,r,Ot(a,s));return Ar(e,n,l,Ot(a,o)),null!==l.attrs&&Kr(l,l.attrs,!1),null!==l.mergedAttrs&&Kr(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,r,0,e,n,i):s.data[o];qt(c,!0);const u=c.mergedAttrs;null!==u&&Se(a,l,u);const h=c.classes;null!==h&&qi(a,l,h);const d=c.styles;null!==d&&Wi(a,l,d),64!=(64&c.flags)&&Fi(s,r,l,c),0===Ut.lFrame.elementDepthCount&&fi(l,r),Ut.lFrame.elementDepthCount++,ft(c)&&(br(s,r,c),function(t,e,n){if(dt(e)){const i=e.directiveEnd;for(let r=e.directiveStart;r<i;r++){const e=t.data[r];e.contentQueries&&e.contentQueries(1,n[r],r)}}}(s,c,r)),null!==i&&wr(r,c)}function zs(){let t=jt();Zt()?Ut.lFrame.isParent=!1:(t=t.parent,qt(t,!1));const e=t;Ut.lFrame.elementDepthCount--;const n=Vt();n.firstCreatePass&&(ye(n,t),dt(t)&&n.queries.elementEnd(t)),null!=e.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(e)&&ks(n,e,Bt(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(e)&&ks(n,e,Bt(),e.stylesWithoutHost,!1)}function Fs(t,e,n,i){Os(t,e,n,i),zs()}function Us(){return Bt()}function Hs(t){return!!t&&"function"==typeof t.then}function Bs(t){return!!t&&"function"==typeof t.subscribe}const Vs=Bs;function Gs(t,e,n,i){const r=Bt(),s=Vt(),o=jt();return function(t,e,n,i,r,s,o,a){const l=ft(i),c=t.firstCreatePass&&Xr(t),u=Yr(e);let h=!0;if(3&i.type||a){const d=Pt(i,e),p=a?a(d):d,f=u.length,m=a?t=>a(At(t[i.index])):i.index;if(Mt(n)){let o=null;if(!a&&l&&(o=function(t,e,n,i){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const t=r[s];if(t===n&&r[s+1]===i){const t=e[7],n=r[s+2];return t.length>n?t[n]:null}"string"==typeof t&&(s+=2)}return null}(t,e,r,i.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,h=!1;else{s=Ws(i,e,0,s,!1);const t=n.listen(p,r,s);u.push(s,t),c&&c.push(r,m,f,f+1)}}else s=Ws(i,e,0,s,!0),p.addEventListener(r,s,o),u.push(s),c&&c.push(r,m,f,o)}else s=Ws(i,e,0,s,!1);const d=i.outputs;let p;if(h&&null!==d&&(p=d[r])){const t=p.length;if(t)for(let n=0;n<t;n+=2){const t=e[p[n]][p[n+1]].subscribe(s),o=u.length;u.push(s,t),c&&c.push(r,i.index,o,-(o+1))}}}(s,r,r[11],o,t,e,!!n,i),Gs}function js(t,e,n,i){try{return!1!==n(i)}catch(r){return Jr(t,r),!1}}function Ws(t,e,n,i,r){return function n(s){if(s===Function)return i;const o=2&t.flags?It(t.index,e):e;0==(32&e[2])&&Gr(o);let a=js(e,0,i,s),l=n.__ngNextListenerFn__;for(;l;)a=js(e,0,l,s)&&a,l=l.__ngNextListenerFn__;return r&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function qs(t=1){return function(t){return(Ut.lFrame.contextLView=function(t,e){for(;t>0;)e=e[15],t--;return e}(t,Ut.lFrame.contextLView))[8]}(t)}function Zs(t,e,n,i,r){const s=t[n+1],o=null===e;let a=i?lr(s):ur(s),l=!1;for(;0!==a&&(!1===l||o);){const n=t[a+1];Ys(t[a],e)&&(l=!0,t[a+1]=i?dr(n):cr(n)),a=i?lr(n):ur(n)}l&&(t[n+1]=i?cr(s):dr(s))}function Ys(t,e){return null===t||null==e||(Array.isArray(t)?t[1]:t)===e||!(!Array.isArray(t)||"string"!=typeof e)&&pn(t,e)>=0}function Xs(t,e){return function(t,e,n,i){const r=Bt(),s=Vt(),o=Kt(2);s.firstUpdatePass&&function(t,e,n,i){const r=t.data;if(null===r[n+1]){const s=r[de()],o=function(t,e){return e>=t.expandoStartIndex}(t,n);(function(t,e){return 0!=(16&t.flags)})(s)&&null===e&&!o&&(e=!1),e=function(t,e,n,i){const r=function(t){const e=Ut.lFrame.currentDirectiveIndex;return-1===e?null:t[e]}(t);let s=e.residualClasses;if(null===r)0===e.classBindings&&(n=$s(n=Js(null,t,e,n,i),e.attrs,i),s=null);else{const o=e.directiveStylingLast;if(-1===o||t[o]!==r)if(n=Js(r,t,e,n,i),null===s){let n=function(t,e,n){const i=e.classBindings;if(0!==ur(i))return t[lr(i)]}(t,e);void 0!==n&&Array.isArray(n)&&(n=Js(null,t,e,n[1],i),n=$s(n,e.attrs,i),function(t,e,n,i){t[lr(e.classBindings)]=i}(t,e,0,n))}else s=function(t,e,n){let i;const r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++)i=$s(i,t[s].hostAttrs,true);return $s(i,e.attrs,true)}(t,e)}return void 0!==s&&(e.residualClasses=s),n}(r,s,e,i),function(t,e,n,i,r,s){let o=e.classBindings,a=lr(o),l=ur(o);t[i]=n;let c,u=!1;if(Array.isArray(n)){const t=n;c=t[1],(null===c||pn(t,c)>0)&&(u=!0)}else c=n;if(r)if(0!==l){const e=lr(t[a+1]);t[i+1]=ar(e,a),0!==e&&(t[e+1]=hr(t[e+1],i)),t[a+1]=131071&t[a+1]|i<<17}else t[i+1]=ar(a,0),0!==a&&(t[a+1]=hr(t[a+1],i)),a=i;else t[i+1]=ar(l,0),0===a?a=i:t[l+1]=hr(t[l+1],i),l=i;u&&(t[i+1]=cr(t[i+1])),Zs(t,c,i,!0),Zs(t,c,i,!1),function(t,e,n,i,r){const s=t.residualClasses;null!=s&&"string"==typeof e&&pn(s,e)>=0&&(n[i+1]=dr(n[i+1]))}(e,c,t,i),o=ar(a,l),e.classBindings=o}(r,s,e,n,o)}}(s,t,o,true),e!==rr&&As(r,o,e)&&function(t,e,n,i,r,s,o,a){if(!(3&e.type))return;const l=t.data,c=l[a+1];Ks(1==(1&c)?Qs(l,e,n,r,ur(c),o):void 0)||(Ks(s)||function(t){return 2==(2&t)}(c)&&(s=Qs(l,null,n,r,a,o)),function(t,e,n,i,r){const s=Mt(t);r?s?t.addClass(n,i):n.classList.add(i):s?t.removeClass(n,i):n.classList.remove(i)}(i,0,Dt(de(),n),r,s))}(s,s.data[de()],r,r[11],t,r[o+1]=function(t,e){return null==t||"object"==typeof t&&(t=u(kn(t))),t}(e),true,o)}(t,e),Xs}function Js(t,e,n,i,r){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=e[a],i=$s(i,s.hostAttrs,r),s!==t);)a++;return null!==t&&(n.directiveStylingLast=a),i}function $s(t,e,n){const i=n?1:2;let r=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?r=o:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),hn(t,o,!!n||e[++s]))}return void 0===t?null:t}function Qs(t,e,n,i,r,s){const o=null===e;let a;for(;r>0;){const e=t[r],s=Array.isArray(e),l=s?e[1]:e,c=null===l;let u=n[r+1];u===rr&&(u=c?V:void 0);let h=c?dn(u,i):l===i?u:void 0;if(s&&!Ks(h)&&(h=dn(e,i)),Ks(h)&&(a=h,o))return a;const d=t[r+1];r=o?lr(d):ur(d)}if(null!==e){let t=s?e.residualClasses:e.residualStyles;null!=t&&(a=dn(t,i))}return a}function Ks(t){return void 0!==t}function to(t,e=""){const n=Bt(),i=Vt(),r=t+lt,s=i.firstCreatePass?mr(i,r,1,e,null):i.data[r],o=n[r]=function(t,e){return Mt(t)?t.createText(e):t.createTextNode(e)}(n[11],e);Fi(i,n,o,s),qt(s,!1)}function eo(t){return no("",t,""),eo}function no(t,e,n){const i=Bt(),r=function(t,e,n,i){return As(t,Qt(),n)?e+y(n)+i:rr}(i,t,e,n);return r!==rr&&Qr(i,de(),r),no}function io(t,e,n,i,r){const s=Bt(),o=function(t,e,n,i,r,s){const o=Ds(t,$t(),n,r);return Kt(2),o?e+y(n)+i+y(r)+s:rr}(s,t,e,n,i,r);return o!==rr&&Qr(s,de(),o),io}function ro(t,e,n){const i=Bt();return As(i,Qt(),e)&&Er(Vt(),fe(),i,t,e,i[11],n,!0),ro}const so=void 0;var oo=["en",[["a","p"],["AM","PM"],so],[["AM","PM"],so,so],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],so,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],so,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",so,"{1} 'at' {0}",so],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){let e=Math.floor(Math.abs(t)),n=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===n?1:5}];let ao={};function lo(t){const e=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let n=uo(e);if(n)return n;const i=e.split("-")[0];if(n=uo(i),n)return n;if("en"===i)return oo;throw new Error(`Missing locale data for the locale "${t}".`)}function co(t){return lo(t)[ho.PluralCase]}function uo(t){return t in ao||(ao[t]=H.ng&&H.ng.common&&H.ng.common.locales&&H.ng.common.locales[t]),ao[t]}var ho=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}({});const po="en-US";let fo=po;function mo(t){var e,n;n="Expected localeId to be defined",null==(e=t)&&function(t,e,n,i){throw new Error(`ASSERTION ERROR: ${t} [Expected=> null != ${e} <=Actual]`)}(n,e),"string"==typeof t&&(fo=t.toLowerCase().replace(/_/g,"-"))}function go(t,e,n,i,r){if(t=f(t),Array.isArray(t))for(let s=0;s<t.length;s++)go(t[s],e,n,i,r);else{const s=Vt(),o=Bt();let a=ps(t)?t:f(t.provide),l=us(t);const c=jt(),u=1048575&c.providerIndexes,h=c.directiveStart,d=c.providerIndexes>>20;if(ps(t)||!t.multi){const i=new Te(l,r,Is),p=_o(a,e,r?u:u+d,h);-1===p?(He(Oe(c,o),s,a),yo(s,t,e.length),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),n.push(i),o.push(i)):(n[p]=i,o[p]=i)}else{const p=_o(a,e,u+d,h),f=_o(a,e,u,u+d),m=p>=0&&n[p],g=f>=0&&n[f];if(r&&!g||!r&&!m){He(Oe(c,o),s,a);const u=function(t,e,n,i,r){const s=new Te(t,n,Is);return s.multi=[],s.index=e,s.componentProviders=0,vo(s,r,i&&!n),s}(r?bo:xo,n.length,r,i,l);!r&&g&&(n[f].providerFactory=u),yo(s,t,e.length,0),e.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),n.push(u),o.push(u)}else yo(s,t,p>-1?p:f,vo(n[r?f:p],l,!r&&i));!r&&i&&g&&n[f].componentProviders++}}}function yo(t,e,n,i){const r=ps(e);if(r||e.useClass){const s=(e.useClass||e).prototype.ngOnDestroy;if(s){const o=t.destroyHooks||(t.destroyHooks=[]);if(!r&&e.multi){const t=o.indexOf(n);-1===t?o.push(n,[i,s]):o[t+1].push(i,s)}else o.push(n,s)}}}function vo(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function _o(t,e,n,i){for(let r=n;r<i;r++)if(e[r]===t)return r;return-1}function xo(t,e,n,i){return wo(this.multi,[])}function bo(t,e,n,i){const r=this.multi;let s;if(this.providerFactory){const t=this.providerFactory.componentProviders,e=Ye(n,n[1],this.providerFactory.index,i);s=e.slice(0,t),wo(r,s);for(let n=t;n<e.length;n++)s.push(e[n])}else s=[],wo(r,s);return s}function wo(t,e){for(let n=0;n<t.length;n++)e.push((0,t[n])());return e}function Co(t,e=[]){return n=>{n.providersResolver=(n,i)=>function(t,e,n){const i=Vt();if(i.firstCreatePass){const r=mt(t);go(n,i.data,i.blueprint,r,!0),go(e,i.data,i.blueprint,r,!1)}}(n,i?i(t):t,e)}}class To{}class So{resolveComponentFactory(t){throw function(t){const e=Error(`No component factory found for ${u(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(t)}}let Mo=(()=>{class t{}return t.NULL=new So,t})();function Eo(...t){}function Ao(t,e){return new Po(Pt(t,e))}const Do=function(){return Ao(jt(),Bt())};let Po=(()=>{class t{constructor(t){this.nativeElement=t}}return t.__NG_ELEMENT_ID__=Do,t})();function Lo(t){return t instanceof Po?t.nativeElement:t}class Ro{}let Io=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>No(),t})();const No=function(){const t=Bt(),e=It(jt().index,t);return function(t){return t[11]}(ut(e)?e:t)};let ko=(()=>{class t{}return t.\u0275prov=x({token:t,providedIn:"root",factory:()=>null}),t})();class Oo{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const zo=new Oo("12.0.5");class Fo{constructor(){}supports(t){return Ss(t)}create(t){return new Ho(t)}}const Uo=(t,e)=>e;class Ho{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Uo}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,n=this._removalsHead,i=0,r=null;for(;e||n;){const s=!n||e&&e.currentIndex<jo(n,i,r)?e:n,o=jo(s,i,r),a=s.currentIndex;if(s===n)i--,n=n._nextRemoved;else if(e=e._next,null==s.previousIndex)i++;else{r||(r=[]);const t=o-i,e=a-i;if(t!=e){for(let n=0;n<t;n++){const i=n<r.length?r[n]:r[n]=0,s=i+n;e<=s&&s<t&&(r[n]=i+1)}r[s.previousIndex]=e-t}}o!==a&&t(s,o,a)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!Ss(t))throw new Error(`Error trying to diff '${u(t)}'. Only arrays and iterables are allowed`);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e,n,i,r=this._itHead,s=!1;if(Array.isArray(t)){this.length=t.length;for(let e=0;e<this.length;e++)n=t[e],i=this._trackByFn(e,n),null!==r&&Object.is(r.trackById,i)?(s&&(r=this._verifyReinsertion(r,n,i,e)),Object.is(r.item,n)||this._addIdentityChange(r,n)):(r=this._mismatch(r,n,i,e),s=!0),r=r._next}else e=0,function(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{const n=t[Cs()]();let i;for(;!(i=n.next()).done;)e(i.value)}}(t,t=>{i=this._trackByFn(e,t),null!==r&&Object.is(r.trackById,i)?(s&&(r=this._verifyReinsertion(r,t,i,e)),Object.is(r.item,t)||this._addIdentityChange(r,t)):(r=this._mismatch(r,t,i,e),s=!0),r=r._next,e++}),this.length=e;return this._truncate(r),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,n,i){let r;return null===t?r=this._itTail:(r=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,r,i)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,r,i)):t=this._addAfter(new Bo(e,n),r,i),t}_verifyReinsertion(t,e,n,i){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==r?t=this._reinsertAfter(r,t._prev,i):t.currentIndex!=i&&(t.currentIndex=i,this._addToMoves(t,i)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const i=t._prevRemoved,r=t._nextRemoved;return null===i?this._removalsHead=r:i._nextRemoved=r,null===r?this._removalsTail=i:r._prevRemoved=i,this._insertAfter(t,e,n),this._addToMoves(t,n),t}_moveAfter(t,e,n){return this._unlink(t),this._insertAfter(t,e,n),this._addToMoves(t,n),t}_addAfter(t,e,n){return this._insertAfter(t,e,n),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,n){const i=null===e?this._itHead:e._next;return t._next=i,t._prev=e,null===i?this._itTail=t:i._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new Go),this._linkedRecords.put(t),t.currentIndex=n,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,n=t._next;return null===e?this._itHead=n:e._next=n,null===n?this._itTail=e:n._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Go),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class Bo{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Vo{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===e||e<=n.currentIndex)&&Object.is(n.trackById,t))return n;return null}remove(t){const e=t._prevDup,n=t._nextDup;return null===e?this._head=n:e._nextDup=n,null===n?this._tail=e:n._prevDup=e,null===this._head}}class Go{constructor(){this.map=new Map}put(t){const e=t.trackById;let n=this.map.get(e);n||(n=new Vo,this.map.set(e,n)),n.add(t)}get(t,e){const n=this.map.get(t);return n?n.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function jo(t,e,n){const i=t.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+e+r}class Wo{constructor(){}supports(t){return t instanceof Map||Ms(t)}create(){return new qo}}class qo{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||Ms(t)))throw new Error(`Error trying to diff '${u(t)}'. Only maps and objects are allowed`)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(t,n)=>{if(e&&e.key===n)this._maybeAddToChanges(e,t),this._appendAfter=e,e=e._next;else{const i=this._getOrCreateRecordForKey(n,t);e=this._insertBeforeOrAppend(e,i)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let t=e;null!==t;t=t._nextRemoved)t===this._mapHead&&(this._mapHead=null),this._records.delete(t.key),t._nextRemoved=t._next,t.previousValue=t.currentValue,t.currentValue=null,t._prev=null,t._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const n=t._prev;return e._next=t,e._prev=n,t._prev=e,n&&(n._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const n=this._records.get(t);this._maybeAddToChanges(n,e);const i=n._prev,r=n._next;return i&&(i._next=r),r&&(r._prev=i),n._next=null,n._prev=null,n}const n=new Zo(t);return this._records.set(t,n),n.currentValue=e,this._addToAdditions(n),n}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(n=>e(t[n],n))}}class Zo{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Yo(){return new Xo([new Fo])}let Xo=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(null!=n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||Yo()),deps:[[t,new Mn,new Sn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(null!=e)return e;throw new Error(`Cannot find a differ supporting object '${t}' of type '${n=t,n.name||typeof n}'`);var n}}return t.\u0275prov=x({token:t,providedIn:"root",factory:Yo}),t})();function Jo(){return new $o([new Wo])}let $o=(()=>{class t{constructor(t){this.factories=t}static create(e,n){if(n){const t=n.factories.slice();e=e.concat(t)}return new t(e)}static extend(e){return{provide:t,useFactory:n=>t.create(e,n||Jo()),deps:[[t,new Mn,new Sn]]}}find(t){const e=this.factories.find(e=>e.supports(t));if(e)return e;throw new Error(`Cannot find a differ supporting object '${t}'`)}}return t.\u0275prov=x({token:t,providedIn:"root",factory:Jo}),t})();function Qo(t,e,n,i,r=!1){for(;null!==n;){const s=e[n.index];if(null!==s&&i.push(At(s)),ht(s))for(let t=ct;t<s.length;t++){const e=s[t],n=e[1].firstChild;null!==n&&Qo(e[1],e,n,i)}const o=n.type;if(8&o)Qo(t,e,n.child,i);else if(32&o){const t=Ci(n,e);let r;for(;r=t();)i.push(r)}else if(16&o){const t=Hi(e,n);if(Array.isArray(t))i.push(...t);else{const n=Ti(e[16]);Qo(n[1],n,t,i,!0)}}n=r?n.projectionNext:n.next}return i}class Ko{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return Qo(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(ht(t)){const e=t[8],n=e?e.indexOf(this):-1;n>-1&&(Li(t,n),un(e,n))}this._attachedToViewContainer=!1}Ri(this._lView[1],this._lView)}onDestroy(t){Sr(this._lView[1],this._lView,null,t)}markForCheck(){Gr(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){jr(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,e,n){Xt(!0);try{jr(t,e,n)}finally{Xt(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var t;this._appRef=null,Gi(this._lView[1],t=this._lView,t[11],2,null,null)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=t}}class ta extends Ko{constructor(t){super(t),this._view=t}detectChanges(){Wr(this._view)}checkNoChanges(){!function(t){Xt(!0);try{Wr(t)}finally{Xt(!1)}}(this._view)}get context(){return null}}const ea=function(t){return function(t,e,n){if(pt(t)&&!n){const n=It(t.index,e);return new Ko(n,n)}return 47&t.type?new Ko(e[16],e):null}(jt(),Bt(),16==(16&t))};let na=(()=>{class t{}return t.__NG_ELEMENT_ID__=ea,t})();const ia=[new Wo],ra=new Xo([new Fo]),sa=new $o(ia),oa=function(){return ua(jt(),Bt())};let aa=(()=>{class t{}return t.__NG_ELEMENT_ID__=oa,t})();const la=aa,ca=class extends la{constructor(t,e,n){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=n}createEmbeddedView(t){const e=this._declarationTContainer.tViews,n=fr(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const i=this._declarationLView[19];return null!==i&&(n[19]=i.createEmbeddedView(e)),yr(e,n,t),new Ko(n)}};function ua(t,e){return 4&t.type?new ca(e,t,Ao(t,e)):null}class ha{}class da{}const pa=function(){return _a(jt(),Bt())};let fa=(()=>{class t{}return t.__NG_ELEMENT_ID__=pa,t})();const ma=fa,ga=class extends ma{constructor(t,e,n){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=n}get element(){return Ao(this._hostTNode,this._hostLView)}get injector(){return new $e(this._hostTNode,this._hostLView)}get parentInjector(){const t=Ue(this._hostTNode,this._hostLView);if(Pe(t)){const e=Re(t,this._hostLView),n=Le(t);return new $e(e[1].data[n+8],e)}return new $e(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=ya(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-ct}createEmbeddedView(t,e,n){const i=t.createEmbeddedView(e||{});return this.insert(i,n),i}createComponent(t,e,n,i,r){const s=n||this.parentInjector;if(!r&&null==t.ngModule&&s){const t=s.get(ha,null);t&&(r=t)}const o=t.create(s,i,void 0,r);return this.insert(o.hostView,e),o}insert(t,e){const n=t._lView,i=n[1];if(ht(n[3])){const e=this.indexOf(t);if(-1!==e)this.detach(e);else{const e=n[3],i=new ga(e,e[6],e[3]);i.detach(i.indexOf(t))}}const r=this._adjustIndex(e),s=this._lContainer;!function(t,e,n,i){const r=ct+i,s=n.length;i>0&&(n[r-1][4]=e),i<s-ct?(e[4]=n[r],cn(n,ct+i,e)):(n.push(e),e[4]=null),e[3]=n;const o=e[17];null!==o&&n!==o&&function(t,e){const n=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===n?t[9]=[e]:n.push(e)}(o,e);const a=e[19];null!==a&&a.insertView(t),e[2]|=128}(i,n,s,r);const o=Bi(r,s),a=n[11],l=zi(a,s[7]);return null!==l&&function(t,e,n,i,r,s){i[0]=r,i[6]=e,Gi(t,i,n,1,r,s)}(i,s[6],a,n,l,o),t.attachToViewContainerRef(),cn(va(s),r,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=ya(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),n=Li(this._lContainer,e);n&&(un(va(this._lContainer),e),Ri(n[1],n))}detach(t){const e=this._adjustIndex(t,-1),n=Li(this._lContainer,e);return n&&null!=un(va(this._lContainer),e)?new Ko(n):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function ya(t){return t[8]}function va(t){return t[8]||(t[8]=[])}function _a(t,e){let n;const i=e[t.index];if(ht(i))n=i;else{let r;if(8&t.type)r=At(i);else{const n=e[11];r=n.createComment("");const i=Pt(t,e);Ni(n,zi(n,i),r,function(t,e){return Mt(t)?t.nextSibling(e):e.nextSibling}(n,i),!1)}e[t.index]=n=Fr(i,e,r,t),Vr(e,n)}return new ga(n,t,e)}const xa={};class ba extends Mo{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=ot(t);return new Ta(e,this.ngModule)}}function wa(t){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push({propName:t[n],templateName:n});return e}const Ca=new rn("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>xi});class Ta extends To{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=t.selectors.map(ir).join(","),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return wa(this.componentDef.inputs)}get outputs(){return wa(this.componentDef.outputs)}create(t,e,n,i){const r=(i=i||this.ngModule)?function(t,e){return{get:(n,i,r)=>{const s=t.get(n,xa,r);return s!==xa||i===xa?s:e.get(n,i,r)}}}(t,i.injector):t,s=r.get(Ro,Et),o=r.get(ko,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=n?function(t,e,n){if(Mt(t))return t.selectRootElement(e,n===k.ShadowDom);let i="string"==typeof e?t.querySelector(e):e;return i.textContent="",i}(a,n,this.componentDef.encapsulation):Di(s.createRenderer(null,this.componentDef),l,function(t){const e=t.toLowerCase();return"svg"===e?Ct:"math"===e?"http://www.w3.org/1998/MathML/":null}(l)),u=this.componentDef.onPush?576:528,h={components:[],scheduler:xi,clean:Zr,playerHandler:null,flags:0},d=Tr(0,null,null,1,0,null,null,null,null,null),p=fr(null,d,h,u,null,null,s,a,o,r);let f,m;oe(p);try{const t=function(t,e,n,i,r,s){const o=n[1];n[20]=t;const a=mr(o,20,2,"#host",null),l=a.mergedAttrs=e.hostAttrs;null!==l&&(Kr(a,l,!0),null!==t&&(Se(r,t,l),null!==a.classes&&qi(r,t,a.classes),null!==a.styles&&Wi(r,t,a.styles)));const c=i.createRenderer(t,e),u=fr(n,Cr(e),null,e.onPush?64:16,n[20],a,i,c,null,null);return o.firstCreatePass&&(He(Oe(a,n),o,e.type),Lr(o,a),Ir(a,n.length,1)),Vr(n,u),n[20]=u}(c,this.componentDef,p,s,a);if(c)if(n)Se(a,c,["ng-version",zo.full]);else{const{attrs:t,classes:e}=function(t){const e=[],n=[];let i=1,r=2;for(;i<t.length;){let s=t[i];if("string"==typeof s)2===r?""!==s&&e.push(s,t[++i]):8===r&&n.push(s);else{if(!Ki(r))break;r=s}i++}return{attrs:e,classes:n}}(this.componentDef.selectors[0]);t&&Se(a,c,t),e&&e.length>0&&qi(a,c,e.join(" "))}if(m=Lt(d,lt),void 0!==e){const t=m.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const i=e[n];t.push(null!=i?Array.from(i):null)}}f=function(t,e,n,i,r){const s=n[1],o=function(t,e,n){const i=jt();t.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Nr(t,i,e,gr(t,e,1,null),n));const r=Ye(e,t,i.directiveStart,i);fi(r,e);const s=Pt(i,e);return s&&fi(s,e),r}(s,n,e);if(i.components.push(o),t[8]=o,r&&r.forEach(t=>t(o,e)),e.contentQueries){const t=jt();e.contentQueries(1,o,t.directiveStart)}const a=jt();return!s.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(pe(a.index),Dr(n[1],a,0,a.directiveStart,a.directiveEnd,e),Pr(e,o)),o}(t,this.componentDef,p,h,[gs]),yr(d,p,null)}finally{he()}return new Sa(this.componentType,f,Ao(m,p),p,m)}}class Sa extends class{}{constructor(t,e,n,i,r){super(),this.location=n,this._rootLView=i,this._tNode=r,this.instance=e,this.hostView=this.changeDetectorRef=new ta(i),this.componentType=t}get injector(){return new $e(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}const Ma=new Map;class Ea extends ha{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new ba(this);const n=at(t),i=t[Z]||null;i&&mo(i),this._bootstrapComponents=bi(n.bootstrap),this._r3Injector=as(t,e,[{provide:ha,useValue:this},{provide:Mo,useValue:this.componentFactoryResolver}],u(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=ms.THROW_IF_NOT_FOUND,n=D.Default){return t===ms||t===ha||t===ts?this:this._r3Injector.get(t,e,n)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Aa extends da{constructor(t){super(),this.moduleType=t,null!==at(t)&&function(t){const e=new Set;!function t(n){const i=at(n,!0),r=i.id;null!==r&&(function(t,e,n){if(e&&e!==n)throw new Error(`Duplicate module registered for ${t} - ${u(e)} vs ${u(e.name)}`)}(r,Ma.get(r),n),Ma.set(r,n));const s=bi(i.imports);for(const o of s)e.has(o)||(e.add(o),t(o))}(t)}(t)}create(t){return new Ea(this.moduleType,t)}}function Da(t,e,n,i){return Ra(Bt(),Jt(),t,e,n,i)}function Pa(t,e,n,i,r){return Ia(Bt(),Jt(),t,e,n,i,r)}function La(t,e){const n=t[e];return n===rr?void 0:n}function Ra(t,e,n,i,r,s){const o=e+n;return As(t,o,r)?Es(t,o+1,s?i.call(s,r):i(r)):La(t,o+1)}function Ia(t,e,n,i,r,s,o){const a=e+n;return Ds(t,a,r,s)?Es(t,a+2,o?i.call(o,r,s):i(r,s)):La(t,a+2)}function Na(t,e){const n=Vt();let i;const r=t+lt;n.firstCreatePass?(i=function(t,e){if(e)for(let n=e.length-1;n>=0;n--){const i=e[n];if(t===i.name)return i}throw new g("302",`The pipe '${t}' could not be found!`)}(e,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(r,i.onDestroy)):i=n.data[r];const s=i.factory||(i.factory=gt(i.type)),o=L(Is);try{const t=Ne(!1),e=s();return Ne(t),function(t,e,n,i){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=i}(n,Bt(),r,e),e}finally{L(o)}}function ka(t,e,n){const i=t+lt,r=Bt(),s=Rt(r,i);return Fa(r,za(r,i)?Ra(r,Jt(),e,s.transform,n,s):s.transform(n))}function Oa(t,e,n,i){const r=t+lt,s=Bt(),o=Rt(s,r);return Fa(s,za(s,r)?Ia(s,Jt(),e,o.transform,n,i,o):o.transform(n,i))}function za(t,e){return t[1].data[e].pure}function Fa(t,e){return Ts.isWrapped(e)&&(e=Ts.unwrap(e),t[$t()]=rr),e}function Ua(t){return e=>{setTimeout(t,void 0,e)}}const Ha=class extends i.xQ{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,n){var i,s,o;let a=t,l=e||(()=>null),c=n;if(t&&"object"==typeof t){const e=t;a=null===(i=e.next)||void 0===i?void 0:i.bind(e),l=null===(s=e.error)||void 0===s?void 0:s.bind(e),c=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}this.__isAsync&&(l=Ua(l),a&&(a=Ua(a)),c&&(c=Ua(c)));const u=super.subscribe({next:a,error:l,complete:c});return t instanceof r.w&&t.add(u),u}};function Ba(){return this._results[Cs()]()}class Va{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Cs(),n=Va.prototype;n[e]||(n[e]=Ba)}get changes(){return this._changes||(this._changes=new Ha)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const n=this;n.dirty=!1;const i=an(t);(this._changesDetected=!function(t,e,n){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=e[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(n._results,i,e))&&(n._results=i,n.length=i.length,n.last=i[this.length-1],n.first=i[0])}notifyOnChanges(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class Ga{constructor(t){this.queryList=t,this.matches=null}clone(){return new Ga(this.queryList)}setDirty(){this.queryList.setDirty()}}class ja{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const n=null!==t.contentQueries?t.contentQueries[0]:e.length,i=[];for(let t=0;t<n;t++){const n=e.getByIndex(t);i.push(this.queries[n.indexInDeclarationView].clone())}return new ja(i)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==rl(t,e).matches&&this.queries[e].setDirty()}}class Wa{constructor(t,e,n=null){this.predicate=t,this.flags=e,this.read=n}}class qa{constructor(t=[]){this.queries=t}elementStart(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let n=0;n<this.length;n++){const i=null!==e?e.length:0,r=this.getByIndex(n).embeddedTView(t,i);r&&(r.indexInDeclarationView=n,null!==e?e.push(r):e=[r])}return null!==e?new qa(e):null}template(t,e){for(let n=0;n<this.queries.length;n++)this.queries[n].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Za{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new Za(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let n=t.parent;for(;null!==n&&8&n.type&&n.index!==e;)n=n.parent;return e===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const r=n[i];this.matchTNodeWithReadOption(t,e,Ya(e,r)),this.matchTNodeWithReadOption(t,e,Ze(e,t,r,!1,!1))}else n===aa?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Ze(e,t,n,!1,!1))}matchTNodeWithReadOption(t,e,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Po||i===fa||i===aa&&4&e.type)this.addMatch(e.index,-2);else{const n=Ze(e,t,i,!1,!1);null!==n&&this.addMatch(e.index,n)}else this.addMatch(e.index,n)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function Ya(t,e){const n=t.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===e)return n[i+1];return null}function Xa(t,e,n,i){return-1===n?function(t,e){return 11&t.type?Ao(t,e):4&t.type?ua(t,e):null}(e,t):-2===n?function(t,e,n){return n===Po?Ao(e,t):n===aa?ua(e,t):n===fa?_a(e,t):void 0}(t,e,i):Ye(t,t[1],n,e)}function Ja(t,e,n,i){const r=e[19].queries[i];if(null===r.matches){const i=t.data,s=n.matches,o=[];for(let t=0;t<s.length;t+=2){const r=s[t];o.push(r<0?null:Xa(e,i[r],s[t+1],n.metadata.read))}r.matches=o}return r.matches}function $a(t,e,n,i){const r=t.queries.getByIndex(n),s=r.matches;if(null!==s){const o=Ja(t,e,r,n);for(let t=0;t<s.length;t+=2){const n=s[t];if(n>0)i.push(o[t/2]);else{const r=s[t+1],o=e[-n];for(let t=ct;t<o.length;t++){const e=o[t];e[17]===e[3]&&$a(e[1],e,r,i)}if(null!==o[9]){const t=o[9];for(let e=0;e<t.length;e++){const n=t[e];$a(n[1],n,r,i)}}}}}return i}function Qa(t){const e=Bt(),n=Vt(),i=ne();ie(i+1);const r=rl(n,i);if(t.dirty&&Nt(e)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const s=r.crossesNgTemplate?$a(n,e,i,[]):Ja(n,e,r,i);t.reset(s,Lo),t.notifyOnChanges()}return!0}return!1}function Ka(t,e,n){const i=Vt();i.firstCreatePass&&(il(i,new Wa(t,e,n),-1),2==(2&e)&&(i.staticViewQueries=!0)),nl(i,Bt(),e)}function tl(t,e,n,i){const r=Vt();if(r.firstCreatePass){const s=jt();il(r,new Wa(e,n,i),s.index),function(t,e){const n=t.contentQueries||(t.contentQueries=[]);e!==(n.length?n[n.length-1]:-1)&&n.push(t.queries.length-1,e)}(r,t),2==(2&n)&&(r.staticContentQueries=!0)}nl(r,Bt(),n)}function el(){return t=Bt(),e=ne(),t[19].queries[e].queryList;var t,e}function nl(t,e,n){const i=new Va(4==(4&n));Sr(t,e,i,i.destroy),null===e[19]&&(e[19]=new ja),e[19].queries.push(new Ga(i))}function il(t,e,n){null===t.queries&&(t.queries=new qa),t.queries.track(new Za(e,n))}function rl(t,e){return t.queries.getByIndex(e)}const sl=new rn("Application Initializer");let ol=(()=>{class t{constructor(t){this.appInits=t,this.resolve=Eo,this.reject=Eo,this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}runInitializers(){if(this.initialized)return;const t=[],e=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const e=this.appInits[n]();if(Hs(e))t.push(e);else if(Vs(e)){const n=new Promise((t,n)=>{e.subscribe({complete:t,error:n})});t.push(n)}}Promise.all(t).then(()=>{e()}).catch(t=>{this.reject(t)}),0===t.length&&e(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(bn(sl,8))},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})();const al=new rn("AppId"),ll={provide:al,useFactory:function(){return`${cl()}${cl()}${cl()}`},deps:[]};function cl(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const ul=new rn("Platform Initializer"),hl=new rn("Platform ID"),dl=new rn("appBootstrapListener");let pl=(()=>{class t{log(t){console.log(t)}warn(t){console.warn(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})();const fl=new rn("LocaleId"),ml=new rn("DefaultCurrencyCode");class gl{constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}}const yl=function(t){return new Aa(t)},vl=yl,_l=function(t){return Promise.resolve(yl(t))},xl=function(t){const e=yl(t),n=bi(at(t).declarations).reduce((t,e)=>{const n=ot(e);return n&&t.push(new Ta(n)),t},[]);return new gl(e,n)},bl=xl,wl=function(t){return Promise.resolve(xl(t))};let Cl=(()=>{class t{constructor(){this.compileModuleSync=vl,this.compileModuleAsync=_l,this.compileModuleAndAllComponentsSync=bl,this.compileModuleAndAllComponentsAsync=wl}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})();const Tl=(()=>Promise.resolve(0))();function Sl(t){"undefined"==typeof Zone?Tl.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Ml{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ha(!1),this.onMicrotaskEmpty=new Ha(!1),this.onStable=new Ha(!1),this.onError=new Ha(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!n&&e,i.shouldCoalesceRunChangeDetection=n,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function(){let t=H.requestAnimationFrame,e=H.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const n=t[Zone.__symbol__("OriginalDelegate")];n&&(t=n);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function(t){const e=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(H,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Dl(t),t.isCheckStableRunning=!0,Al(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Dl(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,o,a)=>{try{return Pl(t),n.invokeTask(r,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&e(),Ll(t)}},onInvoke:(n,i,r,s,o,a,l)=>{try{return Pl(t),n.invoke(r,s,o,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),Ll(t)}},onHasTask:(e,n,i,r)=>{e.hasTask(i,r),n===i&&("microTask"==r.change?(t._hasPendingMicrotasks=r.microTask,Dl(t),Al(t)):"macroTask"==r.change&&(t.hasPendingMacrotasks=r.macroTask))},onHandleError:(e,n,i,r)=>(e.handleError(i,r),t.runOutsideAngular(()=>t.onError.emit(r)),!1)})}(i)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ml.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Ml.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,n){return this._inner.run(t,e,n)}runTask(t,e,n,i){const r=this._inner,s=r.scheduleEventTask("NgZoneEvent: "+i,t,El,Eo,Eo);try{return r.runTask(s,e,n)}finally{r.cancelTask(s)}}runGuarded(t,e,n){return this._inner.runGuarded(t,e,n)}runOutsideAngular(t){return this._outer.run(t)}}const El={};function Al(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Dl(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function Pl(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Ll(t){t._nesting--,Al(t)}class Rl{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ha,this.onMicrotaskEmpty=new Ha,this.onStable=new Ha,this.onError=new Ha}run(t,e,n){return t.apply(e,n)}runGuarded(t,e,n){return t.apply(e,n)}runOutsideAngular(t){return t()}runTask(t,e,n,i){return t.apply(e,n)}}let Il=(()=>{class t{constructor(t){this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ml.assertNotInAngularZone(),Sl(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Sl(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(e=>!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,e,n){let i=-1;e&&e>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(t=>t.timeoutId!==i),t(this._didWork,this.getPendingTasks())},e)),this._callbacks.push({doneCb:t,timeoutId:i,updateCb:n})}whenStable(t,e,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,e,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(t,e,n){return[]}}return t.\u0275fac=function(e){return new(e||t)(bn(Ml))},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})(),Nl=(()=>{class t{constructor(){this._applications=new Map,Fl.addToWindow(this)}registerApplication(t,e){this._applications.set(t,e)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,e=!0){return Fl.findTestabilityInTree(this,t,e)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})();class kl{addToWindow(t){}findTestabilityInTree(t,e,n){return null}}function Ol(t){Fl=t}let zl,Fl=new kl,Ul=!0,Hl=!1;function Bl(){return Hl=!0,Ul}function Vl(){if(Hl)throw new Error("Cannot enable prod mode after platform setup.");Ul=!1}const Gl=new rn("AllowMultipleToken");class jl{constructor(t,e){this.name=t,this.token=e}}function Wl(t,e,n=[]){const i=`Platform: ${e}`,r=new rn(i);return(e=[])=>{let s=ql();if(!s||s.injector.get(Gl,!1))if(t)t(n.concat(e).concat({provide:r,useValue:!0}));else{const t=n.concat(e).concat({provide:r,useValue:!0},{provide:ns,useValue:"platform"});!function(t){if(zl&&!zl.destroyed&&!zl.injector.get(Gl,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");zl=t.get(Zl);const e=t.get(ul,null);e&&e.forEach(t=>t())}(ms.create({providers:t,name:i}))}return function(t){const e=ql();if(!e)throw new Error("No platform exists!");if(!e.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return e}(r)}}function ql(){return zl&&!zl.destroyed?zl:null}let Zl=(()=>{class t{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,e){const n=function(t,e){let n;return n="noop"===t?new Rl:("zone.js"===t?void 0:t)||new Ml({enableLongStackTrace:Bl(),shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),n}(e?e.ngZone:void 0,{ngZoneEventCoalescing:e&&e.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:e&&e.ngZoneRunCoalescing||!1}),i=[{provide:Ml,useValue:n}];return n.run(()=>{const e=ms.create({providers:i,parent:this.injector,name:t.moduleType.name}),r=t.create(e),s=r.injector.get(_i,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const t=n.onError.subscribe({next:t=>{s.handleError(t)}});r.onDestroy(()=>{Jl(this._modules,r),t.unsubscribe()})}),function(t,e,n){try{const i=n();return Hs(i)?i.catch(n=>{throw e.runOutsideAngular(()=>t.handleError(n)),n}):i}catch(i){throw e.runOutsideAngular(()=>t.handleError(i)),i}}(s,n,()=>{const t=r.injector.get(ol);return t.runInitializers(),t.donePromise.then(()=>(mo(r.injector.get(fl,po)||po),this._moduleDoBootstrap(r),r))})})}bootstrapModule(t,e=[]){const n=Yl({},e);return function(t,e,n){const i=new Aa(n);return Promise.resolve(i)}(0,0,t).then(t=>this.bootstrapModuleFactory(t,n))}_moduleDoBootstrap(t){const e=t.injector.get(Xl);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(t=>e.bootstrap(t));else{if(!t.instance.ngDoBootstrap)throw new Error(`The module ${u(t.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);t.instance.ngDoBootstrap(e)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(t=>t.destroy()),this._destroyListeners.forEach(t=>t()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(bn(ms))},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})();function Yl(t,e){return Array.isArray(e)?e.reduce(Yl,t):Object.assign(Object.assign({},t),e)}let Xl=(()=>{class t{constructor(t,e,n,i,r){this._zone=t,this._injector=e,this._exceptionHandler=n,this._componentFactoryResolver=i,this._initStatus=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const l=new s.y(t=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{t.next(this._stable),t.complete()})}),c=new s.y(t=>{let e;this._zone.runOutsideAngular(()=>{e=this._zone.onStable.subscribe(()=>{Ml.assertNotInAngularZone(),Sl(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,t.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{Ml.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{t.next(!1)}))});return()=>{e.unsubscribe(),n.unsubscribe()}});this.isStable=(0,o.T)(l,c.pipe((0,a.B)()))}bootstrap(t,e){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=t instanceof To?t:this._componentFactoryResolver.resolveComponentFactory(t),this.componentTypes.push(n.componentType);const i=n.isBoundToModule?void 0:this._injector.get(ha),r=n.create(ms.NULL,[],e||n.selector,i),s=r.location.nativeElement,o=r.injector.get(Il,null),a=o&&r.injector.get(Nl);return o&&a&&a.registerApplication(s,o),r.onDestroy(()=>{this.detachView(r.hostView),Jl(this.components,r),a&&a.unregisterApplication(s)}),this._loadComponent(r),r}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const e=t;this._views.push(e),e.attachToAppRef(this)}detachView(t){const e=t;Jl(this._views,e),e.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(dl,[]).concat(this._bootstrapListeners).forEach(e=>e(t))}ngOnDestroy(){this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(bn(Ml),bn(ms),bn(_i),bn(Mo),bn(ol))},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})();function Jl(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class $l{}class Ql{}const Kl={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"};let tc=(()=>{class t{constructor(t,e){this._compiler=t,this._config=e||Kl}load(t){return this.loadAndCompile(t)}loadAndCompile(t){let[e,i]=t.split("#");return void 0===i&&(i="default"),n(8255)(e).then(t=>t[i]).then(t=>ec(t,e,i)).then(t=>this._compiler.compileModuleAsync(t))}loadFactory(t){let[e,i]=t.split("#"),r="NgFactory";return void 0===i&&(i="default",r=""),n(8255)(this._config.factoryPathPrefix+e+this._config.factoryPathSuffix).then(t=>t[i+r]).then(t=>ec(t,e,i))}}return t.\u0275fac=function(e){return new(e||t)(bn(Cl),bn(Ql,8))},t.\u0275prov=x({token:t,factory:t.\u0275fac}),t})();function ec(t,e,n){if(!t)throw new Error(`Cannot find '${n}' in '${e}'`);return t}const nc=function(t){return null},ic=Wl(null,"core",[{provide:hl,useValue:"unknown"},{provide:Zl,deps:[ms]},{provide:Nl,deps:[]},{provide:pl,deps:[]}]),rc=[{provide:Xl,useClass:Xl,deps:[Ml,ms,_i,Mo,ol]},{provide:Ca,deps:[Ml],useFactory:function(t){let e=[];return t.onStable.subscribe(()=>{for(;e.length;)e.pop()()}),function(t){e.push(t)}}},{provide:ol,useClass:ol,deps:[[new Sn,sl]]},{provide:Cl,useClass:Cl,deps:[]},ll,{provide:Xo,useFactory:function(){return ra},deps:[]},{provide:$o,useFactory:function(){return sa},deps:[]},{provide:fl,useFactory:function(t){return mo(t=t||"undefined"!=typeof $localize&&$localize.locale||po),t},deps:[[new Tn(fl),new Sn,new Mn]]},{provide:ml,useValue:"USD"}];let sc=(()=>{class t{constructor(t){}}return t.\u0275fac=function(e){return new(e||t)(bn(Xl))},t.\u0275mod=et({type:t}),t.\u0275inj=b({providers:rc}),t})()},2346:(t,e,n)=>{"use strict";n.d(e,{hO:()=>M,xv:()=>_,Dh:()=>v,HU:()=>p,GT:()=>y,sI:()=>T,on:()=>b,ss:()=>f,pX:()=>g,yq:()=>w});var i=n(8489),r=n(8569),s=n(6599),o=n(4187),a=n(9098),l=n(5366),c=n(1858);function u(){}t=n.hmd(t);class h{constructor(t,e=i.N){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,n){const i=this.zone;return this.delegate.schedule(function(e){i.runGuarded(()=>{t.apply(this,[e])})},e,n)}}class d{constructor(t){this.zone=t,this.task=null}call(t,e){const n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",u,{},u,u)),e.pipe((0,s.b)({next:n,complete:n,error:n})).subscribe(t).add(n)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}class p{constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new h(Zone.current)),this.insideAngular=t.run(()=>new h(Zone.current,r.z))}}function f(t){return function(e){return(e=e.lift(new d(t.ngZone))).pipe((0,o.R)(t.outsideAngular),(0,a.QV)(t.insideAngular))}}const m=["ngOnDestroy"],g=(t,e,n,i={})=>new Proxy(t,{get:(r,s)=>n.runOutsideAngular(()=>{var r;if(t[s])return(null===(r=null==i?void 0:i.spy)||void 0===r?void 0:r.get)&&i.spy.get(s,t[s]),t[s];if(m.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(t=>{const e=t&&t[s];return"function"==typeof e?e.bind(t):e&&e.then?e.then(t=>n.run(()=>t)):n.run(()=>e)});return new Proxy(()=>{},{get:(t,e)=>o[e],apply:(t,e,n)=>o.then(t=>{var e;const r=t&&t(...n);return(null===(e=null==i?void 0:i.spy)||void 0===e?void 0:e.apply)&&i.spy.apply(s,n,r),r})})})}),y=(t,e)=>{e.forEach(e=>{Object.getOwnPropertyNames(e.prototype||e).forEach(n=>{Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(e.prototype||e,n))})})},v=new l.OlP("angularfire2.app.options"),_=new l.OlP("angularfire2.app.nameOrConfig"),x=new l.GfV("6.1.5");function b(e,n,i){const r="object"==typeof i&&i||{};r.name=r.name||"string"==typeof i&&i||"[DEFAULT]";const s=c.Z.apps.filter(t=>t&&t.name===r.name)[0]||n.runOutsideAngular(()=>c.Z.initializeApp(e,r));try{JSON.stringify(e)!==JSON.stringify(s.options)&&C("error",`${s.name} Firebase App already initialized with different options${t.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(o){}return s}const w=()=>{C("warn","You may need to import 'firebase/auth' manually in your component rather than rely on AngularFireAuth's dynamic import, when using the emulator suite https://github.com/angular/angularfire/issues/2656")},C=(t,...e)=>{(0,l.X6Q)()&&"undefined"!=typeof console&&console[t](...e)};function T(e,n,i,r,s){const[o,...a]=globalThis.\u0275AngularfireInstanceCache.get(e)||[];if(o){try{s.some((t,e)=>{const n=a[e];return t&&"object"==typeof t?JSON.stringify(t)!==JSON.stringify(n):t!==n})&&C("error",`${n} was already initialized on the ${i.name} Firebase App instance with different settings.${t.hot?" You may need to reload as Firebase is not HMR aware.":""}`)}catch(l){}return o}{const t=r();return globalThis.\u0275AngularfireInstanceCache.set(e,[t,...s]),t}}globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=new Map);const S={provide:class{},useFactory:b,deps:[v,l.R0b,[new l.FiY,_]]};let M=(()=>{class t{constructor(t){c.Z.registerVersion("angularfire",x.full,t.toString()),c.Z.registerVersion("angular",l.q4F.full)}static initializeApp(e,n){return{ngModule:t,providers:[{provide:v,useValue:e},{provide:_,useValue:n}]}}}return t.\u0275fac=function(e){return new(e||t)(l.LFG(l.Lbi))},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({providers:[S]}),t})()},1062:(t,e,n)=>{"use strict";n.d(e,{Z:()=>b});var i,r,s=n(4762),o=n(250),a=n(5119),l=n(308),c=((i={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",i["bad-app-name"]="Illegal App name: '{$appName}",i["duplicate-app"]="Firebase App named '{$appName}' already exists",i["app-deleted"]="Firebase App named '{$appName}' already deleted",i["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",i["invalid-log-argument"]="First argument to `onLog` must be null or a function.",i),u=new o.LL("app","Firebase",c),h="@firebase/app",d="[DEFAULT]",p=((r={})[h]="fire-core",r["@firebase/analytics"]="fire-analytics",r["@firebase/app-check"]="fire-app-check",r["@firebase/auth"]="fire-auth",r["@firebase/database"]="fire-rtdb",r["@firebase/functions"]="fire-fn",r["@firebase/installations"]="fire-iid",r["@firebase/messaging"]="fire-fcm",r["@firebase/performance"]="fire-perf",r["@firebase/remote-config"]="fire-rc",r["@firebase/storage"]="fire-gcs",r["@firebase/firestore"]="fire-fst",r["fire-js"]="fire-js",r["firebase-wrapper"]="fire-js-all",r),f=new l.Yd("@firebase/app"),m=function(){function t(t,e,n){var i=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,o.p$)(t),this.container=new a.H0(e.name),this._addComponent(new a.wA("app",function(){return i},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(t){return i._addComponent(t)})}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map(function(t){return t.delete()}))}).then(function(){t.isDeleted_=!0})},t.prototype._getService=function(t,e){var n;void 0===e&&(e=d),this.checkDestroyed_();var i=this.container.getProvider(t);return i.isInitialized()||"EXPLICIT"!==(null===(n=i.getComponent())||void 0===n?void 0:n.instantiationMode)||i.initialize(),i.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=d),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){f.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{appName:this.name_})},t}();m.prototype.name&&m.prototype.options||m.prototype.delete||console.log("dc");var g=function t(){var e=function(t){var e={},n=new Map,i={__esModule:!0,initializeApp:function(n,r){void 0===r&&(r={}),"object"==typeof r&&null!==r||(r={name:r});var s=r;void 0===s.name&&(s.name=d);var a=s.name;if("string"!=typeof a||!a)throw u.create("bad-app-name",{appName:String(a)});if((0,o.r3)(e,a))throw u.create("duplicate-app",{appName:a});var l=new t(n,s,i);return e[a]=l,l},app:r,registerVersion:function(t,e,n){var i,r=null!==(i=p[t])&&void 0!==i?i:t;n&&(r+="-"+n);var o=r.match(/\s|\//),l=e.match(/\s|\//);if(o||l){var c=['Unable to register library "'+r+'" with version "'+e+'":'];return o&&c.push('library name "'+r+'" contains illegal characters (whitespace or "/")'),o&&l&&c.push("and"),l&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void f.warn(c.join(" "))}s(new a.wA(r+"-version",function(){return{library:r,version:e}},"VERSION"))},setLogLevel:l.Ub,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw u.create("invalid-log-argument");(0,l.Am)(t,e)},apps:null,SDK_VERSION:"8.7.0",INTERNAL:{registerComponent:s,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function r(t){if(!(0,o.r3)(e,t=t||d))throw u.create("no-app",{appName:t});return e[t]}function s(s){var a=s.name;if(n.has(a))return f.debug("There were multiple attempts to register component "+a+"."),"PUBLIC"===s.type?i[a]:null;if(n.set(a,s),"PUBLIC"===s.type){var l=function(t){if(void 0===t&&(t=r()),"function"!=typeof t[a])throw u.create("invalid-app-argument",{appName:a});return t[a]()};void 0!==s.serviceProps&&(0,o.ZB)(l,s.serviceProps),i[a]=l,t.prototype[a]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,a).apply(this,s.multipleInstances?t:[])}}for(var c=0,h=Object.keys(e);c<h.length;c++)e[h[c]]._addComponent(s);return"PUBLIC"===s.type?i[a]:null}return i.default=i,Object.defineProperty(i,"apps",{get:function(){return Object.keys(e).map(function(t){return e[t]})}}),r.App=t,i}(m);return e.INTERNAL=(0,s.pi)((0,s.pi)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,o.ZB)(e,t)},createSubscribe:o.ne,ErrorFactory:o.LL,deepExtend:o.ZB}),e}(),y=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null}).filter(function(t){return t}).join(" ")},t}();if((0,o.jU)()&&void 0!==self.firebase){f.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var v=self.firebase.SDK_VERSION;v&&v.indexOf("LITE")>=0&&f.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var _=g.initializeApp;g.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,o.UG)()&&f.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),_.apply(void 0,t)};var x=g;!function(t,e){t.INTERNAL.registerComponent(new a.wA("platform-logger",function(t){return new y(t)},"PRIVATE")),t.registerVersion(h,"0.6.28",void 0),t.registerVersion("fire-js","")}(x);const b=x},5119:(t,e,n)=>{"use strict";n.d(e,{wA:()=>s,H0:()=>l,zt:()=>a});var i=n(4762),r=n(250),s=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),o="[DEFAULT]",a=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new r.BH;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var i=this.getOrInitializeService({instanceIdentifier:e});i&&n.resolve(i)}catch(s){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:o})}catch(h){}try{for(var r=(0,i.XA)(this.instancesDeferred.entries()),s=r.next();!s.done;s=r.next()){var a=(0,i.CR)(s.value,2),l=a[1],c=this.normalizeInstanceIdentifier(a[0]);try{var u=this.getOrInitializeService({instanceIdentifier:c});l.resolve(u)}catch(h){}}}catch(d){e={error:d}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=o),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return(0,i.mG)(this,void 0,void 0,function(){var t;return(0,i.Jh)(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all((0,i.ev)((0,i.ev)([],(0,i.CR)(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))),(0,i.CR)(t.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()}))))];case 1:return e.sent(),[2]}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=o),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var r=t.options,s=void 0===r?{}:r,o=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:o,options:s});try{for(var l=(0,i.XA)(this.instancesDeferred.entries()),c=l.next();!c.done;c=l.next()){var u=(0,i.CR)(c.value,2),h=u[1];o===this.normalizeInstanceIdentifier(u[0])&&h.resolve(a)}}catch(d){e={error:d}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return a},t.prototype.onInit=function(t,e){var n,i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);var s=this.instances.get(i);return s&&t(s,i),function(){r.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,r,s=this.onInitCallbacks.get(e);if(s)try{for(var o=(0,i.XA)(s),a=o.next();!a.done;a=o.next()){var l=a.value;try{l(t,e)}catch(c){}}}catch(u){n={error:u}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,i=t.options,r=void 0===i?{}:i,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===o?void 0:e),options:r}),this.instances.set(n,s),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(a){}return s||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=o),this.component?this.component.multipleInstances?t:o:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),l=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new a(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},2107:(t,e,n)=>{"use strict";var i=n(1062),r=n(5119),s=n(250),o=n(4762),a=n(308);t=n.hmd(t);var l="";function c(t){l=t}var u,h=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,s.Pz)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,s.cI)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),d=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,s.r3)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),p=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new h(e)}}catch(n){}return new d},f=p("localStorage"),m=p("sessionStorage"),g=new a.Yd("@firebase/database"),y=(u=1,function(){return u++}),v=function(t){var e=(0,s.dS)(t),n=new s.gQ;n.update(e);var i=n.digest();return s.US.encodeByteArray(i)},_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",i=0;i<t.length;i++){var r=t[i];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?n+=_.apply(null,r):n+="object"==typeof r?(0,s.Pz)(r):r,n+=" "}return n},x=null,b=!0,w=function(t,e){(0,s.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(g.logLevel=a.in.VERBOSE,x=g.log.bind(g),e&&m.set("logging_enabled",!0)):"function"==typeof t?x=t:(x=null,m.remove("logging_enabled"))},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===b&&(b=!1,null===x&&!0===m.get("logging_enabled")&&w(!0)),x){var n=_.apply(null,t);x(n)}},T=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];C.apply(void 0,(0,o.ev)([t],(0,o.CR)(e)))}},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+_.apply(void 0,(0,o.ev)([],(0,o.CR)(t)));g.error(n)},M=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+_.apply(void 0,(0,o.ev)([],(0,o.CR)(t)));throw g.error(n),new Error(n)},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+_.apply(void 0,(0,o.ev)([],(0,o.CR)(t)));g.warn(n)},A=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},D="[MIN_NAME]",P="[MAX_NAME]",L=function(t,e){if(t===e)return 0;if(t===D||e===P)return-1;if(e===D||t===P)return 1;var n=U(t),i=U(e);return null!==n?null!==i?n-i==0?t.length-e.length:n-i:-1:null!==i?1:t<e?-1:1},R=function(t,e){return t===e?0:t<e?-1:1},I=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,s.Pz)(e))},N=function(t){if("object"!=typeof t||null===t)return(0,s.Pz)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var i="{",r=0;r<e.length;r++)0!==r&&(i+=","),i+=(0,s.Pz)(e[r]),i+=":",i+=N(t[e[r]]);return i+"}"},k=function(t,e){var n=t.length;if(n<=e)return[t];for(var i=[],r=0;r<n;r+=e)i.push(t.substring(r,r+e>n?n:r+e));return i};function O(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var z=function(t){var e,n,i,r,o;(0,s.hu)(!A(t),"Invalid JSON number"),0===t?(n=0,i=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(r=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,i=Math.round(t*Math.pow(2,52-r)-Math.pow(2,52))):(n=0,i=Math.round(t/Math.pow(2,-1074))));var a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse();var l=a.join(""),c="";for(o=0;o<64;o+=8){var u=parseInt(l.substr(o,8),2).toString(16);1===u.length&&(u="0"+u),c+=u}return c.toLowerCase()},F=new RegExp("^-?(0*)\\d{1,10}$"),U=function(t){if(F.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},H=function(t){try{t()}catch(e){setTimeout(function(){throw E("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},B=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},V=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then(function(t){return n.appCheck=t})}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise(function(n,i){setTimeout(function(){e.appCheck?e.getToken(t).then(n,i):n(null)},0)})},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then(function(e){return e.addTokenListener(t)})},t.prototype.notifyForInvalidToken=function(){E('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),G=function(){function t(t,e,n){var i=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(function(t){return i.auth_=t})}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch(function(t){return t&&"auth/token-not-initialized"===t.code?(C("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)}):new Promise(function(n,i){setTimeout(function(){e.auth_?e.getToken(t).then(n,i):n(null)},0)})},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(function(e){return e.addAuthTokenListener(t)})},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then(function(e){return e.removeAuthTokenListener(t)})},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';E(t+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.')},t}(),j=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),W=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,q="websocket",Z="long_polling",Y=function(){function t(t,e,n,i,r,s,o){void 0===r&&(r=!1),void 0===s&&(s=""),void 0===o&&(o=!1),this.secure=e,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=f.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&f.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host+"/"+(this.includeNamespaceInQueryParams?"?ns="+this.namespace:"")},t}();function X(t,e,n){var i;if((0,s.hu)("string"==typeof e,"typeof type must == string"),(0,s.hu)("object"==typeof n,"typeof params must == object"),e===q)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==Z)throw new Error("Unknown connection type: "+e);i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var r=[];return O(n,function(t,e){r.push(t+"="+e)}),i+r.join("&")}var J=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,s.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,s.p$)(this.counters_)},t}(),$={},Q={};function K(t){var e=t.toString();return $[e]||($[e]=new J),$[e]}var tt=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var i=function(){var t=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var e=function(e){t[e]&&H(function(){n.onMessage_(t[e])})},i=0;i<t.length;++i)e(i);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++},r=this;this.pendingResponses[this.currentResponseNum]&&"break"!==i(););},t}(),et="start",nt="close",it=function(){function t(t,e,n,i,r,s,o){var a=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T(t),this.stats_=K(e),this.urlFn=function(t){return a.appCheckToken&&(t.ac=a.appCheckToken),X(e,Z,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new tt(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if((0,s.Yr)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new rt(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=(0,o.CR)(t,5),r=i[0],s=i[1],a=i[2];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,r===et)n.id=s,n.password=a;else{if(r!==nt)throw new Error("Unrecognized command received: "+r);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=(0,o.CR)(t,2),r=i[0],s=i[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(r,s)},function(){n.onClosed_()},n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&W.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!((0,s.Yr)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,s.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,s.h$)(e),i=k(n,1840),r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,s.Yr)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,s.Pz)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),rt=function(){function t(e,n,i,r){if(this.onDisconnect=i,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,s.Yr)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=y(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(o='<script>document.domain="'+document.domain+'";<\/script>');var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(l){C("frame writing exception"),l.stack&&C(l.stack),C(l)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||C("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",i=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var r=this.pendingSegs.shift();n=n+"&seg"+i+"="+r.seg+"&ts"+i+"="+r.ts+"&d"+i+"="+r.d,i++}return this.addLongPollTag_(e+=n,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var i=function(){n.outstandingRequests.delete(e),n.newRequest_()},r=setTimeout(i,Math.floor(25e3));this.addTag(t,function(){clearTimeout(r),i()})},t.prototype.addTag=function(t,e){var n=this;(0,s.Yr)()?this.doNodeLongPoll(t,e):setTimeout(function(){try{if(!n.sendNewPolls)return;var i=n.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){var t=i.readyState;t&&"loaded"!==t&&"complete"!==t||(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=function(){C("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(i)}catch(r){}},Math.floor(1))},t}(),st=null;"undefined"!=typeof MozWebSocket?st=MozWebSocket:"undefined"!=typeof WebSocket&&(st=WebSocket);var ot=function(){function t(e,n,i,r,s,o,a){this.connId=e,this.applicationId=i,this.appCheckToken=r,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T(this.connId),this.stats_=K(n),this.connURL=t.connectionURL_(n,o,a,r),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,i){var r={v:"5"};return!(0,s.Yr)()&&"undefined"!=typeof location&&location.hostname&&W.test(location.hostname)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),i&&(r.ac=i),X(t,q,r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{if((0,s.Yr)()){var i={headers:{"User-Agent":"Firebase/5/"+l+"/"+process.platform+"/"+(this.nodeAdmin?"AdminNode":"Node"),"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers.Authorization=this.authToken),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var r=process.env,o=0===this.connURL.indexOf("wss://")?r.HTTPS_PROXY||r.https_proxy:r.HTTP_PROXY||r.http_proxy;o&&(i.proxy={origin:o}),this.mySock=new st(this.connURL,[],i)}else this.mySock=new st(this.connURL,[],i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}})}catch(c){this.log_("Error instantiating WebSocket.");var a=c.message||c.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==st&&!t.forceDisallow_},t.previouslyFailed=function(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){f.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,s.cI)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,s.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,s.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=k(e,16384);n.length>1&&this.sendString_(String(n.length));for(var i=0;i<n.length;i++)this.sendString_(n[i])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),at=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[it,ot]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,i,r=ot&&ot.isAvailable(),s=r&&!ot.previouslyFailed();if(e.webSocketOnly&&(r||E("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[ot];else{var a=this.transports_=[];try{for(var l=(0,o.XA)(t.ALL_TRANSPORTS),c=l.next();!c.done;c=l.next()){var u=c.value;u&&u.isAvailable()&&a.push(u)}}catch(h){n={error:h}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),lt=function(){function t(t,e,n,i,r,s,o,a,l,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T("c:"+this.id+":"),this.transportManager_=new at(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,i)},Math.floor(0));var r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=B(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(r)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){this.sendData_({t:"d",d:t})},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=I("t",t),n=I("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=I("t",t),n=I("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=I("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?S("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):S("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&E("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,i),B(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):B(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),ct=function(){function t(){}return t.prototype.put=function(t,e,n,i){},t.prototype.merge=function(t,e,n,i){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),ut=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,s.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var i=(0,o.ev)([],(0,o.CR)(this.listeners_[t])),r=0;r<i.length;r++)i[r].callback.apply(i[r].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var i=this.getInitialEvent(t);i&&e.apply(n,i)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var i=this.listeners_[t]||[],r=0;r<i.length;r++)if(i[r].callback===e&&(!n||n===i[r].context))return void i.splice(r,1)},t.prototype.validateEventType_=function(t){(0,s.hu)(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}(),ht=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,s.uI)()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return(0,o.ZT)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,s.hu)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(ut),dt=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[n]=this.pieces_[i],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function pt(){return new dt("")}function ft(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function mt(t){return t.pieces_.length-t.pieceNum_}function gt(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new dt(t.pieces_,e)}function yt(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function vt(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function _t(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new dt(e,0)}function xt(t,e){for(var n=[],i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof dt)for(i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{var r=e.split("/");for(i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new dt(n,0)}function bt(t){return t.pieceNum_>=t.pieces_.length}function wt(t,e){var n=ft(t),i=ft(e);if(null===n)return e;if(n===i)return wt(gt(t),gt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Ct(t,e){for(var n=vt(t,0),i=vt(e,0),r=0;r<n.length&&r<i.length;r++){var s=L(n[r],i[r]);if(0!==s)return s}return n.length===i.length?0:n.length<i.length?-1:1}function Tt(t,e){if(mt(t)!==mt(e))return!1;for(var n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function St(t,e){var n=t.pieceNum_,i=e.pieceNum_;if(mt(t)>mt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}var Mt=function(){return function(t,e){this.errorPrefix_=e,this.parts_=vt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,s.ug)(this.parts_[n]);Et(this)}}();function Et(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+At(t))}function At(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var Dt,Pt,Lt=function(t){function e(){var e,n,i=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),i.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==i.visible_&&(i.visible_=t,i.trigger("visible",t))},!1),i}return(0,o.ZT)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,s.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(ut),Rt=1e3,It=function(t){function e(n,i,r,o,a,l,c,u){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=i,h.onDataUpdate_=r,h.onConnectStatus_=o,h.onServerInfoUpdate_=a,h.authTokenProvider_=l,h.appCheckTokenProvider_=c,h.authOverride_=u,h.id=e.nextPersistentConnectionId_++,h.log_=T("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=Rt,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,u&&!(0,s.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Lt.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&ht.getInstance().on("online",h.onOnline_,h),h}return(0,o.ZT)(e,t),e.prototype.sendRequest=function(t,e,n){var i=++this.requestNumber_,r={r:i,a:t,b:e};this.log_((0,s.Pz)(r)),(0,s.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new s.BH,i={p:t._path.toString(),q:t._queryObject},r={action:"g",request:i,onComplete:function(t){var r=t.d;"ok"===t.s?(e.onDataUpdate_(i.p,r,!1,null),n.resolve(r)):n.reject(r)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var t=e.outstandingGets_[o];void 0!==t&&r===t&&(delete e.outstandingGets_[o],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+o+" timed out on connection"),n.reject(new Error("Client is offline.")))},3e3),this.connected_&&this.sendGet_(o),n.promise},e.prototype.listen=function(t,e,n,i){this.initConnection_();var r=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),(0,s.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,s.hu)(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");var a={onComplete:i,hashFn:e,query:t,tag:n};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,function(i){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(i)})},e.prototype.sendListen_=function(t){var n=this,i=t.query,r=i._path.toString(),s=i._queryIdentifier;this.log_("Listen on "+r+" for "+s);var o={p:r};t.tag&&(o.q=i._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest("q",o,function(o){var a=o.d,l=o.s;e.warnOnListenWarnings_(a,i),(n.listens.get(r)&&n.listens.get(r).get(s))===t&&(n.log_("listen response",o),"ok"!==l&&n.removeListen_(r,s),t.onComplete&&t.onComplete(l,a))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&(0,s.r3)(t,"w")){var n=(0,s.DV)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var i='".indexOn": "'+e._queryParams.getIndex().toString()+'"',r=e._path.toString();E("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+i+" at "+r+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||(0,s.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,s.w9)(e)?"auth":"gauth",i={cred:e};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(n,i,function(n){var i=n.s,r=n.d||"error";t.authToken_===e&&("ok"===i?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(i,r))})}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(e){var n=e.s,i=e.d||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,i)})},e.prototype.unlisten=function(t,e){var n=t._path.toString(),i=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),(0,s.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,i){this.log_("Unlisten on "+t+" for "+e);var r={p:t};i&&(r.q=n,r.t=i),this.sendRequest("n",r)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,i){var r={p:e,d:n};this.log_("onDisconnect "+t,r),this.sendRequest(t,r,function(t){i&&setTimeout(function(){i(t.s,t.d)},Math.floor(0))})},e.prototype.put=function(t,e,n,i){this.putInternal("p",t,e,n,i)},e.prototype.merge=function(t,e,n,i){this.putInternal("m",t,e,n,i)},e.prototype.putInternal=function(t,e,n,i,r){this.initConnection_();var s={p:e,d:n};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:t,request:s,onComplete:i}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,i,function(i){e.log_(n+" response",i),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),r&&r(i.s,i.d)})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){"ok"!==t.s&&e.log_("reportStats","Error sending stats: "+t.d)})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,s.Pz)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):S("Unrecognized action received from server: "+(0,s.Pz)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,s.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Rt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Rt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Rt),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return(0,o.mG)(this,void 0,void 0,function(){var t,n,i,r,a,l,c,u,h,d,p,f,m,g=this;return(0,o.Jh)(this,function(y){switch(y.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+e.nextConnectionId_++,a=this.lastSessionId,l=!1,c=null,this.realtime_={close:u=function(){c?c.close():(l=!0,i())},sendRequest:function(t){(0,s.hu)(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(t)}},h=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,y.label=1;case 1:return y.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)])];case 2:return d=o.CR.apply(void 0,[y.sent(),2]),p=d[0],f=d[1],l?C("getToken() completed but was canceled"):(C("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=f&&f.token,c=new lt(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,i,function(t){E(t+" ("+g.repoInfo_.toString()+")"),g.interrupt("server_kill")},a)),[3,4];case 3:return m=y.sent(),this.log_("Failed to get token: "+m),l||(this.repoInfo_.nodeAdmin&&E(m),u()),[3,4];case 4:return[2]}})})},e.prototype.interrupt=function(t){C("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){C("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,s.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Rt,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return N(t)}).join("$"):"default";var i=this.removeListen_(t,n);i&&i.onComplete&&i.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,i=new dt(t).toString();if(this.listens.has(i)){var r=this.listens.get(i);n=r.get(e),r.delete(e),0===r.size&&this.listens.delete(i)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){C("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){C("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,i;this.tryAuth(),this.tryAppCheck();try{for(var r=(0,o.XA)(this.listens.values()),s=r.next();!s.done;s=r.next()){var a=s.value;try{for(var l=(n=void 0,(0,o.XA)(a.values())),c=l.next();!c.done;c=l.next())this.sendListen_(c.value)}catch(d){n={error:d}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}}catch(p){t={error:p}}finally{try{s&&!s.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}for(var u=0;u<this.outstandingPuts_.length;u++)this.outstandingPuts_[u]&&this.sendPut_(u);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(u=0;u<this.outstandingGets_.length;u++)this.outstandingGets_[u]&&this.sendGet_(u)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,s.Yr)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+l.replace(/\./g,"-")]=1,(0,s.uI)()?t["framework.cordova"]=1:(0,s.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=ht.getInstance().currentlyOnline();return(0,s.xb)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(ct),Nt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),kt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Nt(D,t),i=new Nt(D,e);return 0!==this.compare(n,i)},t.prototype.minPost=function(){return Nt.MIN},t}(),Ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,o.ZT)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Dt},set:function(t){Dt=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return L(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,s.g5)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Nt.MIN},e.prototype.maxPost=function(){return new Nt(P,Dt)},e.prototype.makePost=function(t,e){return(0,s.hu)("string"==typeof t,"KeyIndex indexValue must always be a string."),new Nt(t,Dt)},e.prototype.toString=function(){return".key"},e}(kt),zt=new Ot,Ft=function(){function t(t,e,n,i,r){void 0===r&&(r=null),this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];for(var s=1;!t.isEmpty();)if(t=t,s=e?n(t.key,e):1,i&&(s*=-1),s<0)t=this.isReverse_?t.left:t.right;else{if(0===s){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Ut=function(){function t(e,n,i,r,s){this.key=e,this.value=n,this.color=null!=i?i:t.RED,this.left=null!=r?r:Bt.EMPTY_NODE,this.right=null!=s?s:Bt.EMPTY_NODE}return t.prototype.copy=function(e,n,i,r,s){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=i?i:this.color,null!=r?r:this.left,null!=s?s:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Bt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,i;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Bt.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Ht=function(){function t(){}return t.prototype.copy=function(t,e,n,i,r){return this},t.prototype.insert=function(t,e,n){return new Ut(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Bt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ut.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ut.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,i=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Ft(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Ft(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Ft(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Ft(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Ht,t}();function Vt(t,e){return L(t.name,e.name)}function Gt(t,e){return L(t,e)}var jt,Wt,qt,Zt,Yt,Xt=function(t){return"number"==typeof t?"number:"+z(t):"string:"+t},Jt=function(t){if(t.isLeafNode()){var e=t.val();(0,s.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,s.r3)(e,".sv"),"Priority must be a string or number.")}else(0,s.hu)(t===Pt||t.isEmpty(),"priority of unexpected type.");(0,s.hu)(t===Pt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},$t=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,s.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Jt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return jt},set:function(t){jt=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return bt(e)?this:".priority"===ft(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var i=ft(e);return null===i?n:n.isEmpty()&&".priority"!==i?this:((0,s.hu)(".priority"!==i||1===mt(e),".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(gt(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Xt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?z(this.value_):this.value_,this.lazyHash_=v(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,s.hu)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,i=typeof this.value_,r=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(i);return(0,s.hu)(r>=0,"Unknown leaf type: "+n),(0,s.hu)(o>=0,"Unknown leaf type: "+i),r===o?"object"===i?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-r},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){return t===this||!!t.isLeafNode()&&this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),Qt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,o.ZT)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),i=e.node.getPriority(),r=n.compareTo(i);return 0===r?L(t.name,e.name):r},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Nt.MIN},e.prototype.maxPost=function(){return new Nt(P,new $t("[PRIORITY-POST]",qt))},e.prototype.makePost=function(t,e){var n=Wt(t);return new Nt(e,new $t("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(kt)),Kt=Math.log(2),te=function(){function t(t){this.count=parseInt(Math.log(t+1)/Kt,10),this.current_=this.count-1;var e=parseInt(Array(this.count+1).join("1"),2);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),ee=function(t,e,n,i){t.sort(e);var r=function(e,i){var s,o,a=i-e;if(0===a)return null;if(1===a)return s=t[e],o=n?n(s):s,new Ut(o,s.node,Ut.BLACK,null,null);var l=parseInt(a/2,10)+e,c=r(e,l),u=r(l+1,i);return s=t[l],o=n?n(s):s,new Ut(o,s.node,Ut.BLACK,c,u)},s=function(e){for(var i=null,s=null,o=t.length,a=function(e,i){var s=o-e,a=o;o-=e;var c=r(s+1,a),u=t[s],h=n?n(u):u;l(new Ut(h,u.node,i,null,c))},l=function(t){i?(i.left=t,i=t):(s=t,i=t)},c=0;c<e.count;++c){var u=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));u?a(h,Ut.BLACK):(a(h,Ut.BLACK),a(h,Ut.RED))}return s}(new te(t.length));return new Bt(i||e,s)},ne={},ie=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,s.hu)(ne&&Qt,"ChildrenNode.ts has not been loaded"),Zt=Zt||new t({".priority":ne},{".priority":Qt})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,s.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Bt?e:null},t.prototype.hasIndex=function(t){return(0,s.r3)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,s.hu)(e!==zt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var i,r=[],a=!1,l=n.getIterator(Nt.Wrap),c=l.getNext();c;)a=a||e.isDefinedOn(c.node),r.push(c),c=l.getNext();i=a?ee(r,e.getCompare()):ne;var u=e.toString(),h=(0,o.pi)({},this.indexSet_);h[u]=e;var d=(0,o.pi)({},this.indexes_);return d[u]=i,new t(d,h)},t.prototype.addToIndexes=function(e,n){var i=this;return new t((0,s.UI)(this.indexes_,function(t,r){var o=(0,s.DV)(i.indexSet_,r);if((0,s.hu)(o,"Missing index implementation for "+r),t===ne){if(o.isDefinedOn(e.node)){for(var a=[],l=n.getIterator(Nt.Wrap),c=l.getNext();c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),ee(a,o.getCompare())}return ne}var u=n.get(e.name),h=t;return u&&(h=h.remove(new Nt(e.name,u))),h.insert(e,e.node)}),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t((0,s.UI)(this.indexes_,function(t){if(t===ne)return t;var i=n.get(e.name);return i?t.remove(new Nt(e.name,i)):t}),this.indexSet_)},t}(),re=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Jt(this.priorityNode_),this.children_.isEmpty()&&(0,s.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return Yt||(Yt=new t(new Bt(Gt),null,ie.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||Yt},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Yt:e},t.prototype.getChild=function(t){var e=ft(t);return null===e?this:this.getImmediateChild(e).getChild(gt(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,s.hu)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var i=new Nt(e,n),r=void 0,o=void 0;n.isEmpty()?(r=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(i,this.children_)):(r=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(i,this.children_));var a=r.isEmpty()?Yt:this.priorityNode_;return new t(r,a,o)},t.prototype.updateChild=function(t,e){var n=ft(t);if(null===n)return e;(0,s.hu)(".priority"!==ft(t)||1===mt(t),".priority must be the last token in a path");var i=this.getImmediateChild(n).updateChild(gt(t),e);return this.updateImmediateChild(n,i)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},i=0,r=0,s=!0;if(this.forEachChild(Qt,function(o,a){n[o]=a.val(e),i++,s&&t.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):s=!1}),!e&&s&&r<2*i){var o=[];for(var a in n)o[a]=n[a];return o}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Xt(this.getPriority().val())+":"),this.forEachChild(Qt,function(e,n){var i=n.hash();""!==i&&(t+=":"+e+":"+i)}),this.lazyHash_=""===t?"":v(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var i=this.resolveIndex_(n);if(i){var r=i.getPredecessorKey(new Nt(t,e));return r?r.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Nt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Nt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var i=this.children_.getIteratorFrom(t.name,Nt.Wrap),r=i.peek();null!=r&&e.compare(r,t)<0;)i.getNext(),r=i.peek();return i},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var i=this.children_.getReverseIteratorFrom(t.name,Nt.Wrap),r=i.peek();null!=r&&e.compare(r,t)>0;)i.getNext(),r=i.peek();return i},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===se?-1:0},t.prototype.withIndex=function(e){if(e===zt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===zt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Qt),i=e.getIterator(Qt),r=n.getNext(),s=i.getNext();r&&s;){if(r.name!==s.name||!r.node.equals(s.node))return!1;r=n.getNext(),s=i.getNext()}return null===r&&null===s}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===zt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),se=new(function(t){function e(){return t.call(this,new Bt(Gt),re.EMPTY_NODE,ie.Default)||this}return(0,o.ZT)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return re.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(re));function oe(t,e){if(void 0===e&&(e=null),null===t)return re.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,s.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new $t(t,oe(e));if(t instanceof Array){var n=re.EMPTY_NODE;return O(t,function(e,i){if((0,s.r3)(t,e)&&"."!==e.substring(0,1)){var r=oe(i);!r.isLeafNode()&&r.isEmpty()||(n=n.updateImmediateChild(e,r))}}),n.updatePriority(oe(e))}var i=[],r=!1;if(O(t,function(t,e){if("."!==t.substring(0,1)){var n=oe(e);n.isEmpty()||(r=r||!n.getPriority().isEmpty(),i.push(new Nt(t,n)))}}),0===i.length)return re.EMPTY_NODE;var o=ee(i,Vt,function(t){return t.name},Gt);if(r){var a=ee(i,Qt.getCompare());return new re(o,oe(e),new ie({".priority":a},{".priority":Qt}))}return new re(o,oe(e),ie.Default)}Object.defineProperties(Nt,{MIN:{value:new Nt(D,re.EMPTY_NODE)},MAX:{value:new Nt(P,se)}}),Ot.__EMPTY_NODE=re.EMPTY_NODE,$t.__childrenNodeConstructor=re,Pt=se,qt=se,Wt=oe;var ae,le,ce=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,s.hu)(!bt(e)&&".priority"!==ft(e),"Can't create PathIndex with empty path or .priority key"),n}return(0,o.ZT)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),i=this.extractChild(e.node),r=n.compareTo(i);return 0===r?L(t.name,e.name):r},e.prototype.makePost=function(t,e){var n=oe(t),i=re.EMPTY_NODE.updateChild(this.indexPath_,n);return new Nt(e,i)},e.prototype.maxPost=function(){var t=re.EMPTY_NODE.updateChild(this.indexPath_,se);return new Nt(P,t)},e.prototype.toString=function(){return vt(this.indexPath_,0).join("/")},e}(kt),ue=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,o.ZT)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?L(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Nt.MIN},e.prototype.maxPost=function(){return Nt.MAX},e.prototype.makePost=function(t,e){var n=oe(t);return new Nt(e,n)},e.prototype.toString=function(){return".value"},e}(kt)),he="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",de=(ae=0,le=[],function(t){var e,n=t===ae;ae=t;var i=new Array(8);for(e=7;e>=0;e--)i[e]=he.charAt(t%64),t=Math.floor(t/64);(0,s.hu)(0===t,"Cannot push at time == 0");var r=i.join("");if(n){for(e=11;e>=0&&63===le[e];e--)le[e]=0;le[e]++}else for(e=0;e<12;e++)le[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)r+=he.charAt(le[e]);return(0,s.hu)(20===r.length,"nextPushId: Length should be 20."),r}),pe=function(t){if("2147483647"===t)return"-";var e=U(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),i=0;i<n.length;i++)n[i]=t.charAt(i);if(n.length<786)return n.push("-"),n.join("");for(var r=n.length-1;r>=0&&"z"===n[r];)r--;if(-1===r)return P;var s=he.charAt(he.indexOf(n[r])+1);return n[r]=s,n.slice(0,r+1).join("")},fe=function(t){if("-2147483648"===t)return D;var e=U(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),i=0;i<n.length;i++)n[i]=t.charAt(i);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=he.charAt(he.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function me(t){return{type:"value",snapshotNode:t}}function ge(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ye(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function ve(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var _e=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,i,r,o){(0,s.hu)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(i).equals(n.getChild(i))&&a.isEmpty()===n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(ye(e,a)):(0,s.hu)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ge(e,n)):o.trackChildChange(ve(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Qt,function(t,i){e.hasChild(t)||n.trackChildChange(ye(t,i))}),e.isLeafNode()||e.forEachChild(Qt,function(e,i){if(t.hasChild(e)){var r=t.getImmediateChild(e);r.equals(i)||n.trackChildChange(ve(e,i,r))}else n.trackChildChange(ge(e,i))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?re.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),xe=function(){function t(e){this.indexedFilter_=new _e(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,i,r,s){return this.matches(new Nt(e,n))||(n=re.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,i,r,s)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=re.EMPTY_NODE);var i=e.withIndex(this.index_);i=i.updatePriority(re.EMPTY_NODE);var r=this;return e.forEachChild(Qt,function(t,e){r.matches(new Nt(t,e))||(i=i.updateImmediateChild(t,re.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,i,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),be=function(){function t(t){this.rangedFilter_=new xe(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,i,r,s){return this.rangedFilter_.matches(new Nt(e,n))||(n=re.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,i,r,s):this.fullLimitUpdateChild_(t,e,n,r,s)},t.prototype.updateFullNode=function(t,e,n){var i;if(e.isLeafNode()||e.isEmpty())i=re.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){i=re.EMPTY_NODE.withIndex(this.index_);var r=void 0;r=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var s=0;r.hasNext()&&s<this.limit_;){var o=r.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),o)<=0:this.index_.compare(o,this.rangedFilter_.getEndPost())<=0))break;i=i.updateImmediateChild(o.name,o.node),s++}}else{i=(i=e.withIndex(this.index_)).updatePriority(re.EMPTY_NODE);var a=void 0,l=void 0,c=void 0;if(r=void 0,this.reverse_){r=i.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost();var u=this.index_.getCompare();c=function(t,e){return u(e,t)}}else r=i.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();s=0;for(var h=!1;r.hasNext();)o=r.getNext(),!h&&c(a,o)<=0&&(h=!0),h&&s<this.limit_&&c(o,l)<=0?s++:i=i.updateImmediateChild(o.name,re.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,i,r){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(t,e){return a(e,t)}}else o=this.index_.getCompare();var l=t;(0,s.hu)(l.numChildren()===this.limit_,"");var c=new Nt(e,n),u=this.reverse_?l.getFirstChild(this.index_):l.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(l.hasChild(e)){for(var d=l.getImmediateChild(e),p=i.getChildAfterChild(this.index_,u,this.reverse_);null!=p&&(p.name===e||l.hasChild(p.name));)p=i.getChildAfterChild(this.index_,p,this.reverse_);var f=null==p?1:o(p,c);if(h&&!n.isEmpty()&&f>=0)return null!=r&&r.trackChildChange(ve(e,n,d)),l.updateImmediateChild(e,n);null!=r&&r.trackChildChange(ye(e,d));var m=l.updateImmediateChild(e,re.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=r&&r.trackChildChange(ge(p.name,p.node)),m.updateImmediateChild(p.name,p.node)):m}return n.isEmpty()?t:h&&o(u,c)>=0?(null!=r&&(r.trackChildChange(ye(u.name,u.node)),r.trackChildChange(ge(e,n))),l.updateImmediateChild(e,n).updateImmediateChild(u.name,re.EMPTY_NODE)):t},t}(),we=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Qt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return(0,s.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,s.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:D},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,s.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,s.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:P},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,s.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Qt},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function Ce(t,e,n){var i=t.copy();return i.startSet_=!0,void 0===e&&(e=null),i.indexStartValue_=e,null!=n?(i.startNameSet_=!0,i.indexStartName_=n):(i.startNameSet_=!1,i.indexStartName_=""),i}function Te(t,e,n){var i=t.copy();return i.endSet_=!0,void 0===e&&(e=null),i.indexEndValue_=e,void 0!==n?(i.endNameSet_=!0,i.indexEndName_=n):(i.endNameSet_=!1,i.indexEndName_=""),i}function Se(t,e){var n=t.copy();return n.index_=e,n}function Me(t){var e,n={};return t.isDefault()||(t.index_===Qt?e="$priority":t.index_===ue?e="$value":t.index_===zt?e="$key":((0,s.hu)(t.index_ instanceof ce,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=(0,s.Pz)(e),t.startSet_&&(n.startAt=(0,s.Pz)(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+(0,s.Pz)(t.indexStartName_))),t.endSet_&&(n.endAt=(0,s.Pz)(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+(0,s.Pz)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function Ee(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Qt&&(e.i=t.index_.toString()),e}var Ae=function(t){function e(e,n,i,r){var s=t.call(this)||this;return s.repoInfo_=e,s.onDataUpdate_=n,s.authTokenProvider_=i,s.appCheckTokenProvider_=r,s.log_=T("p:rest:"),s.listens_={},s}return(0,o.ZT)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,s.hu)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,i,r){var o=this,a=t._path.toString();this.log_("Listen called for "+a+" "+t._queryIdentifier);var l=e.getListenId_(t,i),c={};this.listens_[l]=c;var u=Me(t._queryParams);this.restRequest_(a+".json",u,function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(a,n,!1,i),(0,s.DV)(o.listens_,l)===c&&r(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)})},e.prototype.unlisten=function(t,n){var i=e.getListenId_(t,n);delete this.listens_[i]},e.prototype.get=function(t){var e=this,n=Me(t._queryParams),i=t._path.toString(),r=new s.BH;return this.restRequest_(i+".json",n,function(t,n){var s=n;404===t&&(s=null,t=null),null===t?(e.onDataUpdate_(i,s,!1,null),r.resolve(s)):r.reject(new Error(s))}),r.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var i=this;return void 0===e&&(e={}),e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(r){var a=(0,o.CR)(r,2),l=a[0],c=a[1];l&&l.accessToken&&(e.auth=l.accessToken),c&&c.token&&(e.ac=c.token);var u=(i.repoInfo_.secure?"https://":"http://")+i.repoInfo_.host+t+"?ns="+i.repoInfo_.namespace+(0,s.xO)(e);i.log_("Sending REST request for "+u);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){i.log_("REST Response for "+u+" received. status:",h.status,"response:",h.responseText);var t=null;if(h.status>=200&&h.status<300){try{t=(0,s.cI)(h.responseText)}catch(e){E("Failed to parse JSON response for "+u+": "+h.responseText)}n(null,t)}else 401!==h.status&&404!==h.status&&E("Got unsuccessful REST response for "+u+" Status: "+h.status),n(h.status);n=null}},h.open("GET",u,!0),h.send()})},e}(ct),De=function(){function t(){this.rootNode_=re.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();function Pe(){return{value:null,children:new Map}}function Le(t,e,n){if(bt(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var i=ft(e);t.children.has(i)||t.children.set(i,Pe()),Le(t.children.get(i),e=gt(e),n)}}function Re(t,e){if(bt(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(Qt,function(e,n){Le(t,new dt(e),n)}),Re(t,e)}if(t.children.size>0){var i=ft(e);return e=gt(e),t.children.has(i)&&Re(t.children.get(i),e)&&t.children.delete(i),0===t.children.size}return!0}function Ie(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach(function(t,n){e(n,t)})}(t,function(t,i){Ie(i,new dt(e.toString()+"/"+t),n)})}var Ne=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=(0,o.pi)({},t);return this.last_&&O(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}(),ke=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Ne(t);var n=1e4+2e4*Math.random();B(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},i=!1;O(e,function(e,r){r>0&&(0,s.r3)(t.statsToReport_,e)&&(n[e]=r,i=!0)}),i&&this.server_.reportStats(n),B(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Oe=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}({});function ze(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var Fe,Ue=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Oe.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(bt(this.path)){if(null!=this.affectedTree.value)return(0,s.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new dt(e));return new t(pt(),n,this.revert)}return(0,s.hu)(ft(this.path)===e,"operationForChild called for unrelated child."),new t(gt(this.path),this.affectedTree,this.revert)},t}(),He=function(){function t(t,e){this.source=t,this.path=e,this.type=Oe.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return bt(this.path)?new t(this.source,pt()):new t(this.source,gt(this.path))},t}(),Be=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Oe.OVERWRITE}return t.prototype.operationForChild=function(e){return bt(this.path)?new t(this.source,pt(),this.snap.getImmediateChild(e)):new t(this.source,gt(this.path),this.snap)},t}(),Ve=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Oe.MERGE}return t.prototype.operationForChild=function(e){if(bt(this.path)){var n=this.children.subtree(new dt(e));return n.isEmpty()?null:n.value?new Be(this.source,pt(),n.value):new t(this.source,pt(),n)}return(0,s.hu)(ft(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,gt(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Ge=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(bt(t))return this.isFullyInitialized()&&!this.filtered_;var e=ft(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),je=function(){return function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}();function We(t,e,n,i,r,o){var a=i.filter(function(t){return t.type===n});a.sort(function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw(0,s.g5)("Should only compare child_ events.");var i=new Nt(e.childName,e.snapshotNode),r=new Nt(n.childName,n.snapshotNode);return t.index_.compare(i,r)}(t,e,n)}),a.forEach(function(n){var i=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,o);r.forEach(function(r){r.respondsTo(n.type)&&e.push(r.createEvent(i,t.query_))})})}function qe(t,e){return{eventCache:t,serverCache:e}}function Ze(t,e,n,i){return qe(new Ge(e,n,i),t.serverCache)}function Ye(t,e,n,i){return qe(t.eventCache,new Ge(e,n,i))}function Xe(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Je(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var $e=function(){function t(t,e){void 0===e&&(Fe||(Fe=new Bt(R)),e=Fe),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return O(e,function(t,e){n=n.set(new dt(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:pt(),value:this.value};if(bt(t))return null;var n=ft(t),i=this.children.get(n);if(null!==i){var r=i.findRootMostMatchingPathAndValue(gt(t),e);return null!=r?{path:xt(new dt(n),r.path),value:r.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(bt(e))return this;var n=ft(e),i=this.children.get(n);return null!==i?i.subtree(gt(e)):new t(null)},t.prototype.set=function(e,n){if(bt(e))return new t(n,this.children);var i=ft(e),r=(this.children.get(i)||new t(null)).set(gt(e),n),s=this.children.insert(i,r);return new t(this.value,s)},t.prototype.remove=function(e){if(bt(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=ft(e),i=this.children.get(n);if(i){var r=i.remove(gt(e)),s=void 0;return s=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),null===this.value&&s.isEmpty()?new t(null):new t(this.value,s)}return this},t.prototype.get=function(t){if(bt(t))return this.value;var e=ft(t),n=this.children.get(e);return n?n.get(gt(t)):null},t.prototype.setTree=function(e,n){if(bt(e))return n;var i,r=ft(e),s=(this.children.get(r)||new t(null)).setTree(gt(e),n);return i=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new t(this.value,i)},t.prototype.fold=function(t){return this.fold_(pt(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(i,r){n[i]=r.fold_(xt(t,i),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,pt(),e)},t.prototype.findOnPath_=function(t,e,n){var i=!!this.value&&n(e,this.value);if(i)return i;if(bt(t))return null;var r=ft(t),s=this.children.get(r);return s?s.findOnPath_(gt(t),xt(e,r),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,pt(),e)},t.prototype.foreachOnPath_=function(e,n,i){if(bt(e))return this;this.value&&i(n,this.value);var r=ft(e),s=this.children.get(r);return s?s.foreachOnPath_(gt(e),xt(n,r),i):new t(null)},t.prototype.foreach=function(t){this.foreach_(pt(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,i){i.foreach_(xt(t,n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t}(),Qe=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new $e(null))},t}();function Ke(t,e,n){if(bt(e))return new Qe(new $e(n));var i=t.writeTree_.findRootMostValueAndPath(e);if(null!=i){var r=i.path,s=i.value,o=wt(r,e);return s=s.updateChild(o,n),new Qe(t.writeTree_.set(r,s))}var a=new $e(n),l=t.writeTree_.setTree(e,a);return new Qe(l)}function tn(t,e,n){var i=t;return O(n,function(t,n){i=Ke(i,xt(e,t),n)}),i}function en(t,e){if(bt(e))return Qe.empty();var n=t.writeTree_.setTree(e,new $e(null));return new Qe(n)}function nn(t,e){return null!=rn(t,e)}function rn(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(wt(n.path,e)):null}function sn(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Qt,function(t,n){e.push(new Nt(t,n))}):t.writeTree_.children.inorderTraversal(function(t,n){null!=n.value&&e.push(new Nt(t,n.value))}),e}function on(t,e){if(bt(e))return t;var n=rn(t,e);return new Qe(null!=n?new $e(n):t.writeTree_.subtree(e))}function an(t){return t.writeTree_.isEmpty()}function ln(t,e){return cn(pt(),t.writeTree_,e)}function cn(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var i=null;return e.children.inorderTraversal(function(e,r){".priority"===e?((0,s.hu)(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):n=cn(xt(t,e),r,n)}),n.getChild(t).isEmpty()||null===i||(n=n.updateChild(xt(t,".priority"),i)),n}function un(t,e){return bn(e,t)}function hn(t,e){if(t.snap)return St(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&St(xt(t.path,n),e))return!0;return!1}function dn(t){return t.visible}function pn(t,e,n){for(var i=Qe.empty(),r=0;r<t.length;++r){var o=t[r];if(e(o)){var a=o.path,l=void 0;if(o.snap)St(n,a)?i=Ke(i,l=wt(n,a),o.snap):St(a,n)&&(l=wt(a,n),i=Ke(i,pt(),o.snap.getChild(l)));else{if(!o.children)throw(0,s.g5)("WriteRecord should have .snap or .children");if(St(n,a))i=tn(i,l=wt(n,a),o.children);else if(St(a,n))if(bt(l=wt(a,n)))i=tn(i,pt(),o.children);else{var c=(0,s.DV)(o.children,ft(l));if(c){var u=c.getChild(gt(l));i=Ke(i,pt(),u)}}}}}return i}function fn(t,e,n,i,r){if(i||r){var s=on(t.visibleWrites,e);return!r&&an(s)?n:r||null!=n||nn(s,pt())?ln(pn(t.allWrites,function(t){return(t.visible||r)&&(!i||!~i.indexOf(t.writeId))&&(St(t.path,e)||St(e,t.path))},e),n||re.EMPTY_NODE):null}var o=rn(t.visibleWrites,e);if(null!=o)return o;var a=on(t.visibleWrites,e);return an(a)?n:null!=n||nn(a,pt())?ln(a,n||re.EMPTY_NODE):null}function mn(t,e,n,i){return fn(t.writeTree,t.treePath,e,n,i)}function gn(t,e){return function(t,e,n){var i=re.EMPTY_NODE,r=rn(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Qt,function(t,e){i=i.updateImmediateChild(t,e)}),i;if(n){var s=on(t.visibleWrites,e);return n.forEachChild(Qt,function(t,e){var n=ln(on(s,new dt(t)),e);i=i.updateImmediateChild(t,n)}),sn(s).forEach(function(t){i=i.updateImmediateChild(t.name,t.node)}),i}return sn(on(t.visibleWrites,e)).forEach(function(t){i=i.updateImmediateChild(t.name,t.node)}),i}(t.writeTree,t.treePath,e)}function yn(t,e,n,i){return function(t,e,n,i,r){(0,s.hu)(i||r,"Either existingEventSnap or existingServerSnap must exist");var o=xt(e,n);if(nn(t.visibleWrites,o))return null;var a=on(t.visibleWrites,o);return an(a)?r.getChild(n):ln(a,r.getChild(n))}(t.writeTree,t.treePath,e,n,i)}function vn(t,e){return function(t,e){return rn(t.visibleWrites,e)}(t.writeTree,xt(t.treePath,e))}function _n(t,e,n){return function(t,e,n,i){var r=xt(e,n),s=rn(t.visibleWrites,r);return null!=s?s:i.isCompleteForChild(n)?ln(on(t.visibleWrites,r),i.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function xn(t,e){return bn(xt(t.treePath,e),t.writeTree)}function bn(t,e){return{treePath:t,writeTree:e}}var wn=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,s.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,s.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");var i=this.changeMap.get(n);if(i){var r=i.type;if("child_added"===e&&"child_removed"===r)this.changeMap.set(n,ve(n,t.snapshotNode,i.snapshotNode));else if("child_removed"===e&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===r)this.changeMap.set(n,ye(n,i.oldSnap));else if("child_changed"===e&&"child_added"===r)this.changeMap.set(n,ge(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==r)throw(0,s.g5)("Illegal combination of changes: "+t+" occurred after "+i);this.changeMap.set(n,ve(n,t.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),Cn=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Tn=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Ge(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return _n(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Je(this.viewCache_),r=function(t,e,n,i,r,s){return function(t,e,n,i,r,s,o){var a,l=on(t.visibleWrites,e),c=rn(l,pt());if(null!=c)a=c;else{if(null==n)return[];a=ln(l,n)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var u=[],h=o.getCompare(),d=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o),p=d.getNext();p&&u.length<1;)0!==h(p,i)&&u.push(p),p=d.getNext();return u}(t.writeTree,t.treePath,e,n,0,r,s)}(this.writes_,i,e,0,n,t);return 0===r.length?null:r[0]},t}();function Sn(t,e,n,i,r,o){var a=e.eventCache;if(null!=vn(i,n))return e;var l=void 0,c=void 0;if(bt(n))if((0,s.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var u=Je(e),h=gn(i,u instanceof re?u:re.EMPTY_NODE);l=t.filter.updateFullNode(e.eventCache.getNode(),h,o)}else{var d=mn(i,Je(e));l=t.filter.updateFullNode(e.eventCache.getNode(),d,o)}else{var p=ft(n);if(".priority"===p){(0,s.hu)(1===mt(n),"Can't have a priority with additional path components");var f=a.getNode(),m=yn(i,n,f,c=e.serverCache.getNode());l=null!=m?t.filter.updatePriority(f,m):a.getNode()}else{var g=gt(n),y=void 0;if(a.isCompleteForChild(p)){c=e.serverCache.getNode();var v=yn(i,n,a.getNode(),c);y=null!=v?a.getNode().getImmediateChild(p).updateChild(g,v):a.getNode().getImmediateChild(p)}else y=_n(i,p,e.serverCache);l=null!=y?t.filter.updateChild(a.getNode(),p,y,g,r,o):a.getNode()}}return Ze(e,l,a.isFullyInitialized()||bt(n),t.filter.filtersNodes())}function Mn(t,e,n,i,r,s,o,a){var l,c=e.serverCache,u=o?t.filter:t.filter.getIndexedFilter();if(bt(n))l=u.updateFullNode(c.getNode(),i,null);else if(u.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,i);l=u.updateFullNode(c.getNode(),h,null)}else{var d=ft(n);if(!c.isCompleteForPath(n)&&mt(n)>1)return e;var p=gt(n),f=c.getNode().getImmediateChild(d).updateChild(p,i);l=".priority"===d?u.updatePriority(c.getNode(),f):u.updateChild(c.getNode(),d,f,p,Cn,null)}var m=Ye(e,l,c.isFullyInitialized()||bt(n),u.filtersNodes());return Sn(t,m,n,r,new Tn(r,m,s),a)}function En(t,e,n,i,r,s,o){var a,l,c=e.eventCache,u=new Tn(r,e,s);if(bt(n))l=t.filter.updateFullNode(e.eventCache.getNode(),i,o),a=Ze(e,l,!0,t.filter.filtersNodes());else{var h=ft(n);if(".priority"===h)l=t.filter.updatePriority(e.eventCache.getNode(),i),a=Ze(e,l,c.isFullyInitialized(),c.isFiltered());else{var d=gt(n),p=c.getNode().getImmediateChild(h),f=void 0;if(bt(d))f=i;else{var m=u.getCompleteChild(h);f=null!=m?".priority"===yt(d)&&m.getChild(_t(d)).isEmpty()?m:m.updateChild(d,i):re.EMPTY_NODE}a=p.equals(f)?e:Ze(e,t.filter.updateChild(c.getNode(),h,f,d,u,o),c.isFullyInitialized(),t.filter.filtersNodes())}}return a}function An(t,e){return t.eventCache.isCompleteForChild(e)}function Dn(t,e,n){return n.foreach(function(t,n){e=e.updateChild(t,n)}),e}function Pn(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var l,c=e;l=bt(n)?i:new $e(null).setTree(n,i);var u=e.serverCache.getNode();return l.children.inorderTraversal(function(n,i){if(u.hasChild(n)){var l=Dn(0,e.serverCache.getNode().getImmediateChild(n),i);c=Mn(t,c,new dt(n),l,r,s,o,a)}}),l.children.inorderTraversal(function(n,i){var l=!e.serverCache.isCompleteForChild(n)&&void 0===i.value;if(!u.hasChild(n)&&!l){var h=Dn(0,e.serverCache.getNode().getImmediateChild(n),i);c=Mn(t,c,new dt(n),h,r,s,o,a)}}),c}var Ln,Rn=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,i=this.query_._queryParams,r=new _e(i.getIndex()),s=(n=i).loadsAllData()?new _e(n.getIndex()):n.hasLimit()?new be(n):new xe(n);this.processor_=function(t){return{filter:t}}(s);var o=e.serverCache,a=e.eventCache,l=r.updateFullNode(re.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(re.EMPTY_NODE,a.getNode(),null),u=new Ge(l,o.isFullyInitialized(),r.filtersNodes()),h=new Ge(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=qe(h,u),this.eventGenerator_=new je(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function In(t,e){var n=Je(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!bt(e)&&!n.getImmediateChild(ft(e)).isEmpty())?n.getChild(e):null}function Nn(t){return 0===t.eventRegistrations_.length}function kn(t,e,n){var i=[];if(n){(0,s.hu)(null==e,"A cancel should cancel all event registrations.");var r=t.query._path;t.eventRegistrations_.forEach(function(t){var e=t.createCancelEvent(n,r);e&&i.push(e)})}if(e){for(var o=[],a=0;a<t.eventRegistrations_.length;++a){var l=t.eventRegistrations_[a];if(l.matches(e)){if(e.hasAnyCallback()){o=o.concat(t.eventRegistrations_.slice(a+1));break}}else o.push(l)}t.eventRegistrations_=o}else t.eventRegistrations_=[];return i}function On(t,e,n,i){e.type===Oe.MERGE&&null!==e.source.queryId&&((0,s.hu)(Je(t.viewCache_),"We should always have a full cache before handling merges"),(0,s.hu)(Xe(t.viewCache_),"Missing event cache, even though we have a server cache"));var r,o,a=t.viewCache_,l=function(t,e,n,i,r){var o,a,l=new wn;if(n.type===Oe.OVERWRITE){var c=n;c.source.fromUser?o=En(t,e,c.path,c.snap,i,r,l):((0,s.hu)(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!bt(c.path),o=Mn(t,e,c.path,c.snap,i,r,a,l))}else if(n.type===Oe.MERGE){var u=n;u.source.fromUser?o=function(t,e,n,i,r,s,o){var a=e;return i.foreach(function(i,l){var c=xt(n,i);An(e,ft(c))&&(a=En(t,a,c,l,r,s,o))}),i.foreach(function(i,l){var c=xt(n,i);An(e,ft(c))||(a=En(t,a,c,l,r,s,o))}),a}(t,e,u.path,u.children,i,r,l):((0,s.hu)(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=Pn(t,e,u.path,u.children,i,r,a,l))}else if(n.type===Oe.ACK_USER_WRITE){var h=n;o=h.revert?function(t,e,n,i,r,o){var a;if(null!=vn(i,n))return e;var l=new Tn(i,e,r),c=e.eventCache.getNode(),u=void 0;if(bt(n)||".priority"===ft(n)){var h=void 0;if(e.serverCache.isFullyInitialized())h=mn(i,Je(e));else{var d=e.serverCache.getNode();(0,s.hu)(d instanceof re,"serverChildren would be complete if leaf node"),h=gn(i,d)}u=t.filter.updateFullNode(c,h=h,o)}else{var p=ft(n),f=_n(i,p,e.serverCache);null==f&&e.serverCache.isCompleteForChild(p)&&(f=c.getImmediateChild(p)),(u=null!=f?t.filter.updateChild(c,p,f,gt(n),l,o):e.eventCache.getNode().hasChild(p)?t.filter.updateChild(c,p,re.EMPTY_NODE,gt(n),l,o):c).isEmpty()&&e.serverCache.isFullyInitialized()&&(a=mn(i,Je(e))).isLeafNode()&&(u=t.filter.updateFullNode(u,a,o))}return a=e.serverCache.isFullyInitialized()||null!=vn(i,pt()),Ze(e,u,a,t.filter.filtersNodes())}(t,e,h.path,i,r,l):function(t,e,n,i,r,s,o){if(null!=vn(r,n))return e;var a=e.serverCache.isFiltered(),l=e.serverCache;if(null!=i.value){if(bt(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Mn(t,e,n,l.getNode().getChild(n),r,s,a,o);if(bt(n)){var c=new $e(null);return l.getNode().forEachChild(zt,function(t,e){c=c.set(new dt(t),e)}),Pn(t,e,n,c,r,s,a,o)}return e}var u=new $e(null);return i.foreach(function(t,e){var i=xt(n,t);l.isCompleteForPath(i)&&(u=u.set(t,l.getNode().getChild(i)))}),Pn(t,e,n,u,r,s,a,o)}(t,e,h.path,h.affectedTree,i,r,l)}else{if(n.type!==Oe.LISTEN_COMPLETE)throw(0,s.g5)("Unknown operation type: "+n.type);o=function(t,e,n,i,r){var s=e.serverCache;return Sn(t,Ye(e,s.getNode(),s.isFullyInitialized()||bt(n),s.isFiltered()),n,i,Cn,r)}(t,e,n.path,i,l)}var d=l.getChanges();return function(t,e,n){var i=e.eventCache;if(i.isFullyInitialized()){var r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Xe(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(me(Xe(e)))}}(e,o,d),{viewCache:o,changes:d}}(t.processor_,a,e,n,i);return r=t.processor_,(0,s.hu)((o=l.viewCache).eventCache.getNode().isIndexed(r.filter.getIndex()),"Event snap not indexed"),(0,s.hu)(o.serverCache.getNode().isIndexed(r.filter.getIndex()),"Server snap not indexed"),(0,s.hu)(l.viewCache.serverCache.isFullyInitialized()||!a.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=l.viewCache,zn(t,l.changes,l.viewCache.eventCache.getNode(),null)}function zn(t,e,n,i){return function(t,e,n,i){var r=[],s=[];return e.forEach(function(e){"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&s.push({type:"child_moved",snapshotNode:e.snapshotNode,childName:e.childName})}),We(t,r,"child_removed",e,i,n),We(t,r,"child_added",e,i,n),We(t,r,"child_moved",s,i,n),We(t,r,"child_changed",e,i,n),We(t,r,"value",e,i,n),r}(t.eventGenerator_,e,n,i?[i]:t.eventRegistrations_)}var Fn,Un=function(){return function(){this.views=new Map}}();function Hn(t,e,n,i){var r,a,l=e.source.queryId;if(null!==l){var c=t.views.get(l);return(0,s.hu)(null!=c,"SyncTree gave us an op for an invalid query."),On(c,e,n,i)}var u=[];try{for(var h=(0,o.XA)(t.views.values()),d=h.next();!d.done;d=h.next())u=u.concat(On(c=d.value,e,n,i))}catch(p){r={error:p}}finally{try{d&&!d.done&&(a=h.return)&&a.call(h)}finally{if(r)throw r.error}}return u}function Bn(t,e,n,i,r){var s=t.views.get(e._queryIdentifier);if(!s){var o=mn(n,r?i:null),a=!1;o?a=!0:i instanceof re?(o=gn(n,i),a=!1):(o=re.EMPTY_NODE,a=!1);var l=qe(new Ge(o,a,!1),new Ge(i,r,!1));return new Rn(e,l)}return s}function Vn(t){var e,n,i=[];try{for(var r=(0,o.XA)(t.views.values()),s=r.next();!s.done;s=r.next()){var a=s.value;a.query._queryParams.loadsAllData()||i.push(a)}}catch(l){e={error:l}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Gn(t,e){var n,i,r=null;try{for(var s=(0,o.XA)(t.views.values()),a=s.next();!a.done;a=s.next())r=r||In(a.value,e)}catch(l){n={error:l}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return r}function jn(t,e){return e._queryParams.loadsAllData()?Zn(t):t.views.get(e._queryIdentifier)}function Wn(t,e){return null!=jn(t,e)}function qn(t){return null!=Zn(t)}function Zn(t){var e,n;try{for(var i=(0,o.XA)(t.views.values()),r=i.next();!r.done;r=i.next()){var s=r.value;if(s.query._queryParams.loadsAllData())return s}}catch(a){e={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return null}var Yn=1,Xn=function(){return function(t){this.listenProvider_=t,this.syncPointTree_=new $e(null),this.pendingWriteTree_={visibleWrites:Qe.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}();function Jn(t,e,n,i,r){return function(t,e,n,i,r){(0,s.hu)(i>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=Ke(t.visibleWrites,e,n)),t.lastWriteId=i}(t.pendingWriteTree_,e,n,i,r),r?ni(t,new Be({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function $n(t,e,n){void 0===n&&(n=!1);var i=function(t,e){for(var n=0;n<t.allWrites.length;n++){var i=t.allWrites[n];if(i.writeId===e)return i}return null}(t.pendingWriteTree_,e);if(function(t,e){var n=t.allWrites.findIndex(function(t){return t.writeId===e});(0,s.hu)(n>=0,"removeWrite called with nonexistent writeId.");var i=t.allWrites[n];t.allWrites.splice(n,1);for(var r=i.visible,o=!1,a=t.allWrites.length-1;r&&a>=0;){var l=t.allWrites[a];l.visible&&(a>=n&&hn(l,i.path)?r=!1:St(i.path,l.path)&&(o=!0)),a--}return!!r&&(o?(function(t){t.visibleWrites=pn(t.allWrites,dn,pt()),t.lastWriteId=t.allWrites.length>0?t.allWrites[t.allWrites.length-1].writeId:-1}(t),!0):(i.snap?t.visibleWrites=en(t.visibleWrites,i.path):O(i.children,function(e){t.visibleWrites=en(t.visibleWrites,xt(i.path,e))}),!0))}(t.pendingWriteTree_,e)){var r=new $e(null);return null!=i.snap?r=r.set(pt(),!0):O(i.children,function(t){r=r.set(new dt(t),!0)}),ni(t,new Ue(i.path,r,n))}return[]}function Qn(t,e,n){return ni(t,new Be({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function Kn(t,e,n,i){var r=e._path,a=t.syncPointTree_.get(r),l=[];if(a&&("default"===e._queryIdentifier||Wn(a,e))){var c=function(t,e,n,i){var r,a,l=e._queryIdentifier,c=[],u=[],h=qn(t);if("default"===l)try{for(var d=(0,o.XA)(t.views.entries()),p=d.next();!p.done;p=d.next()){var f,m=(0,o.CR)(p.value,2),g=m[0];u=u.concat(kn(f=m[1],n,i)),Nn(f)&&(t.views.delete(g),f.query._queryParams.loadsAllData()||c.push(f.query))}}catch(y){r={error:y}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}else(f=t.views.get(l))&&(u=u.concat(kn(f,n,i)),Nn(f)&&(t.views.delete(l),f.query._queryParams.loadsAllData()||c.push(f.query)));return h&&!qn(t)&&c.push(new((0,s.hu)(Ln,"Reference.ts has not been loaded"),Ln)(e._repo,e._path)),{removed:c,events:u}}(a,e,n,i);0===a.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(r));var u=c.removed;l=c.events;var h=-1!==u.findIndex(function(t){return t._queryParams.loadsAllData()}),d=t.syncPointTree_.findOnPath(r,function(t,e){return qn(e)});if(h&&!d){var p=t.syncPointTree_.subtree(r);if(!p.isEmpty())for(var f=function(t){return t.fold(function(t,e,n){if(e&&qn(e))return[Zn(e)];var i=[];return e&&(i=Vn(e)),O(n,function(t,e){i=i.concat(e)}),i})}(p),m=0;m<f.length;++m){var g=f[m],y=g.query,v=si(t,g);t.listenProvider_.startListening(hi(y),oi(t,y),v.hashFn,v.onComplete)}}!d&&u.length>0&&!i&&(h?t.listenProvider_.stopListening(hi(e),null):u.forEach(function(e){var n=t.queryToTagMap.get(ai(e));t.listenProvider_.stopListening(hi(e),n)})),function(t,e){for(var n=0;n<e.length;++n){var i=e[n];if(!i._queryParams.loadsAllData()){var r=ai(i),s=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(s)}}}(t,u)}return l}function ti(t,e,n){var i=e._path,r=null,o=!1;t.syncPointTree_.foreachOnPath(i,function(t,e){var n=wt(t,i);r=r||Gn(e,n),o=o||qn(e)});var a,l=t.syncPointTree_.get(i);l?(o=o||qn(l),r=r||Gn(l,pt())):(l=new Un,t.syncPointTree_=t.syncPointTree_.set(i,l)),null!=r?a=!0:(a=!1,r=re.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild(function(t,e){var n=Gn(e,pt());n&&(r=r.updateImmediateChild(t,n))}));var c=Wn(l,e);if(!c&&!e._queryParams.loadsAllData()){var u=ai(e);(0,s.hu)(!t.queryToTagMap.has(u),"View does not exist, but we have a tag");var h=Yn++;t.queryToTagMap.set(u,h),t.tagToQueryMap.set(h,u)}var d=function(t,e,n,i,r,s){var o=Bn(t,e,i,r,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),function(t,e){t.eventRegistrations_.push(e)}(o,n),function(t,e){var n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Qt,function(t,e){i.push(ge(t,e))}),n.isFullyInitialized()&&i.push(me(n.getNode())),zn(t,i,n.getNode(),e)}(o,n)}(l,e,n,un(t.pendingWriteTree_,i),r,a);if(!c&&!o){var p=jn(l,e);d=d.concat(function(t,e,n){var i=e._path,r=oi(t,e),o=si(t,n),a=t.listenProvider_.startListening(hi(e),r,o.hashFn,o.onComplete),l=t.syncPointTree_.subtree(i);if(r)(0,s.hu)(!qn(l.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=l.fold(function(t,e,n){if(!bt(t)&&e&&qn(e))return[Zn(e).query];var i=[];return e&&(i=i.concat(Vn(e).map(function(t){return t.query}))),O(n,function(t,e){i=i.concat(e)}),i}),u=0;u<c.length;++u){var h=c[u];t.listenProvider_.stopListening(hi(h),oi(t,h))}return a}(t,e,p))}return d}function ei(t,e,n){var i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,function(t,n){var i=Gn(n,wt(t,e));if(i)return i});return fn(i,e,r,n,!0)}function ni(t,e){return ii(e,t.syncPointTree_,null,un(t.pendingWriteTree_,pt()))}function ii(t,e,n,i){if(bt(t.path))return ri(t,e,n,i);var r=e.get(pt());null==n&&null!=r&&(n=Gn(r,pt()));var s=[],o=ft(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){var c=n?n.getImmediateChild(o):null,u=xn(i,o);s=s.concat(ii(a,l,c,u))}return r&&(s=s.concat(Hn(r,t,i,n))),s}function ri(t,e,n,i){var r=e.get(pt());null==n&&null!=r&&(n=Gn(r,pt()));var s=[];return e.children.inorderTraversal(function(e,r){var o=n?n.getImmediateChild(e):null,a=xn(i,e),l=t.operationForChild(e);l&&(s=s.concat(ri(l,r,o,a)))}),r&&(s=s.concat(Hn(r,t,i,n))),s}function si(t,e){var n=e.query,i=oi(t,n);return{hashFn:function(){return(function(t){return t.viewCache_.serverCache.getNode()}(e)||re.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return i?function(t,e,n){var i=li(t,n);if(i){var r=ci(i),s=r.path,o=r.queryId,a=wt(s,e);return ui(t,s,new He(ze(o),a))}return[]}(t,n._path,i):function(t,e){return ni(t,new He({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);var r=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}(e,n);return Kn(t,n,null,r)}}}function oi(t,e){var n=ai(e);return t.queryToTagMap.get(n)}function ai(t){return t._path.toString()+"$"+t._queryIdentifier}function li(t,e){return t.tagToQueryMap.get(e)}function ci(t){var e=t.indexOf("$");return(0,s.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new dt(t.substr(0,e))}}function ui(t,e,n){var i=t.syncPointTree_.get(e);return(0,s.hu)(i,"Missing sync point for query tag that we're tracking"),Hn(i,n,un(t.pendingWriteTree_,e),null)}function hi(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,s.hu)(Fn,"Reference.ts has not been loaded"),Fn)(t._repo,t._path):t}var di=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),pi=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=xt(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return ei(this.syncTree_,this.path_)},t}(),fi=function(t,e,n){return t&&"object"==typeof t?((0,s.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?mi(t[".sv"],e,n):"object"==typeof t[".sv"]?gi(t[".sv"],e):void(0,s.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},mi=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:(0,s.hu)(!1,"Unexpected server value: "+t)}},gi=function(t,e,n){t.hasOwnProperty("increment")||(0,s.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var i=t.increment;"number"!=typeof i&&(0,s.hu)(!1,"Unexpected increment value: "+i);var r=e.node();if((0,s.hu)(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;var o=r.getValue();return"number"!=typeof o?i:o+i},yi=function(t,e,n,i){return _i(e,new pi(n,t),i)},vi=function(t,e,n){return _i(t,new di(e),n)};function _i(t,e,n){var i,r=t.getPriority().val(),s=fi(r,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var o=t,a=fi(o.getValue(),e,n);return a!==o.getValue()||s!==o.getPriority().val()?new $t(a,oe(s)):t}var l=t;return i=l,s!==l.getPriority().val()&&(i=i.updatePriority(new $t(s))),l.forEachChild(Qt,function(t,r){var s=_i(r,e.getImmediateChild(t),n);s!==r&&(i=i.updateImmediateChild(t,s))}),i}var xi=function(){return function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n}}();function bi(t,e){for(var n=e instanceof dt?e:new dt(e),i=t,r=ft(n);null!==r;){var o=(0,s.DV)(i.node.children,r)||{children:{},childCount:0};i=new xi(r,i,o),r=ft(n=gt(n))}return i}function wi(t){return t.node.value}function Ci(t,e){t.node.value=e,Ai(t)}function Ti(t){return t.node.childCount>0}function Si(t,e){O(t.node.children,function(n,i){e(new xi(n,t,i))})}function Mi(t,e,n,i){n&&!i&&e(t),Si(t,function(t){Mi(t,e,!0,i)}),n&&i&&e(t)}function Ei(t){return new dt(null===t.parent?t.name:Ei(t.parent)+"/"+t.name)}function Ai(t){null!==t.parent&&function(t,e,n){var i=function(t){return void 0===wi(t)&&!Ti(t)}(n),r=(0,s.r3)(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,Ai(t)):i||r||(t.node.children[e]=n.node,t.node.childCount++,Ai(t))}(t.parent,t.name,t)}var Di=/[\[\].#$\/\u0000-\u001F\u007F]/,Pi=/[\[\].#$\u0000-\u001F\u007F]/,Li=10485760,Ri=function(t){return"string"==typeof t&&0!==t.length&&!Di.test(t)},Ii=function(t){return"string"==typeof t&&0!==t.length&&!Pi.test(t)},Ni=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!A(t)||t&&"object"==typeof t&&(0,s.r3)(t,".sv")},ki=function(t,e,n,i){i&&void 0===e||Oi((0,s.gK)(t,"value"),e,n)},Oi=function(t,e,n){var i=n instanceof dt?new Mt(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+At(i));if("function"==typeof e)throw new Error(t+"contains a function "+At(i)+" with contents = "+e.toString());if(A(e))throw new Error(t+"contains "+e.toString()+" "+At(i));if("string"==typeof e&&e.length>Li/3&&(0,s.ug)(e)>Li)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+At(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var r=!1,o=!1;if(O(e,function(e,n){if(".value"===e)r=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!Ri(e)))throw new Error(t+" contains an invalid key ("+e+") "+At(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var a,l;!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,s.ug)(e),Et(t)}(i,e),Oi(t,n,i),l=(a=i).parts_.pop(),a.byteLength_-=(0,s.ug)(l),a.parts_.length>0&&(a.byteLength_-=1)}),r&&o)throw new Error(t+' contains ".value" child '+At(i)+" in addition to actual children.")}},zi=function(t,e,n,i){if(!i||void 0!==e){var r=(0,s.gK)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");var o=[];O(e,function(t,e){var i=new dt(t);if(Oi(r,e,xt(n,i)),".priority"===yt(i)&&!Ni(e))throw new Error(r+"contains an invalid value for '"+i.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(i)}),function(t,e){var n,i;for(n=0;n<e.length;n++)for(var r=vt(i=e[n]),s=0;s<r.length;s++)if(".priority"===r[s]&&s===r.length-1);else if(!Ri(r[s]))throw new Error(t+"contains an invalid key ("+r[s]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(Ct);var o=null;for(n=0;n<e.length;n++){if(i=e[n],null!==o&&St(o,i))throw new Error(t+"contains a path "+o.toString()+" that is ancestor of another path "+i.toString());o=i}}(r,o)}},Fi=function(t,e,n){if(!n||void 0!==e){if(A(e))throw new Error((0,s.gK)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Ni(e))throw new Error((0,s.gK)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ui=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,s.gK)(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Hi=function(t,e,n,i){if(!(i&&void 0===n||Ri(n)))throw new Error((0,s.gK)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},Bi=function(t,e,n,i){if(!(i&&void 0===n||Ii(n)))throw new Error((0,s.gK)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Vi=function(t,e){if(".info"===ft(e))throw new Error(t+" failed = Can't modify data under /.info/")},Gi=function(t,e){var n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!Ri(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Ii(t)}(n))throw new Error((0,s.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},ji=function(t,e,n,i){if((!i||void 0!==n)&&"boolean"!=typeof n)throw new Error((0,s.gK)(t,e)+"must be a boolean.")},Wi=function(){return function(){this.eventLists_=[],this.recursionDepth_=0}}();function qi(t,e){for(var n=null,i=0;i<e.length;i++){var r=e[i],s=r.getPath();null===n||Tt(s,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function Zi(t,e,n){qi(t,n),Xi(t,function(t){return Tt(t,e)})}function Yi(t,e,n){qi(t,n),Xi(t,function(t){return St(t,e)||St(e,t)})}function Xi(t,e){t.recursionDepth_++;for(var n=!0,i=0;i<t.eventLists_.length;i++){var r=t.eventLists_[i];r&&(e(r.path)?(Ji(t.eventLists_[i]),t.eventLists_[i]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function Ji(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var i=n.getEventRunner();x&&C("event: "+n.toString()),H(i)}}}var $i="repo_interrupt",Qi=function(){function t(t,e,n,i){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Wi,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Pe(),this.transactionQueueTree_=new xi,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function Ki(t){var e=t.infoData_.getNode(new dt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function tr(t){return(e=(e={timestamp:Ki(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function er(t,e,n,i,r){t.dataUpdateCount++;var o=new dt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var a=[];if(r)if(i){var l=(0,s.UI)(n,function(t){return oe(t)});a=function(t,e,n,i){var r=li(t,i);if(r){var s=ci(r),o=s.path,a=s.queryId,l=wt(o,e),c=$e.fromObject(n);return ui(t,o,new Ve(ze(a),l,c))}return[]}(t.serverSyncTree_,o,l,r)}else{var c=oe(n);a=function(t,e,n,i){var r=li(t,i);if(null!=r){var s=ci(r),o=s.path,a=s.queryId,l=wt(o,e);return ui(t,o,new Be(ze(a),l,n))}return[]}(t.serverSyncTree_,o,c,r)}else if(i){var u=(0,s.UI)(n,function(t){return oe(t)});a=function(t,e,n){var i=$e.fromObject(n);return ni(t,new Ve({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,o,u)}else{var h=oe(n);a=Qn(t.serverSyncTree_,o,h)}var d=o;a.length>0&&(d=fr(t,o)),Yi(t.eventQueue_,d,a)}function nr(t,e){ir(t,"connected",e),!1===e&&function(t){ur(t,"onDisconnectEvents");var e=tr(t),n=Pe();Ie(t.onDisconnect_,pt(),function(i,r){var s=yi(i,r,t.serverSyncTree_,e);Le(n,i,s)});var i=[];Ie(n,pt(),function(e,n){i=i.concat(Qn(t.serverSyncTree_,e,n));var r=_r(t,e);fr(t,r)}),t.onDisconnect_=Pe(),Yi(t.eventQueue_,pt(),i)}(t)}function ir(t,e,n){var i=new dt("/.info/"+e),r=oe(n);t.infoData_.updateSnapshot(i,r);var s=Qn(t.infoSyncTree_,i,r);Yi(t.eventQueue_,i,s)}function rr(t){return t.nextWriteId_++}function sr(t,e,n,i,r){ur(t,"set",{path:e.toString(),value:n,priority:i});var s=tr(t),o=oe(n,i),a=ei(t.serverSyncTree_,e),l=vi(o,a,s),c=rr(t),u=Jn(t.serverSyncTree_,e,l,c,!0);qi(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),function(n,i){var s="ok"===n;s||E("set at "+e+" failed: "+n);var o=$n(t.serverSyncTree_,c,!s);Yi(t.eventQueue_,e,o),hr(0,r,n,i)});var h=_r(t,e);fr(t,h),Yi(t.eventQueue_,h,[])}function or(t,e,n){t.server_.onDisconnectCancel(e.toString(),function(i,r){"ok"===i&&Re(t.onDisconnect_,e),hr(0,n,i,r)})}function ar(t,e,n,i){var r=oe(n);t.server_.onDisconnectPut(e.toString(),r.val(!0),function(n,s){"ok"===n&&Le(t.onDisconnect_,e,r),hr(0,i,n,s)})}function lr(t,e,n){var i;i=".info"===ft(e._path)?Kn(t.infoSyncTree_,e,n):Kn(t.serverSyncTree_,e,n),Zi(t.eventQueue_,e._path,i)}function cr(t){t.persistentConnection_&&t.persistentConnection_.interrupt($i)}function ur(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i="";t.persistentConnection_&&(i=t.persistentConnection_.id+":"),C.apply(void 0,(0,o.ev)([i],(0,o.CR)(e)))}function hr(t,e,n,i){e&&H(function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),r=t;i&&(r+=": "+i);var s=new Error(r);s.code=t,e(s)}})}function dr(t,e,n){return ei(t.serverSyncTree_,e,n)||re.EMPTY_NODE}function pr(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||vr(t,e),wi(e)){var n=gr(t,e);(0,s.hu)(n.length>0,"Sending zero length transaction queue"),n.every(function(t){return 0===t.status})&&function(t,e,n){for(var i=n.map(function(t){return t.currentWriteId}),r=dr(t,e,i),o=r,a=r.hash(),l=0;l<n.length;l++){var c=n[l];(0,s.hu)(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var u=wt(e,c.path);o=o.updateChild(u,c.currentOutputSnapshotRaw)}var h=o.val(!0),d=e;t.server_.put(d.toString(),h,function(i){ur(t,"transaction put response",{path:d.toString(),status:i});var r=[];if("ok"===i){for(var s=[],o=function(e){n[e].status=2,r=r.concat($n(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&s.push(function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)}),n[e].unwatcher()},a=0;a<n.length;a++)o(a);for(vr(t,bi(t.transactionQueueTree_,e)),pr(t,t.transactionQueueTree_),Yi(t.eventQueue_,e,r),a=0;a<s.length;a++)H(s[a])}else{if("datastale"===i)for(a=0;a<n.length;a++)n[a].status=3===n[a].status?4:0;else for(E("transaction at "+d.toString()+" failed: "+i),a=0;a<n.length;a++)n[a].status=4,n[a].abortReason=i;fr(t,e)}},a)}(t,Ei(e),n)}else Ti(e)&&Si(e,function(e){pr(t,e)})}function fr(t,e){var n=mr(t,e),i=Ei(n);return function(t,e,n){if(0!==e.length){for(var i=[],r=[],o=e.filter(function(t){return 0===t.status}).map(function(t){return t.currentWriteId}),a=function(a){var l,c=e[a],u=wt(n,c.path),h=!1;if((0,s.hu)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)h=!0,l=c.abortReason,r=r.concat($n(t.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)h=!0,l="maxretry",r=r.concat($n(t.serverSyncTree_,c.currentWriteId,!0));else{var d=dr(t,c.path,o);c.currentInputSnapshot=d;var p=e[a].update(d.val());if(void 0!==p){Oi("transaction failed: Data returned ",p,c.path);var f=oe(p);"object"==typeof p&&null!=p&&(0,s.r3)(p,".priority")||(f=f.updatePriority(d.getPriority()));var m=c.currentWriteId,g=tr(t),y=vi(f,d,g);c.currentOutputSnapshotRaw=f,c.currentOutputSnapshotResolved=y,c.currentWriteId=rr(t),o.splice(o.indexOf(m),1),r=(r=r.concat(Jn(t.serverSyncTree_,c.path,y,c.currentWriteId,c.applyLocally))).concat($n(t.serverSyncTree_,m,!0))}else h=!0,l="nodata",r=r.concat($n(t.serverSyncTree_,c.currentWriteId,!0))}Yi(t.eventQueue_,n,r),r=[],h&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&i.push("nodata"===l?function(){return e[a].onComplete(null,!1,e[a].currentInputSnapshot)}:function(){return e[a].onComplete(new Error(l),!1,null)}))},l=0;l<e.length;l++)a(l);for(vr(t,t.transactionQueueTree_),l=0;l<i.length;l++)H(i[l]);pr(t,t.transactionQueueTree_)}}(t,gr(t,n),i),i}function mr(t,e){var n,i=t.transactionQueueTree_;for(n=ft(e);null!==n&&void 0===wi(i);)i=bi(i,n),n=ft(e=gt(e));return i}function gr(t,e){var n=[];return yr(t,e,n),n.sort(function(t,e){return t.order-e.order}),n}function yr(t,e,n){var i=wi(e);if(i)for(var r=0;r<i.length;r++)n.push(i[r]);Si(e,function(e){yr(t,e,n)})}function vr(t,e){var n=wi(e);if(n){for(var i=0,r=0;r<n.length;r++)2!==n[r].status&&(n[i]=n[r],i++);n.length=i,Ci(e,n.length>0?n:void 0)}Si(e,function(e){vr(t,e)})}function _r(t,e){var n=Ei(mr(t,e)),i=bi(t.transactionQueueTree_,e);return function(t,e,n){for(var i=t.parent;null!==i;){if(e(i))return!0;i=i.parent}}(i,function(e){xr(t,e)}),xr(t,i),Mi(i,function(e){xr(t,e)}),n}function xr(t,e){var n=wi(e);if(n){for(var i=[],r=[],o=-1,a=0;a<n.length;a++)3===n[a].status||(1===n[a].status?((0,s.hu)(o===a-1,"All SENT items should be at beginning of queue."),o=a,n[a].status=3,n[a].abortReason="set"):((0,s.hu)(0===n[a].status,"Unexpected transaction status in abort"),n[a].unwatcher(),r=r.concat($n(t.serverSyncTree_,n[a].currentWriteId,!0)),n[a].onComplete&&i.push(n[a].onComplete.bind(null,new Error("set"),!1,null))));for(-1===o?Ci(e,void 0):n.length=o+1,Yi(t.eventQueue_,Ei(e),r),a=0;a<i.length;a++)H(i[a])}}var br=function(t,e){var n=wr(t),i=n.namespace;return"firebase.com"===n.domain&&M(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||M("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&E("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new Y(n.host,n.secure,i,e,"ws"===n.scheme||"wss"===n.scheme,"",i!==n.subdomain),path:new dt(n.pathString)}},wr=function(t){var e="",n="",i="",r="",s="",a=!0,l="https",c=443;if("string"==typeof t){var u=t.indexOf("//");u>=0&&(l=t.substring(0,u-1),t=t.substring(u+2));var h=t.indexOf("/");-1===h&&(h=t.length);var d=t.indexOf("?");-1===d&&(d=t.length),e=t.substring(0,Math.min(h,d)),h<d&&(r=function(t){for(var e="",n=t.split("/"),i=0;i<n.length;i++)if(n[i].length>0){var r=n[i];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(s){}e+="/"+r}return e}(t.substring(h,d)));var p=function(t){var e,n,i={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var r=(0,o.XA)(t.split("&")),s=r.next();!s.done;s=r.next()){var a=s.value;if(0!==a.length){var l=a.split("=");2===l.length?i[decodeURIComponent(l[0])]=decodeURIComponent(l[1]):E("Invalid query segment '"+a+"' in query '"+t+"'")}}}catch(c){e={error:c}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}(t.substring(Math.min(t.length,d)));(u=e.indexOf(":"))>=0?(a="https"===l||"wss"===l,c=parseInt(e.substring(u+1),10)):u=e.length;var f=e.slice(0,u);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{var m=e.indexOf(".");i=e.substring(0,m).toLowerCase(),n=e.substring(m+1),s=i}"ns"in p&&(s=p.ns)}return{host:e,port:c,domain:n,subdomain:i,secure:a,scheme:l,pathString:r,namespace:s}},Cr=function(){function t(t,e,n,i){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=i}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,s.Pz)(this.snapshot.exportVal())},t}(),Tr=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Sr=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return(0,s.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),Mr=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new s.BH;return or(this._repo,this._path,t.wrapCallback(function(){})),t.promise},t.prototype.remove=function(){Vi("OnDisconnect.remove",this._path);var t=new s.BH;return ar(this._repo,this._path,null,t.wrapCallback(function(){})),t.promise},t.prototype.set=function(t){Vi("OnDisconnect.set",this._path),ki("OnDisconnect.set",t,this._path,!1);var e=new s.BH;return ar(this._repo,this._path,t,e.wrapCallback(function(){})),e.promise},t.prototype.setWithPriority=function(t,e){Vi("OnDisconnect.setWithPriority",this._path),ki("OnDisconnect.setWithPriority",t,this._path,!1),Fi("OnDisconnect.setWithPriority",e,!1);var n=new s.BH;return function(t,e,n,i,r){var s=oe(n,i);t.server_.onDisconnectPut(e.toString(),s.val(!0),function(n,i){"ok"===n&&Le(t.onDisconnect_,e,s),hr(0,r,n,i)})}(this._repo,this._path,t,e,n.wrapCallback(function(){})),n.promise},t.prototype.update=function(t){Vi("OnDisconnect.update",this._path),zi("OnDisconnect.update",t,this._path,!1);var e=new s.BH;return function(t,e,n,i){if((0,s.xb)(n))return C("onDisconnect().update() called with empty data.  Don't do anything."),void hr(0,i,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,function(r,s){"ok"===r&&O(n,function(n,i){var r=oe(i);Le(t.onDisconnect_,xt(e,n),r)}),hr(0,i,r,s)})}(this._repo,this._path,t,e.wrapCallback(function(){})),e.promise},t}(),Er=function(){function t(t,e,n,i){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=i}return Object.defineProperty(t.prototype,"key",{get:function(){return bt(this._path)?null:yt(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Lr(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=Ee(this._queryParams),e=N(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return Ee(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=(0,s.m9)(e))instanceof t))return!1;var n=this._repo===e._repo,i=Tt(this._path,e._path);return n&&i&&this._queryIdentifier===e._queryIdentifier},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function Ar(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Dr(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===zt){var i="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==D)throw new Error(i);if("string"!=typeof e)throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!==P)throw new Error(i);if("string"!=typeof n)throw new Error(r)}}else if(t.getIndex()===Qt){if(null!=e&&!Ni(e)||null!=n&&!Ni(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,s.hu)(t.getIndex()instanceof ce||t.getIndex()===ue,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Pr(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Lr=function(t){function e(e,n){return t.call(this,e,n,new we,!1)||this}return(0,o.ZT)(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=_t(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(Er),Rr=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new dt(e),i=kr(this.ref,e);return new t(this._node.getChild(n),i,Qt)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,function(i,r){return e(new t(r,kr(n.ref,i),Qt))})},t.prototype.hasChild=function(t){var e=new dt(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function Ir(t,e){return(t=(0,s.m9)(t))._checkNotDeleted("ref"),void 0!==e?kr(t._root,e):t._root}function Nr(t,e){(t=(0,s.m9)(t))._checkNotDeleted("refFromURL");var n=br(e,t._repo.repoInfo_.nodeAdmin);Gi("refFromURL",n);var i=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||i.host===t._repo.repoInfo_.host||M("refFromURL: Host name does not match the current database: (found "+i.host+" but expected "+t._repo.repoInfo_.host+")"),Ir(t,n.path.toString())}function kr(t,e){var n;return null===ft((t=(0,s.m9)(t))._path)?((n=e)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Bi("child","path",n,!1)):Bi("child","path",e,!1),new Lr(t._repo,xt(t._path,e))}function Or(t,e){t=(0,s.m9)(t),Vi("push",t._path),ki("push",e,t._path,!0);var n,i=Ki(t._repo),r=de(i),o=kr(t,r),a=kr(t,r);return n=null!=e?Fr(a,e).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),o}function zr(t){return Vi("remove",t._path),Fr(t,null)}function Fr(t,e){t=(0,s.m9)(t),Vi("set",t._path),ki("set",e,t._path,!1);var n=new s.BH;return sr(t._repo,t._path,e,null,n.wrapCallback(function(){})),n.promise}function Ur(t,e){t=(0,s.m9)(t),Vi("setPriority",t._path),Fi("setPriority",e,!1);var n=new s.BH;return sr(t._repo,xt(t._path,".priority"),e,null,n.wrapCallback(function(){})),n.promise}function Hr(t,e,n){if(Vi("setWithPriority",t._path),ki("setWithPriority",e,t._path,!1),Fi("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var i=new s.BH;return sr(t._repo,t._path,e,n,i.wrapCallback(function(){})),i.promise}function Br(t,e){zi("update",e,t._path,!1);var n=new s.BH;return function(t,e,n,i){ur(t,"update",{path:e.toString(),value:n});var r=!0,o=tr(t),a={};if(O(n,function(n,i){r=!1,a[n]=yi(xt(e,n),oe(i),t.serverSyncTree_,o)}),r)C("update() called with empty data.  Don't do anything."),hr(0,i,"ok",void 0);else{var l=rr(t),c=function(t,e,n,i){!function(t,e,n,i){(0,s.hu)(i>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:i,visible:!0}),t.visibleWrites=tn(t.visibleWrites,e,n),t.lastWriteId=i}(t.pendingWriteTree_,e,n,i);var r=$e.fromObject(n);return ni(t,new Ve({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,e,a,l);qi(t.eventQueue_,c),t.server_.merge(e.toString(),n,function(n,r){var s="ok"===n;s||E("update at "+e+" failed: "+n);var o=$n(t.serverSyncTree_,l,!s),a=o.length>0?fr(t,e):e;Yi(t.eventQueue_,a,o),hr(0,i,n,r)}),O(n,function(n){var i=_r(t,xt(e,n));fr(t,i)}),Yi(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback(function(){})),n.promise}var Vr=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new Cr("value",this,new Rr(t.snapshotNode,new Lr(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Tr(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),Gr=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return this.eventType===("children_removed"===e?"child_removed":e)},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Tr(this,t,e):null},t.prototype.createEvent=function(t,e){(0,s.hu)(null!=t.childName,"Child events should have a childName.");var n=kr(new Lr(e._repo,e._path),t.childName),i=e._queryParams.getIndex();return new Cr(t.type,this,new Rr(t.snapshotNode,n,i),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function jr(t,e,n,i,r){var s;if("object"==typeof i&&(s=void 0,r=i),"function"==typeof i&&(s=i),r&&r.onlyOnce){var o=n,a=function(e,n){lr(t._repo,t,c),o(e,n)};a.userCallback=n.userCallback,a.context=n.context,n=a}var l=new Sr(n,s||void 0),c="value"===e?new Vr(l):new Gr(e,l);return function(t,e,n){var i;i=".info"===ft(e._path)?ti(t.infoSyncTree_,e,n):ti(t.serverSyncTree_,e,n),Zi(t.eventQueue_,e._path,i)}(t._repo,t,c),function(){return lr(t._repo,t,c)}}function Wr(t,e,n,i){return jr(t,"value",e,n,i)}function qr(t,e,n,i){return jr(t,"child_added",e,n,i)}function Zr(t,e,n,i){return jr(t,"child_changed",e,n,i)}function Yr(t,e,n,i){return jr(t,"child_moved",e,n,i)}function Xr(t,e,n,i){return jr(t,"child_removed",e,n,i)}function Jr(t,e,n){var i=null,r=n?new Sr(n):null;"value"===e?i=new Vr(r):e&&(i=new Gr(e,r)),lr(t._repo,t,i)}var $r=function(){return function(){}}(),Qr=function(t){function e(e,n){var i=t.call(this)||this;return i._value=e,i._key=n,i}return(0,o.ZT)(e,t),e.prototype._apply=function(t){ki("endAt",this._value,t._path,!0);var e=Te(t._queryParams,this._value,this._key);if(Pr(e),Dr(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Er(t._repo,t._path,e,t._orderByCalled)},e}($r);function Kr(t,e){return Hi("endAt","key",e,!0),new Qr(t,e)}var ts=function(t){function e(e,n){var i=t.call(this)||this;return i._value=e,i._key=n,i}return(0,o.ZT)(e,t),e.prototype._apply=function(t){ki("endBefore",this._value,t._path,!1);var e,n,i,r,s=(n=this._value,i=this._key,(e=t._queryParams).index_===zt?("string"==typeof n&&(n=fe(n)),r=Te(e,n,i)):r=Te(e,n,null==i?D:fe(i)),r.endBeforeSet_=!0,r);if(Pr(s),Dr(s),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Er(t._repo,t._path,s,t._orderByCalled)},e}($r);function es(t,e){return Hi("endBefore","key",e,!0),new ts(t,e)}var ns=function(t){function e(e,n){var i=t.call(this)||this;return i._value=e,i._key=n,i}return(0,o.ZT)(e,t),e.prototype._apply=function(t){ki("startAt",this._value,t._path,!0);var e=Ce(t._queryParams,this._value,this._key);if(Pr(e),Dr(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Er(t._repo,t._path,e,t._orderByCalled)},e}($r);function is(t,e){return void 0===t&&(t=null),Hi("startAt","key",e,!0),new ns(t,e)}var rs=function(t){function e(e,n){var i=t.call(this)||this;return i._value=e,i._key=n,i}return(0,o.ZT)(e,t),e.prototype._apply=function(t){ki("startAfter",this._value,t._path,!1);var e,n,i,r,s=(n=this._value,i=this._key,(e=t._queryParams).index_===zt?("string"==typeof n&&(n=pe(n)),r=Ce(e,n,i)):r=Ce(e,n,null==i?P:pe(i)),r.startAfterSet_=!0,r);if(Pr(s),Dr(s),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Er(t._repo,t._path,s,t._orderByCalled)},e}($r);function ss(t,e){return Hi("startAfter","key",e,!0),new rs(t,e)}var os=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,o.ZT)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Er(t._repo,t._path,(e=this._limit,(n=t._queryParams.copy()).limitSet_=!0,n.limit_=e,n.viewFrom_="l",n),t._orderByCalled);var e,n},e}($r);function as(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new os(t)}var ls=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,o.ZT)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Er(t._repo,t._path,(e=this._limit,(n=t._queryParams.copy()).limitSet_=!0,n.limit_=e,n.viewFrom_="r",n),t._orderByCalled);var e,n},e}($r);function cs(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new ls(t)}var us=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return(0,o.ZT)(e,t),e.prototype._apply=function(t){Ar(t,"orderByChild");var e=new dt(this._path);if(bt(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new ce(e),i=Se(t._queryParams,n);return Dr(i),new Er(t._repo,t._path,i,!0)},e}($r);function hs(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Bi("orderByChild","path",t,!1),new us(t)}var ds=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,o.ZT)(e,t),e.prototype._apply=function(t){Ar(t,"orderByKey");var e=Se(t._queryParams,zt);return Dr(e),new Er(t._repo,t._path,e,!0)},e}($r);function ps(){return new ds}var fs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,o.ZT)(e,t),e.prototype._apply=function(t){Ar(t,"orderByPriority");var e=Se(t._queryParams,Qt);return Dr(e),new Er(t._repo,t._path,e,!0)},e}($r);function ms(){return new fs}var gs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,o.ZT)(e,t),e.prototype._apply=function(t){Ar(t,"orderByValue");var e=Se(t._queryParams,ue);return Dr(e),new Er(t._repo,t._path,e,!0)},e}($r);function ys(){return new gs}var vs=function(t){function e(e,n){var i=t.call(this)||this;return i._value=e,i._key=n,i}return(0,o.ZT)(e,t),e.prototype._apply=function(t){if(ki("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Qr(this._value,this._key)._apply(new ns(this._value,this._key)._apply(t))},e}($r);function _s(t,e){return Hi("equalTo","key",e,!0),new vs(t,e)}function xs(t){for(var e,n,i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var a=(0,s.m9)(t);try{for(var l=(0,o.XA)(i),c=l.next();!c.done;c=l.next()){var u=c.value;a=u._apply(a)}}catch(h){e={error:h}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return a}!function(t){(0,s.hu)(!Ln,"__referenceConstructor has already been defined"),Ln=t}(Lr),function(t){(0,s.hu)(!Fn,"__referenceConstructor has already been defined"),Fn=t}(Lr);var bs={},ws=!1;function Cs(t,e,n,i,r){var s=i||t.options.databaseURL;void 0===s&&(t.options.projectId||M("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),C("Using default host for project ",t.options.projectId),s=t.options.projectId+"-default-rtdb.firebaseio.com");var o,a=br(s,r),l=a.repoInfo,c=void 0;"undefined"!=typeof process&&(c=process.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(o=!0,l=(a=br(s="http://"+c+"?ns="+l.namespace,r)).repoInfo):o=!a.repoInfo.secure;var u=r&&o?new j(j.OWNER):new G(t.name,t.options,e);Gi("Invalid Firebase Database URL",a),bt(a.path)||M("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(t,e,n,i){var r=bs[e.name];r||(bs[e.name]=r={});var s=r[t.toURLString()];return s&&M("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Qi(t,ws,n,i),r[t.toURLString()]=s,s}(l,t,u,new V(t.name,n));return new Ts(h,t)}var Ts=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(function(t,e,n){if(t.stats_=K(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Ae(t.repoInfo_,function(e,n,i,r){er(t,e,n,i,r)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(function(){return nr(t,!0)},0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,s.Pz)(n)}catch(o){throw new Error("Invalid authOverride provided: "+o)}}t.persistentConnection_=new It(t.repoInfo_,e,function(e,n,i,r){er(t,e,n,i,r)},function(e){nr(t,e)},function(e){!function(t,e){O(e,function(e,n){ir(t,e,n)})}(t,e)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}var i,r;t.authTokenProvider_.addTokenChangeListener(function(e){t.server_.refreshAuthToken(e)}),t.appCheckProvider_.addTokenChangeListener(function(e){t.server_.refreshAppCheckToken(e.token)}),t.statsReporter_=(i=function(){return new ke(t.stats_,t.server_)},r=t.repoInfo_.toString(),Q[r]||(Q[r]=i()),Q[r]),t.infoData_=new De,t.infoSyncTree_=new Xn({startListening:function(e,n,i,r){var s=[],o=t.infoData_.getNode(e._path);return o.isEmpty()||(s=Qn(t.infoSyncTree_,e._path,o),setTimeout(function(){r("ok")},0)),s},stopListening:function(){}}),ir(t,"connected",!1),t.serverSyncTree_=new Xn({startListening:function(e,n,i,r){return t.server_.listen(e,i,n,function(n,i){var s=r(n,i);Yi(t.eventQueue_,e._path,s)}),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Lr(this._repo,pt())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){var t,e,n;return this._checkNotDeleted("delete"),t=this._repo,(n=bs[e=this.app.name])&&n[t.key]===t||M("Database "+e+"("+t.repoInfo_+") has already been deleted."),cr(t),delete n[t.key],this._repoInternal=null,this._rootInternal=null,Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&M("Cannot call "+t+" on a deleted database.")},t}();function Ss(t){(t=(0,s.m9)(t))._checkNotDeleted("goOffline"),cr(t._repo)}function Ms(t){var e;(t=(0,s.m9)(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume($i)}var Es={".sv":"timestamp"},As=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function Ds(t,e,n){var i;if(t=(0,s.m9)(t),Vi("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var r=null===(i=null==n?void 0:n.applyLocally)||void 0===i||i,o=new s.BH,a=Wr(t,function(){});return function(e,n,i,r,a,l){ur(e,"transaction on "+n);var c={path:n,update:i,onComplete:function(e,n,i){var r=null;e?o.reject(e):(r=new Rr(i,new Lr(t._repo,t._path),Qt),o.resolve(new As(n,r)))},status:null,order:y(),applyLocally:l,retryCount:0,unwatcher:a,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=dr(e,n,void 0);c.currentInputSnapshot=u;var h=c.update(u.val());if(void 0===h)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Oi("transaction failed: Data returned ",h,c.path),c.status=0;var d=bi(e.transactionQueueTree_,n),p=wi(d)||[];p.push(c),Ci(d,p);var f=void 0;"object"==typeof h&&null!==h&&(0,s.r3)(h,".priority")?(f=(0,s.DV)(h,".priority"),(0,s.hu)(Ni(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(ei(e.serverSyncTree_,n)||re.EMPTY_NODE).getPriority().val();var m=tr(e),g=oe(h,f),v=vi(g,u,m);c.currentOutputSnapshotRaw=g,c.currentOutputSnapshotResolved=v,c.currentWriteId=rr(e);var _=Jn(e.serverSyncTree_,n,v,c.currentWriteId,c.applyLocally);Yi(e.eventQueue_,n,_),pr(e,e.transactionQueueTree_)}}(t._repo,t._path,e,0,a,r),o.promise}var Ps=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){(0,s.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,s.Wj)("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},t.prototype.remove=function(t){(0,s.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,s.Wj)("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},t.prototype.set=function(t,e){(0,s.Dv)("OnDisconnect.set",1,2,arguments.length),(0,s.Wj)("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then(function(){return e(null)},function(t){return e(t)}),n},t.prototype.setWithPriority=function(t,e,n){(0,s.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,s.Wj)("OnDisconnect.setWithPriority","onComplete",n,!0);var i=this._delegate.setWithPriority(t,e);return n&&i.then(function(){return n(null)},function(t){return n(t)}),i},t.prototype.update=function(t,e){if((0,s.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},i=0;i<t.length;++i)n[""+i]=t[i];t=n,E("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,s.Wj)("OnDisconnect.update","onComplete",e,!0);var r=this._delegate.update(t);return e&&r.then(function(){return e(null)},function(t){return e(t)}),r},t}(),Ls=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,s.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Rs=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return(0,s.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return(0,s.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return(0,s.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return(0,s.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return(0,s.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),Bi("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return(0,s.Dv)("DataSnapshot.hasChild",1,1,arguments.length),Bi("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return(0,s.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return(0,s.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,s.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(function(i){return e(new t(n._database,i))})},t.prototype.hasChildren=function(){return(0,s.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,s.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return(0,s.Dv)("DataSnapshot.ref",0,0,arguments.length),new Ns(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Is=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,i,r){var o,a=this;(0,s.Dv)("Query.on",2,4,arguments.length),(0,s.Wj)("Query.on","callback",n,!1);var l=t.getCancelAndContextArgs_("Query.on",i,r),c=function(t,e){n.call(l.context,new Rs(a.database,t),e)};c.userCallback=n,c.context=l.context;var u=null===(o=l.cancel)||void 0===o?void 0:o.bind(l.context);switch(e){case"value":return Wr(this._delegate,c,u),n;case"child_added":return qr(this._delegate,c,u),n;case"child_removed":return Xr(this._delegate,c,u),n;case"child_changed":return Zr(this._delegate,c,u),n;case"child_moved":return Yr(this._delegate,c,u),n;default:throw new Error((0,s.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if((0,s.Dv)("Query.off",0,3,arguments.length),Ui("Query.off",t,!0),(0,s.Wj)("Query.off","callback",e,!0),(0,s.lb)("Query.off","context",n,!0),e){var i=function(){};i.userCallback=e,i.context=n,Jr(this._delegate,t,i)}else Jr(this._delegate,t)},t.prototype.get=function(){var t=this;return function(t){return function(t,e){var n=function(t,e){var n=e._path,i=null;t.syncPointTree_.foreachOnPath(n,function(t,e){var r=wt(t,n);i=i||Gn(e,r)});var r=t.syncPointTree_.get(n);r?i=i||Gn(r,pt()):(r=new Un,t.syncPointTree_=t.syncPointTree_.set(n,r));var s=null!=i,o=s?new Ge(i,!0,!1):null;return Xe(Bn(r,e,un(t.pendingWriteTree_,e._path),s?o.getNode():re.EMPTY_NODE,s).viewCache_)}(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then(function(n){var i=oe(n).withIndex(e._queryParams.getIndex()),r=Qn(t.serverSyncTree_,e._path,i);return Zi(t.eventQueue_,e._path,r),Promise.resolve(i)},function(n){return ur(t,"get for query "+(0,s.Pz)(e)+" failed: "+n),Promise.reject(new Error(n))})}((t=(0,s.m9)(t))._repo,t).then(function(e){return new Rr(e,new Lr(t._repo,t._path),t._queryParams.getIndex())})}(this._delegate).then(function(e){return new Rs(t.database,e)})},t.prototype.once=function(e,n,i,r){var o=this;(0,s.Dv)("Query.once",1,4,arguments.length),(0,s.Wj)("Query.once","callback",n,!0);var a=t.getCancelAndContextArgs_("Query.once",i,r),l=new s.BH,c=function(t,e){var i=new Rs(o.database,t);n&&n.call(a.context,i,e),l.resolve(i)};c.userCallback=n,c.context=a.context;var u=function(t){a.cancel&&a.cancel.call(a.context,t),l.reject(t)};switch(e){case"value":Wr(this._delegate,c,u,{onlyOnce:!0});break;case"child_added":qr(this._delegate,c,u,{onlyOnce:!0});break;case"child_removed":Xr(this._delegate,c,u,{onlyOnce:!0});break;case"child_changed":Zr(this._delegate,c,u,{onlyOnce:!0});break;case"child_moved":Yr(this._delegate,c,u,{onlyOnce:!0});break;default:throw new Error((0,s.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise},t.prototype.limitToFirst=function(e){return(0,s.Dv)("Query.limitToFirst",1,1,arguments.length),new t(this.database,xs(this._delegate,as(e)))},t.prototype.limitToLast=function(e){return(0,s.Dv)("Query.limitToLast",1,1,arguments.length),new t(this.database,xs(this._delegate,cs(e)))},t.prototype.orderByChild=function(e){return(0,s.Dv)("Query.orderByChild",1,1,arguments.length),new t(this.database,xs(this._delegate,hs(e)))},t.prototype.orderByKey=function(){return(0,s.Dv)("Query.orderByKey",0,0,arguments.length),new t(this.database,xs(this._delegate,ps()))},t.prototype.orderByPriority=function(){return(0,s.Dv)("Query.orderByPriority",0,0,arguments.length),new t(this.database,xs(this._delegate,ms()))},t.prototype.orderByValue=function(){return(0,s.Dv)("Query.orderByValue",0,0,arguments.length),new t(this.database,xs(this._delegate,ys()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),(0,s.Dv)("Query.startAt",0,2,arguments.length),new t(this.database,xs(this._delegate,is(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),(0,s.Dv)("Query.startAfter",0,2,arguments.length),new t(this.database,xs(this._delegate,ss(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),(0,s.Dv)("Query.endAt",0,2,arguments.length),new t(this.database,xs(this._delegate,Kr(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),(0,s.Dv)("Query.endBefore",0,2,arguments.length),new t(this.database,xs(this._delegate,es(e,n)))},t.prototype.equalTo=function(e,n){return(0,s.Dv)("Query.equalTo",1,2,arguments.length),new t(this.database,xs(this._delegate,_s(e,n)))},t.prototype.toString=function(){return(0,s.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return(0,s.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if((0,s.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var i={cancel:void 0,context:void 0};if(e&&n)i.cancel=e,(0,s.Wj)(t,"cancel",i.cancel,!0),i.context=n,(0,s.lb)(t,"context",i.context,!0);else if(e)if("object"==typeof e&&null!==e)i.context=e;else{if("function"!=typeof e)throw new Error((0,s.gK)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=e}return i},Object.defineProperty(t.prototype,"ref",{get:function(){return new Ns(this.database,new Lr(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Ns=function(t){function e(e,n){var i=t.call(this,e,new Er(n._repo,n._path,new we,!1))||this;return i.database=e,i._delegate=n,i}return(0,o.ZT)(e,t),e.prototype.getKey=function(){return(0,s.Dv)("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return(0,s.Dv)("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new e(this.database,kr(this._delegate,t))},e.prototype.getParent=function(){(0,s.Dv)("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return(0,s.Dv)("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){(0,s.Dv)("Reference.set",1,2,arguments.length),(0,s.Wj)("Reference.set","onComplete",e,!0);var n=Fr(this._delegate,t);return e&&n.then(function(){return e(null)},function(t){return e(t)}),n},e.prototype.update=function(t,e){if((0,s.Dv)("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},i=0;i<t.length;++i)n[""+i]=t[i];t=n,E("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Vi("Reference.update",this._delegate._path),(0,s.Wj)("Reference.update","onComplete",e,!0);var r=Br(this._delegate,t);return e&&r.then(function(){return e(null)},function(t){return e(t)}),r},e.prototype.setWithPriority=function(t,e,n){(0,s.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,s.Wj)("Reference.setWithPriority","onComplete",n,!0);var i=Hr(this._delegate,t,e);return n&&i.then(function(){return n(null)},function(t){return n(t)}),i},e.prototype.remove=function(t){(0,s.Dv)("Reference.remove",0,1,arguments.length),(0,s.Wj)("Reference.remove","onComplete",t,!0);var e=zr(this._delegate);return t&&e.then(function(){return t(null)},function(e){return t(e)}),e},e.prototype.transaction=function(t,e,n){var i=this;(0,s.Dv)("Reference.transaction",1,3,arguments.length),(0,s.Wj)("Reference.transaction","transactionUpdate",t,!1),(0,s.Wj)("Reference.transaction","onComplete",e,!0),ji("Reference.transaction","applyLocally",n,!0);var r=Ds(this._delegate,t,{applyLocally:n}).then(function(t){return new Ls(t.committed,new Rs(i.database,t.snapshot))});return e&&r.then(function(t){return e(null,t.committed,t.snapshot)},function(t){return e(t,!1,null)}),r},e.prototype.setPriority=function(t,e){(0,s.Dv)("Reference.setPriority",1,2,arguments.length),(0,s.Wj)("Reference.setPriority","onComplete",e,!0);var n=Ur(this._delegate,t);return e&&n.then(function(){return e(null)},function(t){return e(t)}),n},e.prototype.push=function(t,n){var i=this;(0,s.Dv)("Reference.push",0,2,arguments.length),(0,s.Wj)("Reference.push","onComplete",n,!0);var r=Or(this._delegate,t),o=r.then(function(t){return new e(i.database,t)});n&&o.then(function(){return n(null)},function(t){return n(t)});var a=new e(this.database,r);return a.then=o.then.bind(o),a.catch=o.catch.bind(o,void 0),a},e.prototype.onDisconnect=function(){return Vi("Reference.onDisconnect",this._delegate._path),new Ps(new Mr(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Is),ks=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,i){void 0===i&&(i={}),(t=(0,s.m9)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&M("Cannot call useEmulator() after instance has already been initialized.");var r=t._repoInternal,o=void 0;if(r.repoInfo_.nodeAdmin)i.mockUserToken&&M('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new j(j.OWNER);else if(i.mockUserToken){var a=(0,s.Sg)(i.mockUserToken,t.app.options.projectId);o=new j(a)}!function(t,e,n,i){t.repoInfo_=new Y(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),i&&(t.authTokenProvider_=i)}(r,e,n,o)}(this._delegate,t,e,n)},t.prototype.ref=function(t){if((0,s.Dv)("database.ref",0,1,arguments.length),t instanceof Ns){var e=Nr(this._delegate,t.toString());return new Ns(this,e)}return e=Ir(this._delegate,t),new Ns(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";(0,s.Dv)(e,1,1,arguments.length);var n=Nr(this._delegate,t);return new Ns(this,n)},t.prototype.goOffline=function(){return(0,s.Dv)("database.goOffline",0,0,arguments.length),Ss(this._delegate)},t.prototype.goOnline=function(){return(0,s.Dv)("database.goOnline",0,0,arguments.length),Ms(this._delegate)},t.ServerValue={TIMESTAMP:Es,increment:function(t){return function(t){return{".sv":{increment:t}}}(t)}},t}(),Os=Object.freeze({__proto__:null,forceLongPolling:function(){ot.forceDisallow(),it.forceAllow()},forceWebSockets:function(){it.forceDisallow()},isWebSocketsAvailable:function(){return ot.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var n;e?(t.statsListener_||(t.statsListener_=new Ne(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var i=Object.keys(n).reduce(function(t,e){return Math.max(e.length,t)},0);O(n,function(t,e){for(var n=t,r=t.length;r<i+2;r++)n+=" ";console.log(n+e)})}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){!function(t,e){t.stats_.incrementCounter(e),t.statsReporter_.statsToReport_[e]=!0}(t._delegate._repo,e)},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t._delegate._repo,e)},initStandalone:function(t){var e=t.app,n=t.url,i=t.customAuthImpl,s=t.namespace,o=t.nodeAdmin,a=void 0!==o&&o;c(t.version);var l=new r.zt("auth-internal",new r.H0("database-standalone"));return l.setComponent(new r.wA("auth-internal",function(){return i},"PRIVATE")),{instance:new ks(Cs(e,l,void 0,n,a),e),namespace:s}}}),zs=It;It.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},It.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Fs=Object.freeze({__proto__:null,DataConnection:zs,RealTimeConnection:lt,hijackHash:function(t){var e=It.prototype.put;return It.prototype.put=function(n,i,r,s){void 0!==s&&(s=t()),e.call(this,n,i,r,s)},function(){It.prototype.put=e}},ConnectionTarget:Y,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){!function(t){ws=t}(t)}}),Us=ks.ServerValue;!function(e){c(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new r.wA("database",function(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new ks(Cs(i,r,s,n),i)},"PUBLIC").setServiceProps({Reference:Ns,Query:Is,Database:ks,DataSnapshot:Rs,enableLogging:w,INTERNAL:Os,ServerValue:Us,TEST_ACCESS:Fs}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.10.7"),(0,s.Yr)()&&(t.exports=n)}(i.Z)},308:(t,e,n)=>{"use strict";function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,r++)i[r]=s[o];return i}var r;n.d(e,{in:()=>o,Yd:()=>h,Ub:()=>d,Am:()=>p});var s=[],o=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}({}),a={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},l=o.INFO,c=((r={})[o.DEBUG]="log",r[o.VERBOSE]="log",r[o.INFO]="info",r[o.WARN]="warn",r[o.ERROR]="error",r),u=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var s=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,i(["["+s+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=l,this._logHandler=u,this._userLogHandler=null,s.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.DEBUG],t)),this._logHandler.apply(this,i([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.VERBOSE],t)),this._logHandler.apply(this,i([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.INFO],t)),this._logHandler.apply(this,i([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.WARN],t)),this._logHandler.apply(this,i([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,i([this,o.ERROR],t)),this._logHandler.apply(this,i([this,o.ERROR],t))},t}();function d(t){s.forEach(function(e){e.setLogLevel(t)})}function p(t,e){for(var n=function(n){var i=null;e&&e.level&&(i=a[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var r=[],s=2;s<arguments.length;s++)r[s-2]=arguments[s];var a=r.map(function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(e){return null}}).filter(function(t){return t}).join(" ");n>=(null!=i?i:e.logLevel)&&t({level:o[n].toLowerCase(),message:a,args:r,type:e.name})}},i=0,r=s;i<r.length;i++)n(r[i])}},250:(t,e,n)=>{"use strict";n.d(e,{BH:()=>d,LL:()=>x,gQ:()=>I,hu:()=>r,g5:()=>s,US:()=>a,h$:()=>l,r3:()=>A,Sg:()=>p,ne:()=>N,p$:()=>u,ZB:()=>h,gK:()=>F,m9:()=>G,GJ:()=>E,jU:()=>g,xb:()=>P,uI:()=>f,UG:()=>m,Yr:()=>v,b$:()=>y,w9:()=>M,cI:()=>C,UI:()=>L,xO:()=>R,DV:()=>D,ug:()=>V,dS:()=>B,Pz:()=>T,Dv:()=>z,Wj:()=>U,lb:()=>H});var i=n(4762),r=function(t,e){if(!t)throw s(e)},s=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},o=function(t){for(var e=[],n=0,i=0;i<t.length;i++){var r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296==(64512&r)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[],r=0;r<t.length;r+=3){var s=t[r],o=r+1<t.length,a=o?t[r+1]:0,l=r+2<t.length,c=l?t[r+2]:0,u=(15&a)<<2|c>>6,h=63&c;l||(h=64,o||(u=64)),i.push(n[s>>2],n[(3&s)<<4|a>>4],n[u],n[h])}return i.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(o(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,i=0;n<t.length;){var r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){var s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){var o=((7&r)<<18|(63&(s=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(o>>10)),e[i++]=String.fromCharCode(56320+(1023&o))}else{s=t[n++];var a=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[],r=0;r<t.length;){var s=n[t.charAt(r++)],o=r<t.length?n[t.charAt(r)]:0,a=++r<t.length?n[t.charAt(r)]:64,l=++r<t.length?n[t.charAt(r)]:64;if(++r,null==s||null==o||null==a||null==l)throw Error();i.push(s<<2|o>>4),64!==a&&(i.push(o<<4&240|a>>2),64!==l&&i.push(a<<6&192|l))}return i},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},l=function(t){var e=o(t);return a.encodeByteArray(e,!0)},c=function(t){try{return a.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function u(t){return h(void 0,t)}function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=h(t[n],e[n]));return t}var d=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,i){n?e.reject(n):e.resolve(i),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,i))}},t}();function p(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",r=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var o=(0,i.pi)({iss:"https://securetoken.google.com/"+n,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[a.encodeString(JSON.stringify({alg:"none",type:"JWT"}),!1),a.encodeString(JSON.stringify(o),!1),""].join(".")}function f(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}function m(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}function g(){return"object"==typeof self&&self.self===self}function y(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function v(){return!1}var _=function(t){function e(n,i,r){var s=t.call(this,i)||this;return s.code=n,s.customData=r,s.name="FirebaseError",Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,x.prototype.create),s}return(0,i.ZT)(e,t),e}(Error),x=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=e[0]||{},r=this.service+"/"+t,s=this.errors[t],o=s?b(s,i):"Error",a=this.serviceName+": "+o+" ("+r+").",l=new _(r,a,i);return l},t}();function b(t,e){return t.replace(w,function(t,n){var i=e[n];return null!=i?String(i):"<"+n+"?>"})}var w=/\{\$([^}]+)}/g;function C(t){return JSON.parse(t)}function T(t){return JSON.stringify(t)}var S=function(t){var e={},n={},i={},r="";try{var s=t.split(".");e=C(c(s[0])||""),n=C(c(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch(o){}return{header:e,claims:n,data:i,signature:r}},M=function(t){var e=S(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},E=function(t){var e=S(t).claims;return"object"==typeof e&&!0===e.admin};function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function D(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function P(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function L(t,e,n){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function R(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},i=0,r=Object.entries(t);i<r.length;i++){var s=r[i];n(s[0],s[1])}return e.length?"&"+e.join("&"):""}var I=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var i=0;i<16;i++)n[i]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(i=0;i<16;i++)n[i]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(i=16;i<80;i++)n[i]=4294967295&((h=n[i-3]^n[i-8]^n[i-14]^n[i-16])<<1|h>>>31);var r,s,o=this.chain_[0],a=this.chain_[1],l=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(i=0;i<80;i++){i<40?i<20?(r=c^a&(l^c),s=1518500249):(r=a^l^c,s=1859775393):i<60?(r=a&l|c&(a|l),s=2400959708):(r=a^l^c,s=3395469782);var h=(o<<5|o>>>27)+r+u+s+n[i]&4294967295;u=c,c=l,l=4294967295&(a<<30|a>>>2),a=o,o=h}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+a&4294967295,this.chain_[2]=this.chain_[2]+l&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,i=0,r=this.buf_,s=this.inbuf_;i<e;){if(0===s)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if("string"==typeof t){for(;i<e;)if(r[s]=t.charCodeAt(i),++i,++s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<e;)if(r[s]=t[i],++i,++s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var i=0;for(n=0;n<5;n++)for(var r=24;r>=0;r-=8)t[i]=this.chain_[n]>>r&255,++i;return t},t}();function N(t,e){var n=new k(t,e);return n.subscribe.bind(n)}var k=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var i,r=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(i=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,i=["next","error","complete"];n<i.length;n++){var r=i[n];if(r in t&&"function"==typeof t[r])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(i.next=O),void 0===i.error&&(i.error=O),void 0===i.complete&&(i.complete=O);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{r.finalError?i.error(r.finalError):i.complete()}catch(t){}}),this.observers.push(i),s},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(i){"undefined"!=typeof console&&console.error&&console.error(i)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();function O(){}var z=function(t,e,n,i){var r;if(i<e?r="at least "+e:i>n&&(r=0===n?"none":"no more than "+n),r)throw new Error(t+" failed: Was called with "+i+(1===i?" argument.":" arguments.")+" Expects "+r+".")};function F(t,e){return t+" failed: "+e+" argument "}function U(t,e,n,i){if((!i||n)&&"function"!=typeof n)throw new Error(F(t,e)+"must be a valid function.")}function H(t,e,n,i){if((!i||n)&&("object"!=typeof n||null===n))throw new Error(F(t,e)+"must be a valid context object.")}var B=function(t){for(var e=[],n=0,i=0;i<t.length;i++){var s=t.charCodeAt(i);if(s>=55296&&s<=56319){var o=s-55296;i++,r(i<t.length,"Surrogate pair missing trail surrogate."),s=65536+(o<<10)+(t.charCodeAt(i)-56320)}s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):s<65536?(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},V=function(t){for(var e=0,n=0;n<t.length;n++){var i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};function G(t){return t&&t._delegate?t._delegate:t}},1858:(t,e,n)=>{"use strict";n.d(e,{Z:()=>i.Z});var i=n(1062),r="8.7.1";i.Z.registerVersion("firebase",r,"app"),i.Z.SDK_VERSION=r},8318:(t,e,n)=>{"use strict";n.d(e,{y:()=>c});var i=n(6673),r=n(5331),s=n(7498),o=n(6197),a=n(3392),l=n(1484);let c=(()=>{class t{constructor(t){this._isScalar=!1,t&&(this._subscribe=t)}lift(e){const n=new t;return n.source=this,n.operator=e,n}subscribe(t,e,n){const{operator:o}=this,a=function(t,e,n){if(t){if(t instanceof i.L)return t;if(t[r.b])return t[r.b]()}return t||e||n?new i.L(t,e,n):new i.L(s.c)}(t,e,n);if(a.add(o?o.call(a,this.source):this.source||l.v.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),l.v.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}_trySubscribe(t){try{return this._subscribe(t)}catch(e){l.v.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){const{closed:e,destination:n,isStopped:r}=t;if(e||r)return!1;t=n&&n instanceof i.L?n:null}return!0}(t)?t.error(e):console.warn(e)}}forEach(t,e){return new(e=u(e))((e,n)=>{let i;i=this.subscribe(e=>{try{t(e)}catch(r){n(r),i&&i.unsubscribe()}},n,e)})}_subscribe(t){const{source:e}=this;return e&&e.subscribe(t)}[o.L](){return this}pipe(...t){return 0===t.length?this:(0===(e=t).length?a.y:1===e.length?e[0]:function(t){return e.reduce((t,e)=>e(t),t)})(this);var e}toPromise(t){return new(t=u(t))((t,e)=>{let n;this.subscribe(t=>n=t,t=>e(t),()=>t(n))})}}return t.create=e=>new t(e),t})();function u(t){if(t||(t=l.v.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},7498:(t,e,n)=>{"use strict";n.d(e,{c:()=>s});var i=n(1484),r=n(4294);const s={closed:!0,next(t){},error(t){if(i.v.useDeprecatedSynchronousErrorHandling)throw t;(0,r.z)(t)},complete(){}}},5959:(t,e,n)=>{"use strict";n.d(e,{Yc:()=>c,xQ:()=>u});var i=n(8318),r=n(6673),s=n(7570),o=n(3895),a=n(9291),l=n(5331);class c extends r.L{constructor(t){super(t),this.destination=t}}let u=(()=>{class t extends i.y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[l.b](){return new c(this)}lift(t){const e=new h(this,this);return e.operator=t,e}next(t){if(this.closed)throw new o.N;if(!this.isStopped){const{observers:e}=this,n=e.length,i=e.slice();for(let r=0;r<n;r++)i[r].next(t)}}error(t){if(this.closed)throw new o.N;this.hasError=!0,this.thrownError=t,this.isStopped=!0;const{observers:e}=this,n=e.length,i=e.slice();for(let r=0;r<n;r++)i[r].error(t);this.observers.length=0}complete(){if(this.closed)throw new o.N;this.isStopped=!0;const{observers:t}=this,e=t.length,n=t.slice();for(let i=0;i<e;i++)n[i].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(t){if(this.closed)throw new o.N;return super._trySubscribe(t)}_subscribe(t){if(this.closed)throw new o.N;return this.hasError?(t.error(this.thrownError),s.w.EMPTY):this.isStopped?(t.complete(),s.w.EMPTY):(this.observers.push(t),new a.W(this,t))}asObservable(){const t=new i.y;return t.source=this,t}}return t.create=(t,e)=>new h(t,e),t})();class h extends u{constructor(t,e){super(),this.destination=t,this.source=e}next(t){const{destination:e}=this;e&&e.next&&e.next(t)}error(t){const{destination:e}=this;e&&e.error&&this.destination.error(t)}complete(){const{destination:t}=this;t&&t.complete&&this.destination.complete()}_subscribe(t){const{source:e}=this;return e?this.source.subscribe(t):s.w.EMPTY}}},9291:(t,e,n)=>{"use strict";n.d(e,{W:()=>r});var i=n(7570);class r extends i.w{constructor(t,e){super(),this.subject=t,this.subscriber=e,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const t=this.subject,e=t.observers;if(this.subject=null,!e||0===e.length||t.isStopped||t.closed)return;const n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},6673:(t,e,n)=>{"use strict";n.d(e,{L:()=>c});var i=n(5024),r=n(7498),s=n(7570),o=n(5331),a=n(1484),l=n(4294);class c extends s.w{constructor(t,e,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=r.c;break;case 1:if(!t){this.destination=r.c;break}if("object"==typeof t){t instanceof c?(this.syncErrorThrowable=t.syncErrorThrowable,this.destination=t,t.add(this)):(this.syncErrorThrowable=!0,this.destination=new u(this,t));break}default:this.syncErrorThrowable=!0,this.destination=new u(this,t,e,n)}}[o.b](){return this}static create(t,e,n){const i=new c(t,e,n);return i.syncErrorThrowable=!1,i}next(t){this.isStopped||this._next(t)}error(t){this.isStopped||(this.isStopped=!0,this._error(t))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(t){this.destination.next(t)}_error(t){this.destination.error(t),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:t}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this}}class u extends c{constructor(t,e,n,s){let o;super(),this._parentSubscriber=t;let a=this;(0,i.m)(e)?o=e:e&&(o=e.next,n=e.error,s=e.complete,e!==r.c&&(a=Object.create(e),(0,i.m)(a.unsubscribe)&&this.add(a.unsubscribe.bind(a)),a.unsubscribe=this.unsubscribe.bind(this))),this._context=a,this._next=o,this._error=n,this._complete=s}next(t){if(!this.isStopped&&this._next){const{_parentSubscriber:e}=this;a.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}}error(t){if(!this.isStopped){const{_parentSubscriber:e}=this,{useDeprecatedSynchronousErrorHandling:n}=a.v;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):(0,l.z)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;(0,l.z)(t)}}}complete(){if(!this.isStopped){const{_parentSubscriber:t}=this;if(this._complete){const e=()=>this._complete.call(this._context);a.v.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,e),this.unsubscribe()):(this.__tryOrUnsub(e),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(t,e){try{t.call(this._context,e)}catch(n){if(this.unsubscribe(),a.v.useDeprecatedSynchronousErrorHandling)throw n;(0,l.z)(n)}}__tryOrSetError(t,e,n){if(!a.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(i){return a.v.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=i,t.syncErrorThrown=!0,!0):((0,l.z)(i),!0)}return!1}_unsubscribe(){const{_parentSubscriber:t}=this;this._context=null,this._parentSubscriber=null,t.unsubscribe()}}},7570:(t,e,n)=>{"use strict";n.d(e,{w:()=>a});var i=n(8470),r=n(2056),s=n(5024);const o=(()=>{function t(t){return Error.call(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((t,e)=>`${e+1}) ${t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t})();let a=(()=>{class t{constructor(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}unsubscribe(){let e;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:a,_unsubscribe:c,_subscriptions:u}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(let t=0;t<n.length;++t)n[t].remove(this);if((0,s.m)(c)){a&&(this._unsubscribe=void 0);try{c.call(this)}catch(h){e=h instanceof o?l(h.errors):[h]}}if((0,i.k)(u)){let t=-1,n=u.length;for(;++t<n;){const n=u[t];if((0,r.K)(n))try{n.unsubscribe()}catch(h){e=e||[],h instanceof o?e=e.concat(l(h.errors)):e.push(h)}}}if(e)throw new o(e)}add(e){let n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){const e=n;n=new t,n._subscriptions=[e]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}let{_parentOrParents:i}=n;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n}remove(t){const e=this._subscriptions;if(e){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}}}var e;return t.EMPTY=((e=new t).closed=!0,e),t})();function l(t){return t.reduce((t,e)=>t.concat(e instanceof o?e.errors:e),[])}},1484:(t,e,n)=>{"use strict";n.d(e,{v:()=>r});let i=!1;const r={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){if(t){const t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else i&&console.log("RxJS: Back to a better error behavior. Thank you. <3");i=t},get useDeprecatedSynchronousErrorHandling(){return i}}},6882:(t,e,n)=>{"use strict";n.d(e,{IY:()=>o,Ds:()=>a,ft:()=>l});var i=n(6673),r=n(8318),s=n(6015);class o extends i.L{constructor(t){super(),this.parent=t}_next(t){this.parent.notifyNext(t)}_error(t){this.parent.notifyError(t),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class a extends i.L{notifyNext(t){this.destination.next(t)}notifyError(t){this.destination.error(t)}notifyComplete(){this.destination.complete()}}function l(t,e){if(e.closed)return;if(t instanceof r.y)return t.subscribe(e);let n;try{n=(0,s.s)(t)(e)}catch(i){e.error(i)}return n}},2875:(t,e,n)=>{"use strict";n.d(e,{c:()=>a,N:()=>l});var i=n(5959),r=n(8318),s=n(7570),o=n(1564);class a extends r.y{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let t=this._connection;return t||(this._isComplete=!1,t=this._connection=new s.w,t.add(this.source.subscribe(new c(this.getSubject(),this))),t.closed&&(this._connection=null,t=s.w.EMPTY)),t}refCount(){return(0,o.x)()(this)}}const l=(()=>{const t=a.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}})();class c extends i.Yc{constructor(t,e){super(t),this.connectable=e}_error(t){this._unsubscribe(),super._error(t)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const t=this.connectable;if(t){this.connectable=null;const e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}}}},653:(t,e,n)=>{"use strict";n.d(e,{E:()=>r,c:()=>s});var i=n(8318);const r=new i.y(t=>t.complete());function s(t){return t?function(t){return new i.y(e=>t.schedule(()=>e.complete()))}(t):r}},9764:(t,e,n)=>{"use strict";n.d(e,{D:()=>h});var i=n(8318),r=n(6015),s=n(7570),o=n(6197),a=n(2570),l=n(5686),c=n(5168),u=n(9653);function h(t,e){return e?function(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[o.L]}(t))return function(t,e){return new i.y(n=>{const i=new s.w;return i.add(e.schedule(()=>{const r=t[o.L]();i.add(r.subscribe({next(t){i.add(e.schedule(()=>n.next(t)))},error(t){i.add(e.schedule(()=>n.error(t)))},complete(){i.add(e.schedule(()=>n.complete()))}}))})),i})}(t,e);if((0,c.t)(t))return function(t,e){return new i.y(n=>{const i=new s.w;return i.add(e.schedule(()=>t.then(t=>{i.add(e.schedule(()=>{n.next(t),i.add(e.schedule(()=>n.complete()))}))},t=>{i.add(e.schedule(()=>n.error(t)))}))),i})}(t,e);if((0,u.z)(t))return(0,a.r)(t,e);if(function(t){return t&&"function"==typeof t[l.hZ]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new i.y(n=>{const i=new s.w;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(e.schedule(()=>{r=t[l.hZ](),i.add(e.schedule(function(){if(n.closed)return;let t,e;try{const n=r.next();t=n.value,e=n.done}catch(i){return void n.error(i)}e?n.complete():(n.next(t),this.schedule())}))})),i})}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}(t,e):t instanceof i.y?t:new i.y((0,r.s)(t))}},9342:(t,e,n)=>{"use strict";n.d(e,{n:()=>o});var i=n(8318),r=n(625),s=n(2570);function o(t,e){return e?(0,s.r)(t,e):new i.y((0,r.V)(t))}},1906:(t,e,n)=>{"use strict";n.d(e,{T:()=>a});var i=n(8318),r=n(6163),s=n(7471),o=n(9342);function a(...t){let e=Number.POSITIVE_INFINITY,n=null,a=t[t.length-1];return(0,r.K)(a)?(n=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(e=t.pop())):"number"==typeof a&&(e=t.pop()),null===n&&1===t.length&&t[0]instanceof i.y?t[0]:(0,s.J)(e)((0,o.n)(t,n))}},878:(t,e,n)=>{"use strict";n.d(e,{of:()=>o});var i=n(6163),r=n(9342),s=n(2570);function o(...t){let e=t[t.length-1];return(0,i.K)(e)?(t.pop(),(0,s.r)(t,e)):(0,r.n)(t)}},9996:(t,e,n)=>{"use strict";n.d(e,{U:()=>r});var i=n(6673);function r(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new s(t,e))}}class s{constructor(t,e){this.project=t,this.thisArg=e}call(t,e){return e.subscribe(new o(t,this.project,this.thisArg))}}class o extends i.L{constructor(t,e,n){super(t),this.project=e,this.count=0,this.thisArg=n||this}_next(t){let e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}},7471:(t,e,n)=>{"use strict";n.d(e,{J:()=>s});var i=n(3982),r=n(3392);function s(t=Number.POSITIVE_INFINITY){return(0,i.zg)(r.y,t)}},3982:(t,e,n)=>{"use strict";n.d(e,{zg:()=>o});var i=n(9996),r=n(9764),s=n(6882);function o(t,e,n=Number.POSITIVE_INFINITY){return"function"==typeof e?s=>s.pipe(o((n,s)=>(0,r.D)(t(n,s)).pipe((0,i.U)((t,i)=>e(n,t,s,i))),n)):("number"==typeof e&&(n=e),e=>e.lift(new a(t,n)))}class a{constructor(t,e=Number.POSITIVE_INFINITY){this.project=t,this.concurrent=e}call(t,e){return e.subscribe(new l(t,this.project,this.concurrent))}}class l extends s.Ds{constructor(t,e,n=Number.POSITIVE_INFINITY){super(t),this.project=e,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)}_tryNext(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(e)}_innerSub(t){const e=new s.IY(this),n=this.destination;n.add(e);const i=(0,s.ft)(t,e);i!==e&&n.add(i)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(t){this.destination.next(t)}notifyComplete(){const t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}},9098:(t,e,n)=>{"use strict";n.d(e,{ht:()=>u,QV:()=>l});var i=n(6673),r=n(653),s=n(878),o=n(8318);let a=(()=>{class t{constructor(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}observe(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}}do(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}}accept(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)}toObservable(){switch(this.kind){case"N":return(0,s.of)(this.value);case"E":return t=this.error,new o.y(e=>e.error(t));case"C":return(0,r.c)()}var t;throw new Error("unexpected notification kind value")}static createNext(e){return void 0!==e?new t("N",e):t.undefinedValueNotification}static createError(e){return new t("E",void 0,e)}static createComplete(){return t.completeNotification}}return t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t})();function l(t,e=0){return function(n){return n.lift(new c(t,e))}}class c{constructor(t,e=0){this.scheduler=t,this.delay=e}call(t,e){return e.subscribe(new u(t,this.scheduler,this.delay))}}class u extends i.L{constructor(t,e,n=0){super(t),this.scheduler=e,this.delay=n}static dispatch(t){const{notification:e,destination:n}=t;e.observe(n),this.unsubscribe()}scheduleMessage(t){this.destination.add(this.scheduler.schedule(u.dispatch,this.delay,new h(t,this.destination)))}_next(t){this.scheduleMessage(a.createNext(t))}_error(t){this.scheduleMessage(a.createError(t)),this.unsubscribe()}_complete(){this.scheduleMessage(a.createComplete()),this.unsubscribe()}}class h{constructor(t,e){this.notification=t,this.destination=e}}},1564:(t,e,n)=>{"use strict";n.d(e,{x:()=>r});var i=n(6673);function r(){return function(t){return t.lift(new s(t))}}class s{constructor(t){this.connectable=t}call(t,e){const{connectable:n}=this;n._refCount++;const i=new o(t,n),r=e.subscribe(i);return i.closed||(i.connection=n.connect()),r}}class o extends i.L{constructor(t,e){super(t),this.connectable=e}_unsubscribe(){const{connectable:t}=this;if(!t)return void(this.connection=null);this.connectable=null;const e=t._refCount;if(e<=0)return void(this.connection=null);if(t._refCount=e-1,e>1)return void(this.connection=null);const{connection:n}=this,i=t._connection;this.connection=null,!i||n&&i!==n||i.unsubscribe()}}},1055:(t,e,n)=>{"use strict";n.d(e,{B:()=>a});var i=n(2875),r=n(1564),s=n(5959);function o(){return new s.xQ}function a(){return t=>{return(0,r.x)()((e=o,function(t){let n;n="function"==typeof e?e:function(){return e};const r=Object.create(t,i.N);return r.source=t,r.subjectFactory=n,r})(t));var e}}},4187:(t,e,n)=>{"use strict";n.d(e,{R:()=>g});var i=n(8318);let r=1;const s=(()=>Promise.resolve())(),o={};function a(t){return t in o&&(delete o[t],!0)}const l={setImmediate(t){const e=r++;return o[e]=!0,s.then(()=>a(e)&&t()),e},clearImmediate(t){a(t)}};var c=n(8277);class u extends c.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}requestAsyncId(t,e,n=0){return null!==n&&n>0?super.requestAsyncId(t,e,n):(t.actions.push(this),t.scheduled||(t.scheduled=l.setImmediate(t.flush.bind(t,null))))}recycleAsyncId(t,e,n=0){if(null!==n&&n>0||null===n&&this.delay>0)return super.recycleAsyncId(t,e,n);0===t.actions.length&&(l.clearImmediate(e),t.scheduled=void 0)}}var h=n(1098);class d extends h.v{flush(t){this.active=!0,this.scheduled=void 0;const{actions:e}=this;let n,i=-1,r=e.length;t=t||e.shift();do{if(n=t.execute(t.state,t.delay))break}while(++i<r&&(t=e.shift()));if(this.active=!1,n){for(;++i<r&&(t=e.shift());)t.unsubscribe();throw n}}}const p=new d(u);var f=n(8470);class m extends i.y{constructor(t,e=0,n=p){var i;super(),this.source=t,this.delayTime=e,this.scheduler=n,((0,f.k)(i=e)||!(i-parseFloat(i)+1>=0)||e<0)&&(this.delayTime=0),n&&"function"==typeof n.schedule||(this.scheduler=p)}static create(t,e=0,n=p){return new m(t,e,n)}static dispatch(t){const{source:e,subscriber:n}=t;return this.add(e.subscribe(n))}_subscribe(t){return this.scheduler.schedule(m.dispatch,this.delayTime,{source:this.source,subscriber:t})}}function g(t,e=0){return function(n){return n.lift(new y(t,e))}}class y{constructor(t,e){this.scheduler=t,this.delay=e}call(t,e){return new m(e,this.delay,this.scheduler).subscribe(t)}}},6599:(t,e,n)=>{"use strict";n.d(e,{b:()=>o});var i=n(6673);function r(){}var s=n(5024);function o(t,e,n){return function(i){return i.lift(new a(t,e,n))}}class a{constructor(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}call(t,e){return e.subscribe(new l(t,this.nextOrObserver,this.error,this.complete))}}class l extends i.L{constructor(t,e,n,i){super(t),this._tapNext=r,this._tapError=r,this._tapComplete=r,this._tapError=n||r,this._tapComplete=i||r,(0,s.m)(e)?(this._context=this,this._tapNext=e):e&&(this._context=e,this._tapNext=e.next||r,this._tapError=e.error||r,this._tapComplete=e.complete||r)}_next(t){try{this._tapNext.call(this._context,t)}catch(e){return void this.destination.error(e)}this.destination.next(t)}_error(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)}_complete(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()}}},2570:(t,e,n)=>{"use strict";n.d(e,{r:()=>s});var i=n(8318),r=n(7570);function s(t,e){return new i.y(n=>{const i=new r.w;let s=0;return i.add(e.schedule(function(){s!==t.length?(n.next(t[s++]),n.closed||i.add(this.schedule())):n.complete()})),i})}},8277:(t,e,n)=>{"use strict";n.d(e,{o:()=>s});var i=n(7570);class r extends i.w{constructor(t,e){super()}schedule(t,e=0){return this}}class s extends r{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){if(this.closed)return this;this.state=t;const n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this}requestAsyncId(t,e,n=0){return setInterval(t.flush.bind(t,this),n)}recycleAsyncId(t,e,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let n,i=!1;try{this.work(t)}catch(r){i=!0,n=!!r&&r||new Error(r)}if(i)return this.unsubscribe(),n}_unsubscribe(){const t=this.id,e=this.scheduler,n=e.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}},1098:(t,e,n)=>{"use strict";n.d(e,{v:()=>r});let i=(()=>{class t{constructor(e,n=t.now){this.SchedulerAction=e,this.now=n}schedule(t,e=0,n){return new this.SchedulerAction(this,t).schedule(n,e)}}return t.now=()=>Date.now(),t})();class r extends i{constructor(t,e=i.now){super(t,()=>r.delegate&&r.delegate!==this?r.delegate.now():e()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(t,e=0,n){return r.delegate&&r.delegate!==this?r.delegate.schedule(t,e,n):super.schedule(t,e,n)}flush(t){const{actions:e}=this;if(this.active)return void e.push(t);let n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}}},8569:(t,e,n)=>{"use strict";n.d(e,{z:()=>r});var i=n(8277);const r=new(n(1098).v)(i.o)},8489:(t,e,n)=>{"use strict";n.d(e,{c:()=>l,N:()=>a});var i=n(8277);class r extends i.o{constructor(t,e){super(t,e),this.scheduler=t,this.work=e}schedule(t,e=0){return e>0?super.schedule(t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)}execute(t,e){return e>0||this.closed?super.execute(t,e):this._execute(t,e)}requestAsyncId(t,e,n=0){return null!==n&&n>0||null===n&&this.delay>0?super.requestAsyncId(t,e,n):t.flush(this)}}var s=n(1098);class o extends s.v{}const a=new o(r),l=a},5686:(t,e,n)=>{"use strict";function i(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(e,{hZ:()=>r});const r=i()},6197:(t,e,n)=>{"use strict";n.d(e,{L:()=>i});const i=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")()},5331:(t,e,n)=>{"use strict";n.d(e,{b:()=>i});const i=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())()},3895:(t,e,n)=>{"use strict";n.d(e,{N:()=>i});const i=(()=>{function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t})()},4294:(t,e,n)=>{"use strict";function i(t){setTimeout(()=>{throw t},0)}n.d(e,{z:()=>i})},3392:(t,e,n)=>{"use strict";function i(t){return t}n.d(e,{y:()=>i})},8470:(t,e,n)=>{"use strict";n.d(e,{k:()=>i});const i=(()=>Array.isArray||(t=>t&&"number"==typeof t.length))()},9653:(t,e,n)=>{"use strict";n.d(e,{z:()=>i});const i=t=>t&&"number"==typeof t.length&&"function"!=typeof t},5024:(t,e,n)=>{"use strict";function i(t){return"function"==typeof t}n.d(e,{m:()=>i})},2056:(t,e,n)=>{"use strict";function i(t){return null!==t&&"object"==typeof t}n.d(e,{K:()=>i})},5168:(t,e,n)=>{"use strict";function i(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}n.d(e,{t:()=>i})},6163:(t,e,n)=>{"use strict";function i(t){return t&&"function"==typeof t.schedule}n.d(e,{K:()=>i})},6015:(t,e,n)=>{"use strict";n.d(e,{s:()=>u});var i=n(625),r=n(4294),s=n(5686),o=n(6197),a=n(9653),l=n(5168),c=n(2056);const u=t=>{if(t&&"function"==typeof t[o.L])return u=t,t=>{const e=u[o.L]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if((0,a.z)(t))return(0,i.V)(t);if((0,l.t)(t))return n=t,t=>(n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,r.z),t);if(t&&"function"==typeof t[s.hZ])return e=t,t=>{const n=e[s.hZ]();for(;;){let e;try{e=n.next()}catch(i){return t.error(i),t}if(e.done){t.complete();break}if(t.next(e.value),t.closed)break}return"function"==typeof n.return&&t.add(()=>{n.return&&n.return()}),t};{const e=(0,c.K)(t)?"an invalid object":`'${t}'`;throw new TypeError(`You provided ${e} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var e,n,u}},625:(t,e,n)=>{"use strict";n.d(e,{V:()=>i});const i=t=>e=>{for(let n=0,i=t.length;n<i&&!e.closed;n++)e.next(t[n]);e.complete()}},4395:(t,e,n)=>{"use strict";var i=n(5366);let r=null;function s(){return r}const o=new i.OlP("DocumentToken");let a=(()=>{class t{historyGo(t){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,i.Yz7)({factory:l,token:t,providedIn:"platform"}),t})();function l(){return(0,i.LFG)(u)}const c=new i.OlP("Location Initialized");let u=(()=>{class t extends a{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return s().getBaseHref(this._doc)}onPopState(t){const e=s().getGlobalEventTarget(this._doc,"window");return e.addEventListener("popstate",t,!1),()=>e.removeEventListener("popstate",t)}onHashChange(t){const e=s().getGlobalEventTarget(this._doc,"window");return e.addEventListener("hashchange",t,!1),()=>e.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,e,n){h()?this._history.pushState(t,e,n):this.location.hash=n}replaceState(t,e,n){h()?this._history.replaceState(t,e,n):this.location.hash=n}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o))},t.\u0275prov=(0,i.Yz7)({factory:d,token:t,providedIn:"platform"}),t})();function h(){return!!window.history.pushState}function d(){return new u((0,i.LFG)(o))}function p(t,e){if(0==t.length)return e;if(0==e.length)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,2==n?t+e.substring(1):1==n?t+e:t+"/"+e}function f(t){const e=t.match(/#|\?|$/),n=e&&e.index||t.length;return t.slice(0,n-("/"===t[n-1]?1:0))+t.slice(n)}function m(t){return t&&"?"!==t[0]?"?"+t:t}let g=(()=>{class t{historyGo(t){throw new Error("Not implemented")}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=(0,i.Yz7)({factory:y,token:t,providedIn:"root"}),t})();function y(t){const e=(0,i.LFG)(o).location;return new _((0,i.LFG)(a),e&&e.origin||"")}const v=new i.OlP("appBaseHref");let _=(()=>{class t extends g{constructor(t,e){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==e&&(e=this._platformLocation.getBaseHrefFromDOM()),null==e)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=e}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return p(this._baseHref,t)}path(t=!1){const e=this._platformLocation.pathname+m(this._platformLocation.search),n=this._platformLocation.hash;return n&&t?`${e}${n}`:e}pushState(t,e,n,i){const r=this.prepareExternalUrl(n+m(i));this._platformLocation.pushState(t,e,r)}replaceState(t,e,n,i){const r=this.prepareExternalUrl(n+m(i));this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformLocation).historyGo)||void 0===n||n.call(e,t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(a),i.LFG(v,8))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),x=(()=>{class t extends g{constructor(t,e){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=e&&(this._baseHref=e)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}prepareExternalUrl(t){const e=p(this._baseHref,t);return e.length>0?"#"+e:e}pushState(t,e,n,i){let r=this.prepareExternalUrl(n+m(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.pushState(t,e,r)}replaceState(t,e,n,i){let r=this.prepareExternalUrl(n+m(i));0==r.length&&(r=this._platformLocation.pathname),this._platformLocation.replaceState(t,e,r)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformLocation).historyGo)||void 0===n||n.call(e,t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(a),i.LFG(v,8))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),b=(()=>{class t{constructor(t,e){this._subject=new i.vpe,this._urlChangeListeners=[],this._platformStrategy=t;const n=this._platformStrategy.getBaseHref();this._platformLocation=e,this._baseHref=f(C(n)),this._platformStrategy.onPopState(t=>{this._subject.emit({url:this.path(!0),pop:!0,state:t.state,type:t.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,e=""){return this.path()==this.normalize(t+m(e))}normalize(e){return t.stripTrailingSlash(function(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,C(e)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,e="",n=null){this._platformStrategy.pushState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+m(e)),n)}replaceState(t,e="",n=null){this._platformStrategy.replaceState(n,"",t,e),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+m(e)),n)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var e,n;null===(n=(e=this._platformStrategy).historyGo)||void 0===n||n.call(e,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(t=>{this._notifyUrlChangeListeners(t.url,t.state)}))}_notifyUrlChangeListeners(t="",e){this._urlChangeListeners.forEach(n=>n(t,e))}subscribe(t,e,n){return this._subject.subscribe({next:t,error:e,complete:n})}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(g),i.LFG(a))},t.normalizeQueryParams=m,t.joinWithSlash=p,t.stripTrailingSlash=f,t.\u0275prov=(0,i.Yz7)({factory:w,token:t,providedIn:"root"}),t})();function w(){return new b((0,i.LFG)(g),(0,i.LFG)(a))}function C(t){return t.replace(/\/index.html$/,"")}var T=function(t){return t[t.Decimal=0]="Decimal",t[t.Percent=1]="Percent",t[t.Currency=2]="Currency",t[t.Scientific=3]="Scientific",t}({}),S=function(t){return t[t.Zero=0]="Zero",t[t.One=1]="One",t[t.Two=2]="Two",t[t.Few=3]="Few",t[t.Many=4]="Many",t[t.Other=5]="Other",t}({}),M=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}({}),E=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}({}),A=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}({}),D=function(t){return t[t.Decimal=0]="Decimal",t[t.Group=1]="Group",t[t.List=2]="List",t[t.PercentSign=3]="PercentSign",t[t.PlusSign=4]="PlusSign",t[t.MinusSign=5]="MinusSign",t[t.Exponential=6]="Exponential",t[t.SuperscriptingExponent=7]="SuperscriptingExponent",t[t.PerMille=8]="PerMille",t[t[1/0]=9]="Infinity",t[t.NaN=10]="NaN",t[t.TimeSeparator=11]="TimeSeparator",t[t.CurrencyDecimal=12]="CurrencyDecimal",t[t.CurrencyGroup=13]="CurrencyGroup",t}({});function P(t,e){return O((0,i.cg1)(t)[i.wAp.DateFormat],e)}function L(t,e){return O((0,i.cg1)(t)[i.wAp.TimeFormat],e)}function R(t,e){return O((0,i.cg1)(t)[i.wAp.DateTimeFormat],e)}function I(t,e){const n=(0,i.cg1)(t),r=n[i.wAp.NumberSymbols][e];if(void 0===r){if(e===D.CurrencyDecimal)return n[i.wAp.NumberSymbols][D.Decimal];if(e===D.CurrencyGroup)return n[i.wAp.NumberSymbols][D.Group]}return r}const N=i.kL8;function k(t){if(!t[i.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[i.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function O(t,e){for(let n=e;n>-1;n--)if(void 0!==t[n])return t[n];throw new Error("Locale data API: locale data undefined")}function z(t){const[e,n]=t.split(":");return{hours:+e,minutes:+n}}const F=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,U={},H=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var B=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}({}),V=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}({}),G=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}({});function j(t,e,n,i){let r=function(t){if(it(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[e,n=1,i=1]=t.split("-").map(t=>+t);return W(e,n-1,i)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let n;if(n=t.match(F))return function(t){const e=new Date(0);let n=0,i=0;const r=t[8]?e.setUTCFullYear:e.setFullYear,s=t[8]?e.setUTCHours:e.setHours;t[9]&&(n=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(e,Number(t[1]),Number(t[2])-1,Number(t[3]));const o=Number(t[4]||0)-n,a=Number(t[5]||0)-i,l=Number(t[6]||0),c=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return s.call(e,o,a,l,c),e}(n)}const e=new Date(t);if(!it(e))throw new Error(`Unable to convert "${t}" into a date`);return e}(t);e=q(n,e)||e;let s,o=[];for(;e;){if(s=H.exec(e),!s){o.push(e);break}{o=o.concat(s.slice(1));const t=o.pop();if(!t)break;e=t}}let a=r.getTimezoneOffset();i&&(a=nt(i,a),r=function(t,e,n){const i=t.getTimezoneOffset();return function(t,e){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+e),t}(t,-1*(nt(e,i)-i))}(r,i));let l="";return o.forEach(t=>{const e=function(t){if(et[t])return et[t];let e;switch(t){case"G":case"GG":case"GGG":e=J(G.Eras,E.Abbreviated);break;case"GGGG":e=J(G.Eras,E.Wide);break;case"GGGGG":e=J(G.Eras,E.Narrow);break;case"y":e=X(V.FullYear,1,0,!1,!0);break;case"yy":e=X(V.FullYear,2,0,!0,!0);break;case"yyy":e=X(V.FullYear,3,0,!1,!0);break;case"yyyy":e=X(V.FullYear,4,0,!1,!0);break;case"Y":e=tt(1);break;case"YY":e=tt(2,!0);break;case"YYY":e=tt(3);break;case"YYYY":e=tt(4);break;case"M":case"L":e=X(V.Month,1,1);break;case"MM":case"LL":e=X(V.Month,2,1);break;case"MMM":e=J(G.Months,E.Abbreviated);break;case"MMMM":e=J(G.Months,E.Wide);break;case"MMMMM":e=J(G.Months,E.Narrow);break;case"LLL":e=J(G.Months,E.Abbreviated,M.Standalone);break;case"LLLL":e=J(G.Months,E.Wide,M.Standalone);break;case"LLLLL":e=J(G.Months,E.Narrow,M.Standalone);break;case"w":e=K(1);break;case"ww":e=K(2);break;case"W":e=K(1,!0);break;case"d":e=X(V.Date,1);break;case"dd":e=X(V.Date,2);break;case"c":case"cc":e=X(V.Day,1);break;case"ccc":e=J(G.Days,E.Abbreviated,M.Standalone);break;case"cccc":e=J(G.Days,E.Wide,M.Standalone);break;case"ccccc":e=J(G.Days,E.Narrow,M.Standalone);break;case"cccccc":e=J(G.Days,E.Short,M.Standalone);break;case"E":case"EE":case"EEE":e=J(G.Days,E.Abbreviated);break;case"EEEE":e=J(G.Days,E.Wide);break;case"EEEEE":e=J(G.Days,E.Narrow);break;case"EEEEEE":e=J(G.Days,E.Short);break;case"a":case"aa":case"aaa":e=J(G.DayPeriods,E.Abbreviated);break;case"aaaa":e=J(G.DayPeriods,E.Wide);break;case"aaaaa":e=J(G.DayPeriods,E.Narrow);break;case"b":case"bb":case"bbb":e=J(G.DayPeriods,E.Abbreviated,M.Standalone,!0);break;case"bbbb":e=J(G.DayPeriods,E.Wide,M.Standalone,!0);break;case"bbbbb":e=J(G.DayPeriods,E.Narrow,M.Standalone,!0);break;case"B":case"BB":case"BBB":e=J(G.DayPeriods,E.Abbreviated,M.Format,!0);break;case"BBBB":e=J(G.DayPeriods,E.Wide,M.Format,!0);break;case"BBBBB":e=J(G.DayPeriods,E.Narrow,M.Format,!0);break;case"h":e=X(V.Hours,1,-12);break;case"hh":e=X(V.Hours,2,-12);break;case"H":e=X(V.Hours,1);break;case"HH":e=X(V.Hours,2);break;case"m":e=X(V.Minutes,1);break;case"mm":e=X(V.Minutes,2);break;case"s":e=X(V.Seconds,1);break;case"ss":e=X(V.Seconds,2);break;case"S":e=X(V.FractionalSeconds,1);break;case"SS":e=X(V.FractionalSeconds,2);break;case"SSS":e=X(V.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=$(B.Short);break;case"ZZZZZ":e=$(B.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=$(B.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=$(B.Long);break;default:return null}return et[t]=e,e}(t);l+=e?e(r,n,a):"''"===t?"'":t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function W(t,e,n){const i=new Date(0);return i.setFullYear(t,e,n),i.setHours(0,0,0),i}function q(t,e){const n=function(t){return(0,i.cg1)(t)[i.wAp.LocaleId]}(t);if(U[n]=U[n]||{},U[n][e])return U[n][e];let r="";switch(e){case"shortDate":r=P(t,A.Short);break;case"mediumDate":r=P(t,A.Medium);break;case"longDate":r=P(t,A.Long);break;case"fullDate":r=P(t,A.Full);break;case"shortTime":r=L(t,A.Short);break;case"mediumTime":r=L(t,A.Medium);break;case"longTime":r=L(t,A.Long);break;case"fullTime":r=L(t,A.Full);break;case"short":const e=q(t,"shortTime"),n=q(t,"shortDate");r=Z(R(t,A.Short),[e,n]);break;case"medium":const i=q(t,"mediumTime"),s=q(t,"mediumDate");r=Z(R(t,A.Medium),[i,s]);break;case"long":const o=q(t,"longTime"),a=q(t,"longDate");r=Z(R(t,A.Long),[o,a]);break;case"full":const l=q(t,"fullTime"),c=q(t,"fullDate");r=Z(R(t,A.Full),[l,c])}return r&&(U[n][e]=r),r}function Z(t,e){return e&&(t=t.replace(/\{([^}]+)}/g,function(t,n){return null!=e&&n in e?e[n]:t})),t}function Y(t,e,n="-",i,r){let s="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,s=n));let o=String(t);for(;o.length<e;)o="0"+o;return i&&(o=o.substr(o.length-e)),s+o}function X(t,e,n=0,i=!1,r=!1){return function(s,o){let a=function(t,e){switch(t){case V.FullYear:return e.getFullYear();case V.Month:return e.getMonth();case V.Date:return e.getDate();case V.Hours:return e.getHours();case V.Minutes:return e.getMinutes();case V.Seconds:return e.getSeconds();case V.FractionalSeconds:return e.getMilliseconds();case V.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,s);if((n>0||a>-n)&&(a+=n),t===V.Hours)0===a&&-12===n&&(a=12);else if(t===V.FractionalSeconds)return l=e,Y(a,3).substr(0,l);var l;const c=I(o,D.MinusSign);return Y(a,e,c,i,r)}}function J(t,e,n=M.Format,r=!1){return function(s,o){return function(t,e,n,r,s,o){switch(n){case G.Months:return function(t,e,n){const r=(0,i.cg1)(t),s=O([r[i.wAp.MonthsFormat],r[i.wAp.MonthsStandalone]],e);return O(s,n)}(e,s,r)[t.getMonth()];case G.Days:return function(t,e,n){const r=(0,i.cg1)(t),s=O([r[i.wAp.DaysFormat],r[i.wAp.DaysStandalone]],e);return O(s,n)}(e,s,r)[t.getDay()];case G.DayPeriods:const a=t.getHours(),l=t.getMinutes();if(o){const t=function(t){const e=(0,i.cg1)(t);return k(e),(e[i.wAp.ExtraData][2]||[]).map(t=>"string"==typeof t?z(t):[z(t[0]),z(t[1])])}(e),n=function(t,e,n){const r=(0,i.cg1)(t);k(r);const s=O([r[i.wAp.ExtraData][0],r[i.wAp.ExtraData][1]],e)||[];return O(s,n)||[]}(e,s,r),o=t.findIndex(t=>{if(Array.isArray(t)){const[e,n]=t,i=a>=e.hours&&l>=e.minutes,r=a<n.hours||a===n.hours&&l<n.minutes;if(e.hours<n.hours){if(i&&r)return!0}else if(i||r)return!0}else if(t.hours===a&&t.minutes===l)return!0;return!1});if(-1!==o)return n[o]}return function(t,e,n){const r=(0,i.cg1)(t),s=O([r[i.wAp.DayPeriodsFormat],r[i.wAp.DayPeriodsStandalone]],e);return O(s,n)}(e,s,r)[a<12?0:1];case G.Eras:return function(t,e){return O((0,i.cg1)(t)[i.wAp.Eras],e)}(e,r)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${n}`)}}(s,o,t,e,n,r)}}function $(t){return function(e,n,i){const r=-1*i,s=I(n,D.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case B.Short:return(r>=0?"+":"")+Y(o,2,s)+Y(Math.abs(r%60),2,s);case B.ShortGMT:return"GMT"+(r>=0?"+":"")+Y(o,1,s);case B.Long:return"GMT"+(r>=0?"+":"")+Y(o,2,s)+":"+Y(Math.abs(r%60),2,s);case B.Extended:return 0===i?"Z":(r>=0?"+":"")+Y(o,2,s)+":"+Y(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${t}"`)}}}function Q(t){return W(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay()))}function K(t,e=!1){return function(n,i){let r;if(e){const t=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,e=n.getDate();r=1+Math.floor((e+t)/7)}else{const t=Q(n),e=function(t){const e=W(t,0,1).getDay();return W(t,0,1+(e<=4?4:11)-e)}(t.getFullYear()),i=t.getTime()-e.getTime();r=1+Math.round(i/6048e5)}return Y(r,t,I(i,D.MinusSign))}}function tt(t,e=!1){return function(n,i){return Y(Q(n).getFullYear(),t,I(i,D.MinusSign),e)}}const et={};function nt(t,e){t=t.replace(/:/g,"");const n=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(n)?e:n}function it(t){return t instanceof Date&&!isNaN(t.valueOf())}const rt=/^(\d+)?\.((\d+)(-(\d+))?)?$/,st=".",ot="0";function at(t){const e=parseInt(t);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+t);return e}class lt{}let ct=(()=>{class t extends lt{constructor(t){super(),this.locale=t}getPluralCategory(t,e){switch(N(e||this.locale)(t)){case S.Zero:return"zero";case S.One:return"one";case S.Two:return"two";case S.Few:return"few";case S.Many:return"many";default:return"other"}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.soG))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();function ut(t,e){e=encodeURIComponent(e);for(const n of t.split(";")){const t=n.indexOf("="),[i,r]=-1==t?[n,""]:[n.slice(0,t),n.slice(t+1)];if(i.trim()===e)return decodeURIComponent(r)}return null}let ht=(()=>{class t{constructor(t,e,n,i){this._iterableDiffers=t,this._keyValueDiffers=e,this._ngEl=n,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(t){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof t?t.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(t){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof t?t.split(/\s+/):t,this._rawClass&&((0,i.sIi)(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const t=this._iterableDiffer.diff(this._rawClass);t&&this._applyIterableChanges(t)}else if(this._keyValueDiffer){const t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}_applyKeyValueChanges(t){t.forEachAddedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachChangedItem(t=>this._toggleClass(t.key,t.currentValue)),t.forEachRemovedItem(t=>{t.previousValue&&this._toggleClass(t.key,!1)})}_applyIterableChanges(t){t.forEachAddedItem(t=>{if("string"!=typeof t.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${(0,i.AaK)(t.item)}`);this._toggleClass(t.item,!0)}),t.forEachRemovedItem(t=>this._toggleClass(t.item,!1))}_applyClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!0)):Object.keys(t).forEach(e=>this._toggleClass(e,!!t[e])))}_removeClasses(t){t&&(Array.isArray(t)||t instanceof Set?t.forEach(t=>this._toggleClass(t,!1)):Object.keys(t).forEach(t=>this._toggleClass(t,!1)))}_toggleClass(t,e){(t=t.trim())&&t.split(/\s+/g).forEach(t=>{e?this._renderer.addClass(this._ngEl.nativeElement,t):this._renderer.removeClass(this._ngEl.nativeElement,t)})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.ZZ4),i.Y36(i.aQg),i.Y36(i.SBq),i.Y36(i.Qsj))},t.\u0275dir=i.lG2({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class dt{constructor(t,e,n,i){this.$implicit=t,this.ngForOf=e,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let pt=(()=>{class t{constructor(t,e,n){this._viewContainer=t,this._template=e,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(e){throw new Error(`Cannot find a differ supporting object '${n}' of type '${t=n,t.name||typeof t}'. NgFor only supports binding to Iterables such as Arrays.`)}}var t;if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const e=[];t.forEachOperation((t,n,i)=>{if(null==t.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new dt(null,this._ngForOf,-1,-1),null===i?void 0:i),r=new ft(t,n);e.push(r)}else if(null==i)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const r=this._viewContainer.get(n);this._viewContainer.move(r,i);const s=new ft(t,r);e.push(s)}});for(let n=0;n<e.length;n++)this._perViewChange(e[n].view,e[n].record);for(let n=0,i=this._viewContainer.length;n<i;n++){const t=this._viewContainer.get(n);t.context.index=n,t.context.count=i,t.context.ngForOf=this._ngForOf}t.forEachIdentityChange(t=>{this._viewContainer.get(t.currentIndex).context.$implicit=t.item})}_perViewChange(t,e){t.context.$implicit=e.item}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.s_b),i.Y36(i.Rgc),i.Y36(i.ZZ4))},t.\u0275dir=i.lG2({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();class ft{constructor(t,e){this.record=t,this.view=e}}let mt=(()=>{class t{constructor(t,e){this._viewContainer=t,this._context=new gt,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=e}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){yt("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){yt("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,e){return!0}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.s_b),i.Y36(i.Rgc))},t.\u0275dir=i.lG2({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class gt{constructor(){this.$implicit=null,this.ngIf=null}}function yt(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${(0,i.AaK)(e)}'.`)}let vt=(()=>{class t{constructor(t,e,n){this._ngEl=t,this._differs=e,this._renderer=n,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,e){const[n,i]=t.split(".");null!=(e=null!=e&&i?`${e}${i}`:e)?this._renderer.setStyle(this._ngEl.nativeElement,n,e):this._renderer.removeStyle(this._ngEl.nativeElement,n)}_applyChanges(t){t.forEachRemovedItem(t=>this._setStyle(t.key,null)),t.forEachAddedItem(t=>this._setStyle(t.key,t.currentValue)),t.forEachChangedItem(t=>this._setStyle(t.key,t.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq),i.Y36(i.aQg),i.Y36(i.Qsj))},t.\u0275dir=i.lG2({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})();function _t(t,e){return Error(`InvalidPipeArgument: '${e}' for pipe '${(0,i.AaK)(t)}'`)}let xt=(()=>{class t{constructor(t){this.locale=t}transform(e,n="mediumDate",i,r){if(null==e||""===e||e!=e)return null;try{return j(e,n,r||this.locale,i)}catch(s){throw _t(t,s.message)}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.soG,16))},t.\u0275pipe=i.Yjl({name:"date",type:t,pure:!0}),t})(),bt=(()=>{class t{constructor(t){this._locale=t}transform(e,n,r){if(!function(t){return!(null==t||""===t||t!=t)}(e))return null;r=r||this._locale;try{return function(t,e,n){return function(t,e,n,i,r,s,o=!1){let a="",l=!1;if(isFinite(t)){let c=function(t){let e,n,i,r,s,o=Math.abs(t)+"",a=0;for((n=o.indexOf(st))>-1&&(o=o.replace(st,"")),(i=o.search(/e/i))>0?(n<0&&(n=i),n+=+o.slice(i+1),o=o.substring(0,i)):n<0&&(n=o.length),i=0;o.charAt(i)===ot;i++);if(i===(s=o.length))e=[0],n=1;else{for(s--;o.charAt(s)===ot;)s--;for(n-=i,e=[],r=0;i<=s;i++,r++)e[r]=Number(o.charAt(i))}return n>22&&(e=e.splice(0,21),a=n-1,n=1),{digits:e,exponent:a,integerLen:n}}(t);o&&(c=function(t){if(0===t.digits[0])return t;const e=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(0===e?t.digits.push(0,0):1===e&&t.digits.push(0),t.integerLen+=2),t}(c));let u=e.minInt,h=e.minFrac,d=e.maxFrac;if(s){const t=s.match(rt);if(null===t)throw new Error(`${s} is not a valid digit info`);const e=t[1],n=t[3],i=t[5];null!=e&&(u=at(e)),null!=n&&(h=at(n)),null!=i?d=at(i):null!=n&&h>d&&(d=h)}!function(t,e,n){if(e>n)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${n}).`);let i=t.digits,r=i.length-t.integerLen;const s=Math.min(Math.max(e,r),n);let o=s+t.integerLen,a=i[o];if(o>0){i.splice(Math.max(t.integerLen,o));for(let t=o;t<i.length;t++)i[t]=0}else{r=Math.max(0,r),t.integerLen=1,i.length=Math.max(1,o=s+1),i[0]=0;for(let t=1;t<o;t++)i[t]=0}if(a>=5)if(o-1<0){for(let e=0;e>o;e--)i.unshift(0),t.integerLen++;i.unshift(1),t.integerLen++}else i[o-1]++;for(;r<Math.max(0,s);r++)i.push(0);let l=0!==s;const c=e+t.integerLen,u=i.reduceRight(function(t,e,n,i){return i[n]=(e+=t)<10?e:e-10,l&&(0===i[n]&&n>=c?i.pop():l=!1),e>=10?1:0},0);u&&(i.unshift(u),t.integerLen++)}(c,h,d);let p=c.digits,f=c.integerLen;const m=c.exponent;let g=[];for(l=p.every(t=>!t);f<u;f++)p.unshift(0);for(;f<0;f++)p.unshift(0);f>0?g=p.splice(f,p.length):(g=p,p=[0]);const y=[];for(p.length>=e.lgSize&&y.unshift(p.splice(-e.lgSize,p.length).join(""));p.length>e.gSize;)y.unshift(p.splice(-e.gSize,p.length).join(""));p.length&&y.unshift(p.join("")),a=y.join(I(n,i)),g.length&&(a+=I(n,r)+g.join("")),m&&(a+=I(n,D.Exponential)+"+"+m)}else a=I(n,D.Infinity);return a=t<0&&!l?e.negPre+a+e.negSuf:e.posPre+a+e.posSuf,a}(t,function(t,e="-"){const n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=t.split(";"),r=i[0],s=i[1],o=-1!==r.indexOf(st)?r.split(st):[r.substring(0,r.lastIndexOf(ot)+1),r.substring(r.lastIndexOf(ot)+1)],a=o[0],l=o[1]||"";n.posPre=a.substr(0,a.indexOf("#"));for(let u=0;u<l.length;u++){const t=l.charAt(u);t===ot?n.minFrac=n.maxFrac=u+1:"#"===t?n.maxFrac=u+1:n.posSuf+=t}const c=a.split(",");if(n.gSize=c[1]?c[1].length:0,n.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,s){const t=r.length-n.posPre.length-n.posSuf.length,e=s.indexOf("#");n.negPre=s.substr(0,e).replace(/'/g,""),n.negSuf=s.substr(e+t).replace(/'/g,"")}else n.negPre=e+n.posPre,n.negSuf=n.posSuf;return n}(function(t,e){return(0,i.cg1)(t)[i.wAp.NumberFormats][e]}(e,T.Decimal),I(e,D.MinusSign)),e,D.Group,D.Decimal,n)}(function(t){if("string"==typeof t&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if("number"!=typeof t)throw new Error(`${t} is not a number`);return t}(e),r,n)}catch(s){throw _t(t,s.message)}}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.soG,16))},t.\u0275pipe=i.Yjl({name:"number",type:t,pure:!0}),t})(),wt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[{provide:lt,useClass:ct}]}),t})(),Ct=(()=>{class t{}return t.\u0275prov=(0,i.Yz7)({token:t,providedIn:"root",factory:()=>new Tt((0,i.LFG)(o),window)}),t})();class Tt{constructor(t,e){this.document=t,this.window=e,this.offset=()=>[0,0]}setOffset(t){this.offset=Array.isArray(t)?()=>t:t}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(t){this.supportsScrolling()&&this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){if(!this.supportsScrolling())return;const e=function(t,e){const n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const n=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let i=n.currentNode;for(;i;){const t=i.shadowRoot;if(t){const n=t.getElementById(e)||t.querySelector(`[name="${e}"]`);if(n)return n}i=n.nextNode()}}return null}(this.document,t);e&&(this.scrollToElement(e),this.attemptFocus(e))}setHistoryScrollRestoration(t){if(this.supportScrollRestoration()){const e=this.window.history;e&&e.scrollRestoration&&(e.scrollRestoration=t)}}scrollToElement(t){const e=t.getBoundingClientRect(),n=e.left+this.window.pageXOffset,i=e.top+this.window.pageYOffset,r=this.offset();this.window.scrollTo(n-r[0],i-r[1])}attemptFocus(t){return t.focus(),this.document.activeElement===t}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const t=St(this.window.history)||St(Object.getPrototypeOf(this.window.history));return!(!t||!t.writable&&!t.set)}catch(t){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(t){return!1}}}function St(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class Mt{}class Et extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){var t;t=new Et,r||(r=t)}onAndCancel(t,e,n){return t.addEventListener(e,n,!1),()=>{t.removeEventListener(e,n,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=(Dt=Dt||document.querySelector("base"),Dt?Dt.getAttribute("href"):null);return null==e?null:function(t){At=At||document.createElement("a"),At.setAttribute("href",t);const e=At.pathname;return"/"===e.charAt(0)?e:`/${e}`}(e)}resetBaseElement(){Dt=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return ut(document.cookie,t)}}let At,Dt=null;const Pt=new i.OlP("TRANSITION_ID"),Lt=[{provide:i.ip1,useFactory:function(t,e,n){return()=>{n.get(i.CZH).donePromise.then(()=>{const n=s();Array.prototype.slice.apply(e.querySelectorAll("style[ng-transition]")).filter(e=>e.getAttribute("ng-transition")===t).forEach(t=>n.remove(t))})}},deps:[Pt,o,i.zs3],multi:!0}];class Rt{static init(){(0,i.VLi)(new Rt)}addToWindow(t){i.dqk.getAngularTestability=(e,n=!0)=>{const i=t.findTestabilityInTree(e,n);if(null==i)throw new Error("Could not find testability for element.");return i},i.dqk.getAllAngularTestabilities=()=>t.getAllTestabilities(),i.dqk.getAllAngularRootElements=()=>t.getAllRootElements(),i.dqk.frameworkStabilizers||(i.dqk.frameworkStabilizers=[]),i.dqk.frameworkStabilizers.push(t=>{const e=i.dqk.getAllAngularTestabilities();let n=e.length,r=!1;const s=function(e){r=r||e,n--,0==n&&t(r)};e.forEach(function(t){t.whenStable(s)})})}findTestabilityInTree(t,e,n){if(null==e)return null;const i=t.getTestability(e);return null!=i?i:n?s().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let It=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const Nt=new i.OlP("EventManagerPlugins");let kt=(()=>{class t{constructor(t,e){this._zone=e,this._eventNameToPlugin=new Map,t.forEach(t=>t.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,e,n){return this._findPluginFor(e).addEventListener(t,e,n)}addGlobalEventListener(t,e,n){return this._findPluginFor(e).addGlobalEventListener(t,e,n)}getZone(){return this._zone}_findPluginFor(t){const e=this._eventNameToPlugin.get(t);if(e)return e;const n=this._plugins;for(let i=0;i<n.length;i++){const e=n[i];if(e.supports(t))return this._eventNameToPlugin.set(t,e),e}throw new Error(`No event manager plugin found for event ${t}`)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Nt),i.LFG(i.R0b))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class Ot{constructor(t){this._doc=t}addGlobalEventListener(t,e,n){const i=s().getGlobalEventTarget(this._doc,t);if(!i)throw new Error(`Unsupported event target ${i} for event ${e}`);return this.addEventListener(i,e,n)}}let zt=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(t){const e=new Set;t.forEach(t=>{this._stylesSet.has(t)||(this._stylesSet.add(t),e.add(t))}),this.onStylesAdded(e)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Ft=(()=>{class t extends zt{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,e,n){t.forEach(t=>{const i=this._doc.createElement("style");i.textContent=t,n.push(e.appendChild(i))})}addHost(t){const e=[];this._addStylesToHost(this._stylesSet,t,e),this._hostNodes.set(t,e)}removeHost(t){const e=this._hostNodes.get(t);e&&e.forEach(Ut),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((e,n)=>{this._addStylesToHost(t,n,e)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(Ut))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();function Ut(t){s().remove(t)}const Ht={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Bt=/%COMP%/g;function Vt(t,e,n){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?Vt(t,r,n):(r=r.replace(Bt,t),n.push(r))}return n}function Gt(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let jt=(()=>{class t{constructor(t,e,n){this.eventManager=t,this.sharedStylesHost=e,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new Wt(t)}createRenderer(t,e){if(!t||!e)return this.defaultRenderer;switch(e.encapsulation){case i.ifc.Emulated:{let n=this.rendererByCompId.get(e.id);return n||(n=new qt(this.eventManager,this.sharedStylesHost,e,this.appId),this.rendererByCompId.set(e.id,n)),n.applyToHost(t),n}case 1:case i.ifc.ShadowDom:return new Zt(this.eventManager,this.sharedStylesHost,t,e);default:if(!this.rendererByCompId.has(e.id)){const t=Vt(e.id,e.styles,[]);this.sharedStylesHost.addStyles(t),this.rendererByCompId.set(e.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(kt),i.LFG(Ft),i.LFG(i.AFp))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class Wt{constructor(t){this.eventManager=t,this.data=Object.create(null)}destroy(){}createElement(t,e){return e?document.createElementNS(Ht[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,n){t&&t.insertBefore(e,n)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let n="string"==typeof t?document.querySelector(t):t;if(!n)throw new Error(`The selector "${t}" did not match any elements`);return e||(n.textContent=""),n}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,n,i){if(i){e=i+":"+e;const r=Ht[i];r?t.setAttributeNS(r,e,n):t.setAttribute(e,n)}else t.setAttribute(e,n)}removeAttribute(t,e,n){if(n){const i=Ht[n];i?t.removeAttributeNS(i,e):t.removeAttribute(`${n}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,n,r){r&(i.JOm.DashCase|i.JOm.Important)?t.style.setProperty(e,n,r&i.JOm.Important?"important":""):t.style[e]=n}removeStyle(t,e,n){n&i.JOm.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,n){t[e]=n}setValue(t,e){t.nodeValue=e}listen(t,e,n){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,Gt(n)):this.eventManager.addEventListener(t,e,Gt(n))}}class qt extends Wt{constructor(t,e,n,i){super(t),this.component=n;const r=Vt(i+"-"+n.id,n.styles,[]);e.addStyles(r),this.contentAttr="_ngcontent-%COMP%".replace(Bt,i+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(Bt,i+"-"+n.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const n=super.createElement(t,e);return super.setAttribute(n,this.contentAttr,""),n}}class Zt extends Wt{constructor(t,e,n,i){super(t),this.sharedStylesHost=e,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const r=Vt(i.id,i.styles,[]);for(let s=0;s<r.length;s++){const t=document.createElement("style");t.textContent=r[s],this.shadowRoot.appendChild(t)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,n){return super.insertBefore(this.nodeOrShadowRoot(t),e,n)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let Yt=(()=>{class t extends Ot{constructor(t){super(t)}supports(t){return!0}addEventListener(t,e,n){return t.addEventListener(e,n,!1),()=>this.removeEventListener(t,e,n)}removeEventListener(t,e,n){return t.removeEventListener(e,n)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const Xt=["alt","control","meta","shift"],Jt={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},$t={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Qt={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let Kt=(()=>{class t extends Ot{constructor(t){super(t)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,n,i){const r=t.parseEventName(n),o=t.eventCallback(r.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>s().onAndCancel(e,r.domEventName,o))}static parseEventName(e){const n=e.toLowerCase().split("."),i=n.shift();if(0===n.length||"keydown"!==i&&"keyup"!==i)return null;const r=t._normalizeKey(n.pop());let s="";if(Xt.forEach(t=>{const e=n.indexOf(t);e>-1&&(n.splice(e,1),s+=t+".")}),s+=r,0!=n.length||0===r.length)return null;const o={};return o.domEventName=i,o.fullKey=s,o}static getEventFullKey(t){let e="",n=function(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&$t.hasOwnProperty(e)&&(e=$t[e]))}return Jt[e]||e}(t);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),Xt.forEach(i=>{i!=n&&(0,Qt[i])(t)&&(e+=i+".")}),e+=n,e}static eventCallback(e,n,i){return r=>{t.getEventFullKey(r)===e&&i.runGuarded(()=>n(r))}}static _normalizeKey(t){switch(t){case"esc":return"escape";default:return t}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const te=(0,i.eFA)(i._c5,"browser",[{provide:i.Lbi,useValue:"browser"},{provide:i.g9A,useValue:function(){Et.makeCurrent(),Rt.init()},multi:!0},{provide:o,useFactory:function(){return(0,i.RDi)(document),document},deps:[]}]),ee=[[],{provide:i.zSh,useValue:"root"},{provide:i.qLn,useFactory:function(){return new i.qLn},deps:[]},{provide:Nt,useClass:Yt,multi:!0,deps:[o,i.R0b,i.Lbi]},{provide:Nt,useClass:Kt,multi:!0,deps:[o]},[],{provide:jt,useClass:jt,deps:[kt,Ft,i.AFp]},{provide:i.FYo,useExisting:jt},{provide:zt,useExisting:Ft},{provide:Ft,useClass:Ft,deps:[o]},{provide:i.dDg,useClass:i.dDg,deps:[i.R0b]},{provide:kt,useClass:kt,deps:[Nt,i.R0b]},{provide:Mt,useClass:It,deps:[]},[]];let ne=(()=>{class t{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:i.AFp,useValue:e.appId},{provide:Pt,useExisting:i.AFp},Lt]}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(t,12))},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:ee,imports:[wt,i.hGG]}),t})();"undefined"!=typeof window&&window;var ie=n(878),re=n(8318),se=n(3982);function oe(t,e){return(0,se.zg)(t,e,1)}var ae=n(6673);function le(t,e){return function(n){return n.lift(new ce(t,e))}}class ce{constructor(t,e){this.predicate=t,this.thisArg=e}call(t,e){return e.subscribe(new ue(t,this.predicate,this.thisArg))}}class ue extends ae.L{constructor(t,e,n){super(t),this.predicate=e,this.thisArg=n,this.count=0}_next(t){let e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(n){return void this.destination.error(n)}e&&this.destination.next(t)}}var he=n(9996);class de{}class pe{}class fe{constructor(t){this.normalizedNames=new Map,this.lazyUpdate=null,t?this.lazyInit="string"==typeof t?()=>{this.headers=new Map,t.split("\n").forEach(t=>{const e=t.indexOf(":");if(e>0){const n=t.slice(0,e),i=n.toLowerCase(),r=t.slice(e+1).trim();this.maybeSetNormalizedName(n,i),this.headers.has(i)?this.headers.get(i).push(r):this.headers.set(i,[r])}})}:()=>{this.headers=new Map,Object.keys(t).forEach(e=>{let n=t[e];const i=e.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(i,n),this.maybeSetNormalizedName(e,i))})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();const e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof fe?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){const e=new fe;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof fe?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){const e=t.name.toLowerCase();switch(t.op){case"a":case"s":let n=t.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(t.name,e);const i=("a"===t.op?this.headers.get(e):void 0)||[];i.push(...n),this.headers.set(e,i);break;case"d":const r=t.value;if(r){let t=this.headers.get(e);if(!t)return;t=t.filter(t=>-1===r.indexOf(t)),0===t.length?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,t)}else this.headers.delete(e),this.normalizedNames.delete(e)}}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}}class me{encodeKey(t){return ge(t)}encodeValue(t){return ge(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}}function ge(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}function ye(t){return`${t}`}class ve{constructor(t={}){if(this.updates=null,this.cloneFrom=null,this.encoder=t.encoder||new me,t.fromString){if(t.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(t,e){const n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(t=>{const i=t.indexOf("="),[r,s]=-1==i?[e.decodeKey(t),""]:[e.decodeKey(t.slice(0,i)),e.decodeValue(t.slice(i+1))],o=n.get(r)||[];o.push(s),n.set(r,o)}),n}(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{const n=t.fromObject[e];this.map.set(e,Array.isArray(n)?n:[n])})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();const e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){const e=[];return Object.keys(t).forEach(n=>{const i=t[n];Array.isArray(i)?i.forEach(t=>{e.push({param:n,value:t,op:"a"})}):e.push({param:n,value:i,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{const e=this.encoder.encodeKey(t);return this.map.get(t).map(t=>e+"="+this.encoder.encodeValue(t)).join("&")}).filter(t=>""!==t).join("&")}clone(t){const e=new ve({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":const e=("a"===t.op?this.map.get(t.param):void 0)||[];e.push(ye(t.value)),this.map.set(t.param,e);break;case"d":if(void 0===t.value){this.map.delete(t.param);break}{let e=this.map.get(t.param)||[];const n=e.indexOf(ye(t.value));-1!==n&&e.splice(n,1),e.length>0?this.map.set(t.param,e):this.map.delete(t.param)}}}),this.cloneFrom=this.updates=null)}}class _e{constructor(){this.map=new Map}set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}keys(){return this.map.keys()}}function xe(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer}function be(t){return"undefined"!=typeof Blob&&t instanceof Blob}function we(t){return"undefined"!=typeof FormData&&t instanceof FormData}class Ce{constructor(t,e,n,i){let r;if(this.url=e,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=t.toUpperCase(),function(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==n?n:null,r=i):r=n,r&&(this.reportProgress=!!r.reportProgress,this.withCredentials=!!r.withCredentials,r.responseType&&(this.responseType=r.responseType),r.headers&&(this.headers=r.headers),r.context&&(this.context=r.context),r.params&&(this.params=r.params)),this.headers||(this.headers=new fe),this.context||(this.context=new _e),this.params){const t=this.params.toString();if(0===t.length)this.urlWithParams=e;else{const n=e.indexOf("?");this.urlWithParams=e+(-1===n?"?":n<e.length-1?"&":"")+t}}else this.params=new ve,this.urlWithParams=e}serializeBody(){return null===this.body?null:xe(this.body)||be(this.body)||we(this.body)||"string"==typeof this.body?this.body:this.body instanceof ve?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||we(this.body)?null:be(this.body)?this.body.type||null:xe(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ve?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(t={}){var e;const n=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,s=void 0!==t.body?t.body:this.body,o=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,a=void 0!==t.reportProgress?t.reportProgress:this.reportProgress;let l=t.headers||this.headers,c=t.params||this.params;const u=null!==(e=t.context)&&void 0!==e?e:this.context;return void 0!==t.setHeaders&&(l=Object.keys(t.setHeaders).reduce((e,n)=>e.set(n,t.setHeaders[n]),l)),t.setParams&&(c=Object.keys(t.setParams).reduce((e,n)=>e.set(n,t.setParams[n]),c)),new Ce(n,i,s,{params:c,headers:l,context:u,reportProgress:a,responseType:r,withCredentials:o})}}var Te=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}({});class Se{constructor(t,e=200,n="OK"){this.headers=t.headers||new fe,this.status=void 0!==t.status?t.status:e,this.statusText=t.statusText||n,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}}class Me extends Se{constructor(t={}){super(t),this.type=Te.ResponseHeader}clone(t={}){return new Me({headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Ee extends Se{constructor(t={}){super(t),this.type=Te.Response,this.body=void 0!==t.body?t.body:null}clone(t={}){return new Ee({body:void 0!==t.body?t.body:this.body,headers:t.headers||this.headers,status:void 0!==t.status?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}}class Ae extends Se{constructor(t){super(t,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${t.url||"(unknown url)"}`:`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}}function De(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials}}let Pe=(()=>{class t{constructor(t){this.handler=t}request(t,e,n={}){let i;if(t instanceof Ce)i=t;else{let r,s;r=n.headers instanceof fe?n.headers:new fe(n.headers),n.params&&(s=n.params instanceof ve?n.params:new ve({fromObject:n.params})),i=new Ce(t,e,void 0!==n.body?n.body:null,{headers:r,context:n.context,params:s,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}const r=(0,ie.of)(i).pipe(oe(t=>this.handler.handle(t)));if(t instanceof Ce||"events"===n.observe)return r;const s=r.pipe(le(t=>t instanceof Ee));switch(n.observe||"body"){case"body":switch(i.responseType){case"arraybuffer":return s.pipe((0,he.U)(t=>{if(null!==t.body&&!(t.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return t.body}));case"blob":return s.pipe((0,he.U)(t=>{if(null!==t.body&&!(t.body instanceof Blob))throw new Error("Response is not a Blob.");return t.body}));case"text":return s.pipe((0,he.U)(t=>{if(null!==t.body&&"string"!=typeof t.body)throw new Error("Response is not a string.");return t.body}));case"json":default:return s.pipe((0,he.U)(t=>t.body))}case"response":return s;default:throw new Error(`Unreachable: unhandled observe type ${n.observe}}`)}}delete(t,e={}){return this.request("DELETE",t,e)}get(t,e={}){return this.request("GET",t,e)}head(t,e={}){return this.request("HEAD",t,e)}jsonp(t,e){return this.request("JSONP",t,{params:(new ve).append(e,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,e={}){return this.request("OPTIONS",t,e)}patch(t,e,n={}){return this.request("PATCH",t,De(n,e))}post(t,e,n={}){return this.request("POST",t,De(n,e))}put(t,e,n={}){return this.request("PUT",t,De(n,e))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(de))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();class Le{constructor(t,e){this.next=t,this.interceptor=e}handle(t){return this.interceptor.intercept(t,this.next)}}const Re=new i.OlP("HTTP_INTERCEPTORS");let Ie=(()=>{class t{intercept(t,e){return e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const Ne=/^\)\]\}',?\n/;let ke=(()=>{class t{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new re.y(e=>{const n=this.xhrFactory.build();if(n.open(t.method,t.urlWithParams),t.withCredentials&&(n.withCredentials=!0),t.headers.forEach((t,e)=>n.setRequestHeader(t,e.join(","))),t.headers.has("Accept")||n.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const e=t.detectContentTypeHeader();null!==e&&n.setRequestHeader("Content-Type",e)}if(t.responseType){const e=t.responseType.toLowerCase();n.responseType="json"!==e?e:"text"}const i=t.serializeBody();let r=null;const s=()=>{if(null!==r)return r;const e=1223===n.status?204:n.status,i=n.statusText||"OK",s=new fe(n.getAllResponseHeaders()),o=function(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}(n)||t.url;return r=new Me({headers:s,status:e,statusText:i,url:o}),r},o=()=>{let{headers:i,status:r,statusText:o,url:a}=s(),l=null;204!==r&&(l=void 0===n.response?n.responseText:n.response),0===r&&(r=l?200:0);let c=r>=200&&r<300;if("json"===t.responseType&&"string"==typeof l){const t=l;l=l.replace(Ne,"");try{l=""!==l?JSON.parse(l):null}catch(u){l=t,c&&(c=!1,l={error:u,text:l})}}c?(e.next(new Ee({body:l,headers:i,status:r,statusText:o,url:a||void 0})),e.complete()):e.error(new Ae({error:l,headers:i,status:r,statusText:o,url:a||void 0}))},a=t=>{const{url:i}=s(),r=new Ae({error:t,status:n.status||0,statusText:n.statusText||"Unknown Error",url:i||void 0});e.error(r)};let l=!1;const c=i=>{l||(e.next(s()),l=!0);let r={type:Te.DownloadProgress,loaded:i.loaded};i.lengthComputable&&(r.total=i.total),"text"===t.responseType&&n.responseText&&(r.partialText=n.responseText),e.next(r)},u=t=>{let n={type:Te.UploadProgress,loaded:t.loaded};t.lengthComputable&&(n.total=t.total),e.next(n)};return n.addEventListener("load",o),n.addEventListener("error",a),n.addEventListener("timeout",a),n.addEventListener("abort",a),t.reportProgress&&(n.addEventListener("progress",c),null!==i&&n.upload&&n.upload.addEventListener("progress",u)),n.send(i),e.next({type:Te.Sent}),()=>{n.removeEventListener("error",a),n.removeEventListener("abort",a),n.removeEventListener("load",o),n.removeEventListener("timeout",a),t.reportProgress&&(n.removeEventListener("progress",c),null!==i&&n.upload&&n.upload.removeEventListener("progress",u)),n.readyState!==n.DONE&&n.abort()}})}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Mt))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const Oe=new i.OlP("XSRF_COOKIE_NAME"),ze=new i.OlP("XSRF_HEADER_NAME");class Fe{}let Ue=(()=>{class t{constructor(t,e,n){this.doc=t,this.platform=e,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=ut(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o),i.LFG(i.Lbi),i.LFG(Oe))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),He=(()=>{class t{constructor(t,e){this.tokenService=t,this.headerName=e}intercept(t,e){const n=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||n.startsWith("http://")||n.startsWith("https://"))return e.handle(t);const i=this.tokenService.getToken();return null===i||t.headers.has(this.headerName)||(t=t.clone({headers:t.headers.set(this.headerName,i)})),e.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Fe),i.LFG(ze))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Be=(()=>{class t{constructor(t,e){this.backend=t,this.injector=e,this.chain=null}handle(t){if(null===this.chain){const t=this.injector.get(Re,[]);this.chain=t.reduceRight((t,e)=>new Le(t,e),this.backend)}return this.chain.handle(t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(pe),i.LFG(i.zs3))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Ve=(()=>{class t{static disable(){return{ngModule:t,providers:[{provide:He,useClass:Ie}]}}static withOptions(e={}){return{ngModule:t,providers:[e.cookieName?{provide:Oe,useValue:e.cookieName}:[],e.headerName?{provide:ze,useValue:e.headerName}:[]]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[He,{provide:Re,useExisting:He,multi:!0},{provide:Fe,useClass:Ue},{provide:Oe,useValue:"XSRF-TOKEN"},{provide:ze,useValue:"X-XSRF-TOKEN"}]}),t})(),Ge=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[Pe,{provide:de,useClass:Be},ke,{provide:pe,useExisting:ke}],imports:[[Ve.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),t})();var je=n(9764),We=n(5959),qe=n(3895);class Ze extends We.xQ{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return e&&!e.closed&&t.next(this._value),e}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new qe.N;return this._value}next(t){super.next(this._value=t)}}var Ye=n(6163),Xe=n(8470);class Je extends ae.L{notifyNext(t,e,n,i,r){this.destination.next(e)}notifyError(t,e){this.destination.error(t)}notifyComplete(t){this.destination.complete()}}class $e extends ae.L{constructor(t,e,n){super(),this.parent=t,this.outerValue=e,this.outerIndex=n,this.index=0}_next(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)}_error(t){this.parent.notifyError(t,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var Qe=n(6015);function Ke(t,e,n,i,r=new $e(t,n,i)){if(!r.closed)return e instanceof re.y?e.subscribe(r):(0,Qe.s)(e)(r)}var tn=n(9342);const en={};class nn{constructor(t){this.resultSelector=t}call(t,e){return e.subscribe(new rn(t,this.resultSelector))}}class rn extends Je{constructor(t,e){super(t),this.resultSelector=e,this.active=0,this.values=[],this.observables=[]}_next(t){this.values.push(en),this.observables.push(t)}_complete(){const t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(let n=0;n<e;n++)this.add(Ke(this,t[n],void 0,n))}}notifyComplete(t){0==(this.active-=1)&&this.destination.complete()}notifyNext(t,e,n){const i=this.values,r=this.toRespond?i[n]===en?--this.toRespond:this.toRespond:0;i[n]=e,0===r&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))}_tryResultSelector(t){let e;try{e=this.resultSelector.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}const sn=(()=>{function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t})();var on=n(7471);function an(...t){return(0,on.J)(1)((0,ie.of)(...t))}var ln=n(653);function cn(t){return new re.y(e=>{let n;try{n=t()}catch(i){return void e.error(i)}return(n?(0,je.D)(n):(0,ln.c)()).subscribe(e)})}var un=n(2875),hn=n(6882);function dn(t,e){return"function"==typeof e?n=>n.pipe(dn((n,i)=>(0,je.D)(t(n,i)).pipe((0,he.U)((t,r)=>e(n,t,i,r))))):e=>e.lift(new pn(t))}class pn{constructor(t){this.project=t}call(t,e){return e.subscribe(new fn(t,this.project))}}class fn extends hn.Ds{constructor(t,e){super(t),this.project=e,this.index=0}_next(t){let e;const n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this._innerSub(e)}_innerSub(t){const e=this.innerSubscription;e&&e.unsubscribe();const n=new hn.IY(this),i=this.destination;i.add(n),this.innerSubscription=(0,hn.ft)(t,n),this.innerSubscription!==n&&i.add(this.innerSubscription)}_complete(){const{innerSubscription:t}=this;t&&!t.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(t){this.destination.next(t)}}const mn=(()=>{function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t})();function gn(t){return e=>0===t?(0,ln.c)():e.lift(new yn(t))}class yn{constructor(t){if(this.total=t,this.total<0)throw new mn}call(t,e){return e.subscribe(new vn(t,this.total))}}class vn extends ae.L{constructor(t,e){super(t),this.total=e,this.count=0}_next(t){const e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))}}function _n(t,e){let n=!1;return arguments.length>=2&&(n=!0),function(i){return i.lift(new xn(t,e,n))}}class xn{constructor(t,e,n=!1){this.accumulator=t,this.seed=e,this.hasSeed=n}call(t,e){return e.subscribe(new bn(t,this.accumulator,this.seed,this.hasSeed))}}class bn extends ae.L{constructor(t,e,n,i){super(t),this.accumulator=e,this._seed=n,this.hasSeed=i,this.index=0}get seed(){return this._seed}set seed(t){this.hasSeed=!0,this._seed=t}_next(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)}_tryNext(t){const e=this.index++;let n;try{n=this.accumulator(this.seed,t,e)}catch(i){this.destination.error(i)}this.seed=n,this.destination.next(n)}}function wn(t){return function(e){const n=new Cn(t),i=e.lift(n);return n.caught=i}}class Cn{constructor(t){this.selector=t}call(t,e){return e.subscribe(new Tn(t,this.selector,this.caught))}}class Tn extends hn.Ds{constructor(t,e,n){super(t),this.selector=e,this.caught=n}error(t){if(!this.isStopped){let n;try{n=this.selector(t,this.caught)}catch(e){return void super.error(e)}this._unsubscribeAndRecycle();const i=new hn.IY(this);this.add(i);const r=(0,hn.ft)(n,i);r!==i&&this.add(r)}}}function Sn(t){return function(e){return 0===t?(0,ln.c)():e.lift(new Mn(t))}}class Mn{constructor(t){if(this.total=t,this.total<0)throw new mn}call(t,e){return e.subscribe(new En(t,this.total))}}class En extends ae.L{constructor(t,e){super(t),this.total=e,this.ring=new Array,this.count=0}_next(t){const e=this.ring,n=this.total,i=this.count++;e.length<n?e.push(t):e[i%n]=t}_complete(){const t=this.destination;let e=this.count;if(e>0){const n=this.count>=this.total?this.total:this.count,i=this.ring;for(let r=0;r<n;r++){const r=e++%n;t.next(i[r])}}t.complete()}}function An(t=Ln){return e=>e.lift(new Dn(t))}class Dn{constructor(t){this.errorFactory=t}call(t,e){return e.subscribe(new Pn(t,this.errorFactory))}}class Pn extends ae.L{constructor(t,e){super(t),this.errorFactory=e,this.hasValue=!1}_next(t){this.hasValue=!0,this.destination.next(t)}_complete(){if(this.hasValue)return this.destination.complete();{let e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}}function Ln(){return new sn}function Rn(t=null){return e=>e.lift(new In(t))}class In{constructor(t){this.defaultValue=t}call(t,e){return e.subscribe(new Nn(t,this.defaultValue))}}class Nn extends ae.L{constructor(t,e){super(t),this.defaultValue=e,this.isEmpty=!0}_next(t){this.isEmpty=!1,this.destination.next(t)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}var kn=n(3392);function On(t,e){const n=arguments.length>=2;return i=>i.pipe(t?le((e,n)=>t(e,n,i)):kn.y,gn(1),n?Rn(e):An(()=>new sn))}var zn=n(6599),Fn=n(1564),Un=n(7570);class Hn{constructor(t){this.callback=t}call(t,e){return e.subscribe(new Bn(t,this.callback))}}class Bn extends ae.L{constructor(t,e){super(t),this.add(new Un.w(e))}}class Vn{constructor(t,e){this.id=t,this.url=e}}class Gn extends Vn{constructor(t,e,n="imperative",i=null){super(t,e),this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class jn extends Vn{constructor(t,e,n){super(t,e),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Wn extends Vn{constructor(t,e,n){super(t,e),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class qn extends Vn{constructor(t,e,n){super(t,e),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Zn extends Vn{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Yn extends Vn{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xn extends Vn{constructor(t,e,n,i,r){super(t,e),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=r}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Jn extends Vn{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $n extends Vn{constructor(t,e,n,i){super(t,e),this.urlAfterRedirects=n,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Qn{constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Kn{constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ti{constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ei{constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ni{constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ii{constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ri{constructor(t,e,n){this.routerEvent=t,this.position=e,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const si="primary";class oi{constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){const e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}}function ai(t){return new oi(t)}function li(t){const e=Error("NavigationCancelingError: "+t);return e.ngNavigationCancelingError=!0,e}function ci(t,e,n){const i=n.path.split("/");if(i.length>t.length)return null;if("full"===n.pathMatch&&(e.hasChildren()||i.length<t.length))return null;const r={};for(let s=0;s<i.length;s++){const e=i[s],n=t[s];if(e.startsWith(":"))r[e.substring(1)]=n;else if(e!==n.path)return null}return{consumed:t.slice(0,i.length),posParams:r}}function ui(t,e){const n=t?Object.keys(t):void 0,i=e?Object.keys(e):void 0;if(!n||!i||n.length!=i.length)return!1;let r;for(let s=0;s<n.length;s++)if(r=n[s],!hi(t[r],e[r]))return!1;return!0}function hi(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const n=[...t].sort(),i=[...e].sort();return n.every((t,e)=>i[e]===t)}return t===e}function di(t){return Array.prototype.concat.apply([],t)}function pi(t){return t.length>0?t[t.length-1]:null}function fi(t,e){for(const n in t)t.hasOwnProperty(n)&&e(t[n],n)}function mi(t){return(0,i.CqO)(t)?t:(0,i.QGY)(t)?(0,je.D)(Promise.resolve(t)):(0,ie.of)(t)}const gi={exact:function t(e,n,i){if(!Si(e.segments,n.segments))return!1;if(!bi(e.segments,n.segments,i))return!1;if(e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children){if(!e.children[r])return!1;if(!t(e.children[r],n.children[r],i))return!1}return!0},subset:_i},yi={exact:function(t,e){return ui(t,e)},subset:function(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>hi(t[n],e[n]))},ignored:()=>!0};function vi(t,e,n){return gi[n.paths](t.root,e.root,n.matrixParams)&&yi[n.queryParams](t.queryParams,e.queryParams)&&!("exact"===n.fragment&&t.fragment!==e.fragment)}function _i(t,e,n){return xi(t,e,e.segments,n)}function xi(t,e,n,i){if(t.segments.length>n.length){const r=t.segments.slice(0,n.length);return!!Si(r,n)&&!e.hasChildren()&&!!bi(r,n,i)}if(t.segments.length===n.length){if(!Si(t.segments,n))return!1;if(!bi(t.segments,n,i))return!1;for(const n in e.children){if(!t.children[n])return!1;if(!_i(t.children[n],e.children[n],i))return!1}return!0}{const r=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!!Si(t.segments,r)&&!!bi(t.segments,r,i)&&!!t.children.primary&&xi(t.children.primary,e,s,i)}}function bi(t,e,n){return e.every((e,i)=>yi[n](t[i].parameters,e.parameters))}class wi{constructor(t,e,n){this.root=t,this.queryParams=e,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ai(this.queryParams)),this._queryParamMap}toString(){return Ai.serialize(this)}}class Ci{constructor(t,e){this.segments=t,this.children=e,this.parent=null,fi(e,(t,e)=>t.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Di(this)}}class Ti{constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap||(this._parameterMap=ai(this.parameters)),this._parameterMap}toString(){return Oi(this)}}function Si(t,e){return t.length===e.length&&t.every((t,n)=>t.path===e[n].path)}class Mi{}class Ei{parse(t){const e=new Bi(t);return new wi(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){var e;return`/${Pi(t.root,!0)}${function(t){const e=Object.keys(t).map(e=>{const n=t[e];return Array.isArray(n)?n.map(t=>`${Ri(e)}=${Ri(t)}`).join("&"):`${Ri(e)}=${Ri(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(t.queryParams)}${"string"==typeof t.fragment?`#${e=t.fragment,encodeURI(e)}`:""}`}}const Ai=new Ei;function Di(t){return t.segments.map(t=>Oi(t)).join("/")}function Pi(t,e){if(!t.hasChildren())return Di(t);if(e){const e=t.children.primary?Pi(t.children.primary,!1):"",n=[];return fi(t.children,(t,e)=>{e!==si&&n.push(`${e}:${Pi(t,!1)}`)}),n.length>0?`${e}(${n.join("//")})`:e}{const e=function(t,e){let n=[];return fi(t.children,(t,i)=>{i===si&&(n=n.concat(e(t,i)))}),fi(t.children,(t,i)=>{i!==si&&(n=n.concat(e(t,i)))}),n}(t,(e,n)=>n===si?[Pi(t.children.primary,!1)]:[`${n}:${Pi(e,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children.primary?`${Di(t)}/${e[0]}`:`${Di(t)}/(${e.join("//")})`}}function Li(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ri(t){return Li(t).replace(/%3B/gi,";")}function Ii(t){return Li(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ni(t){return decodeURIComponent(t)}function ki(t){return Ni(t.replace(/\+/g,"%20"))}function Oi(t){return`${Ii(t.path)}${e=t.parameters,Object.keys(e).map(t=>`;${Ii(t)}=${Ii(e[t])}`).join("")}`;var e}const zi=/^[^\/()?;=#]+/;function Fi(t){const e=t.match(zi);return e?e[0]:""}const Ui=/^[^=?&#]+/,Hi=/^[^?&#]+/;class Bi{constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ci([],{}):new Ci([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(n.primary=new Ci(t,e)),n}parseSegment(){const t=Fi(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(t),new Ti(Ni(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const e=Fi(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=Fi(this.remaining);t&&(n=t,this.capture(n))}t[Ni(e)]=Ni(n)}parseQueryParam(t){const e=function(t){const e=t.match(Ui);return e?e[0]:""}(this.remaining);if(!e)return;this.capture(e);let n="";if(this.consumeOptional("=")){const t=function(t){const e=t.match(Hi);return e?e[0]:""}(this.remaining);t&&(n=t,this.capture(n))}const i=ki(e),r=ki(n);if(t.hasOwnProperty(i)){let e=t[i];Array.isArray(e)||(e=[e],t[i]=e),e.push(r)}else t[i]=r}parseParens(t){const e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=Fi(this.remaining),i=this.remaining[n.length];if("/"!==i&&")"!==i&&";"!==i)throw new Error(`Cannot parse url '${this.url}'`);let r;n.indexOf(":")>-1?(r=n.substr(0,n.indexOf(":")),this.capture(r),this.capture(":")):t&&(r=si);const s=this.parseChildren();e[r]=1===Object.keys(s).length?s.primary:new Ci([],s),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new Error(`Expected "${t}".`)}}class Vi{constructor(t){this._root=t}get root(){return this._root.value}parent(t){const e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){const e=Gi(t,this._root);return e?e.children.map(t=>t.value):[]}firstChild(t){const e=Gi(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){const e=ji(t,this._root);return e.length<2?[]:e[e.length-2].children.map(t=>t.value).filter(e=>e!==t)}pathFromRoot(t){return ji(t,this._root).map(t=>t.value)}}function Gi(t,e){if(t===e.value)return e;for(const n of e.children){const e=Gi(t,n);if(e)return e}return null}function ji(t,e){if(t===e.value)return[e];for(const n of e.children){const i=ji(t,n);if(i.length)return i.unshift(e),i}return[]}class Wi{constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}}function qi(t){const e={};return t&&t.children.forEach(t=>e[t.value.outlet]=t),e}class Zi extends Vi{constructor(t,e){super(t),this.snapshot=e,Ki(this,t)}toString(){return this.snapshot.toString()}}function Yi(t,e){const n=function(t,e){const n=new $i([],{},{},"",{},si,e,null,t.root,-1,{});return new Qi("",new Wi(n,[]))}(t,e),i=new Ze([new Ti("",{})]),r=new Ze({}),s=new Ze({}),o=new Ze({}),a=new Ze(""),l=new Xi(i,r,o,a,s,si,e,n.root);return l.snapshot=n.root,new Zi(new Wi(l,[]),n)}class Xi{constructor(t,e,n,i,r,s,o,a){this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=r,this.outlet=s,this.component=o,this._futureSnapshot=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,he.U)(t=>ai(t)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,he.U)(t=>ai(t)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ji(t,e="emptyOnly"){const n=t.pathFromRoot;let i=0;if("always"!==e)for(i=n.length-1;i>=1;){const t=n[i],e=n[i-1];if(t.routeConfig&&""===t.routeConfig.path)i--;else{if(e.component)break;i--}}return function(t){return t.reduce((t,e)=>({params:Object.assign(Object.assign({},t.params),e.params),data:Object.assign(Object.assign({},t.data),e.data),resolve:Object.assign(Object.assign({},t.resolve),e._resolvedData)}),{params:{},data:{},resolve:{}})}(n.slice(i))}class $i{constructor(t,e,n,i,r,s,o,a,l,c,u){this.url=t,this.params=e,this.queryParams=n,this.fragment=i,this.data=r,this.outlet=s,this.component=o,this.routeConfig=a,this._urlSegment=l,this._lastPathIndex=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=ai(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=ai(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(t=>t.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Qi extends Vi{constructor(t,e){super(e),this.url=t,Ki(this,e)}toString(){return tr(this._root)}}function Ki(t,e){e.value._routerState=t,e.children.forEach(e=>Ki(t,e))}function tr(t){const e=t.children.length>0?` { ${t.children.map(tr).join(", ")} } `:"";return`${t.value}${e}`}function er(t){if(t.snapshot){const e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,ui(e.queryParams,n.queryParams)||t.queryParams.next(n.queryParams),e.fragment!==n.fragment&&t.fragment.next(n.fragment),ui(e.params,n.params)||t.params.next(n.params),function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!ui(t[n],e[n]))return!1;return!0}(e.url,n.url)||t.url.next(n.url),ui(e.data,n.data)||t.data.next(n.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function nr(t,e){var n,i;return ui(t.params,e.params)&&Si(n=t.url,i=e.url)&&n.every((t,e)=>ui(t.parameters,i[e].parameters))&&!(!t.parent!=!e.parent)&&(!t.parent||nr(t.parent,e.parent))}function ir(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){const i=n.value;i._futureSnapshot=e.value;const r=function(t,e,n){return e.children.map(e=>{for(const i of n.children)if(t.shouldReuseRoute(e.value,i.value.snapshot))return ir(t,e,i);return ir(t,e)})}(t,e,n);return new Wi(i,r)}{if(t.shouldAttach(e.value)){const n=t.retrieve(e.value);if(null!==n){const t=n.route;return rr(e,t),t}}const n=new Xi(new Ze((i=e.value).url),new Ze(i.params),new Ze(i.queryParams),new Ze(i.fragment),new Ze(i.data),i.outlet,i.component,i),r=e.children.map(e=>ir(t,e));return new Wi(n,r)}var i}function rr(t,e){if(t.value.routeConfig!==e.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==e.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");e.value._futureSnapshot=t.value;for(let n=0;n<t.children.length;++n)rr(t.children[n],e.children[n])}function sr(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function or(t){return"object"==typeof t&&null!=t&&t.outlets}function ar(t,e,n,i,r){let s={};return i&&fi(i,(t,e)=>{s[e]=Array.isArray(t)?t.map(t=>`${t}`):`${t}`}),new wi(n.root===t?e:lr(n.root,t,e),s,r)}function lr(t,e,n){const i={};return fi(t.children,(t,r)=>{i[r]=t===e?n:lr(t,e,n)}),new Ci(t.segments,i)}class cr{constructor(t,e,n){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=n,t&&n.length>0&&sr(n[0]))throw new Error("Root segment cannot have matrix parameters");const i=n.find(or);if(i&&i!==pi(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ur{constructor(t,e,n){this.segmentGroup=t,this.processChildren=e,this.index=n}}function hr(t,e,n){if(t||(t=new Ci([],{})),0===t.segments.length&&t.hasChildren())return dr(t,e,n);const i=function(t,e,n){let i=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<t.segments.length;){if(i>=n.length)return s;const e=t.segments[r],o=n[i];if(or(o))break;const a=`${o}`,l=i<n.length-1?n[i+1]:null;if(r>0&&void 0===a)break;if(a&&l&&"object"==typeof l&&void 0===l.outlets){if(!gr(a,l,e))return s;i+=2}else{if(!gr(a,{},e))return s;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(t,e,n),r=n.slice(i.commandIndex);if(i.match&&i.pathIndex<t.segments.length){const e=new Ci(t.segments.slice(0,i.pathIndex),{});return e.children.primary=new Ci(t.segments.slice(i.pathIndex),t.children),dr(e,0,r)}return i.match&&0===r.length?new Ci(t.segments,{}):i.match&&!t.hasChildren()?pr(t,e,n):i.match?dr(t,0,r):pr(t,e,n)}function dr(t,e,n){if(0===n.length)return new Ci(t.segments,{});{const i=function(t){return or(t[0])?t[0].outlets:{[si]:t}}(n),r={};return fi(i,(n,i)=>{"string"==typeof n&&(n=[n]),null!==n&&(r[i]=hr(t.children[i],e,n))}),fi(t.children,(t,e)=>{void 0===i[e]&&(r[e]=t)}),new Ci(t.segments,r)}}function pr(t,e,n){const i=t.segments.slice(0,e);let r=0;for(;r<n.length;){const s=n[r];if(or(s)){const t=fr(s.outlets);return new Ci(i,t)}if(0===r&&sr(n[0])){i.push(new Ti(t.segments[e].path,mr(n[0]))),r++;continue}const o=or(s)?s.outlets.primary:`${s}`,a=r<n.length-1?n[r+1]:null;o&&a&&sr(a)?(i.push(new Ti(o,mr(a))),r+=2):(i.push(new Ti(o,{})),r++)}return new Ci(i,{})}function fr(t){const e={};return fi(t,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=pr(new Ci([],{}),0,t))}),e}function mr(t){const e={};return fi(t,(t,n)=>e[n]=`${t}`),e}function gr(t,e,n){return t==n.path&&ui(e,n.parameters)}class yr{constructor(t,e,n,i){this.routeReuseStrategy=t,this.futureState=e,this.currState=n,this.forwardEvent=i}activate(t){const e=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,n,t),er(this.futureState.root),this.activateChildRoutes(e,n,t)}deactivateChildRoutes(t,e,n){const i=qi(e);t.children.forEach(t=>{const e=t.value.outlet;this.deactivateRoutes(t,i[e],n),delete i[e]}),fi(i,(t,e)=>{this.deactivateRouteAndItsChildren(t,n)})}deactivateRoutes(t,e,n){const i=t.value,r=e?e.value:null;if(i===r)if(i.component){const r=n.getContext(i.outlet);r&&this.deactivateChildRoutes(t,e,r.children)}else this.deactivateChildRoutes(t,e,n);else r&&this.deactivateRouteAndItsChildren(e,n)}deactivateRouteAndItsChildren(t,e){this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){const n=e.getContext(t.value.outlet);if(n&&n.outlet){const e=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:e,route:t,contexts:i})}}deactivateRouteAndOutlet(t,e){const n=e.getContext(t.value.outlet),i=n&&t.value.component?n.children:e,r=qi(t);for(const s of Object.keys(r))this.deactivateRouteAndItsChildren(r[s],i);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(t,e,n){const i=qi(e);t.children.forEach(t=>{this.activateRoutes(t,i[t.value.outlet],n),this.forwardEvent(new ii(t.value.snapshot))}),t.children.length&&this.forwardEvent(new ei(t.value.snapshot))}activateRoutes(t,e,n){const i=t.value,r=e?e.value:null;if(er(i),i===r)if(i.component){const r=n.getOrCreateContext(i.outlet);this.activateChildRoutes(t,e,r.children)}else this.activateChildRoutes(t,e,n);else if(i.component){const e=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const t=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),e.children.onOutletReAttached(t.contexts),e.attachRef=t.componentRef,e.route=t.route.value,e.outlet&&e.outlet.attach(t.componentRef,t.route.value),vr(t.route)}else{const n=function(t){for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(i.snapshot),r=n?n.module.componentFactoryResolver:null;e.attachRef=null,e.route=i,e.resolver=r,e.outlet&&e.outlet.activateWith(i,r),this.activateChildRoutes(t,null,e.children)}}else this.activateChildRoutes(t,null,n)}}function vr(t){er(t.value),t.children.forEach(vr)}class _r{constructor(t,e){this.routes=t,this.module=e}}function xr(t){return"function"==typeof t}function br(t){return t instanceof wi}const wr=Symbol("INITIAL_VALUE");function Cr(){return dn(t=>function(...t){let e,n;return(0,Ye.K)(t[t.length-1])&&(n=t.pop()),"function"==typeof t[t.length-1]&&(e=t.pop()),1===t.length&&(0,Xe.k)(t[0])&&(t=t[0]),(0,tn.n)(t,n).lift(new nn(e))}(t.map(t=>t.pipe(gn(1),function(...t){const e=t[t.length-1];return(0,Ye.K)(e)?(t.pop(),n=>an(t,n,e)):e=>an(t,e)}(wr)))).pipe(_n((t,e)=>{let n=!1;return e.reduce((t,i,r)=>{if(t!==wr)return t;if(i===wr&&(n=!0),!n){if(!1===i)return i;if(r===e.length-1||br(i))return i}return t},t)},wr),le(t=>t!==wr),(0,he.U)(t=>br(t)?t:!0===t),gn(1)))}let Tr=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&i._UZ(0,"router-outlet")},directives:function(){return[vs]},encapsulation:2}),t})();function Sr(t,e=""){for(let n=0;n<t.length;n++){const i=t[n];Mr(i,Er(e,i))}}function Mr(t,e){t.children&&Sr(t.children,e)}function Er(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function Ar(t){const e=t.children&&t.children.map(Ar),n=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!n.component&&(e||n.loadChildren)&&n.outlet&&n.outlet!==si&&(n.component=Tr),n}function Dr(t){return t.outlet||si}function Pr(t,e){const n=t.filter(t=>Dr(t)===e);return n.push(...t.filter(t=>Dr(t)!==e)),n}const Lr={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Rr(t,e,n){var i;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||n.length>0)?Object.assign({},Lr):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const r=(e.matcher||ci)(n,t,e);if(!r)return Object.assign({},Lr);const s={};fi(r.posParams,(t,e)=>{s[e]=t.path});const o=r.consumed.length>0?Object.assign(Object.assign({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o,positionalParamSegments:null!==(i=r.posParams)&&void 0!==i?i:{}}}function Ir(t,e,n,i,r="corrected"){if(n.length>0&&function(t,e,n){return n.some(n=>Nr(t,e,n)&&Dr(n)!==si)}(t,n,i)){const r=new Ci(e,function(t,e,n,i){const r={};r.primary=i,i._sourceSegment=t,i._segmentIndexShift=e.length;for(const s of n)if(""===s.path&&Dr(s)!==si){const n=new Ci([],{});n._sourceSegment=t,n._segmentIndexShift=e.length,r[Dr(s)]=n}return r}(t,e,i,new Ci(n,t.children)));return r._sourceSegment=t,r._segmentIndexShift=e.length,{segmentGroup:r,slicedSegments:[]}}if(0===n.length&&function(t,e,n){return n.some(n=>Nr(t,e,n))}(t,n,i)){const s=new Ci(t.segments,function(t,e,n,i,r,s){const o={};for(const a of i)if(Nr(t,n,a)&&!r[Dr(a)]){const n=new Ci([],{});n._sourceSegment=t,n._segmentIndexShift="legacy"===s?t.segments.length:e.length,o[Dr(a)]=n}return Object.assign(Object.assign({},r),o)}(t,e,n,i,t.children,r));return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}const s=new Ci(t.segments,t.children);return s._sourceSegment=t,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:n}}function Nr(t,e,n){return(!(t.hasChildren()||e.length>0)||"full"!==n.pathMatch)&&""===n.path}function kr(t,e,n,i){return!!(Dr(t)===i||i!==si&&Nr(e,n,t))&&("**"===t.path||Rr(e,t,n).matched)}function Or(t,e,n){return 0===e.length&&!t.children[n]}class zr{constructor(t){this.segmentGroup=t||null}}class Fr{constructor(t){this.urlTree=t}}function Ur(t){return new re.y(e=>e.error(new zr(t)))}function Hr(t){return new re.y(e=>e.error(new Fr(t)))}function Br(t){return new re.y(e=>e.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${t}'`)))}class Vr{constructor(t,e,n,r,s){this.configLoader=e,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=t.get(i.h0i)}apply(){const t=Ir(this.urlTree.root,[],[],this.config).segmentGroup,e=new Ci(t.segments,t.children);return this.expandSegmentGroup(this.ngModule,this.config,e,si).pipe((0,he.U)(t=>this.createUrlTree(Gr(t),this.urlTree.queryParams,this.urlTree.fragment))).pipe(wn(t=>{if(t instanceof Fr)return this.allowRedirects=!1,this.match(t.urlTree);if(t instanceof zr)throw this.noMatchError(t);throw t}))}match(t){return this.expandSegmentGroup(this.ngModule,this.config,t.root,si).pipe((0,he.U)(e=>this.createUrlTree(Gr(e),t.queryParams,t.fragment))).pipe(wn(t=>{if(t instanceof zr)throw this.noMatchError(t);throw t}))}noMatchError(t){return new Error(`Cannot match any routes. URL Segment: '${t.segmentGroup}'`)}createUrlTree(t,e,n){const i=t.segments.length>0?new Ci([],{[si]:t}):t;return new wi(i,e,n)}expandSegmentGroup(t,e,n,i){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(t,e,n).pipe((0,he.U)(t=>new Ci([],t))):this.expandSegment(t,n,e,n.segments,i,!0)}expandChildren(t,e,n){const i=[];for(const r of Object.keys(n.children))"primary"===r?i.unshift(r):i.push(r);return(0,je.D)(i).pipe(oe(i=>{const r=n.children[i],s=Pr(e,i);return this.expandSegmentGroup(t,s,r,i).pipe((0,he.U)(t=>({segment:t,outlet:i})))}),_n((t,e)=>(t[e.outlet]=e.segment,t),{}),function(t,e){const n=arguments.length>=2;return i=>i.pipe(t?le((e,n)=>t(e,n,i)):kn.y,Sn(1),n?Rn(e):An(()=>new sn))}())}expandSegment(t,e,n,i,r,s){return(0,je.D)(n).pipe(oe(o=>this.expandSegmentAgainstRoute(t,e,n,o,i,r,s).pipe(wn(t=>{if(t instanceof zr)return(0,ie.of)(null);throw t}))),On(t=>!!t),wn((t,n)=>{if(t instanceof sn||"EmptyError"===t.name){if(Or(e,i,r))return(0,ie.of)(new Ci([],{}));throw new zr(e)}throw t}))}expandSegmentAgainstRoute(t,e,n,i,r,s,o){return kr(i,e,r,s)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(t,e,i,r,s):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s):Ur(e):Ur(e)}expandSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(t,n,i,s):this.expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s)}expandWildCardWithParamsAgainstRouteUsingRedirect(t,e,n,i){const r=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Hr(r):this.lineralizeSegments(n,r).pipe((0,se.zg)(n=>{const r=new Ci(n,{});return this.expandSegment(t,r,e,n,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(t,e,n,i,r,s){const{matched:o,consumedSegments:a,lastChild:l,positionalParamSegments:c}=Rr(e,i,r);if(!o)return Ur(e);const u=this.applyRedirectCommands(a,i.redirectTo,c);return i.redirectTo.startsWith("/")?Hr(u):this.lineralizeSegments(i,u).pipe((0,se.zg)(i=>this.expandSegment(t,e,n,i.concat(r.slice(l)),s,!1)))}matchSegmentAgainstRoute(t,e,n,i,r){if("**"===n.path)return n.loadChildren?(n._loadedConfig?(0,ie.of)(n._loadedConfig):this.configLoader.load(t.injector,n)).pipe((0,he.U)(t=>(n._loadedConfig=t,new Ci(i,{})))):(0,ie.of)(new Ci(i,{}));const{matched:s,consumedSegments:o,lastChild:a}=Rr(e,n,i);if(!s)return Ur(e);const l=i.slice(a);return this.getChildConfig(t,n,i).pipe((0,se.zg)(t=>{const i=t.module,s=t.routes,{segmentGroup:a,slicedSegments:c}=Ir(e,o,l,s),u=new Ci(a.segments,a.children);if(0===c.length&&u.hasChildren())return this.expandChildren(i,s,u).pipe((0,he.U)(t=>new Ci(o,t)));if(0===s.length&&0===c.length)return(0,ie.of)(new Ci(o,{}));const h=Dr(n)===r;return this.expandSegment(i,u,s,c,h?si:r,!0).pipe((0,he.U)(t=>new Ci(o.concat(t.segments),t.children)))}))}getChildConfig(t,e,n){return e.children?(0,ie.of)(new _r(e.children,t)):e.loadChildren?void 0!==e._loadedConfig?(0,ie.of)(e._loadedConfig):this.runCanLoadGuards(t.injector,e,n).pipe((0,se.zg)(n=>n?this.configLoader.load(t.injector,e).pipe((0,he.U)(t=>(e._loadedConfig=t,t))):function(t){return new re.y(e=>e.error(li(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`)))}(e))):(0,ie.of)(new _r([],t))}runCanLoadGuards(t,e,n){const i=e.canLoad;if(!i||0===i.length)return(0,ie.of)(!0);const r=i.map(i=>{const r=t.get(i);let s;if(function(t){return t&&xr(t.canLoad)}(r))s=r.canLoad(e,n);else{if(!xr(r))throw new Error("Invalid CanLoad guard");s=r(e,n)}return mi(s)});return(0,ie.of)(r).pipe(Cr(),(0,zn.b)(t=>{if(!br(t))return;const e=li(`Redirecting to "${this.urlSerializer.serialize(t)}"`);throw e.url=t,e}),(0,he.U)(t=>!0===t))}lineralizeSegments(t,e){let n=[],i=e.root;for(;;){if(n=n.concat(i.segments),0===i.numberOfChildren)return(0,ie.of)(n);if(i.numberOfChildren>1||!i.children.primary)return Br(t.redirectTo);i=i.children.primary}}applyRedirectCommands(t,e,n){return this.applyRedirectCreatreUrlTree(e,this.urlSerializer.parse(e),t,n)}applyRedirectCreatreUrlTree(t,e,n,i){const r=this.createSegmentGroup(t,e.root,n,i);return new wi(r,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){const n={};return fi(t,(t,i)=>{if("string"==typeof t&&t.startsWith(":")){const r=t.substring(1);n[i]=e[r]}else n[i]=t}),n}createSegmentGroup(t,e,n,i){const r=this.createSegments(t,e.segments,n,i);let s={};return fi(e.children,(e,r)=>{s[r]=this.createSegmentGroup(t,e,n,i)}),new Ci(r,s)}createSegments(t,e,n,i){return e.map(e=>e.path.startsWith(":")?this.findPosParam(t,e,i):this.findOrReturn(e,n))}findPosParam(t,e,n){const i=n[e.path.substring(1)];if(!i)throw new Error(`Cannot redirect to '${t}'. Cannot find '${e.path}'.`);return i}findOrReturn(t,e){let n=0;for(const i of e){if(i.path===t.path)return e.splice(n),i;n++}return t}}function Gr(t){const e={};for(const n of Object.keys(t.children)){const i=Gr(t.children[n]);(i.segments.length>0||i.hasChildren())&&(e[n]=i)}return function(t){if(1===t.numberOfChildren&&t.children.primary){const e=t.children.primary;return new Ci(t.segments.concat(e.segments),e.children)}return t}(new Ci(t.segments,e))}class jr{constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class Wr{constructor(t,e){this.component=t,this.route=e}}function qr(t,e,n){const i=t._root;return Yr(i,e?e._root:null,n,[i.value])}function Zr(t,e,n){const i=function(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(i?i.module.injector:n).get(t)}function Yr(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=qi(e);return t.children.forEach(t=>{!function(t,e,n,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function(t,e,n){if("function"==typeof n)return n(t,e);switch(n){case"pathParamsChange":return!Si(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Si(t.url,e.url)||!ui(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!nr(t,e)||!ui(t.queryParams,e.queryParams);case"paramsChange":default:return!nr(t,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?r.canActivateChecks.push(new jr(i)):(s.data=o.data,s._resolvedData=o._resolvedData),Yr(t,e,s.component?a?a.children:null:n,i,r),l&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Wr(a.outlet.component,o))}else o&&Xr(e,a,r),r.canActivateChecks.push(new jr(i)),Yr(t,null,s.component?a?a.children:null:n,i,r)}(t,s[t.value.outlet],n,i.concat([t.value]),r),delete s[t.value.outlet]}),fi(s,(t,e)=>Xr(t,n.getContext(e),r)),r}function Xr(t,e,n){const i=qi(t),r=t.value;fi(i,(t,i)=>{Xr(t,r.component?e?e.children.getContext(i):null:e,n)}),n.canDeactivateChecks.push(new Wr(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class Jr{}function $r(t){return new re.y(e=>e.error(t))}class Qr{constructor(t,e,n,i,r,s){this.rootComponentType=t,this.config=e,this.urlTree=n,this.url=i,this.paramsInheritanceStrategy=r,this.relativeLinkResolution=s}recognize(){const t=Ir(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup,e=this.processSegmentGroup(this.config,t,si);if(null===e)return null;const n=new $i([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},si,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Wi(n,e),r=new Qi(this.url,i);return this.inheritParamsAndData(r._root),r}inheritParamsAndData(t){const e=t.value,n=Ji(e,this.paramsInheritanceStrategy);e.params=Object.freeze(n.params),e.data=Object.freeze(n.data),t.children.forEach(t=>this.inheritParamsAndData(t))}processSegmentGroup(t,e,n){return 0===e.segments.length&&e.hasChildren()?this.processChildren(t,e):this.processSegment(t,e,e.segments,n)}processChildren(t,e){const n=[];for(const r of Object.keys(e.children)){const i=e.children[r],s=Pr(t,r),o=this.processSegmentGroup(s,i,r);if(null===o)return null;n.push(...o)}const i=ts(n);return i.sort((t,e)=>t.value.outlet===si?-1:e.value.outlet===si?1:t.value.outlet.localeCompare(e.value.outlet)),i}processSegment(t,e,n,i){for(const r of t){const t=this.processSegmentAgainstRoute(r,e,n,i);if(null!==t)return t}return Or(e,n,i)?[]:null}processSegmentAgainstRoute(t,e,n,i){if(t.redirectTo||!kr(t,e,n,i))return null;let r,s=[],o=[];if("**"===t.path){const i=n.length>0?pi(n).parameters:{};r=new $i(n,i,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,is(t),Dr(t),t.component,t,es(e),ns(e)+n.length,rs(t))}else{const i=Rr(e,t,n);if(!i.matched)return null;s=i.consumedSegments,o=n.slice(i.lastChild),r=new $i(s,i.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,is(t),Dr(t),t.component,t,es(e),ns(e)+s.length,rs(t))}const a=function(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(t),{segmentGroup:l,slicedSegments:c}=Ir(e,s,o,a.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution);if(0===c.length&&l.hasChildren()){const t=this.processChildren(a,l);return null===t?null:[new Wi(r,t)]}if(0===a.length&&0===c.length)return[new Wi(r,[])];const u=Dr(t)===i,h=this.processSegment(a,l,c,u?si:i);return null===h?null:[new Wi(r,h)]}}function Kr(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function ts(t){const e=[],n=new Set;for(const i of t){if(!Kr(i)){e.push(i);continue}const t=e.find(t=>i.value.routeConfig===t.value.routeConfig);void 0!==t?(t.children.push(...i.children),n.add(t)):e.push(i)}for(const i of n){const t=ts(i.children);e.push(new Wi(i.value,t))}return e.filter(t=>!n.has(t))}function es(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function ns(t){let e=t,n=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,n+=e._segmentIndexShift?e._segmentIndexShift:0;return n-1}function is(t){return t.data||{}}function rs(t){return t.resolve||{}}function ss(t){return dn(e=>{const n=t(e);return n?(0,je.D)(n).pipe((0,he.U)(()=>e)):(0,ie.of)(e)})}class os extends class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}}{}const as=new i.OlP("ROUTES");class ls{constructor(t,e,n,i){this.loader=t,this.compiler=e,this.onLoadStartListener=n,this.onLoadEndListener=i}load(t,e){if(e._loader$)return e._loader$;this.onLoadStartListener&&this.onLoadStartListener(e);const n=this.loadModuleFactory(e.loadChildren).pipe((0,he.U)(n=>{this.onLoadEndListener&&this.onLoadEndListener(e);const r=n.create(t);return new _r(di(r.injector.get(as,void 0,i.XFs.Self|i.XFs.Optional)).map(Ar),r)}),wn(t=>{throw e._loader$=void 0,t}));return e._loader$=new un.c(n,()=>new We.xQ).pipe((0,Fn.x)()),e._loader$}loadModuleFactory(t){return"string"==typeof t?(0,je.D)(this.loader.load(t)):mi(t()).pipe((0,se.zg)(t=>t instanceof i.YKP?(0,ie.of)(t):(0,je.D)(this.compiler.compileModuleAsync(t))))}}class cs{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new us,this.attachRef=null}}class us{constructor(){this.contexts=new Map}onChildOutletCreated(t,e){const n=this.getOrCreateContext(t);n.outlet=e,this.contexts.set(t,n)}onChildOutletDestroyed(t){const e=this.getContext(t);e&&(e.outlet=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let e=this.getContext(t);return e||(e=new cs,this.contexts.set(t,e)),e}getContext(t){return this.contexts.get(t)||null}}class hs{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,e){return t}}function ds(t){throw t}function ps(t,e,n){return e.parse("/")}function fs(t,e){return(0,ie.of)(null)}const ms={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},gs={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ys=(()=>{class t{constructor(t,e,n,r,s,o,a,l){this.rootComponentType=t,this.urlSerializer=e,this.rootContexts=n,this.location=r,this.config=l,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.lastLocationChangeInfo=null,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new We.xQ,this.errorHandler=ds,this.malformedUriErrorHandler=ps,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:fs,afterPreactivation:fs},this.urlHandlingStrategy=new hs,this.routeReuseStrategy=new os,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=s.get(i.h0i),this.console=s.get(i.c2e);const c=s.get(i.R0b);this.isNgZoneEnabled=c instanceof i.R0b&&i.R0b.isInAngularZone(),this.resetConfig(l),this.currentUrlTree=new wi(new Ci([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new ls(o,a,t=>this.triggerEvent(new Qn(t)),t=>this.triggerEvent(new Kn(t))),this.routerState=Yi(this.currentUrlTree,this.rootComponentType),this.transitions=new Ze({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}setupNavigations(t){const e=this.events;return t.pipe(le(t=>0!==t.id),(0,he.U)(t=>Object.assign(Object.assign({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl)})),dn(t=>{let n=!1,i=!1;return(0,ie.of)(t).pipe((0,zn.b)(t=>{this.currentNavigation={id:t.id,initialUrl:t.currentRawUrl,extractedUrl:t.extractedUrl,trigger:t.source,extras:t.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),dn(t=>{const n=!this.navigated||t.extractedUrl.toString()!==this.browserUrlTree.toString();if(("reload"===this.onSameUrlNavigation||n)&&this.urlHandlingStrategy.shouldProcessUrl(t.rawUrl))return(0,ie.of)(t).pipe(dn(t=>{const n=this.transitions.getValue();return e.next(new Gn(t.id,this.serializeUrl(t.extractedUrl),t.source,t.restoredState)),n!==this.transitions.getValue()?ln.E:Promise.resolve(t)}),(i=this.ngModule.injector,r=this.configLoader,s=this.urlSerializer,o=this.config,dn(t=>function(t,e,n,i,r){return new Vr(t,e,n,i,r).apply()}(i,r,s,t.extractedUrl,o).pipe((0,he.U)(e=>Object.assign(Object.assign({},t),{urlAfterRedirects:e}))))),(0,zn.b)(t=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:t.urlAfterRedirects})}),function(t,e,n,i,r){return(0,se.zg)(s=>function(t,e,n,i,r="emptyOnly",s="legacy"){try{const o=new Qr(t,e,n,i,r,s).recognize();return null===o?$r(new Jr):(0,ie.of)(o)}catch(o){return $r(o)}}(t,e,s.urlAfterRedirects,n(s.urlAfterRedirects),i,r).pipe((0,he.U)(t=>Object.assign(Object.assign({},s),{targetSnapshot:t}))))}(this.rootComponentType,this.config,t=>this.serializeUrl(t),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,zn.b)(t=>{"eager"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(t.urlAfterRedirects,t),this.browserUrlTree=t.urlAfterRedirects);const n=new Zn(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);e.next(n)}));var i,r,s,o;if(n&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:n,extractedUrl:i,source:r,restoredState:s,extras:o}=t,a=new Gn(n,this.serializeUrl(i),r,s);e.next(a);const l=Yi(i,this.rootComponentType).snapshot;return(0,ie.of)(Object.assign(Object.assign({},t),{targetSnapshot:l,urlAfterRedirects:i,extras:Object.assign(Object.assign({},o),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=t.rawUrl,this.browserUrlTree=t.urlAfterRedirects,t.resolve(null),ln.E}),ss(t=>{const{targetSnapshot:e,id:n,extractedUrl:i,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.beforePreactivation(e,{navigationId:n,appliedUrlTree:i,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),(0,zn.b)(t=>{const e=new Yn(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),(0,he.U)(t=>Object.assign(Object.assign({},t),{guards:qr(t.targetSnapshot,t.currentSnapshot,this.rootContexts)})),function(t,e){return(0,se.zg)(n=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return 0===o.length&&0===s.length?(0,ie.of)(Object.assign(Object.assign({},n),{guardsResult:!0})):function(t,e,n,i){return(0,je.D)(t).pipe((0,se.zg)(t=>function(t,e,n,i,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||0===s.length)return(0,ie.of)(!0);const o=s.map(s=>{const o=Zr(s,e,r);let a;if(function(t){return t&&xr(t.canDeactivate)}(o))a=mi(o.canDeactivate(t,e,n,i));else{if(!xr(o))throw new Error("Invalid CanDeactivate guard");a=mi(o(t,e,n,i))}return a.pipe(On())});return(0,ie.of)(o).pipe(Cr())}(t.component,t.route,n,e,i)),On(t=>!0!==t,!0))}(o,i,r,t).pipe((0,se.zg)(n=>n&&"boolean"==typeof n?function(t,e,n,i){return(0,je.D)(e).pipe(oe(e=>an(function(t,e){return null!==t&&e&&e(new ti(t)),(0,ie.of)(!0)}(e.route.parent,i),function(t,e){return null!==t&&e&&e(new ni(t)),(0,ie.of)(!0)}(e.route,i),function(t,e,n){const i=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(t=>function(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(t)).filter(t=>null!==t).map(e=>cn(()=>{const r=e.guards.map(r=>{const s=Zr(r,e.node,n);let o;if(function(t){return t&&xr(t.canActivateChild)}(s))o=mi(s.canActivateChild(i,t));else{if(!xr(s))throw new Error("Invalid CanActivateChild guard");o=mi(s(i,t))}return o.pipe(On())});return(0,ie.of)(r).pipe(Cr())}));return(0,ie.of)(r).pipe(Cr())}(t,e.path,n),function(t,e,n){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return(0,ie.of)(!0);const r=i.map(i=>cn(()=>{const r=Zr(i,e,n);let s;if(function(t){return t&&xr(t.canActivate)}(r))s=mi(r.canActivate(e,t));else{if(!xr(r))throw new Error("Invalid CanActivate guard");s=mi(r(e,t))}return s.pipe(On())}));return(0,ie.of)(r).pipe(Cr())}(t,e.route,n))),On(t=>!0!==t,!0))}(i,s,t,e):(0,ie.of)(n)),(0,he.U)(t=>Object.assign(Object.assign({},n),{guardsResult:t})))})}(this.ngModule.injector,t=>this.triggerEvent(t)),(0,zn.b)(t=>{if(br(t.guardsResult)){const e=li(`Redirecting to "${this.serializeUrl(t.guardsResult)}"`);throw e.url=t.guardsResult,e}const e=new Xn(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot,!!t.guardsResult);this.triggerEvent(e)}),le(t=>!!t.guardsResult||(this.cancelNavigationTransition(t,""),!1)),ss(t=>{if(t.guards.canActivateChecks.length)return(0,ie.of)(t).pipe((0,zn.b)(t=>{const e=new Jn(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}),dn(t=>{let e=!1;return(0,ie.of)(t).pipe((n=this.paramsInheritanceStrategy,i=this.ngModule.injector,(0,se.zg)(t=>{const{targetSnapshot:e,guards:{canActivateChecks:r}}=t;if(!r.length)return(0,ie.of)(t);let s=0;return(0,je.D)(r).pipe(oe(t=>function(t,e,n,i){return function(t,e,n,i){const r=Object.keys(t);if(0===r.length)return(0,ie.of)({});const s={};return(0,je.D)(r).pipe((0,se.zg)(r=>function(t,e,n,i){const r=Zr(t,e,i);return mi(r.resolve?r.resolve(e,n):r(e,n))}(t[r],e,n,i).pipe((0,zn.b)(t=>{s[r]=t}))),Sn(1),(0,se.zg)(()=>Object.keys(s).length===r.length?(0,ie.of)(s):ln.E))}(t._resolve,t,e,i).pipe((0,he.U)(e=>(t._resolvedData=e,t.data=Object.assign(Object.assign({},t.data),Ji(t,n).resolve),null)))}(t.route,e,n,i)),(0,zn.b)(()=>s++),Sn(1),(0,se.zg)(e=>s===r.length?(0,ie.of)(t):ln.E))})),(0,zn.b)({next:()=>e=!0,complete:()=>{e||this.cancelNavigationTransition(t,"At least one route resolver didn't emit any value.")}}));var n,i}),(0,zn.b)(t=>{const e=new $n(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(t.urlAfterRedirects),t.targetSnapshot);this.triggerEvent(e)}))}),ss(t=>{const{targetSnapshot:e,id:n,extractedUrl:i,rawUrl:r,extras:{skipLocationChange:s,replaceUrl:o}}=t;return this.hooks.afterPreactivation(e,{navigationId:n,appliedUrlTree:i,rawUrlTree:r,skipLocationChange:!!s,replaceUrl:!!o})}),(0,he.U)(t=>{const e=function(t,e,n){const i=ir(t,e._root,n?n._root:void 0);return new Zi(i,e)}(this.routeReuseStrategy,t.targetSnapshot,t.currentRouterState);return Object.assign(Object.assign({},t),{targetRouterState:e})}),(0,zn.b)(t=>{this.currentUrlTree=t.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl),this.routerState=t.targetRouterState,"deferred"===this.urlUpdateStrategy&&(t.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,t),this.browserUrlTree=t.urlAfterRedirects)}),(s=this.rootContexts,o=this.routeReuseStrategy,a=t=>this.triggerEvent(t),(0,he.U)(t=>(new yr(o,t.targetRouterState,t.currentRouterState,a).activate(s),t))),(0,zn.b)({next(){n=!0},complete(){n=!0}}),(r=()=>{n||i||this.cancelNavigationTransition(t,`Navigation ID ${t.id} is not equal to the current navigation id ${this.navigationId}`),this.currentNavigation=null},t=>t.lift(new Hn(r))),wn(n=>{if(i=!0,(r=n)&&r.ngNavigationCancelingError){const i=br(n.url);i||(this.navigated=!0,this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl));const r=new Wn(t.id,this.serializeUrl(t.extractedUrl),n.message);e.next(r),i?setTimeout(()=>{const e=this.urlHandlingStrategy.merge(n.url,this.rawUrlTree);this.scheduleNavigation(e,"imperative",null,{skipLocationChange:t.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy},{resolve:t.resolve,reject:t.reject,promise:t.promise})},0):t.resolve(!1)}else{this.resetStateAndUrl(t.currentRouterState,t.currentUrlTree,t.rawUrl);const i=new qn(t.id,this.serializeUrl(t.extractedUrl),n);e.next(i);try{t.resolve(this.errorHandler(n))}catch(s){t.reject(s)}}var r;return ln.E}));var r,s,o,a}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}getTransition(){const t=this.transitions.value;return t.urlAfterRedirects=this.browserUrlTree,t}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const e=this.extractLocationChangeInfoFromEvent(t);this.shouldScheduleNavigation(this.lastLocationChangeInfo,e)&&setTimeout(()=>{const{source:t,state:n,urlTree:i}=e,r={replaceUrl:!0};if(n){const t=Object.assign({},n);delete t.navigationId,delete t.\u0275routerPageId,0!==Object.keys(t).length&&(r.state=t)}this.scheduleNavigation(i,t,n,r)},0),this.lastLocationChangeInfo=e}))}extractLocationChangeInfoFromEvent(t){var e;return{source:"popstate"===t.type?"popstate":"hashchange",urlTree:this.parseUrl(t.url),state:(null===(e=t.state)||void 0===e?void 0:e.navigationId)?t.state:null,transitionId:this.getTransition().id}}shouldScheduleNavigation(t,e){if(!t)return!0;const n=e.urlTree.toString()===t.urlTree.toString();return!(e.transitionId===t.transitionId&&n&&("hashchange"===e.source&&"popstate"===t.source||"popstate"===e.source&&"hashchange"===t.source))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){Sr(t),this.config=t.map(Ar),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,e={}){const{relativeTo:n,queryParams:i,fragment:r,queryParamsHandling:s,preserveFragment:o}=e,a=n||this.routerState.root,l=o?this.currentUrlTree.fragment:r;let c=null;switch(s){case"merge":c=Object.assign(Object.assign({},this.currentUrlTree.queryParams),i);break;case"preserve":c=this.currentUrlTree.queryParams;break;default:c=i||null}return null!==c&&(c=this.removeEmptyProps(c)),function(t,e,n,i,r){if(0===n.length)return ar(e.root,e.root,e,i,r);const s=function(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new cr(!0,0,t);let e=0,n=!1;const i=t.reduce((t,i,r)=>{if("object"==typeof i&&null!=i){if(i.outlets){const e={};return fi(i.outlets,(t,n)=>{e[n]="string"==typeof t?t.split("/"):t}),[...t,{outlets:e}]}if(i.segmentPath)return[...t,i.segmentPath]}return"string"!=typeof i?[...t,i]:0===r?(i.split("/").forEach((i,r)=>{0==r&&"."===i||(0==r&&""===i?n=!0:".."===i?e++:""!=i&&t.push(i))}),t):[...t,i]},[]);return new cr(n,e,i)}(n);if(s.toRoot())return ar(e.root,new Ci([],{}),e,i,r);const o=function(t,e,n){if(t.isAbsolute)return new ur(e.root,!0,0);if(-1===n.snapshot._lastPathIndex){const t=n.snapshot._urlSegment;return new ur(t,t===e.root,0)}const i=sr(t.commands[0])?0:1;return function(t,e,n){let i=t,r=e,s=n;for(;s>r;){if(s-=r,i=i.parent,!i)throw new Error("Invalid number of '../'");r=i.segments.length}return new ur(i,!1,r-s)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+i,t.numberOfDoubleDots)}(s,e,t),a=o.processChildren?dr(o.segmentGroup,o.index,s.commands):hr(o.segmentGroup,o.index,s.commands);return ar(o.segmentGroup,a,e,i,r)}(a,this.currentUrlTree,t,c,null!=l?l:null)}navigateByUrl(t,e={skipLocationChange:!1}){const n=br(t)?t:this.parseUrl(t),i=this.urlHandlingStrategy.merge(n,this.rawUrlTree);let r=null;return"computed"===this.canceledNavigationResolution&&(0===this.currentPageId||e.skipLocationChange||e.replaceUrl)&&(r=this.location.getState()),this.scheduleNavigation(i,"imperative",r,e)}navigate(t,e={skipLocationChange:!1}){return function(t){for(let e=0;e<t.length;e++){const n=t[e];if(null==n)throw new Error(`The requested path contains ${n} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,e),e)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let e;try{e=this.urlSerializer.parse(t)}catch(n){e=this.malformedUriErrorHandler(n,this.urlSerializer,t)}return e}isActive(t,e){let n;if(n=!0===e?Object.assign({},ms):!1===e?Object.assign({},gs):e,br(t))return vi(this.currentUrlTree,t,n);const i=this.parseUrl(t);return vi(this.currentUrlTree,i,n)}removeEmptyProps(t){return Object.keys(t).reduce((e,n)=>{const i=t[n];return null!=i&&(e[n]=i),e},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new jn(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn("Unhandled Navigation Error: ")})}scheduleNavigation(t,e,n,i,r){if(this.disposed)return Promise.resolve(!1);const s=this.getTransition(),o="imperative"!==e&&"imperative"===(null==s?void 0:s.source),a=(this.lastSuccessfulId===s.id||this.currentNavigation?s.rawUrl:s.urlAfterRedirects).toString()===t.toString();if(o&&a)return Promise.resolve(!0);let l,c,u;r?(l=r.resolve,c=r.reject,u=r.promise):u=new Promise((t,e)=>{l=t,c=e});const h=++this.navigationId;let d;return d="computed"===this.canceledNavigationResolution?n&&n.\u0275routerPageId?n.\u0275routerPageId:this.currentPageId+1:0,this.setTransition({id:h,targetPageId:d,source:e,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:i,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(t=>Promise.reject(t))}setBrowserUrl(t,e){const n=this.urlSerializer.serialize(t),i=Object.assign(Object.assign({},e.extras.state),this.generateNgRouterState(e.id,e.targetPageId));this.location.isCurrentPathEqualTo(n)||e.extras.replaceUrl?this.location.replaceState(n,"",i):this.location.go(n,"",i)}resetStateAndUrl(t,e,n){this.routerState=t,this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,e){"computed"===this.canceledNavigationResolution?"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy||this.location.historyGo(this.currentPageId-t.targetPageId):this.resetUrlToCurrentUrlTree();const n=new Wn(t.id,this.serializeUrl(t.extractedUrl),e);this.triggerEvent(n),t.resolve(!1)}generateNgRouterState(t,e){return"computed"===this.canceledNavigationResolution?{navigationId:t,"\u0275routerPageId":e}:{navigationId:t}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.DyG),i.LFG(Mi),i.LFG(us),i.LFG(b),i.LFG(i.zs3),i.LFG(i.v3s),i.LFG(i.Sil),i.LFG(void 0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),vs=(()=>{class t{constructor(t,e,n,r,s){this.parentContexts=t,this.location=e,this.resolver=n,this.changeDetector=s,this.activated=null,this._activatedRoute=null,this.activateEvents=new i.vpe,this.deactivateEvents=new i.vpe,this.name=r||si,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,t}attach(t,e){this.activated=t,this._activatedRoute=e,this.location.insert(t.hostView)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,e){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const n=(e=e||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),i=this.parentContexts.getOrCreateContext(this.name).children,r=new _s(t,i,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,r),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(us),i.Y36(i.s_b),i.Y36(i._Vd),i.$8M("name"),i.Y36(i.sBO))},t.\u0275dir=i.lG2({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),t})();class _s{constructor(t,e,n){this.route=t,this.childContexts=e,this.parent=n}get(t,e){return t===Xi?this.route:t===us?this.childContexts:this.parent.get(t,e)}}class xs{}class bs{preload(t,e){return(0,ie.of)(null)}}let ws=(()=>{class t{constructor(t,e,n,i,r){this.router=t,this.injector=i,this.preloadingStrategy=r,this.loader=new ls(e,n,e=>t.triggerEvent(new Qn(e)),e=>t.triggerEvent(new Kn(e)))}setUpPreloading(){this.subscription=this.router.events.pipe(le(t=>t instanceof jn),oe(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(i.h0i);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,e){const n=[];for(const i of e)if(i.loadChildren&&!i.canLoad&&i._loadedConfig){const t=i._loadedConfig;n.push(this.processRoutes(t.module,t.routes))}else i.loadChildren&&!i.canLoad?n.push(this.preloadConfig(t,i)):i.children&&n.push(this.processRoutes(t,i.children));return(0,je.D)(n).pipe((0,on.J)(),(0,he.U)(t=>{}))}preloadConfig(t,e){return this.preloadingStrategy.preload(e,()=>(e._loadedConfig?(0,ie.of)(e._loadedConfig):this.loader.load(t.injector,e)).pipe((0,se.zg)(t=>(e._loadedConfig=t,this.processRoutes(t.module,t.routes)))))}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(ys),i.LFG(i.v3s),i.LFG(i.Sil),i.LFG(i.zs3),i.LFG(xs))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),Cs=(()=>{class t{constructor(t,e,n={}){this.router=t,this.viewportScroller=e,this.options=n,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},n.scrollPositionRestoration=n.scrollPositionRestoration||"disabled",n.anchorScrolling=n.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Gn?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof jn&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof ri&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,e){this.router.triggerEvent(new ri(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,e))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(ys),i.LFG(Ct),i.LFG(void 0))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();const Ts=new i.OlP("ROUTER_CONFIGURATION"),Ss=new i.OlP("ROUTER_FORROOT_GUARD"),Ms=[b,{provide:Mi,useClass:Ei},{provide:ys,useFactory:function(t,e,n,i,r,s,o,a={},l,c){const u=new ys(null,t,e,n,i,r,s,di(o));return l&&(u.urlHandlingStrategy=l),c&&(u.routeReuseStrategy=c),function(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy)}(a,u),a.enableTracing&&u.events.subscribe(t=>{var e,n;null===(e=console.group)||void 0===e||e.call(console,`Router Event: ${t.constructor.name}`),console.log(t.toString()),console.log(t),null===(n=console.groupEnd)||void 0===n||n.call(console)}),u},deps:[Mi,us,b,i.zs3,i.v3s,i.Sil,as,Ts,[class{},new i.FiY],[class{},new i.FiY]]},us,{provide:Xi,useFactory:function(t){return t.routerState.root},deps:[ys]},{provide:i.v3s,useClass:i.EAV},ws,bs,class{preload(t,e){return e().pipe(wn(()=>(0,ie.of)(null)))}},{provide:Ts,useValue:{enableTracing:!1}}];function Es(){return new i.PXZ("Router",ys)}let As=(()=>{class t{constructor(t,e){}static forRoot(e,n){return{ngModule:t,providers:[Ms,Rs(e),{provide:Ss,useFactory:Ls,deps:[[ys,new i.FiY,new i.tp0]]},{provide:Ts,useValue:n||{}},{provide:g,useFactory:Ps,deps:[a,[new i.tBr(v),new i.FiY],Ts]},{provide:Cs,useFactory:Ds,deps:[ys,Ct,Ts]},{provide:xs,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:bs},{provide:i.PXZ,multi:!0,useFactory:Es},[Is,{provide:i.ip1,multi:!0,useFactory:Ns,deps:[Is]},{provide:Os,useFactory:ks,deps:[Is]},{provide:i.tb,multi:!0,useExisting:Os}]]}}static forChild(e){return{ngModule:t,providers:[Rs(e)]}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Ss,8),i.LFG(ys,8))},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})();function Ds(t,e,n){return n.scrollOffset&&e.setOffset(n.scrollOffset),new Cs(t,e,n)}function Ps(t,e,n={}){return n.useHash?new x(t,e):new _(t,e)}function Ls(t){return"guarded"}function Rs(t){return[{provide:i.deG,multi:!0,useValue:t},{provide:as,multi:!0,useValue:t}]}let Is=(()=>{class t{constructor(t){this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new We.xQ}appInitializer(){return this.injector.get(c,Promise.resolve(null)).then(()=>{let t=null;const e=new Promise(e=>t=e),n=this.injector.get(ys),i=this.injector.get(Ts);return"disabled"===i.initialNavigation?(n.setUpLocationChangeListener(),t(!0)):"enabled"===i.initialNavigation||"enabledBlocking"===i.initialNavigation?(n.hooks.afterPreactivation=()=>this.initNavigation?(0,ie.of)(null):(this.initNavigation=!0,t(!0),this.resultOfPreactivationDone),n.initialNavigation()):t(!0),e})}bootstrapListener(t){const e=this.injector.get(Ts),n=this.injector.get(ws),r=this.injector.get(Cs),s=this.injector.get(ys),o=this.injector.get(i.z2F);t===o.components[0]&&("enabledNonBlocking"!==e.initialNavigation&&void 0!==e.initialNavigation||s.initialNavigation(),n.setUpPreloading(),r.init(),s.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(i.zs3))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})();function Ns(t){return t.appInitializer.bind(t)}function ks(t){return t.bootstrapListener.bind(t)}const Os=new i.OlP("Router Initializer");function zs(t,e,n,i,r,s,o){try{var a=t[s](o),l=a.value}catch(c){return void n(c)}a.done?e(l):Promise.resolve(l).then(i,r)}function Fs(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var s=t.apply(e,n);function o(t){zs(s,i,r,o,a,"next",t)}function a(t){zs(s,i,r,o,a,"throw",t)}o(void 0)})}}function Us(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Hs(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var Bs,Vs,Gs,js,Ws,qs,Zs,Ys,Xs,Js,$s,Qs,Ks,to={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},eo={duration:.5,overwrite:!1,delay:0},no=1e8,io=1e-8,ro=2*Math.PI,so=ro/4,oo=0,ao=Math.sqrt,lo=Math.cos,co=Math.sin,uo=function(t){return"string"==typeof t},ho=function(t){return"function"==typeof t},po=function(t){return"number"==typeof t},fo=function(t){return void 0===t},mo=function(t){return"object"==typeof t},go=function(t){return!1!==t},yo=function(){return"undefined"!=typeof window},vo=function(t){return ho(t)||uo(t)},_o="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},xo=Array.isArray,bo=/(?:-?\.?\d|\.)+/gi,wo=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Co=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,To=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,So=/[+-]=-?[.\d]+/,Mo=/[^,'"\[\]\s]+/gi,Eo=/[\d.+\-=]+(?:e[-+]\d*)*/i,Ao={},Do={},Po=function(t){return(Do=ea(t,Ao))&&Bl},Lo=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Ro=function(t,e){return!e&&console.warn(t)},Io=function(t,e){return t&&(Ao[t]=e)&&Do&&(Do[t]=e)||Ao},No=function(){return 0},ko={},Oo=[],zo={},Fo={},Uo={},Ho=30,Bo=[],Vo="",Go=function(t){var e,n,i=t[0];if(mo(i)||ho(i)||(t=[t]),!(e=(i._gsap||{}).harness)){for(n=Bo.length;n--&&!Bo[n].targetTest(i););e=Bo[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new dl(t[n],e)))||t.splice(n,1);return t},jo=function(t){return t._gsap||Go(La(t))[0]._gsap},Wo=function(t,e,n){return(n=t[e])&&ho(n)?t[e]():fo(n)&&t.getAttribute&&t.getAttribute(e)||n},qo=function(t,e){return(t=t.split(",")).forEach(e)||t},Zo=function(t){return Math.round(1e5*t)/1e5||0},Yo=function(t,e){for(var n=e.length,i=0;t.indexOf(e[i])<0&&++i<n;);return i<n},Xo=function(){var t,e,n=Oo.length,i=Oo.slice(0);for(zo={},Oo.length=0,t=0;t<n;t++)(e=i[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},Jo=function(t,e,n,i){Oo.length&&Xo(),t.render(e,n,i),Oo.length&&Xo()},$o=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(Mo).length<2?e:uo(t)?t.trim():t},Qo=function(t){return t},Ko=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},ta=function(t,e){for(var n in e)n in t||"duration"===n||"ease"===n||(t[n]=e[n])},ea=function(t,e){for(var n in e)t[n]=e[n];return t},na=function t(e,n){for(var i in n)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=mo(n[i])?t(e[i]||(e[i]={}),n[i]):n[i]);return e},ia=function(t,e){var n,i={};for(n in t)n in e||(i[n]=t[n]);return i},ra=function(t){var e=t.parent||Vs,n=t.keyframes?ta:Ko;if(go(t.inherit))for(;e;)n(t,e.vars.defaults),e=e.parent||e._dp;return t},sa=function(t,e,n,i){void 0===n&&(n="_first"),void 0===i&&(i="_last");var r=e._prev,s=e._next;r?r._next=s:t[n]===e&&(t[n]=s),s?s._prev=r:t[i]===e&&(t[i]=r),e._next=e._prev=e.parent=null},oa=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove(t),t._act=0},aa=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},la=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},ca=function t(e){return!e||e._ts&&t(e.parent)},ua=function(t){return t._repeat?ha(t._tTime,t=t.duration()+t._rDelay)*t:0},ha=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},da=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},pa=function(t){return t._end=Zo(t._start+(t._tDur/Math.abs(t._ts||t._rts||io)||0))},fa=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=Zo(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),pa(t),n._dirty||aa(n,t)),t},ma=function(t,e){var n;if((e._time||e._initted&&!e._dur)&&(n=da(t.rawTime(),e),(!e._dur||Ea(0,e.totalDuration(),n)-e._tTime>io)&&e.render(n,!0)),aa(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},ga=function(t,e,n,i){return e.parent&&oa(e),e._start=Zo((po(n)?n:n||t!==Vs?Ta(t,n,e):t._time)+e._delay),e._end=Zo(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),function(t,e,n,i,r){void 0===n&&(n="_first"),void 0===i&&(i="_last");var s,o=t[i];if(r)for(s=e[r];o&&o[r]>s;)o=o._prev;o?(e._next=o._next,o._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[i]=e,e._prev=o,e.parent=e._dp=t}(t,e,"_first","_last",t._sort?"_start":0),xa(e)||(t._recent=e),i||ma(t,e),t},ya=function(t,e){return(Ao.ScrollTrigger||Lo("scrollTrigger",e))&&Ao.ScrollTrigger.create(e,t)},va=function(t,e,n,i){return _l(t,e),t._initted?!n&&t._pt&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&Zs!==Ka.frame?(Oo.push(t),t._lazy=[e,i],1):void 0:1},_a=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},xa=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},ba=function(t,e,n,i){var r=t._repeat,s=Zo(e)||0,o=t._tTime/t._tDur;return o&&!i&&(t._time*=s/t._dur),t._dur=s,t._tDur=r?r<0?1e10:Zo(s*(r+1)+t._rDelay*r):s,o&&!i?fa(t,t._tTime=t._tDur*o):t.parent&&pa(t),n||aa(t.parent,t),t},wa=function(t){return t instanceof fl?aa(t):ba(t,t._dur)},Ca={_start:0,endTime:No,totalDuration:No},Ta=function t(e,n,i){var r,s,o,a=e.labels,l=e._recent||Ca,c=e.duration()>=no?l.endTime(!1):e._dur;return uo(n)&&(isNaN(n)||n in a)?(s=n.charAt(0),o="%"===n.substr(-1),r=n.indexOf("="),"<"===s||">"===s?(r>=0&&(n=n.replace(/=/,"")),("<"===s?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(r<0?l:i).totalDuration()/100:1)):r<0?(n in a||(a[n]=c),a[n]):(s=parseFloat(n.charAt(r-1)+n.substr(r+1)),o&&i&&(s=s/100*(xo(i)?i[0]:i).totalDuration()),r>1?t(e,n.substr(0,r-1),i)+s:c+s)):null==n?c:+n},Sa=function(t,e,n){var i,r,s=po(e[1]),o=(s?2:1)+(t<2?0:1),a=e[o];if(s&&(a.duration=e[1]),a.parent=n,t){for(i=a,r=n;r&&!("immediateRender"in i);)i=r.vars.defaults||{},r=go(r.vars.inherit)&&r.parent;a.immediateRender=go(i.immediateRender),t<2?a.runBackwards=1:a.startAt=e[o-1]}return new Cl(e[0],a,e[o+1])},Ma=function(t,e){return t||0===t?e(t):e},Ea=function(t,e,n){return n<t?t:n>e?e:n},Aa=function(t){if("string"!=typeof t)return"";var e=Eo.exec(t);return e?t.substr(e.index+e[0].length):""},Da=[].slice,Pa=function(t,e){return t&&mo(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&mo(t[0]))&&!t.nodeType&&t!==Gs},La=function(t,e,n){return!uo(t)||n||!js&&tl()?xo(t)?function(t,e,n){return void 0===n&&(n=[]),t.forEach(function(t){var i;return uo(t)&&!e||Pa(t,1)?(i=n).push.apply(i,La(t)):n.push(t)})||n}(t,n):Pa(t)?Da.call(t,0):t?[t]:[]:Da.call((e||Ws).querySelectorAll(t),0)},Ra=function(t){return t.sort(function(){return.5-Math.random()})},Ia=function(t){if(ho(t))return t;var e=mo(t)?t:{each:t},n=al(e.ease),i=e.from||0,r=parseFloat(e.base)||0,s={},o=i>0&&i<1,a=isNaN(i)||o,l=e.axis,c=i,u=i;return uo(i)?c=u={center:.5,edges:.5,end:1}[i]||0:!o&&a&&(c=i[0],u=i[1]),function(t,o,h){var d,p,f,m,g,y,v,_,x,b=(h||e).length,w=s[b];if(!w){if(!(x="auto"===e.grid?0:(e.grid||[1,no])[1])){for(v=-no;v<(v=h[x++].getBoundingClientRect().left)&&x<b;);x--}for(w=s[b]=[],d=a?Math.min(x,b)*c-.5:i%x,p=a?b*u/x-.5:i/x|0,v=0,_=no,y=0;y<b;y++)f=y%x-d,m=p-(y/x|0),w[y]=g=l?Math.abs("y"===l?m:f):ao(f*f+m*m),g>v&&(v=g),g<_&&(_=g);"random"===i&&Ra(w),w.max=v-_,w.min=_,w.v=b=(parseFloat(e.amount)||parseFloat(e.each)*(x>b?b-1:l?"y"===l?b/x:x:Math.max(x,b/x))||0)*("edges"===i?-1:1),w.b=b<0?r-b:r,w.u=Aa(e.amount||e.each)||0,n=n&&b<0?sl(n):n}return b=(w[t]-w.min)/w.max||0,Zo(w.b+(n?n(b):b)*w.v)+w.u}},Na=function(t){var e=t<1?Math.pow(10,(t+"").length-2):1;return function(n){var i=Math.round(parseFloat(n)/t)*t*e;return(i-i%1)/e+(po(n)?0:Aa(n))}},ka=function(t,e){var n,i,r=xo(t);return!r&&mo(t)&&(n=r=t.radius||no,t.values?(t=La(t.values),(i=!po(t[0]))&&(n*=n)):t=Na(t.increment)),Ma(e,r?ho(t)?function(e){return i=t(e),Math.abs(i-e)<=n?i:e}:function(e){for(var r,s,o=parseFloat(i?e.x:e),a=parseFloat(i?e.y:0),l=no,c=0,u=t.length;u--;)(r=i?(r=t[u].x-o)*r+(s=t[u].y-a)*s:Math.abs(t[u]-o))<l&&(l=r,c=u);return c=!n||l<=n?t[c]:e,i||c===e||po(e)?c:c+Aa(e)}:Na(t))},Oa=function(t,e,n,i){return Ma(xo(t)?!e:!0===n?!!(n=0):!i,function(){return xo(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*i)/i})},za=function(t,e,n){return Ma(n,function(n){return t[~~e(n)]})},Fa=function(t){for(var e,n,i,r,s=0,o="";~(e=t.indexOf("random(",s));)i=t.indexOf(")",e),r="["===t.charAt(e+7),n=t.substr(e+7,i-e-7).match(r?Mo:bo),o+=t.substr(s,e-s)+Oa(r?n:+n[0],r?0:+n[1],+n[2]||1e-5),s=i+1;return o+t.substr(s,t.length-s)},Ua=function(t,e,n,i,r){var s=e-t,o=i-n;return Ma(r,function(e){return n+((e-t)/s*o||0)})},Ha=function(t,e,n){var i,r,s,o=t.labels,a=no;for(i in o)(r=o[i]-e)<0==!!n&&r&&a>(r=Math.abs(r))&&(s=i,a=r);return s},Ba=function(t,e,n){var i,r,s=t.vars,o=s[e];if(o)return i=s[e+"Params"],r=s.callbackScope||t,n&&Oo.length&&Xo(),i?o.apply(r,i):o.call(r)},Va=function(t){return oa(t),t.scrollTrigger&&t.scrollTrigger.kill(!1),t.progress()<1&&Ba(t,"onInterrupt"),t},Ga=function(t){var e=(t=!t.name&&t.default||t).name,n=ho(t),i=e&&!n&&t.init?function(){this._props=[]}:t,r={init:No,render:Rl,add:yl,kill:Nl,modifier:Il,rawVars:0},s={targetTest:0,get:0,getSetter:Al,aliases:{},register:0};if(tl(),t!==i){if(Fo[e])return;Ko(i,Ko(ia(t,r),s)),ea(i.prototype,ea(r,ia(t,s))),Fo[i.prop=e]=i,t.targetTest&&(Bo.push(i),ko[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Io(e,i),t.register&&t.register(Bl,i,zl)},ja=255,Wa={aqua:[0,ja,ja],lime:[0,ja,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,ja],navy:[0,0,128],white:[ja,ja,ja],olive:[128,128,0],yellow:[ja,ja,0],orange:[ja,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[ja,0,0],pink:[ja,192,203],cyan:[0,ja,ja],transparent:[ja,ja,ja,0]},qa=function(t,e,n){return(6*(t=t<0?t+1:t>1?t-1:t)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*ja+.5|0},Za=function(t,e,n){var i,r,s,o,a,l,c,u,h,d,p=t?po(t)?[t>>16,t>>8&ja,t&ja]:0:Wa.black;if(!p){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),Wa[t])p=Wa[t];else if("#"===t.charAt(0)){if(t.length<6&&(i=t.charAt(1),r=t.charAt(2),s=t.charAt(3),t="#"+i+i+r+r+s+s+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(p=parseInt(t.substr(1,6),16))>>16,p>>8&ja,p&ja,parseInt(t.substr(7),16)/255];p=[(t=parseInt(t.substr(1),16))>>16,t>>8&ja,t&ja]}else if("hsl"===t.substr(0,3))if(p=d=t.match(bo),e){if(~t.indexOf("="))return p=t.match(wo),n&&p.length<4&&(p[3]=1),p}else o=+p[0]%360/360,a=+p[1]/100,i=2*(l=+p[2]/100)-(r=l<=.5?l*(a+1):l+a-l*a),p.length>3&&(p[3]*=1),p[0]=qa(o+1/3,i,r),p[1]=qa(o,i,r),p[2]=qa(o-1/3,i,r);else p=t.match(bo)||Wa.transparent;p=p.map(Number)}return e&&!d&&(i=p[0]/ja,r=p[1]/ja,s=p[2]/ja,l=((c=Math.max(i,r,s))+(u=Math.min(i,r,s)))/2,c===u?o=a=0:(h=c-u,a=l>.5?h/(2-c-u):h/(c+u),o=c===i?(r-s)/h+(r<s?6:0):c===r?(s-i)/h+2:(i-r)/h+4,o*=60),p[0]=~~(o+.5),p[1]=~~(100*a+.5),p[2]=~~(100*l+.5)),n&&p.length<4&&(p[3]=1),p},Ya=function(t){var e=[],n=[],i=-1;return t.split(Ja).forEach(function(t){var r=t.match(Co)||[];e.push.apply(e,r),n.push(i+=r.length+1)}),e.c=n,e},Xa=function(t,e,n){var i,r,s,o,a="",l=(t+a).match(Ja),c=e?"hsla(":"rgba(",u=0;if(!l)return t;if(l=l.map(function(t){return(t=Za(t,e,1))&&c+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"}),n&&(s=Ya(t),(i=n.c).join(a)!==s.c.join(a)))for(o=(r=t.replace(Ja,"1").split(Co)).length-1;u<o;u++)a+=r[u]+(~i.indexOf(u)?l.shift()||c+"0,0,0,0)":(s.length?s:l.length?l:n).shift());if(!r)for(o=(r=t.split(Ja)).length-1;u<o;u++)a+=r[u]+l[u];return a+r[o]},Ja=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in Wa)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),$a=/hsl[a]?\(/,Qa=function(t){var e,n=t.join(" ");if(Ja.lastIndex=0,Ja.test(n))return e=$a.test(n),t[1]=Xa(t[1],e),t[0]=Xa(t[0],e,Ya(t[1])),!0},Ka=function(){var t,e,n,i,r,s,o=Date.now,a=500,l=33,c=o(),u=c,h=1e3/240,d=h,p=[],f=function n(f){var m,g,y,v,_=o()-u,x=!0===f;if(_>a&&(c+=_-l),((m=(y=(u+=_)-c)-d)>0||x)&&(v=++i.frame,r=y-1e3*i.time,i.time=y/=1e3,d+=m+(m>=h?4:h-m),g=1),x||(t=e(n)),g)for(s=0;s<p.length;s++)p[s](y,r,v,f)};return i={time:0,frame:0,tick:function(){f(!0)},deltaRatio:function(t){return r/(1e3/(t||60))},wake:function(){qs&&(!js&&yo()&&(Gs=js=window,Ws=Gs.document||{},Ao.gsap=Bl,(Gs.gsapVersions||(Gs.gsapVersions=[])).push(Bl.version),Po(Do||Gs.GreenSockGlobals||!Gs.gsap&&Gs||{}),n=Gs.requestAnimationFrame),t&&i.sleep(),e=n||function(t){return setTimeout(t,d-1e3*i.time+1|0)},Xs=1,f(2))},sleep:function(){(n?Gs.cancelAnimationFrame:clearTimeout)(t),Xs=0,e=No},lagSmoothing:function(t,e){a=t||1e8,l=Math.min(e,a,0)},fps:function(t){d=1e3*i.time+(h=1e3/(t||240))},add:function(t){p.indexOf(t)<0&&p.push(t),tl()},remove:function(t){var e;~(e=p.indexOf(t))&&p.splice(e,1)&&s>=e&&s--},_listeners:p}}(),tl=function(){return!Xs&&Ka.wake()},el={},nl=/^[\d.\-M][\d.\-,\s]/,il=/["']/g,rl=function(t){for(var e,n,i,r={},s=t.substr(1,t.length-3).split(":"),o=s[0],a=1,l=s.length;a<l;a++)n=s[a],e=a!==l-1?n.lastIndexOf(","):n.length,i=n.substr(0,e),r[o]=isNaN(i)?i.replace(il,"").trim():+i,o=n.substr(e+1).trim();return r},sl=function(t){return function(e){return 1-t(1-e)}},ol=function t(e,n){for(var i,r=e._first;r;)r instanceof fl?t(r,n):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===n||(r.timeline?t(r.timeline,n):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=n)),r=r._next},al=function(t,e){return t&&(ho(t)?t:el[t]||function(t){var e,n,i,r,s=(t+"").split("("),o=el[s[0]];return o&&s.length>1&&o.config?o.config.apply(null,~t.indexOf("{")?[rl(s[1])]:(e=t,n=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",n),e.substring(n,~r&&r<i?e.indexOf(")",i+1):i)).split(",").map($o)):el._CE&&nl.test(t)?el._CE("",t):o}(t))||e},ll=function(t,e,n,i){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===i&&(i=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var r,s={easeIn:e,easeOut:n,easeInOut:i};return qo(t,function(t){for(var e in el[t]=Ao[t]=s,el[r=t.toLowerCase()]=n,s)el[r+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=el[t+"."+e]=s[e]}),s},cl=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},ul=function t(e,n,i){var r=n>=1?n:1,s=(i||(e?.3:.45))/(n<1?n:1),o=s/ro*(Math.asin(1/r)||0),a=function(t){return 1===t?1:r*Math.pow(2,-10*t)*co((t-o)*s)+1},l="out"===e?a:"in"===e?function(t){return 1-a(1-t)}:cl(a);return s=ro/s,l.config=function(n,i){return t(e,n,i)},l},hl=function t(e,n){void 0===n&&(n=1.70158);var i=function(t){return t?--t*t*((n+1)*t+n)+1:0},r="out"===e?i:"in"===e?function(t){return 1-i(1-t)}:cl(i);return r.config=function(n){return t(e,n)},r};qo("Linear,Quad,Cubic,Quart,Quint,Strong",function(t,e){var n=e<5?e+1:e;ll(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},function(t){return 1-Math.pow(1-t,n)},function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2})}),el.Linear.easeNone=el.none=el.Linear.easeIn,ll("Elastic",ul("in"),ul("out"),ul()),Js=7.5625,Qs=1/($s=2.75),ll("Bounce",function(t){return 1-Ks(1-t)},Ks=function(t){return t<Qs?Js*t*t:t<.7272727272727273?Js*Math.pow(t-1.5/$s,2)+.75:t<.9090909090909092?Js*(t-=2.25/$s)*t+.9375:Js*Math.pow(t-2.625/$s,2)+.984375}),ll("Expo",function(t){return t?Math.pow(2,10*(t-1)):0}),ll("Circ",function(t){return-(ao(1-t*t)-1)}),ll("Sine",function(t){return 1===t?1:1-lo(t*so)}),ll("Back",hl("in"),hl("out"),hl()),el.SteppedEase=el.steps=Ao.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,i=t+(e?0:1),r=e?1:0;return function(t){return((i*Ea(0,.99999999,t)|0)+r)*n}}},eo.ease=el["quad.out"],qo("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(t){return Vo+=t+","+t+"Params,"});var dl=function(t,e){this.id=oo++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:Wo,this.set=e?e.getSetter:Al},pl=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,ba(this,+t.duration,1,1),this.data=t.data,Xs||Ka.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,ba(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(tl(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(fa(this,t),!n._dp||n.parent||ma(n,this);n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&ga(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===io||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),Jo(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+ua(this))%this._dur||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+ua(this),e):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?ha(this._tTime,n)+1:1},e.timeScale=function(t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var e=this.parent&&this._ts?da(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,la(this.totalTime(Ea(-this._delay,this._tDur,e),!0))},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(tl(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&(this._tTime-=io)&&Math.abs(this._zTime)!==io))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&ga(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(go(t)?this.totalDuration():this.duration())/Math.abs(this._ts)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?da(e.rawTime(t),this):this._tTime:this._tTime},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(e._ts||1),e=e._dp;return n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,wa(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){return arguments.length?(this._rDelay=t,wa(this)):this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(Ta(this,t),go(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,go(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-io))},e.eventCallback=function(t,e,n){var i=this.vars;return arguments.length>1?(e?(i[t]=e,n&&(i[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete i[t],this):i[t]},e.then=function(t){var e=this;return new Promise(function(n){var i=ho(t)?t:Qo,r=function(){var t=e.then;e.then=null,ho(i)&&(i=i(e))&&(i.then||i===e)&&(e.then=t),n(i),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?r():e._prom=r})},e.kill=function(){Va(this)},t}();Ko(pl.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var fl=function(t){function e(e,n){var i;return void 0===e&&(e={}),(i=t.call(this,e)||this).labels={},i.smoothChildTiming=!!e.smoothChildTiming,i.autoRemoveChildren=!!e.autoRemoveChildren,i._sort=go(e.sortChildren),Vs&&ga(e.parent||Vs,Us(i),n),e.reversed&&i.reverse(),e.paused&&i.paused(!0),e.scrollTrigger&&ya(Us(i),e.scrollTrigger),i}Hs(e,t);var n=e.prototype;return n.to=function(t,e,n){return Sa(0,arguments,this),this},n.from=function(t,e,n){return Sa(1,arguments,this),this},n.fromTo=function(t,e,n,i){return Sa(2,arguments,this),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,ra(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Cl(t,e,Ta(this,n),1),this},n.call=function(t,e,n){return ga(this,Cl.delayedCall(0,t,e),n)},n.staggerTo=function(t,e,n,i,r,s,o){return n.duration=e,n.stagger=n.stagger||i,n.onComplete=s,n.onCompleteParams=o,n.parent=this,new Cl(t,n,Ta(this,r)),this},n.staggerFrom=function(t,e,n,i,r,s,o){return n.runBackwards=1,ra(n).immediateRender=go(n.immediateRender),this.staggerTo(t,e,n,i,r,s,o)},n.staggerFromTo=function(t,e,n,i,r,s,o,a){return i.startAt=n,ra(i).immediateRender=go(i.immediateRender),this.staggerTo(t,e,i,r,s,o,a)},n.render=function(t,e,n){var i,r,s,o,a,l,c,u,h,d,p,f,m=this._time,g=this._dirty?this.totalDuration():this._tDur,y=this._dur,v=this!==Vs&&t>g-io&&t>=0?g:t<io?0:t,_=this._zTime<0!=t<0&&(this._initted||!y);if(v!==this._tTime||n||_){if(m!==this._time&&y&&(v+=this._time-m,t+=this._time-m),i=v,h=this._start,l=!(u=this._ts),_&&(y||(m=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(p=this._yoyo,a=y+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*a+t,e,n);if(i=Zo(v%a),v===g?(o=this._repeat,i=y):((o=~~(v/a))&&o===v/a&&(i=y,o--),i>y&&(i=y)),d=ha(this._tTime,a),!m&&this._tTime&&d!==o&&(d=o),p&&1&o&&(i=y-i,f=1),o!==d&&!this._lock){var x=p&&1&d,b=x===(p&&1&o);if(o<d&&(x=!x),m=x?0:y,this._lock=1,this.render(m||(f?0:Zo(o*a)),e,!y)._lock=0,this._tTime=v,!e&&this.parent&&Ba(this,"onRepeat"),this.vars.repeatRefresh&&!f&&(this.invalidate()._lock=1),m&&m!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,g=this._tDur,b&&(this._lock=2,this.render(m=x?y:-1e-4,!0),this.vars.repeatRefresh&&!f&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;ol(this,f)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=function(t,e,n){var i;if(n>e)for(i=t._first;i&&i._start<=n;){if(!i._dur&&"isPause"===i.data&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=n;){if(!i._dur&&"isPause"===i.data&&i._start<e)return i;i=i._prev}}(this,Zo(m),Zo(i)))&&(v-=i-(i=c._start)),this._tTime=v,this._time=i,this._act=!u,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,m=0),!m&&i&&!e&&(Ba(this,"onStart"),this._tTime!==v))return this;if(i>=m&&t>=0)for(r=this._first;r;){if(s=r._next,(r._act||i>=r._start)&&r._ts&&c!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(i-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(i-r._start)*r._ts,e,n),i!==this._time||!this._ts&&!l){c=0,s&&(v+=this._zTime=-1e-8);break}}r=s}else{r=this._last;for(var w=t<0?t:i;r;){if(s=r._prev,(r._act||w<=r._end)&&r._ts&&c!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(w-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(w-r._start)*r._ts,e,n),i!==this._time||!this._ts&&!l){c=0,s&&(v+=this._zTime=w?-1e-8:io);break}}r=s}}if(c&&!e&&(this.pause(),c.render(i>=m?0:-1e-8)._zTime=i>=m?1:-1,this._ts))return this._start=h,pa(this),this.render(t,e,n);this._onUpdate&&!e&&Ba(this,"onUpdate",!0),(v===g&&g>=this.totalDuration()||!v&&m)&&(h!==this._start&&Math.abs(u)===Math.abs(this._ts)||this._lock||((t||!y)&&(v===g&&this._ts>0||!v&&this._ts<0)&&oa(this,1),e||t<0&&!m||!v&&!m&&g||(Ba(this,v===g&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(v<g&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(po(e)||(e=Ta(this,e,t)),!(t instanceof pl)){if(xo(t))return t.forEach(function(t){return n.add(t,e)}),this;if(uo(t))return this.addLabel(t,e);if(!ho(t))return this;t=Cl.delayedCall(0,t)}return this!==t?ga(this,t,e):this},n.getChildren=function(t,e,n,i){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=-no);for(var r=[],s=this._first;s;)s._start>=i&&(s instanceof Cl?e&&r.push(s):(n&&r.push(s),t&&r.push.apply(r,s.getChildren(!0,e,n)))),s=s._next;return r},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return uo(t)?this.removeLabel(t):ho(t)?this.killTweensOf(t):(sa(this,t),t===this._recent&&(this._recent=this._last),aa(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Zo(Ka.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=Ta(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var i=Cl.delayedCall(0,e||No,n);return i.data="isPause",this._hasPause=1,ga(this,i,Ta(this,t))},n.removePause=function(t){var e=this._first;for(t=Ta(this,t);e;)e._start===t&&"isPause"===e.data&&oa(e),e=e._next},n.killTweensOf=function(t,e,n){for(var i=this.getTweensOf(t,n),r=i.length;r--;)ml!==i[r]&&i[r].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,i=[],r=La(t),s=this._first,o=po(e);s;)s instanceof Cl?Yo(s._targets,r)&&(o?(!ml||s._initted&&s._ts)&&s.globalTime(0)<=e&&s.globalTime(s.totalDuration())>e:!e||s.isActive())&&i.push(s):(n=s.getTweensOf(r,e)).length&&i.push.apply(i,n),s=s._next;return i},n.tweenTo=function(t,e){e=e||{};var n,i=this,r=Ta(i,t),s=e.startAt,o=e.onStart,a=e.onStartParams,l=e.immediateRender,c=Cl.to(i,Ko({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:e.duration||Math.abs((r-(s&&"time"in s?s.time:i._time))/i.timeScale())||io,onStart:function(){if(i.pause(),!n){var t=e.duration||Math.abs((r-(s&&"time"in s?s.time:i._time))/i.timeScale());c._dur!==t&&ba(c,t,0,1).render(c._time,!0,!0),n=1}o&&o.apply(c,a||[])}},e));return l?c.render(0):c},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,Ko({startAt:{time:Ta(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),Ha(this,Ta(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),Ha(this,Ta(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+io)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var i,r=this._first,s=this.labels;r;)r._start>=n&&(r._start+=t,r._end+=t),r=r._next;if(e)for(i in s)s[i]>=n&&(s[i]+=t);return aa(this)},n.invalidate=function(){var e=this._first;for(this._lock=0;e;)e.invalidate(),e=e._next;return t.prototype.invalidate.call(this)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),aa(this)},n.totalDuration=function(t){var e,n,i,r=0,s=this,o=s._last,a=no;if(arguments.length)return s.timeScale((s._repeat<0?s.duration():s.totalDuration())/(s.reversed()?-t:t));if(s._dirty){for(i=s.parent;o;)e=o._prev,o._dirty&&o.totalDuration(),(n=o._start)>a&&s._sort&&o._ts&&!s._lock?(s._lock=1,ga(s,o,n-o._delay,1)._lock=0):a=n,n<0&&o._ts&&(r-=n,(!i&&!s._dp||i&&i.smoothChildTiming)&&(s._start+=n/s._ts,s._time-=n,s._tTime-=n),s.shiftChildren(-n,!1,-Infinity),a=0),o._end>r&&o._ts&&(r=o._end),o=e;ba(s,s===Vs&&s._time>r?s._time:r,1,1),s._dirty=0}return s._tDur},e.updateRoot=function(t){if(Vs._ts&&(Jo(Vs,da(t,Vs)),Zs=Ka.frame),Ka.frame>=Ho){Ho+=to.autoSleep||120;var e=Vs._first;if((!e||!e._ts)&&to.autoSleep&&Ka._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||Ka.sleep()}}},e}(pl);Ko(fl.prototype,{_lock:0,_hasPause:0,_forcing:0});var ml,gl=function(t,e,n,i,r,s,o){var a,l,c,u,h,d,p,f,m=new zl(this._pt,t,e,0,1,Ll,null,r),g=0,y=0;for(m.b=n,m.e=i,n+="",(p=~(i+="").indexOf("random("))&&(i=Fa(i)),s&&(s(f=[n,i],t,e),n=f[0],i=f[1]),l=n.match(To)||[];a=To.exec(i);)u=a[0],h=i.substring(g,a.index),c?c=(c+1)%5:"rgba("===h.substr(-5)&&(c=1),u!==l[y++]&&(d=parseFloat(l[y-1])||0,m._pt={_next:m._pt,p:h||1===y?h:",",s:d,c:"="===u.charAt(1)?parseFloat(u.substr(2))*("-"===u.charAt(0)?-1:1):parseFloat(u)-d,m:c&&c<4?Math.round:0},g=To.lastIndex);return m.c=g<i.length?i.substring(g,i.length):"",m.fp=o,(So.test(i)||p)&&(m.e=0),this._pt=m,m},yl=function(t,e,n,i,r,s,o,a,l){ho(i)&&(i=i(r||0,t,s));var c,u=t[e],h="get"!==n?n:ho(u)?l?t[e.indexOf("set")||!ho(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():u,d=ho(u)?l?Ml:Sl:Tl;if(uo(i)&&(~i.indexOf("random(")&&(i=Fa(i)),"="===i.charAt(1)&&((c=parseFloat(h)+parseFloat(i.substr(2))*("-"===i.charAt(0)?-1:1)+(Aa(h)||0))||0===c)&&(i=c)),h!==i)return isNaN(h*i)||""===i?(!u&&!(e in t)&&Lo(e,i),gl.call(this,t,e,h,i,d,a||to.stringFilter,l)):(c=new zl(this._pt,t,e,+h||0,i-(h||0),"boolean"==typeof u?Pl:Dl,0,d),l&&(c.fp=l),o&&c.modifier(o,this,t),this._pt=c)},vl=function(t,e,n,i,r,s){var o,a,l,c;if(Fo[t]&&!1!==(o=new Fo[t]).init(r,o.rawVars?e[t]:function(t,e,n,i,r){if(ho(t)&&(t=xl(t,r,e,n,i)),!mo(t)||t.style&&t.nodeType||xo(t)||_o(t))return uo(t)?xl(t,r,e,n,i):t;var s,o={};for(s in t)o[s]=xl(t[s],r,e,n,i);return o}(e[t],i,r,s,n),n,i,s)&&(n._pt=a=new zl(n._pt,r,t,0,1,o.render,o,0,o.priority),n!==Ys))for(l=n._ptLookup[n._targets.indexOf(r)],c=o._props.length;c--;)l[o._props[c]]=a;return o},_l=function t(e,n){var i,r,s,o,a,l,c,u,h,d,p,f,m,g=e.vars,y=g.ease,v=g.startAt,_=g.immediateRender,x=g.lazy,b=g.onUpdate,w=g.onUpdateParams,C=g.callbackScope,T=g.runBackwards,S=g.yoyoEase,M=g.autoRevert,E=e._dur,A=e._startAt,D=e._targets,P=e.parent,L=P&&"nested"===P.data?P.parent._targets:D,R="auto"===e._overwrite&&!Bs,I=e.timeline;if(I&&(!g.keyframes||!y)&&(y="none"),e._ease=al(y,eo.ease),e._yEase=S?sl(al(!0===S?y:S,eo.ease)):0,S&&e._yoyo&&!e._repeat&&(S=e._yEase,e._yEase=e._ease,e._ease=S),e._from=!I&&!!g.runBackwards,!I){if(f=(u=D[0]?jo(D[0]).harness:0)&&g[u.prop],i=ia(g,ko),A&&A.render(-1,!0).kill(),v)if(oa(e._startAt=Cl.set(D,Ko({data:"isStart",overwrite:!1,parent:P,immediateRender:!0,lazy:go(x),startAt:null,delay:0,onUpdate:b,onUpdateParams:w,callbackScope:C,stagger:0},v))),n<0&&!_&&!M&&e._startAt.render(-1,!0),_){if(n>0&&!M&&(e._startAt=0),E&&n<=0)return void(n&&(e._zTime=n))}else!1===M&&(e._startAt=0);else if(T&&E)if(A)!M&&(e._startAt=0);else if(n&&(_=!1),s=Ko({overwrite:!1,data:"isFromStart",lazy:_&&go(x),immediateRender:_,stagger:0,parent:P},i),f&&(s[u.prop]=f),oa(e._startAt=Cl.set(D,s)),n<0&&e._startAt.render(-1,!0),_){if(!n)return}else t(e._startAt,io);for(e._pt=0,x=E&&go(x)||x&&!E,r=0;r<D.length;r++){if(c=(a=D[r])._gsap||Go(D)[r]._gsap,e._ptLookup[r]=d={},zo[c.id]&&Oo.length&&Xo(),p=L===D?r:L.indexOf(a),u&&!1!==(h=new u).init(a,f||i,e,p,L)&&(e._pt=o=new zl(e._pt,a,h.name,0,1,h.render,h,0,h.priority),h._props.forEach(function(t){d[t]=o}),h.priority&&(l=1)),!u||f)for(s in i)Fo[s]&&(h=vl(s,i,e,p,a,L))?h.priority&&(l=1):d[s]=o=yl.call(e,a,s,"get",i[s],p,L,0,g.stringFilter);e._op&&e._op[r]&&e.kill(a,e._op[r]),R&&e._pt&&(ml=e,Vs.killTweensOf(a,d,e.globalTime(0)),m=!e.parent,ml=0),e._pt&&x&&(zo[c.id]=1)}l&&Ol(e),e._onInit&&e._onInit(e)}e._onUpdate=b,e._initted=(!e._op||e._pt)&&!m},xl=function(t,e,n,i,r){return ho(t)?t.call(e,n,i,r):uo(t)&&~t.indexOf("random(")?Fa(t):t},bl=Vo+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",wl=(bl+",id,stagger,delay,duration,paused,scrollTrigger").split(","),Cl=function(t){function e(e,n,i,r){var s;"number"==typeof n&&(i.duration=n,n=i,i=null);var o,a,l,c,u,h,d,p,f=(s=t.call(this,r?n:ra(n))||this).vars,m=f.duration,g=f.delay,y=f.immediateRender,v=f.stagger,_=f.overwrite,x=f.keyframes,b=f.defaults,w=f.scrollTrigger,C=f.yoyoEase,T=n.parent||Vs,S=(xo(e)||_o(e)?po(e[0]):"length"in n)?[e]:La(e);if(s._targets=S.length?Go(S):Ro("GSAP target "+e+" not found. https://greensock.com",!to.nullTargetWarn)||[],s._ptLookup=[],s._overwrite=_,x||v||vo(m)||vo(g)){if(n=s.vars,(o=s.timeline=new fl({data:"nested",defaults:b||{}})).kill(),o.parent=o._dp=Us(s),o._start=0,x)Ko(o.vars.defaults,{ease:"none"}),v?S.forEach(function(t,e){return x.forEach(function(n,i){return o.to(t,n,i?">":e*v)})}):x.forEach(function(t){return o.to(S,t,">")});else{if(c=S.length,d=v?Ia(v):No,mo(v))for(u in v)~bl.indexOf(u)&&(p||(p={}),p[u]=v[u]);for(a=0;a<c;a++){for(u in l={},n)wl.indexOf(u)<0&&(l[u]=n[u]);l.stagger=0,C&&(l.yoyoEase=C),p&&ea(l,p),h=S[a],l.duration=+xl(m,Us(s),a,h,S),l.delay=(+xl(g,Us(s),a,h,S)||0)-s._delay,!v&&1===c&&l.delay&&(s._delay=g=l.delay,s._start+=g,l.delay=0),o.to(h,l,d(a,h,S))}o.duration()?m=g=0:s.timeline=0}m||s.duration(m=o.duration())}else s.timeline=0;return!0!==_||Bs||(ml=Us(s),Vs.killTweensOf(S),ml=0),ga(T,Us(s),i),n.reversed&&s.reverse(),n.paused&&s.paused(!0),(y||!m&&!x&&s._start===Zo(T._time)&&go(y)&&ca(Us(s))&&"nested"!==T.data)&&(s._tTime=-1e-8,s.render(Math.max(0,-g))),w&&ya(Us(s),w),s}Hs(e,t);var n=e.prototype;return n.render=function(t,e,n){var i,r,s,o,a,l,c,u,h,d=this._time,p=this._tDur,f=this._dur,m=t>p-io&&t>=0?p:t<io?0:t;if(f){if(m!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=t<0){if(i=m,u=this.timeline,this._repeat){if(o=f+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*o+t,e,n);if(i=Zo(m%o),m===p?(s=this._repeat,i=f):((s=~~(m/o))&&s===m/o&&(i=f,s--),i>f&&(i=f)),(l=this._yoyo&&1&s)&&(h=this._yEase,i=f-i),a=ha(this._tTime,o),i===d&&!n&&this._initted)return this;s!==a&&(u&&this._yEase&&ol(u,l),!this.vars.repeatRefresh||l||this._lock||(this._lock=n=1,this.render(Zo(o*s),!0).invalidate()._lock=0))}if(!this._initted){if(va(this,t<0?t:i,n,e))return this._tTime=0,this;if(f!==this._dur)return this.render(t,e,n)}if(this._tTime=m,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=c=(h||this._ease)(i/f),this._from&&(this.ratio=c=1-c),i&&!d&&!e&&Ba(this,"onStart"),i&&!d&&!e&&(Ba(this,"onStart"),this._tTime!==m))return this;for(r=this._pt;r;)r.r(c,r.d),r=r._next;u&&u.render(t<0?t:!i&&l?-1e-8:u._dur*c,e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(t<0&&this._startAt&&this._startAt.render(t,!0,n),Ba(this,"onUpdate")),this._repeat&&s!==a&&this.vars.onRepeat&&!e&&this.parent&&Ba(this,"onRepeat"),m!==this._tDur&&m||this._tTime!==m||(t<0&&this._startAt&&!this._onUpdate&&this._startAt.render(t,!0,!0),(t||!f)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&oa(this,1),e||t<0&&!d||!m&&!d||(Ba(this,m===p?"onComplete":"onReverseComplete",!0),this._prom&&!(m<p&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,i){var r,s,o,a=t.ratio,l=e<0||!e&&(!t._start&&_a(t)&&(t._initted||!xa(t))||(t._ts<0||t._dp._ts<0)&&!xa(t))?0:1,c=t._rDelay,u=0;if(c&&t._repeat&&(u=Ea(0,t._tDur,e),s=ha(u,c),o=ha(t._tTime,c),t._yoyo&&1&s&&(l=1-l),s!==o&&(a=1-l,t.vars.repeatRefresh&&t._initted&&t.invalidate())),l!==a||i||t._zTime===io||!e&&t._zTime){if(!t._initted&&va(t,e,i,n))return;for(o=t._zTime,t._zTime=e||(n?io:0),n||(n=e&&!o),t.ratio=l,t._from&&(l=1-l),t._time=0,t._tTime=u,r=t._pt;r;)r.r(l,r.d),r=r._next;t._startAt&&e<0&&t._startAt.render(e,!0,!0),t._onUpdate&&!n&&Ba(t,"onUpdate"),u&&t._repeat&&!n&&t.parent&&Ba(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===l&&(l&&oa(t,1),n||(Ba(t,l?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),t.prototype.invalidate.call(this)},n.kill=function(t,e){if(void 0===e&&(e="all"),!(t||e&&"all"!==e))return this._lazy=this._pt=0,this.parent?Va(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,ml&&!0!==ml.vars.overwrite)._first||Va(this),this.parent&&n!==this.timeline.totalDuration()&&ba(this,this._dur*this.timeline._tDur/n,0,1),this}var i,r,s,o,a,l,c,u=this._targets,h=t?La(t):u,d=this._ptLookup,p=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,i=n===e.length;i&&n--&&t[n]===e[n];);return n<0}(u,h))return"all"===e&&(this._pt=0),Va(this);for(i=this._op=this._op||[],"all"!==e&&(uo(e)&&(a={},qo(e,function(t){return a[t]=1}),e=a),e=function(t,e){var n,i,r,s,o=t[0]?jo(t[0]).harness:0,a=o&&o.aliases;if(!a)return e;for(i in n=ea({},e),a)if(i in n)for(r=(s=a[i].split(",")).length;r--;)n[s[r]]=n[i];return n}(u,e)),c=u.length;c--;)if(~h.indexOf(u[c]))for(a in r=d[c],"all"===e?(i[c]=e,o=r,s={}):(s=i[c]=i[c]||{},o=e),o)(l=r&&r[a])&&("kill"in l.d&&!0!==l.d.kill(a)||sa(this,l,"_pt"),delete r[a]),"all"!==s&&(s[a]=1);return this._initted&&!this._pt&&p&&Va(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,e){return Sa(1,arguments)},e.delayedCall=function(t,n,i,r){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:r})},e.fromTo=function(t,e,n){return Sa(2,arguments)},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return Vs.killTweensOf(t,e,n)},e}(pl);Ko(Cl.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),qo("staggerTo,staggerFrom,staggerFromTo",function(t){Cl[t]=function(){var e=new fl,n=Da.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}});var Tl=function(t,e,n){return t[e]=n},Sl=function(t,e,n){return t[e](n)},Ml=function(t,e,n,i){return t[e](i.fp,n)},El=function(t,e,n){return t.setAttribute(e,n)},Al=function(t,e){return ho(t[e])?Sl:fo(t[e])&&t.setAttribute?El:Tl},Dl=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},Pl=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},Ll=function(t,e){var n=e._pt,i="";if(!t&&e.b)i=e.b;else if(1===t&&e.e)i=e.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+i,n=n._next;i+=e.c}e.set(e.t,e.p,i,e)},Rl=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},Il=function(t,e,n,i){for(var r,s=this._pt;s;)r=s._next,s.p===i&&s.modifier(t,e,n),s=r},Nl=function(t){for(var e,n,i=this._pt;i;)n=i._next,i.p===t&&!i.op||i.op===t?sa(this,i,"_pt"):i.dep||(e=1),i=n;return!e},kl=function(t,e,n,i){i.mSet(t,e,i.m.call(i.tween,n,i.mt),i)},Ol=function(t){for(var e,n,i,r,s=t._pt;s;){for(e=s._next,n=i;n&&n.pr>s.pr;)n=n._next;(s._prev=n?n._prev:r)?s._prev._next=s:i=s,(s._next=n)?n._prev=s:r=s,s=e}t._pt=i},zl=function(){function t(t,e,n,i,r,s,o,a,l){this.t=e,this.s=i,this.c=r,this.p=n,this.r=s||Dl,this.d=o||this,this.set=a||Tl,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=kl,this.m=t,this.mt=n,this.tween=e},t}();qo(Vo+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(t){return ko[t]=1}),Ao.TweenMax=Ao.TweenLite=Cl,Ao.TimelineLite=Ao.TimelineMax=fl,Vs=new fl({sortChildren:!1,defaults:eo,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),to.stringFilter=Qa;var Fl={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(function(t){return Ga(t)})},timeline:function(t){return new fl(t)},getTweensOf:function(t,e){return Vs.getTweensOf(t,e)},getProperty:function(t,e,n,i){uo(t)&&(t=La(t)[0]);var r=jo(t||{}).get,s=n?Qo:$o;return"native"===n&&(n=""),t?e?s((Fo[e]&&Fo[e].get||r)(t,e,n,i)):function(e,n,i){return s((Fo[e]&&Fo[e].get||r)(t,e,n,i))}:t},quickSetter:function(t,e,n){if((t=La(t)).length>1){var i=t.map(function(t){return Bl.quickSetter(t,e,n)}),r=i.length;return function(t){for(var e=r;e--;)i[e](t)}}var s=Fo[e],o=jo(t=t[0]||{}),a=o.harness&&(o.harness.aliases||{})[e]||e,l=s?function(e){var i=new s;Ys._pt=0,i.init(t,n?e+n:e,Ys,0,[t]),i.render(1,i),Ys._pt&&Rl(1,Ys)}:o.set(t,a);return s?l:function(e){return l(t,a,n?e+n:e,o,1)}},isTweening:function(t){return Vs.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=al(t.ease,eo.ease)),na(eo,t||{})},config:function(t){return na(to,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,i=t.defaults,r=t.extendTimeline;(t.plugins||"").split(",").forEach(function(t){return t&&!Fo[t]&&!Ao[t]&&Ro(e+" effect requires "+t+" plugin.")}),Uo[e]=function(t,e,r){return n(La(t),Ko(e||{},i),r)},r&&(fl.prototype[e]=function(t,n,i){return this.add(Uo[e](t,mo(n)?n:(i=n)&&{},this),i)})},registerEase:function(t,e){el[t]=al(e)},parseEase:function(t,e){return arguments.length?al(t,e):el},getById:function(t){return Vs.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,i,r=new fl(t);for(r.smoothChildTiming=go(t.smoothChildTiming),Vs.remove(r),r._dp=0,r._time=r._tTime=Vs._time,n=Vs._first;n;)i=n._next,!e&&!n._dur&&n instanceof Cl&&n.vars.onComplete===n._targets[0]||ga(r,n,n._start-n._delay),n=i;return ga(Vs,r,0),r},utils:{wrap:function t(e,n,i){var r=n-e;return xo(e)?za(e,t(0,e.length),n):Ma(i,function(t){return(r+(t-e)%r)%r+e})},wrapYoyo:function t(e,n,i){var r=n-e,s=2*r;return xo(e)?za(e,t(0,e.length-1),n):Ma(i,function(t){return e+((t=(s+(t-e)%s)%s||0)>r?s-t:t)})},distribute:Ia,random:Oa,snap:ka,normalize:function(t,e,n){return Ua(t,e,0,1,n)},getUnit:Aa,clamp:function(t,e,n){return Ma(n,function(n){return Ea(t,e,n)})},splitColor:Za,toArray:La,selector:function(t){return t=La(t)[0]||Ro("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return La(e,n.querySelectorAll?n:n===t?Ro("Invalid scope")||Ws.createElement("div"):t)}},mapRange:Ua,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce(function(t,e){return e(t)},t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||Aa(n))}},interpolate:function t(e,n,i,r){var s=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!s){var o,a,l,c,u,h=uo(e),d={};if(!0===i&&(r=1)&&(i=null),h)e={p:e},n={p:n};else if(xo(e)&&!xo(n)){for(l=[],u=(c=e.length)-2,a=1;a<c;a++)l.push(t(e[a-1],e[a]));c--,s=function(t){t*=c;var e=Math.min(u,~~t);return l[e](t-e)},i=n}else r||(e=ea(xo(e)?[]:{},e));if(!l){for(o in n)yl.call(d,e,o,"get",n[o]);s=function(t){return Rl(t,d)||(h?e.p:e)}}}return Ma(i,s)},shuffle:Ra},install:Po,effects:Uo,ticker:Ka,updateRoot:fl.updateRoot,plugins:Fo,globalTimeline:Vs,core:{PropTween:zl,globals:Io,Tween:Cl,Timeline:fl,Animation:pl,getCache:jo,_removeLinkedListItem:sa,suppressOverwrites:function(t){return Bs=t}}};qo("to,from,fromTo,delayedCall,set,killTweensOf",function(t){return Fl[t]=Cl[t]}),Ka.add(fl.updateRoot),Ys=Fl.to({},{duration:0});var Ul=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},Hl=function(t,e){return{name:t,rawVars:1,init:function(t,n,i){i._onInit=function(t){var i,r;if(uo(n)&&(i={},qo(n,function(t){return i[t]=1}),n=i),e){for(r in i={},n)i[r]=e(n[r]);n=i}!function(t,e){var n,i,r,s=t._targets;for(n in e)for(i=s.length;i--;)(r=t._ptLookup[i][n])&&(r=r.d)&&(r._pt&&(r=Ul(r,n)),r&&r.modifier&&r.modifier(e[n],t,s[i],n))}(t,n)}}}},Bl=Fl.registerPlugin({name:"attr",init:function(t,e,n,i,r){var s,o;for(s in e)(o=this.add(t,"setAttribute",(t.getAttribute(s)||0)+"",e[s],i,r,0,0,s))&&(o.op=s),this._props.push(s)}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n])}},Hl("roundProps",Na),Hl("modifiers"),Hl("snap",ka))||Fl;Cl.version=fl.version=Bl.version="3.7.0",qs=1,yo()&&tl();var Vl,Gl,jl,Wl,ql,Zl,Yl,Xl=el.Power1,Jl={},$l=180/Math.PI,Ql=Math.PI/180,Kl=Math.atan2,tc=/([A-Z])/g,ec=/(?:left|right|width|margin|padding|x)/i,nc=/[\s,\(]\S/,ic={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},rc=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},sc=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},oc=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},ac=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},lc=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},cc=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},uc=function(t,e,n){return t.style[e]=n},hc=function(t,e,n){return t.style.setProperty(e,n)},dc=function(t,e,n){return t._gsap[e]=n},pc=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},fc=function(t,e,n,i,r){var s=t._gsap;s.scaleX=s.scaleY=n,s.renderTransform(r,s)},mc=function(t,e,n,i,r){var s=t._gsap;s[e]=n,s.renderTransform(r,s)},gc="transform",yc=gc+"Origin",vc=function(t,e){var n=Gl.createElementNS?Gl.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Gl.createElement(t);return n.style?n:Gl.createElement(t)},_c=function t(e,n,i){var r=getComputedStyle(e);return r[n]||r.getPropertyValue(n.replace(tc,"-$1").toLowerCase())||r.getPropertyValue(n)||!i&&t(e,bc(n)||n,1)||""},xc="O,Moz,ms,Ms,Webkit".split(","),bc=function(t,e,n){var i=(e||ql).style,r=5;if(t in i&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);r--&&!(xc[r]+t in i););return r<0?null:(3===r?"ms":r>=0?xc[r]:"")+t},wc=function(){"undefined"!=typeof window&&window.document&&(Vl=window,jl=(Gl=Vl.document).documentElement,ql=vc("div")||{style:{}},vc("div"),gc=bc(gc),yc=gc+"Origin",ql.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Yl=!!bc("perspective"),Wl=1)},Cc=function t(e){var n,i=vc("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,s=this.nextSibling,o=this.style.cssText;if(jl.appendChild(i),i.appendChild(this),this.style.display="block",e)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(a){}else this._gsapBBox&&(n=this._gsapBBox());return r&&(s?r.insertBefore(this,s):r.appendChild(this)),jl.removeChild(i),this.style.cssText=o,n},Tc=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},Sc=function(t){var e;try{e=t.getBBox()}catch(n){e=Cc.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===Cc||(e=Cc.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+Tc(t,["x","cx","x1"])||0,y:+Tc(t,["y","cy","y1"])||0,width:0,height:0}},Mc=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!Sc(t))},Ec=function(t,e){if(e){var n=t.style;e in Jl&&e!==yc&&(e=gc),n.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty(e.replace(tc,"-$1").toLowerCase())):n.removeAttribute(e)}},Ac=function(t,e,n,i,r,s){var o=new zl(t._pt,e,n,0,1,s?cc:lc);return t._pt=o,o.b=i,o.e=r,t._props.push(n),o},Dc={deg:1,rad:1,turn:1},Pc=function t(e,n,i,r){var s,o,a,l,c=parseFloat(i)||0,u=(i+"").trim().substr((c+"").length)||"px",h=ql.style,d=ec.test(n),p="svg"===e.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),m=100,g="px"===r,y="%"===r;return r===u||!c||Dc[r]||Dc[u]?c:("px"!==u&&!g&&(c=t(e,n,i,"px")),l=e.getCTM&&Mc(e),!y&&"%"!==u||!Jl[n]&&!~n.indexOf("adius")?(h[d?"width":"height"]=m+(g?u:r),o=~n.indexOf("adius")||"em"===r&&e.appendChild&&!p?e:e.parentNode,l&&(o=(e.ownerSVGElement||{}).parentNode),o&&o!==Gl&&o.appendChild||(o=Gl.body),(a=o._gsap)&&y&&a.width&&d&&a.time===Ka.time?Zo(c/a.width*m):((y||"%"===u)&&(h.position=_c(e,"position")),o===e&&(h.position="static"),o.appendChild(ql),s=ql[f],o.removeChild(ql),h.position="absolute",d&&y&&((a=jo(o)).time=Ka.time,a.width=o[f]),Zo(g?s*c/m:s&&c?m/s*c:0))):(s=l?e.getBBox()[d?"width":"height"]:e[f],Zo(y?c/s*m:c/100*s)))},Lc=function(t,e,n,i){var r;return Wl||wc(),e in ic&&"transform"!==e&&~(e=ic[e]).indexOf(",")&&(e=e.split(",")[0]),Jl[e]&&"transform"!==e?(r=Gc(t,i),r="transformOrigin"!==e?r[e]:r.svg?r.origin:jc(_c(t,yc))+" "+r.zOrigin+"px"):(!(r=t.style[e])||"auto"===r||i||~(r+"").indexOf("calc("))&&(r=Oc[e]&&Oc[e](t,e,n)||_c(t,e)||Wo(t,e)||("opacity"===e?1:0)),n&&!~(r+"").trim().indexOf(" ")?Pc(t,e,r,n)+n:r},Rc=function(t,e,n,i){if(!n||"none"===n){var r=bc(e,t,1),s=r&&_c(t,r,1);s&&s!==n?(e=r,n=s):"borderColor"===e&&(n=_c(t,"borderTopColor"))}var o,a,l,c,u,h,d,p,f,m,g,y,v=new zl(this._pt,t.style,e,0,1,Ll),_=0,x=0;if(v.b=n,v.e=i,n+="","auto"==(i+="")&&(t.style[e]=i,i=_c(t,e)||i,t.style[e]=n),Qa(o=[n,i]),i=o[1],l=(n=o[0]).match(Co)||[],(i.match(Co)||[]).length){for(;a=Co.exec(i);)d=a[0],f=i.substring(_,a.index),u?u=(u+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(u=1),d!==(h=l[x++]||"")&&(c=parseFloat(h)||0,g=h.substr((c+"").length),(y="="===d.charAt(1)?+(d.charAt(0)+"1"):0)&&(d=d.substr(2)),p=parseFloat(d),m=d.substr((p+"").length),_=Co.lastIndex-m.length,m||(m=m||to.units[e]||g,_===i.length&&(i+=m,v.e+=m)),g!==m&&(c=Pc(t,e,h,m)||0),v._pt={_next:v._pt,p:f||1===x?f:",",s:c,c:y?y*p:p-c,m:u&&u<4||"zIndex"===e?Math.round:0});v.c=_<i.length?i.substring(_,i.length):""}else v.r="display"===e&&"none"===i?cc:lc;return So.test(i)&&(v.e=0),this._pt=v,v},Ic={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Nc=function(t){var e=t.split(" "),n=e[0],i=e[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==i&&"right"!==i||(t=n,n=i,i=t),e[0]=Ic[n]||n,e[1]=Ic[i]||i,e.join(" ")},kc=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,i,r,s=e.t,o=e.u,a=s._gsap;if("all"===o||!0===o)s.style.cssText="",i=1;else for(r=(o=o.split(",")).length;--r>-1;)Jl[n=o[r]]&&(i=1,n="transformOrigin"===n?yc:gc),Ec(s,n);i&&(Ec(s,gc),a&&(a.svg&&s.removeAttribute("transform"),Gc(s,1),a.uncache=1))}},Oc={clearProps:function(t,e,n,i,r){if("isFromStart"!==r.data){var s=t._pt=new zl(t._pt,e,n,0,0,kc);return s.u=i,s.pr=-10,s.tween=r,t._props.push(n),1}}},zc=[1,0,0,1,0,0],Fc={},Uc=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},Hc=function(t){var e=_c(t,gc);return Uc(e)?zc:e.substr(7).match(wo).map(Zo)},Bc=function(t,e){var n,i,r,s,o=t._gsap||jo(t),a=t.style,l=Hc(t);return o.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=t.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?zc:l:(l!==zc||t.offsetParent||t===jl||o.svg||(r=a.display,a.display="block",(n=t.parentNode)&&t.offsetParent||(s=1,i=t.nextSibling,jl.appendChild(t)),l=Hc(t),r?a.display=r:Ec(t,"display"),s&&(i?n.insertBefore(t,i):n?n.appendChild(t):jl.removeChild(t))),e&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},Vc=function(t,e,n,i,r,s){var o,a,l,c=t._gsap,u=r||Bc(t,!0),h=c.xOrigin||0,d=c.yOrigin||0,p=c.xOffset||0,f=c.yOffset||0,m=u[0],g=u[1],y=u[2],v=u[3],_=u[4],x=u[5],b=e.split(" "),w=parseFloat(b[0])||0,C=parseFloat(b[1])||0;n?u!==zc&&(a=m*v-g*y)&&(l=w*(-g/a)+C*(m/a)-(m*x-g*_)/a,w=w*(v/a)+C*(-y/a)+(y*x-v*_)/a,C=l):(w=(o=Sc(t)).x+(~b[0].indexOf("%")?w/100*o.width:w),C=o.y+(~(b[1]||b[0]).indexOf("%")?C/100*o.height:C)),i||!1!==i&&c.smooth?(c.xOffset=p+((_=w-h)*m+(x=C-d)*y)-_,c.yOffset=f+(_*g+x*v)-x):c.xOffset=c.yOffset=0,c.xOrigin=w,c.yOrigin=C,c.smooth=!!i,c.origin=e,c.originIsAbsolute=!!n,t.style[yc]="0px 0px",s&&(Ac(s,c,"xOrigin",h,w),Ac(s,c,"yOrigin",d,C),Ac(s,c,"xOffset",p,c.xOffset),Ac(s,c,"yOffset",f,c.yOffset)),t.setAttribute("data-svg-origin",w+" "+C)},Gc=function(t,e){var n=t._gsap||new dl(t);if("x"in n&&!e&&!n.uncache)return n;var i,r,s,o,a,l,c,u,h,d,p,f,m,g,y,v,_,x,b,w,C,T,S,M,E,A,D,P,L,R,I,N,k=t.style,O=n.scaleX<0,z="px",F="deg",U=_c(t,yc)||"0";return i=r=s=l=c=u=h=d=p=0,o=a=1,n.svg=!(!t.getCTM||!Mc(t)),g=Bc(t,n.svg),n.svg&&(M=(!n.uncache||"0px 0px"===U)&&!e&&t.getAttribute("data-svg-origin"),Vc(t,M||U,!!M||n.originIsAbsolute,!1!==n.smooth,g)),f=n.xOrigin||0,m=n.yOrigin||0,g!==zc&&(x=g[0],b=g[1],w=g[2],C=g[3],i=T=g[4],r=S=g[5],6===g.length?(o=Math.sqrt(x*x+b*b),a=Math.sqrt(C*C+w*w),l=x||b?Kl(b,x)*$l:0,(h=w||C?Kl(w,C)*$l+l:0)&&(a*=Math.abs(Math.cos(h*Ql))),n.svg&&(i-=f-(f*x+m*w),r-=m-(f*b+m*C))):(R=g[7],D=g[8],P=g[9],I=g[11],i=g[12],r=g[13],s=g[14],c=(y=Kl(N=g[6],L=g[10]))*$l,y&&(M=T*(v=Math.cos(-y))+D*(_=Math.sin(-y)),E=S*v+P*_,A=N*v+L*_,D=T*-_+D*v,P=S*-_+P*v,L=N*-_+L*v,I=R*-_+I*v,T=M,S=E,N=A),u=(y=Kl(-w,L))*$l,y&&(v=Math.cos(-y),I=C*(_=Math.sin(-y))+I*v,x=M=x*v-D*_,b=E=b*v-P*_,w=A=w*v-L*_),l=(y=Kl(b,x))*$l,y&&(M=x*(v=Math.cos(y))+b*(_=Math.sin(y)),E=T*v+S*_,b=b*v-x*_,S=S*v-T*_,x=M,T=E),c&&Math.abs(c)+Math.abs(l)>359.9&&(c=l=0,u=180-u),o=Zo(Math.sqrt(x*x+b*b+w*w)),a=Zo(Math.sqrt(S*S+N*N)),y=Kl(T,S),h=Math.abs(y)>2e-4?y*$l:0,p=I?1/(I<0?-I:I):0),n.svg&&(M=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!Uc(_c(t,gc)),M&&t.setAttribute("transform",M))),Math.abs(h)>90&&Math.abs(h)<270&&(O?(o*=-1,h+=l<=0?180:-180,l+=l<=0?180:-180):(a*=-1,h+=h<=0?180:-180)),n.x=i-((n.xPercent=i&&(n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-i)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+z,n.y=r-((n.yPercent=r&&(n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-r)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+z,n.z=s+z,n.scaleX=Zo(o),n.scaleY=Zo(a),n.rotation=Zo(l)+F,n.rotationX=Zo(c)+F,n.rotationY=Zo(u)+F,n.skewX=h+F,n.skewY=d+F,n.transformPerspective=p+z,(n.zOrigin=parseFloat(U.split(" ")[2])||0)&&(k[yc]=jc(U)),n.xOffset=n.yOffset=0,n.force3D=to.force3D,n.renderTransform=n.svg?$c:Yl?Jc:qc,n.uncache=0,n},jc=function(t){return(t=t.split(" "))[0]+" "+t[1]},Wc=function(t,e,n){var i=Aa(e);return Zo(parseFloat(e)+parseFloat(Pc(t,"x",n+"px",i)))+i},qc=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Jc(t,e)},Zc="0deg",Yc="0px",Xc=") ",Jc=function(t,e){var n=e||this,i=n.xPercent,r=n.yPercent,s=n.x,o=n.y,a=n.z,l=n.rotation,c=n.rotationY,u=n.rotationX,h=n.skewX,d=n.skewY,p=n.scaleX,f=n.scaleY,m=n.transformPerspective,g=n.force3D,y=n.target,v=n.zOrigin,_="",x="auto"===g&&t&&1!==t||!0===g;if(v&&(u!==Zc||c!==Zc)){var b,w=parseFloat(c)*Ql,C=Math.sin(w),T=Math.cos(w);w=parseFloat(u)*Ql,b=Math.cos(w),s=Wc(y,s,C*b*-v),o=Wc(y,o,-Math.sin(w)*-v),a=Wc(y,a,T*b*-v+v)}m!==Yc&&(_+="perspective("+m+Xc),(i||r)&&(_+="translate("+i+"%, "+r+"%) "),(x||s!==Yc||o!==Yc||a!==Yc)&&(_+=a!==Yc||x?"translate3d("+s+", "+o+", "+a+") ":"translate("+s+", "+o+Xc),l!==Zc&&(_+="rotate("+l+Xc),c!==Zc&&(_+="rotateY("+c+Xc),u!==Zc&&(_+="rotateX("+u+Xc),h===Zc&&d===Zc||(_+="skew("+h+", "+d+Xc),1===p&&1===f||(_+="scale("+p+", "+f+Xc),y.style[gc]=_||"translate(0, 0)"},$c=function(t,e){var n,i,r,s,o,a=e||this,l=a.xPercent,c=a.yPercent,u=a.x,h=a.y,d=a.rotation,p=a.skewX,f=a.skewY,m=a.scaleX,g=a.scaleY,y=a.target,v=a.xOrigin,_=a.yOrigin,x=a.xOffset,b=a.yOffset,w=a.forceCSS,C=parseFloat(u),T=parseFloat(h);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=Ql,p*=Ql,n=Math.cos(d)*m,i=Math.sin(d)*m,r=Math.sin(d-p)*-g,s=Math.cos(d-p)*g,p&&(f*=Ql,o=Math.tan(p-f),r*=o=Math.sqrt(1+o*o),s*=o,f&&(o=Math.tan(f),n*=o=Math.sqrt(1+o*o),i*=o)),n=Zo(n),i=Zo(i),r=Zo(r),s=Zo(s)):(n=m,s=g,i=r=0),(C&&!~(u+"").indexOf("px")||T&&!~(h+"").indexOf("px"))&&(C=Pc(y,"x",u,"px"),T=Pc(y,"y",h,"px")),(v||_||x||b)&&(C=Zo(C+v-(v*n+_*r)+x),T=Zo(T+_-(v*i+_*s)+b)),(l||c)&&(o=y.getBBox(),C=Zo(C+l/100*o.width),T=Zo(T+c/100*o.height)),y.setAttribute("transform",o="matrix("+n+","+i+","+r+","+s+","+C+","+T+")"),w&&(y.style[gc]=o)},Qc=function(t,e,n,i,r,s){var o,a,l=360,c=uo(r),u=parseFloat(r)*(c&&~r.indexOf("rad")?$l:1),h=s?u*s:u-i,d=i+h+"deg";return c&&("short"===(o=r.split("_")[1])&&(h%=l)!=h%180&&(h+=h<0?l:-360),"cw"===o&&h<0?h=(h+36e9)%l-~~(h/l)*l:"ccw"===o&&h>0&&(h=(h-36e9)%l-~~(h/l)*l)),t._pt=a=new zl(t._pt,e,n,i,h,sc),a.e=d,a.u="deg",t._props.push(n),a},Kc=function(t,e){for(var n in e)t[n]=e[n];return t},tu=function(t,e,n){var i,r,s,o,a,l,c,u=Kc({},n._gsap),h=n.style;for(r in u.svg?(s=n.getAttribute("transform"),n.setAttribute("transform",""),h[gc]=e,i=Gc(n,1),Ec(n,gc),n.setAttribute("transform",s)):(s=getComputedStyle(n)[gc],h[gc]=e,i=Gc(n,1),h[gc]=s),Jl)(s=u[r])!==(o=i[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(a=Aa(s)!==(c=Aa(o))?Pc(n,r,s,c):parseFloat(s),l=parseFloat(o),t._pt=new zl(t._pt,i,r,a,l-a,rc),t._pt.u=c||0,t._props.push(r));Kc(i,u)};qo("padding,margin,Width,Radius",function(t,e){var n="Top",i="Right",r="Bottom",s="Left",o=(e<3?[n,i,r,s]:[n+s,n+i,r+i,r+s]).map(function(n){return e<2?t+n:"border"+n+t});Oc[e>1?"border"+t:t]=function(t,e,n,i,r){var s,a;if(arguments.length<4)return s=o.map(function(e){return Lc(t,e,n)}),5===(a=s.join(" ")).split(s[0]).length?s[0]:a;s=(i+"").split(" "),a={},o.forEach(function(t,e){return a[t]=s[e]=s[e]||s[(e-1)/2|0]}),t.init(e,a,r)}});var eu,nu,iu={name:"css",register:wc,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,i,r){var s,o,a,l,c,u,h,d,p,f,m,g,y,v,_,x=this._props,b=t.style,w=n.vars.startAt;for(h in Wl||wc(),e)if("autoRound"!==h&&(o=e[h],!Fo[h]||!vl(h,e,n,i,t,r)))if(u=Oc[h],"function"==(c=typeof o)&&(c=typeof(o=o.call(n,i,t,r))),"string"===c&&~o.indexOf("random(")&&(o=Fa(o)),u)u(this,t,h,o,n)&&(_=1);else if("--"===h.substr(0,2))s=(getComputedStyle(t).getPropertyValue(h)+"").trim(),o+="",Ja.lastIndex=0,Ja.test(s)||(d=Aa(s),p=Aa(o)),p?d!==p&&(s=Pc(t,h,s,p)+p):d&&(o+=d),this.add(b,"setProperty",s,o,i,r,0,0,h),x.push(h);else if("undefined"!==c){if(w&&h in w?(s="function"==typeof w[h]?w[h].call(n,i,t,r):w[h],h in to.units&&!Aa(s)&&(s+=to.units[h]),"="===(s+"").charAt(1)&&(s=Lc(t,h))):s=Lc(t,h),l=parseFloat(s),(f="string"===c&&"="===o.charAt(1)?+(o.charAt(0)+"1"):0)&&(o=o.substr(2)),a=parseFloat(o),h in ic&&("autoAlpha"===h&&(1===l&&"hidden"===Lc(t,"visibility")&&a&&(l=0),Ac(this,b,"visibility",l?"inherit":"hidden",a?"inherit":"hidden",!a)),"scale"!==h&&"transform"!==h&&~(h=ic[h]).indexOf(",")&&(h=h.split(",")[0])),m=h in Jl)if(g||((y=t._gsap).renderTransform&&!e.parseTransform||Gc(t,e.parseTransform),v=!1!==e.smoothOrigin&&y.smooth,(g=this._pt=new zl(this._pt,b,gc,0,1,y.renderTransform,y,0,-1)).dep=1),"scale"===h)this._pt=new zl(this._pt,y,"scaleY",y.scaleY,(f?f*a:a-y.scaleY)||0),x.push("scaleY",h),h+="X";else{if("transformOrigin"===h){o=Nc(o),y.svg?Vc(t,o,0,v,0,this):((p=parseFloat(o.split(" ")[2])||0)!==y.zOrigin&&Ac(this,y,"zOrigin",y.zOrigin,p),Ac(this,b,h,jc(s),jc(o)));continue}if("svgOrigin"===h){Vc(t,o,1,v,0,this);continue}if(h in Fc){Qc(this,y,h,l,o,f);continue}if("smoothOrigin"===h){Ac(this,y,"smooth",y.smooth,o);continue}if("force3D"===h){y[h]=o;continue}if("transform"===h){tu(this,o,t);continue}}else h in b||(h=bc(h)||h);if(m||(a||0===a)&&(l||0===l)&&!nc.test(o)&&h in b)a||(a=0),(d=(s+"").substr((l+"").length))!==(p=Aa(o)||(h in to.units?to.units[h]:d))&&(l=Pc(t,h,s,p)),this._pt=new zl(this._pt,m?y:b,h,l,f?f*a:a-l,m||"px"!==p&&"zIndex"!==h||!1===e.autoRound?rc:ac),this._pt.u=p||0,d!==p&&(this._pt.b=s,this._pt.r=oc);else if(h in b)Rc.call(this,t,h,s,o);else{if(!(h in t)){Lo(h,o);continue}this.add(t,h,s||t[h],o,i,r)}x.push(h)}_&&Ol(this)},get:Lc,aliases:ic,getSetter:function(t,e,n){var i=ic[e];return i&&i.indexOf(",")<0&&(e=i),e in Jl&&e!==yc&&(t._gsap.x||Lc(t,"x"))?n&&Zl===n?"scale"===e?pc:dc:(Zl=n||{})&&("scale"===e?fc:mc):t.style&&!fo(t.style[e])?uc:~e.indexOf("-")?hc:Al(t,e)},core:{_removeProperty:Ec,_getMatrix:Bc}};Bl.utils.checkPrefix=bc,nu=qo("x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+(eu="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(t){Jl[t]=1}),qo(eu,function(t){to.units[t]="deg",Fc[t]=1}),ic[nu[13]]="x,y,z,scale,scaleX,scaleY,xPercent,yPercent,"+eu,qo("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",function(t){var e=t.split(":");ic[e[1]]=nu[e[0]]}),qo("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(t){to.units[t]="px"}),Bl.registerPlugin(iu);var ru=Bl.registerPlugin(iu)||Bl;const su=100,ou=1e3,au=1001,lu=1002,cu=1003,uu=1004,hu=1005,du=1006,pu=1008,fu=1009,mu=1012,gu=1014,yu=1015,vu=1016,_u=1020,xu=1022,bu=1023,wu=1026,Cu=1027,Tu=2300,Su=2301,Mu=2302,Eu=2400,Au=2401,Du=2402,Pu=3e3,Lu=3001,Ru=7680,Iu=35044,Nu=35048,ku="300 es";class Ou{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,i=n.length;e<i;e++)n[e].call(this,t);t.target=null}}}const zu=[];for(let Ww=0;Ww<256;Ww++)zu[Ww]=(Ww<16?"0":"")+Ww.toString(16);let Fu=1234567;const Uu=Math.PI/180,Hu=180/Math.PI;function Bu(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(zu[255&t]+zu[t>>8&255]+zu[t>>16&255]+zu[t>>24&255]+"-"+zu[255&e]+zu[e>>8&255]+"-"+zu[e>>16&15|64]+zu[e>>24&255]+"-"+zu[63&n|128]+zu[n>>8&255]+"-"+zu[n>>16&255]+zu[n>>24&255]+zu[255&i]+zu[i>>8&255]+zu[i>>16&255]+zu[i>>24&255]).toUpperCase()}function Vu(t,e,n){return Math.max(e,Math.min(n,t))}function Gu(t,e){return(t%e+e)%e}function ju(t,e,n){return(1-n)*t+n*e}function Wu(t){return 0==(t&t-1)&&0!==t}function qu(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Zu(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}var Yu=Object.freeze({__proto__:null,DEG2RAD:Uu,RAD2DEG:Hu,generateUUID:Bu,clamp:Vu,euclideanModulo:Gu,mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:ju,damp:function(t,e,n,i){return ju(t,e,1-Math.exp(-n*i))},pingpong:function(t,e=1){return e-Math.abs(Gu(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(Fu=t%2147483647),Fu=16807*Fu%2147483647,(Fu-1)/2147483646},degToRad:function(t){return t*Uu},radToDeg:function(t){return t*Hu},isPowerOfTwo:Wu,ceilPowerOfTwo:qu,floorPowerOfTwo:Zu,setQuaternionFromProperEuler:function(t,e,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+i)/2),u=o((e+i)/2),h=s((e-i)/2),d=o((e-i)/2),p=s((i-e)/2),f=o((i-e)/2);switch(r){case"XYX":t.set(a*u,l*h,l*d,a*c);break;case"YZY":t.set(l*d,a*u,l*h,a*c);break;case"ZXZ":t.set(l*h,l*d,a*u,a*c);break;case"XZX":t.set(a*u,l*f,l*p,a*c);break;case"YXY":t.set(l*p,a*u,l*f,a*c);break;case"ZYZ":t.set(l*f,l*p,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}});class Xu{constructor(t=0,e=0){this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*n-s*i+t.x,this.y=r*i+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}Xu.prototype.isVector2=!0;class Ju{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,s,o,a,l){const c=this.elements;return c[0]=t,c[1]=i,c[2]=o,c[3]=e,c[4]=r,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],u=n[7],h=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],y=i[1],v=i[4],_=i[7],x=i[2],b=i[5],w=i[8];return r[0]=s*f+o*y+a*x,r[3]=s*m+o*v+a*b,r[6]=s*g+o*_+a*w,r[1]=l*f+c*y+u*x,r[4]=l*m+c*v+u*b,r[7]=l*g+c*_+u*w,r[2]=h*f+d*y+p*x,r[5]=h*m+d*v+p*b,r[8]=h*g+d*_+p*w,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*s*c-e*o*l-n*r*c+n*o*a+i*r*l-i*s*a}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=c*s-o*l,h=o*a-c*r,d=l*r-s*a,p=e*u+n*h+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=u*f,t[1]=(i*l-c*n)*f,t[2]=(o*n-i*s)*f,t[3]=h*f,t[4]=(c*e-i*a)*f,t[5]=(i*r-o*e)*f,t[6]=d*f,t[7]=(n*a-l*e)*f,t[8]=(s*e-n*r)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,s,o){const a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*s+l*o)+s+t,-i*l,i*a,-i*(-l*s+a*o)+o+e,0,0,1),this}scale(t,e){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],s=i[3],o=i[6],a=i[1],l=i[4],c=i[7];return i[0]=e*r+n*a,i[3]=e*s+n*l,i[6]=e*o+n*c,i[1]=-n*r+e*a,i[4]=-n*s+e*l,i[7]=-n*o+e*c,this}translate(t,e){const n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}let $u;Ju.prototype.isMatrix3=!0;class Qu{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===$u&&($u=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),$u.width=t.width,$u.height=t.height;const n=$u.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=$u}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}}let Ku=0;class th extends Ou{constructor(t=th.DEFAULT_IMAGE,e=th.DEFAULT_MAPPING,n=1001,i=1001,r=1006,s=1008,o=1023,a=1009,l=1,c=3e3){super(),Object.defineProperty(this,"id",{value:Ku++}),this.uuid=Bu(),this.name="",this.image=t,this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Xu(0,0),this.repeat=new Xu(1,1),this.center=new Xu(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ju,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const i=this.image;if(void 0===i.uuid&&(i.uuid=Bu()),!e&&void 0===t.images[i.uuid]){let e;if(Array.isArray(i)){e=[];for(let t=0,n=i.length;t<n;t++)e.push(eh(i[t].isDataTexture?i[t].image:i[t]))}else e=eh(i);t.images[i.uuid]={uuid:i.uuid,url:e}}n.image=i.uuid}return e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ou:t.x=t.x-Math.floor(t.x);break;case au:t.x=t.x<0?0:1;break;case lu:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case ou:t.y=t.y-Math.floor(t.y);break;case au:t.y=t.y<0?0:1;break;case lu:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&this.version++}}function eh(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?Qu.getDataURL(t):t.data?{data:Array.prototype.slice.call(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}th.DEFAULT_IMAGE=void 0,th.DEFAULT_MAPPING=300,th.prototype.isTexture=!0;class nh{constructor(t=0,e=0,n=0,i=1){this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const s=.01,o=.1,a=t.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<s&&Math.abs(u-f)<s&&Math.abs(p-m)<s){if(Math.abs(c+h)<o&&Math.abs(u+f)<o&&Math.abs(p+m)<o&&Math.abs(l+d+g-3)<o)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,a=(d+1)/2,y=(g+1)/2,v=(c+h)/4,_=(u+f)/4,x=(p+m)/4;return t>a&&t>y?t<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=v/n,r=_/n):a>y?a<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(a),n=v/i,r=x/i):y<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(y),n=_/r,i=x/r),this.set(n,i,r,e),this}let y=Math.sqrt((m-p)*(m-p)+(u-f)*(u-f)+(h-c)*(h-c));return Math.abs(y)<.001&&(y=1),this.x=(m-p)/y,this.y=(u-f)/y,this.z=(h-c)/y,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}nh.prototype.isVector4=!0;class ih extends Ou{constructor(t,e,n={}){super(),this.width=t,this.height=e,this.depth=1,this.scissor=new nh(0,0,t,e),this.scissorTest=!1,this.viewport=new nh(0,0,t,e),this.texture=new th(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={width:t,height:e,depth:1},this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:du,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}setTexture(t){t.image={width:this.width,height:this.height,depth:this.depth},this.texture=t}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}ih.prototype.isWebGLRenderTarget=!0,class extends ih{constructor(t,e,n){super(t,e);const i=this.texture;this.texture=[];for(let r=0;r<n;r++)this.texture[r]=i.clone()}setSize(t,e,n=1){if(this.width!==t||this.height!==e||this.depth!==n){this.width=t,this.height=e,this.depth=n;for(let i=0,r=this.texture.length;i<r;i++)this.texture[i].image.width=t,this.texture[i].image.height=e,this.texture[i].image.depth=n;this.dispose()}return this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this.texture.length=0;for(let e=0,n=t.texture.length;e<n;e++)this.texture[e]=t.texture[e].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class rh extends ih{constructor(t,e,n){super(t,e,n),this.samples=4}copy(t){return super.copy.call(this,t),this.samples=t.samples,this}}rh.prototype.isWebGLMultisampleRenderTarget=!0;class sh{constructor(t=0,e=0,n=0,i=1){this._x=t,this._y=e,this._z=n,this._w=i}static slerp(t,e,n,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(t,e,i)}static slerpFlat(t,e,n,i,r,s,o){let a=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3];const h=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(0===o)return t[e+0]=a,t[e+1]=l,t[e+2]=c,void(t[e+3]=u);if(1===o)return t[e+0]=h,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(u!==f||a!==h||l!==d||c!==p){let t=1-o;const e=a*h+l*d+c*p+u*f,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,e*n);t=Math.sin(t*s)/r,o=Math.sin(o*s)/r}const r=o*n;if(a=a*t+h*r,l=l*t+d*r,c=c*t+p*r,u=u*t+f*r,t===1-o){const t=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=t,l*=t,c*=t,u*=t}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,n,i,r,s){const o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],u=r[s],h=r[s+1],d=r[s+2],p=r[s+3];return t[e]=o*p+c*u+a*d-l*h,t[e+1]=a*p+c*h+l*u-o*d,t[e+2]=l*p+c*d+o*h-a*u,t[e+3]=c*p-o*u-a*h-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=t._x,i=t._y,r=t._z,s=t._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),u=o(r/2),h=a(n/2),d=a(i/2),p=a(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],s=e[1],o=e[5],a=e[9],l=e[2],c=e[6],u=e[10],h=n+o+u;if(h>0){const t=.5/Math.sqrt(h+1);this._w=.25/t,this._x=(c-a)*t,this._y=(r-l)*t,this._z=(s-i)*t}else if(n>o&&n>u){const t=2*Math.sqrt(1+n-o-u);this._w=(c-a)/t,this._x=.25*t,this._y=(i+s)/t,this._z=(r+l)/t}else if(o>u){const t=2*Math.sqrt(1+o-n-u);this._w=(r-l)/t,this._x=(i+s)/t,this._y=.25*t,this._z=(a+c)/t}else{const t=2*Math.sqrt(1+u-n-o);this._w=(s-i)/t,this._x=(r+l)/t,this._y=(a+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Vu(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,s=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=n*c+s*o+i*l-r*a,this._y=i*c+s*a+r*o-n*l,this._z=r*c+s*l+n*a-i*o,this._w=s*c-n*o-i*a-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,s=this._w;let o=s*t._w+n*t._x+i*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-e)*c)/l,h=Math.sin(e*c)/l;return this._w=s*u+this._w*h,this._x=n*u+this._x*h,this._y=i*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(t,e,n){this.copy(t).slerp(e,n)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}sh.prototype.isQuaternion=!0;class oh{constructor(t=0,e=0,n=0){this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(lh.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(lh.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,s=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,o=t.z,a=t.w,l=a*e+s*i-o*n,c=a*n+o*e-r*i,u=a*i+r*n-s*e,h=-r*e-s*n-o*i;return this.x=l*a+h*-r+c*-o-u*-s,this.y=c*a+h*-s+u*-r-l*-o,this.z=u*a+h*-o+l*-s-c*-r,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,s=e.x,o=e.y,a=e.z;return this.x=i*a-r*o,this.y=r*s-n*a,this.z=n*o-i*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return ah.copy(this).projectOnVector(t),this.sub(ah)}reflect(t){return this.sub(ah.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Vu(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}oh.prototype.isVector3=!0;const ah=new oh,lh=new sh;class ch{constructor(t=new oh(1/0,1/0,1/0),e=new oh(-1/0,-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=3){const l=t[a],c=t[a+1],u=t[a+2];l<e&&(e=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,s,o),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.count;a<l;a++){const l=t.getX(a),c=t.getY(a),u=t.getZ(a);l<e&&(e=l),c<n&&(n=c),u<i&&(i=u),l>r&&(r=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=hh.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),dh.copy(e.boundingBox),dh.applyMatrix4(t.matrixWorld),this.union(dh));const n=t.children;for(let i=0,r=n.length;i<r;i++)this.expandByObject(n[i]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,hh),hh.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(_h),xh.subVectors(this.max,_h),ph.subVectors(t.a,_h),fh.subVectors(t.b,_h),mh.subVectors(t.c,_h),gh.subVectors(fh,ph),yh.subVectors(mh,fh),vh.subVectors(ph,mh);let e=[0,-gh.z,gh.y,0,-yh.z,yh.y,0,-vh.z,vh.y,gh.z,0,-gh.x,yh.z,0,-yh.x,vh.z,0,-vh.x,-gh.y,gh.x,0,-yh.y,yh.x,0,-vh.y,vh.x,0];return!!Ch(e,ph,fh,mh,xh)&&(e=[1,0,0,0,1,0,0,0,1],!!Ch(e,ph,fh,mh,xh)&&(bh.crossVectors(gh,yh),e=[bh.x,bh.y,bh.z],Ch(e,ph,fh,mh,xh)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return hh.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=.5*this.getSize(hh).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(uh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),uh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),uh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),uh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),uh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),uh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),uh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),uh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(uh)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}ch.prototype.isBox3=!0;const uh=[new oh,new oh,new oh,new oh,new oh,new oh,new oh,new oh],hh=new oh,dh=new ch,ph=new oh,fh=new oh,mh=new oh,gh=new oh,yh=new oh,vh=new oh,_h=new oh,xh=new oh,bh=new oh,wh=new oh;function Ch(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){wh.fromArray(t,s);const o=r.x*Math.abs(wh.x)+r.y*Math.abs(wh.y)+r.z*Math.abs(wh.z),a=e.dot(wh),l=n.dot(wh),c=i.dot(wh);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const Th=new ch,Sh=new oh,Mh=new oh,Eh=new oh;class Ah{constructor(t=new oh,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):Th.setFromPoints(t).getCenter(n);let i=0;for(let r=0,s=t.length;r<s;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){Eh.subVectors(t,this.center);const e=Eh.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.add(Eh.multiplyScalar(n/t)),this.radius+=n}return this}union(t){return Mh.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(Sh.copy(t.center).add(Mh)),this.expandByPoint(Sh.copy(t.center).sub(Mh)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Dh=new oh,Ph=new oh,Lh=new oh,Rh=new oh,Ih=new oh,Nh=new oh,kh=new oh;class Oh{constructor(t=new oh,e=new oh(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Dh)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Dh.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Dh.copy(this.direction).multiplyScalar(e).add(this.origin),Dh.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){Ph.copy(t).add(e).multiplyScalar(.5),Lh.copy(e).sub(t).normalize(),Rh.copy(this.origin).sub(Ph);const r=.5*t.distanceTo(e),s=-this.direction.dot(Lh),o=Rh.dot(this.direction),a=-Rh.dot(Lh),l=Rh.lengthSq(),c=Math.abs(1-s*s);let u,h,d,p;if(c>0)if(u=s*a-o,h=s*o-a,p=r*c,u>=0)if(h>=-p)if(h<=p){const t=1/c;u*=t,h*=t,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-p?(u=Math.max(0,-(-s*r+o)),h=u>0?-r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-a),r),d=h*(h+2*a)+l):(u=Math.max(0,-(s*r+o)),h=u>0?r:Math.min(Math.max(-r,-a),r),d=-u*u+h*(h+2*a)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(Lh).multiplyScalar(h).add(Ph),d}intersectSphere(t,e){Dh.subVectors(t.center,this.origin);const n=Dh.dot(this.direction),i=Dh.dot(Dh)-n*n,r=t.radius*t.radius;if(i>r)return null;const s=Math.sqrt(r-i),o=n-s,a=n+s;return o<0&&a<0?null:this.at(o<0?a:o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(t.min.x-h.x)*l,i=(t.max.x-h.x)*l):(n=(t.max.x-h.x)*l,i=(t.min.x-h.x)*l),c>=0?(r=(t.min.y-h.y)*c,s=(t.max.y-h.y)*c):(r=(t.max.y-h.y)*c,s=(t.min.y-h.y)*c),n>s||r>i?null:((r>n||n!=n)&&(n=r),(s<i||i!=i)&&(i=s),u>=0?(o=(t.min.z-h.z)*u,a=(t.max.z-h.z)*u):(o=(t.max.z-h.z)*u,a=(t.min.z-h.z)*u),n>a||o>i?null:((o>n||n!=n)&&(n=o),(a<i||i!=i)&&(i=a),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,Dh)}intersectTriangle(t,e,n,i,r){Ih.subVectors(e,t),Nh.subVectors(n,t),kh.crossVectors(Ih,Nh);let s,o=this.direction.dot(kh);if(o>0){if(i)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}Rh.subVectors(this.origin,t);const a=s*this.direction.dot(Nh.crossVectors(Rh,Nh));if(a<0)return null;const l=s*this.direction.dot(Ih.cross(Rh));if(l<0)return null;if(a+l>o)return null;const c=-s*Rh.dot(kh);return c<0?null:this.at(c/o,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class zh{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,n,i,r,s,o,a,l,c,u,h,d,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new zh).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/Fh.setFromMatrixColumn(t,0).length(),r=1/Fh.setFromMatrixColumn(t,1).length(),s=1/Fh.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,n=t.x,i=t.y,r=t.z,s=Math.cos(n),o=Math.sin(n),a=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if("XYZ"===t.order){const t=s*c,n=s*u,i=o*c,r=o*u;e[0]=a*c,e[4]=-a*u,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-o*a,e[2]=r-t*l,e[6]=i+n*l,e[10]=s*a}else if("YXZ"===t.order){const t=a*c,n=a*u,i=l*c,r=l*u;e[0]=t+r*o,e[4]=i*o-n,e[8]=s*l,e[1]=s*u,e[5]=s*c,e[9]=-o,e[2]=n*o-i,e[6]=r+t*o,e[10]=s*a}else if("ZXY"===t.order){const t=a*c,n=a*u,i=l*c,r=l*u;e[0]=t-r*o,e[4]=-s*u,e[8]=i+n*o,e[1]=n+i*o,e[5]=s*c,e[9]=r-t*o,e[2]=-s*l,e[6]=o,e[10]=s*a}else if("ZYX"===t.order){const t=s*c,n=s*u,i=o*c,r=o*u;e[0]=a*c,e[4]=i*l-n,e[8]=t*l+r,e[1]=a*u,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=o*a,e[10]=s*a}else if("YZX"===t.order){const t=s*a,n=s*l,i=o*a,r=o*l;e[0]=a*c,e[4]=r-t*u,e[8]=i*u+n,e[1]=u,e[5]=s*c,e[9]=-o*c,e[2]=-l*c,e[6]=n*u+i,e[10]=t-r*u}else if("XZY"===t.order){const t=s*a,n=s*l,i=o*a,r=o*l;e[0]=a*c,e[4]=-u,e[8]=l*c,e[1]=t*u+r,e[5]=s*c,e[9]=n*u-i,e[2]=i*u-n,e[6]=o*c,e[10]=r*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Hh,t,Bh)}lookAt(t,e,n){const i=this.elements;return jh.subVectors(t,e),0===jh.lengthSq()&&(jh.z=1),jh.normalize(),Vh.crossVectors(n,jh),0===Vh.lengthSq()&&(1===Math.abs(n.z)?jh.x+=1e-4:jh.z+=1e-4,jh.normalize(),Vh.crossVectors(n,jh)),Vh.normalize(),Gh.crossVectors(jh,Vh),i[0]=Vh.x,i[4]=Gh.x,i[8]=jh.x,i[1]=Vh.y,i[5]=Gh.y,i[9]=jh.y,i[2]=Vh.z,i[6]=Gh.z,i[10]=jh.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],o=n[4],a=n[8],l=n[12],c=n[1],u=n[5],h=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],y=n[3],v=n[7],_=n[11],x=n[15],b=i[0],w=i[4],C=i[8],T=i[12],S=i[1],M=i[5],E=i[9],A=i[13],D=i[2],P=i[6],L=i[10],R=i[14],I=i[3],N=i[7],k=i[11],O=i[15];return r[0]=s*b+o*S+a*D+l*I,r[4]=s*w+o*M+a*P+l*N,r[8]=s*C+o*E+a*L+l*k,r[12]=s*T+o*A+a*R+l*O,r[1]=c*b+u*S+h*D+d*I,r[5]=c*w+u*M+h*P+d*N,r[9]=c*C+u*E+h*L+d*k,r[13]=c*T+u*A+h*R+d*O,r[2]=p*b+f*S+m*D+g*I,r[6]=p*w+f*M+m*P+g*N,r[10]=p*C+f*E+m*L+g*k,r[14]=p*T+f*A+m*R+g*O,r[3]=y*b+v*S+_*D+x*I,r[7]=y*w+v*M+_*P+x*N,r[11]=y*C+v*E+_*L+x*k,r[15]=y*T+v*A+_*R+x*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],s=t[1],o=t[5],a=t[9],l=t[13],c=t[2],u=t[6],h=t[10],d=t[14];return t[3]*(+r*a*u-i*l*u-r*o*h+n*l*h+i*o*d-n*a*d)+t[7]*(+e*a*d-e*l*h+r*s*h-i*s*d+i*l*c-r*a*c)+t[11]*(+e*l*u-e*o*d-r*s*u+n*s*d+r*o*c-n*l*c)+t[15]*(-i*o*c-e*a*u+e*o*h+i*s*u-n*s*h+n*a*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],y=u*m*l-f*h*l+f*a*d-o*m*d-u*a*g+o*h*g,v=p*h*l-c*m*l-p*a*d+s*m*d+c*a*g-s*h*g,_=c*f*l-p*u*l+p*o*d-s*f*d-c*o*g+s*u*g,x=p*u*a-c*f*a-p*o*h+s*f*h+c*o*m-s*u*m,b=e*y+n*v+i*_+r*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/b;return t[0]=y*w,t[1]=(f*h*r-u*m*r-f*i*d+n*m*d+u*i*g-n*h*g)*w,t[2]=(o*m*r-f*a*r+f*i*l-n*m*l-o*i*g+n*a*g)*w,t[3]=(u*a*r-o*h*r-u*i*l+n*h*l+o*i*d-n*a*d)*w,t[4]=v*w,t[5]=(c*m*r-p*h*r+p*i*d-e*m*d-c*i*g+e*h*g)*w,t[6]=(p*a*r-s*m*r-p*i*l+e*m*l+s*i*g-e*a*g)*w,t[7]=(s*h*r-c*a*r+c*i*l-e*h*l-s*i*d+e*a*d)*w,t[8]=_*w,t[9]=(p*u*r-c*f*r-p*n*d+e*f*d+c*n*g-e*u*g)*w,t[10]=(s*f*r-p*o*r+p*n*l-e*f*l-s*n*g+e*o*g)*w,t[11]=(c*o*r-s*u*r-c*n*l+e*u*l+s*n*d-e*o*d)*w,t[12]=x*w,t[13]=(c*f*i-p*u*i+p*n*h-e*f*h-c*n*m+e*u*m)*w,t[14]=(p*o*i-s*f*i-p*n*a+e*f*a+s*n*m-e*o*m)*w,t[15]=(s*u*i-c*o*i+c*n*a-e*u*a-s*n*h+e*o*h)*w,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))}makeTranslation(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,o=t.y,a=t.z,l=r*s,c=r*o;return this.set(l*s+n,l*o-i*a,l*a+i*o,0,l*o+i*a,c*o+n,c*a-i*s,0,l*a-i*o,c*a+i*s,r*a*a+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,s){return this.set(1,n,r,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,s=e._y,o=e._z,a=e._w,l=r+r,c=s+s,u=o+o,h=r*l,d=r*c,p=r*u,f=s*c,m=s*u,g=o*u,y=a*l,v=a*c,_=a*u,x=n.x,b=n.y,w=n.z;return i[0]=(1-(f+g))*x,i[1]=(d+_)*x,i[2]=(p-v)*x,i[3]=0,i[4]=(d-_)*b,i[5]=(1-(h+g))*b,i[6]=(m+y)*b,i[7]=0,i[8]=(p+v)*w,i[9]=(m-y)*w,i[10]=(1-(h+f))*w,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=Fh.set(i[0],i[1],i[2]).length();const s=Fh.set(i[4],i[5],i[6]).length(),o=Fh.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],Uh.copy(this);const a=1/r,l=1/s,c=1/o;return Uh.elements[0]*=a,Uh.elements[1]*=a,Uh.elements[2]*=a,Uh.elements[4]*=l,Uh.elements[5]*=l,Uh.elements[6]*=l,Uh.elements[8]*=c,Uh.elements[9]*=c,Uh.elements[10]*=c,e.setFromRotationMatrix(Uh),n.x=r,n.y=s,n.z=o,this}makePerspective(t,e,n,i,r,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,a=2*r/(n-i),l=(e+t)/(e-t),c=(n+i)/(n-i),u=-(s+r)/(s-r),h=-2*s*r/(s-r);return o[0]=2*r/(e-t),o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=a,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,n,i,r,s){const o=this.elements,a=1/(e-t),l=1/(n-i),c=1/(s-r),u=(e+t)*a,h=(n+i)*l,d=(s+r)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}zh.prototype.isMatrix4=!0;const Fh=new oh,Uh=new zh,Hh=new oh(0,0,0),Bh=new oh(1,1,1),Vh=new oh,Gh=new oh,jh=new oh,Wh=new zh,qh=new sh;class Zh{constructor(t=0,e=0,n=0,i=Zh.DefaultOrder){this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(Vu(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Vu(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(Vu(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-Vu(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Vu(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Vu(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return Wh.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Wh,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return qh.setFromEuler(this),this.setFromQuaternion(qh,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new oh(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}Zh.prototype.isEuler=!0,Zh.DefaultOrder="XYZ",Zh.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Yh{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}}let Xh=0;const Jh=new oh,$h=new sh,Qh=new zh,Kh=new oh,td=new oh,ed=new oh,nd=new sh,id=new oh(1,0,0),rd=new oh(0,1,0),sd=new oh(0,0,1),od={type:"added"},ad={type:"removed"};class ld extends Ou{constructor(){super(),Object.defineProperty(this,"id",{value:Xh++}),this.uuid=Bu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ld.DefaultUp.clone();const t=new oh,e=new Zh,n=new sh,i=new oh(1,1,1);e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new zh},normalMatrix:{value:new Ju}}),this.matrix=new zh,this.matrixWorld=new zh,this.matrixAutoUpdate=ld.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Yh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return $h.setFromAxisAngle(t,e),this.quaternion.multiply($h),this}rotateOnWorldAxis(t,e){return $h.setFromAxisAngle(t,e),this.quaternion.premultiply($h),this}rotateX(t){return this.rotateOnAxis(id,t)}rotateY(t){return this.rotateOnAxis(rd,t)}rotateZ(t){return this.rotateOnAxis(sd,t)}translateOnAxis(t,e){return Jh.copy(t).applyQuaternion(this.quaternion),this.position.add(Jh.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(id,t)}translateY(t){return this.translateOnAxis(rd,t)}translateZ(t){return this.translateOnAxis(sd,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Qh.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Kh.copy(t):Kh.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),td.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Qh.lookAt(td,Kh,this.up):Qh.lookAt(Kh,td,this.up),this.quaternion.setFromRotationMatrix(Qh),i&&(Qh.extractRotation(i.matrixWorld),$h.setFromRotationMatrix(Qh),this.quaternion.premultiply($h.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(od)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(ad)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(ad)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Qh.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Qh.multiply(t.parent.matrixWorld)),t.applyMatrix4(Qh),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(td,t,ed),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(td,nd,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].updateMatrixWorld(t)}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++)t[e].updateWorldMatrix(!1,!0)}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++)r(t.shapes,n[e]);else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++)i.animations.push(r(t.animations,this.animations[e]))}if(e){const e=s(t.geometries),i=s(t.materials),r=s(t.textures),o=s(t.images),a=s(t.shapes),l=s(t.skeletons),c=s(t.animations);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),o.length>0&&(n.images=o),a.length>0&&(n.shapes=a),l.length>0&&(n.skeletons=l),c.length>0&&(n.animations=c)}return n.object=i,n;function s(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++)this.add(t.children[n].clone());return this}}ld.DefaultUp=new oh(0,1,0),ld.DefaultMatrixAutoUpdate=!0,ld.prototype.isObject3D=!0;const cd=new oh,ud=new oh,hd=new oh,dd=new oh,pd=new oh,fd=new oh,md=new oh,gd=new oh,yd=new oh,vd=new oh;class _d{constructor(t=new oh,e=new oh,n=new oh){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),cd.subVectors(t,e),i.cross(cd);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){cd.subVectors(i,e),ud.subVectors(n,e),hd.subVectors(t,e);const s=cd.dot(cd),o=cd.dot(ud),a=cd.dot(hd),l=ud.dot(ud),c=ud.dot(hd),u=s*l-o*o;if(0===u)return r.set(-2,-1,-1);const h=1/u,d=(l*a-o*c)*h,p=(s*c-o*a)*h;return r.set(1-d-p,p,d)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,dd),dd.x>=0&&dd.y>=0&&dd.x+dd.y<=1}static getUV(t,e,n,i,r,s,o,a){return this.getBarycoord(t,e,n,i,dd),a.set(0,0),a.addScaledVector(r,dd.x),a.addScaledVector(s,dd.y),a.addScaledVector(o,dd.z),a}static isFrontFacing(t,e,n,i){return cd.subVectors(n,e),ud.subVectors(t,e),cd.cross(ud).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return cd.subVectors(this.c,this.b),ud.subVectors(this.a,this.b),.5*cd.cross(ud).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return _d.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return _d.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return _d.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return _d.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return _d.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let s,o;pd.subVectors(i,n),fd.subVectors(r,n),gd.subVectors(t,n);const a=pd.dot(gd),l=fd.dot(gd);if(a<=0&&l<=0)return e.copy(n);yd.subVectors(t,i);const c=pd.dot(yd),u=fd.dot(yd);if(c>=0&&u<=c)return e.copy(i);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),e.copy(n).addScaledVector(pd,s);vd.subVectors(t,r);const d=pd.dot(vd),p=fd.dot(vd);if(p>=0&&d<=p)return e.copy(r);const f=d*l-a*p;if(f<=0&&l>=0&&p<=0)return o=l/(l-p),e.copy(n).addScaledVector(fd,o);const m=c*p-d*u;if(m<=0&&u-c>=0&&d-p>=0)return md.subVectors(r,i),o=(u-c)/(u-c+(d-p)),e.copy(i).addScaledVector(md,o);const g=1/(m+f+h);return s=f*g,o=h*g,e.copy(n).addScaledVector(pd,s).addScaledVector(fd,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let xd=0;class bd extends Ou{constructor(){super(),Object.defineProperty(this,"id",{value:xd++}),this.uuid=Bu(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=su,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ru,this.stencilZFail=Ru,this.stencilZPass=Ru,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if("shading"===e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;continue}const i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}bd.prototype.isMaterial=!0;const wd={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Cd={h:0,s:0,l:0},Td={h:0,s:0,l:0};function Sd(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function Md(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Ed(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class Ad{constructor(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,n){return this.r=t,this.g=e,this.b=n,this}setHSL(t,e,n){if(t=Gu(t,1),e=Vu(e,0,1),n=Vu(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=Sd(r,i,t+1/3),this.g=Sd(r,i,t),this.b=Sd(r,i,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let t;const i=n[2];switch(n[1]){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){const n=parseFloat(t[1])/360,i=parseInt(t[2],10)/100,r=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(n,i,r)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=n[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=wd[t.toLowerCase()];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=Md(t.r),this.g=Md(t.g),this.b=Md(t.b),this}copyLinearToSRGB(t){return this.r=Ed(t.r),this.g=Ed(t.g),this.b=Ed(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){const e=this.r,n=this.g,i=this.b,r=Math.max(e,n,i),s=Math.min(e,n,i);let o,a;const l=(s+r)/2;if(s===r)o=0,a=0;else{const t=r-s;switch(a=l<=.5?t/(r+s):t/(2-r-s),r){case e:o=(n-i)/t+(n<i?6:0);break;case n:o=(i-e)/t+2;break;case i:o=(e-n)/t+4}o/=6}return t.h=o,t.s=a,t.l=l,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,n){return this.getHSL(Cd),Cd.h+=t,Cd.s+=e,Cd.l+=n,this.setHSL(Cd.h,Cd.s,Cd.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Cd),t.getHSL(Td);const n=ju(Cd.h,Td.h,e),i=ju(Cd.s,Td.s,e),r=ju(Cd.l,Td.l,e);return this.setHSL(n,i,r),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Ad.NAMES=wd,Ad.prototype.isColor=!0,Ad.prototype.r=1,Ad.prototype.g=1,Ad.prototype.b=1;class Dd extends bd{constructor(t){super(),this.type="MeshBasicMaterial",this.color=new Ad(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this}}Dd.prototype.isMeshBasicMaterial=!0;const Pd=new oh,Ld=new Xu;class Rd{constructor(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.usage=Iu,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),r=new Ad),e[n++]=r.r,e[n++]=r.g,e[n++]=r.b}return this}copyVector2sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),r=new Xu),e[n++]=r.x,e[n++]=r.y}return this}copyVector3sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),r=new oh),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z}return this}copyVector4sArray(t){const e=this.array;let n=0;for(let i=0,r=t.length;i<r;i++){let r=t[i];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),r=new nh),e[n++]=r.x,e[n++]=r.y,e[n++]=r.z,e[n++]=r.w}return this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Ld.fromBufferAttribute(this,e),Ld.applyMatrix3(t),this.setXY(e,Ld.x,Ld.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Pd.fromBufferAttribute(this,e),Pd.applyMatrix3(t),this.setXYZ(e,Pd.x,Pd.y,Pd.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Pd.x=this.getX(e),Pd.y=this.getY(e),Pd.z=this.getZ(e),Pd.applyMatrix4(t),this.setXYZ(e,Pd.x,Pd.y,Pd.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Pd.x=this.getX(e),Pd.y=this.getY(e),Pd.z=this.getZ(e),Pd.applyNormalMatrix(t),this.setXYZ(e,Pd.x,Pd.y,Pd.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Pd.x=this.getX(e),Pd.y=this.getY(e),Pd.z=this.getZ(e),Pd.transformDirection(t),this.setXYZ(e,Pd.x,Pd.y,Pd.z);return this}set(t,e=0){return this.array.set(t,e),this}getX(t){return this.array[t*this.itemSize]}setX(t,e){return this.array[t*this.itemSize]=e,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,e){return this.array[t*this.itemSize+1]=e,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,e){return this.array[t*this.itemSize+2]=e,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,e){return this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return this.array[0+(t*=this.itemSize)]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==Iu&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}}Rd.prototype.isBufferAttribute=!0;class Id extends Rd{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Nd extends Rd{constructor(t,e,n){super(new Uint32Array(t),e,n)}}(class extends Rd{constructor(t,e,n){super(new Uint16Array(t),e,n)}}).prototype.isFloat16BufferAttribute=!0;class kd extends Rd{constructor(t,e,n){super(new Float32Array(t),e,n)}}function Od(t){if(0===t.length)return-1/0;let e=t[0];for(let n=1,i=t.length;n<i;++n)t[n]>e&&(e=t[n]);return e}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;let zd=0;const Fd=new zh,Ud=new ld,Hd=new oh,Bd=new ch,Vd=new ch,Gd=new oh;class jd extends Ou{constructor(){super(),Object.defineProperty(this,"id",{value:zd++}),this.uuid=Bu(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return this.index=Array.isArray(t)?new(Od(t)>65535?Nd:Id)(t,1):t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new Ju).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Fd.makeRotationFromQuaternion(t),this.applyMatrix4(Fd),this}rotateX(t){return Fd.makeRotationX(t),this.applyMatrix4(Fd),this}rotateY(t){return Fd.makeRotationY(t),this.applyMatrix4(Fd),this}rotateZ(t){return Fd.makeRotationZ(t),this.applyMatrix4(Fd),this}translate(t,e,n){return Fd.makeTranslation(t,e,n),this.applyMatrix4(Fd),this}scale(t,e,n){return Fd.makeScale(t,e,n),this.applyMatrix4(Fd),this}lookAt(t){return Ud.lookAt(t),Ud.updateMatrix(),this.applyMatrix4(Ud.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Hd).negate(),this.translate(Hd.x,Hd.y,Hd.z),this}setFromPoints(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new kd(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ch);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new oh(-1/0,-1/0,-1/0),new oh(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let n=0,i=e.length;n<i;n++)Bd.setFromBufferAttribute(e[n]),this.morphTargetsRelative?(Gd.addVectors(this.boundingBox.min,Bd.min),this.boundingBox.expandByPoint(Gd),Gd.addVectors(this.boundingBox.max,Bd.max),this.boundingBox.expandByPoint(Gd)):(this.boundingBox.expandByPoint(Bd.min),this.boundingBox.expandByPoint(Bd.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Ah);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new oh,1/0);if(t){const n=this.boundingSphere.center;if(Bd.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++)Vd.setFromBufferAttribute(e[t]),this.morphTargetsRelative?(Gd.addVectors(Bd.min,Vd.min),Bd.expandByPoint(Gd),Gd.addVectors(Bd.max,Vd.max),Bd.expandByPoint(Gd)):(Bd.expandByPoint(Vd.min),Bd.expandByPoint(Vd.max));Bd.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)Gd.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(Gd));if(e)for(let r=0,s=e.length;r<s;r++){const s=e[r],o=this.morphTargetsRelative;for(let e=0,r=s.count;e<r;e++)Gd.fromBufferAttribute(s,e),o&&(Hd.fromBufferAttribute(t,e),Gd.add(Hd)),i=Math.max(i,n.distanceToSquared(Gd))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeFaceNormals(){}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=t.array,i=e.position.array,r=e.normal.array,s=e.uv.array,o=i.length/3;void 0===e.tangent&&this.setAttribute("tangent",new Rd(new Float32Array(4*o),4));const a=e.tangent.array,l=[],c=[];for(let S=0;S<o;S++)l[S]=new oh,c[S]=new oh;const u=new oh,h=new oh,d=new oh,p=new Xu,f=new Xu,m=new Xu,g=new oh,y=new oh;function v(t,e,n){u.fromArray(i,3*t),h.fromArray(i,3*e),d.fromArray(i,3*n),p.fromArray(s,2*t),f.fromArray(s,2*e),m.fromArray(s,2*n),h.sub(u),d.sub(u),f.sub(p),m.sub(p);const r=1/(f.x*m.y-m.x*f.y);isFinite(r)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(r),y.copy(d).multiplyScalar(f.x).addScaledVector(h,-m.x).multiplyScalar(r),l[t].add(g),l[e].add(g),l[n].add(g),c[t].add(y),c[e].add(y),c[n].add(y))}let _=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(let S=0,M=_.length;S<M;++S){const t=_[S],e=t.start;for(let i=e,r=e+t.count;i<r;i+=3)v(n[i+0],n[i+1],n[i+2])}const x=new oh,b=new oh,w=new oh,C=new oh;function T(t){w.fromArray(r,3*t),C.copy(w);const e=l[t];x.copy(e),x.sub(w.multiplyScalar(w.dot(e))).normalize(),b.crossVectors(C,e);const n=b.dot(c[t])<0?-1:1;a[4*t]=x.x,a[4*t+1]=x.y,a[4*t+2]=x.z,a[4*t+3]=n}for(let S=0,M=_.length;S<M;++S){const t=_[S],e=t.start;for(let i=e,r=e+t.count;i<r;i+=3)T(n[i+0]),T(n[i+1]),T(n[i+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Rd(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new oh,r=new oh,s=new oh,o=new oh,a=new oh,l=new oh,c=new oh,u=new oh;if(t)for(let h=0,d=t.count;h<d;h+=3){const d=t.getX(h+0),p=t.getX(h+1),f=t.getX(h+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,p),s.fromBufferAttribute(e,f),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),o.fromBufferAttribute(n,d),a.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),o.add(c),a.add(c),l.add(c),n.setXYZ(d,o.x,o.y,o.z),n.setXYZ(p,a.x,a.y,a.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,h=e.count;t<h;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),c.subVectors(s,r),u.subVectors(i,r),c.cross(u),n.setXYZ(t+0,c.x,c.y,c.z),n.setXYZ(t+1,c.x,c.y,c.z),n.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const i in n){if(void 0===t.attributes[i])continue;const r=n[i].array,s=t.attributes[i],o=s.array,a=s.itemSize*e,l=Math.min(o.length,r.length-a);for(let t=0,e=a;t<l;t++,e++)r[e]=o[t]}return this}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)Gd.fromBufferAttribute(t,e),Gd.normalize(),t.setXYZ(e,Gd.x,Gd.y,Gd.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,s=new n.constructor(e.length*i);let o=0,a=0;for(let l=0,c=e.length;l<c;l++){o=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*i;for(let t=0;t<i;t++)s[a++]=n[o++]}return new Rd(s,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new jd,n=this.index.array,i=this.attributes;for(const o in i){const r=t(i[o],n);e.setAttribute(o,r)}const r=this.morphAttributes;for(const o in r){const i=[],s=r[o];for(let e=0,r=s.length;e<r;e++){const r=t(s[e],n);i.push(r)}e.morphAttributes[o]=i}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let o=0,a=s.length;o<a;o++){const t=s[o];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const a in n)t.data.attributes[a]=n[a].toJSON(t.data);const i={};let r=!1;for(const a in this.morphAttributes){const e=this.morphAttributes[a],n=[];for(let i=0,r=e.length;i<r;i++)n.push(e[i].toJSON(t.data));n.length>0&&(i[a]=n,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return(new jd).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const i=t.attributes;for(const l in i)this.setAttribute(l,i[l].clone(e));const r=t.morphAttributes;for(const l in r){const t=[],n=r[l];for(let i=0,r=n.length;i<r;i++)t.push(n[i].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let l=0,c=s.length;l<c;l++){const t=s[l];this.addGroup(t.start,t.count,t.materialIndex)}const o=t.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}jd.prototype.isBufferGeometry=!0;const Wd=new zh,qd=new Oh,Zd=new Ah,Yd=new oh,Xd=new oh,Jd=new oh,$d=new oh,Qd=new oh,Kd=new oh,tp=new oh,ep=new oh,np=new oh,ip=new Xu,rp=new Xu,sp=new Xu,op=new oh,ap=new oh;class lp extends ld{constructor(t=new jd,e=new Dd){super(),this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(t,e){const n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0===i)return;if(null===n.boundingSphere&&n.computeBoundingSphere(),Zd.copy(n.boundingSphere),Zd.applyMatrix4(r),!1===t.ray.intersectsSphere(Zd))return;if(Wd.copy(r).invert(),qd.copy(t.ray).applyMatrix4(Wd),null!==n.boundingBox&&!1===qd.intersectsBox(n.boundingBox))return;let s;if(n.isBufferGeometry){const r=n.index,o=n.attributes.position,a=n.morphAttributes.position,l=n.morphTargetsRelative,c=n.attributes.uv,u=n.attributes.uv2,h=n.groups,d=n.drawRange;if(null!==r)if(Array.isArray(i))for(let n=0,p=h.length;n<p;n++){const p=h[n],f=i[p.materialIndex];for(let n=Math.max(p.start,d.start),i=Math.min(p.start+p.count,d.start+d.count);n<i;n+=3){const i=r.getX(n),h=r.getX(n+1),d=r.getX(n+2);s=cp(this,f,t,qd,o,a,l,c,u,i,h,d),s&&(s.faceIndex=Math.floor(n/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else for(let n=Math.max(0,d.start),p=Math.min(r.count,d.start+d.count);n<p;n+=3){const h=r.getX(n),d=r.getX(n+1),p=r.getX(n+2);s=cp(this,i,t,qd,o,a,l,c,u,h,d,p),s&&(s.faceIndex=Math.floor(n/3),e.push(s))}else if(void 0!==o)if(Array.isArray(i))for(let n=0,p=h.length;n<p;n++){const r=h[n],p=i[r.materialIndex];for(let n=Math.max(r.start,d.start),i=Math.min(r.start+r.count,d.start+d.count);n<i;n+=3)s=cp(this,p,t,qd,o,a,l,c,u,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),s.face.materialIndex=r.materialIndex,e.push(s))}else for(let n=Math.max(0,d.start),p=Math.min(o.count,d.start+d.count);n<p;n+=3)s=cp(this,i,t,qd,o,a,l,c,u,n,n+1,n+2),s&&(s.faceIndex=Math.floor(n/3),e.push(s))}else n.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function cp(t,e,n,i,r,s,o,a,l,c,u,h){Yd.fromBufferAttribute(r,c),Xd.fromBufferAttribute(r,u),Jd.fromBufferAttribute(r,h);const d=t.morphTargetInfluences;if(e.morphTargets&&s&&d){tp.set(0,0,0),ep.set(0,0,0),np.set(0,0,0);for(let t=0,e=s.length;t<e;t++){const e=d[t],n=s[t];0!==e&&($d.fromBufferAttribute(n,c),Qd.fromBufferAttribute(n,u),Kd.fromBufferAttribute(n,h),o?(tp.addScaledVector($d,e),ep.addScaledVector(Qd,e),np.addScaledVector(Kd,e)):(tp.addScaledVector($d.sub(Yd),e),ep.addScaledVector(Qd.sub(Xd),e),np.addScaledVector(Kd.sub(Jd),e)))}Yd.add(tp),Xd.add(ep),Jd.add(np)}t.isSkinnedMesh&&(t.boneTransform(c,Yd),t.boneTransform(u,Xd),t.boneTransform(h,Jd));const p=function(t,e,n,i,r,s,o,a){let l;if(l=1===e.side?i.intersectTriangle(o,s,r,!0,a):i.intersectTriangle(r,s,o,2!==e.side,a),null===l)return null;ap.copy(a),ap.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(ap);return c<n.near||c>n.far?null:{distance:c,point:ap.clone(),object:t}}(t,e,n,i,Yd,Xd,Jd,op);if(p){a&&(ip.fromBufferAttribute(a,c),rp.fromBufferAttribute(a,u),sp.fromBufferAttribute(a,h),p.uv=_d.getUV(op,Yd,Xd,Jd,ip,rp,sp,new Xu)),l&&(ip.fromBufferAttribute(l,c),rp.fromBufferAttribute(l,u),sp.fromBufferAttribute(l,h),p.uv2=_d.getUV(op,Yd,Xd,Jd,ip,rp,sp,new Xu));const t={a:c,b:u,c:h,normal:new oh,materialIndex:0};_d.getNormal(Yd,Xd,Jd,t.normal),p.face=t}return p}lp.prototype.isMesh=!0;class up extends jd{constructor(t=1,e=1,n=1,i=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const o=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function p(t,e,n,i,r,s,p,f,m,g,y){const v=s/m,_=p/g,x=s/2,b=p/2,w=f/2,C=m+1,T=g+1;let S=0,M=0;const E=new oh;for(let o=0;o<T;o++){const s=o*_-b;for(let a=0;a<C;a++)E[t]=(a*v-x)*i,E[e]=s*r,E[n]=w,l.push(E.x,E.y,E.z),E[t]=0,E[e]=0,E[n]=f>0?1:-1,c.push(E.x,E.y,E.z),u.push(a/m),u.push(1-o/g),S+=1}for(let o=0;o<g;o++)for(let t=0;t<m;t++){const e=h+t+C*(o+1),n=h+(t+1)+C*(o+1),i=h+(t+1)+C*o;a.push(h+t+C*o,e,i),a.push(e,n,i),M+=6}o.addGroup(d,M,y),d+=M,h+=S}p("z","y","x",-1,-1,n,e,t,s,r,0),p("z","y","x",1,-1,n,e,-t,s,r,1),p("x","z","y",1,1,t,n,e,i,s,2),p("x","z","y",1,-1,t,n,-e,i,s,3),p("x","y","z",1,-1,t,e,n,i,r,4),p("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(a),this.setAttribute("position",new kd(l,3)),this.setAttribute("normal",new kd(c,3)),this.setAttribute("uv",new kd(u,2))}static fromJSON(t){return new up(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function hp(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];e[n][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function dp(t){const e={};for(let n=0;n<t.length;n++){const i=hp(t[n]);for(const t in i)e[t]=i[t]}return e}const pp={clone:hp,merge:dp};class fp extends bd{constructor(t){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=hp(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;e.uniforms[i]=n&&n.isTexture?{type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?{type:"c",value:n.getHex()}:n&&n.isVector2?{type:"v2",value:n.toArray()}:n&&n.isVector3?{type:"v3",value:n.toArray()}:n&&n.isVector4?{type:"v4",value:n.toArray()}:n&&n.isMatrix3?{type:"m3",value:n.toArray()}:n&&n.isMatrix4?{type:"m4",value:n.toArray()}:{value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}fp.prototype.isShaderMaterial=!0;class mp extends ld{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new zh,this.projectionMatrix=new zh,this.projectionMatrixInverse=new zh}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}mp.prototype.isCamera=!0;class gp extends mp{constructor(t=50,e=1,n=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*Hu*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*Uu*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*Hu*Math.atan(Math.tan(.5*Uu*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,i,r,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*Uu*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,o=s.fullHeight;r+=s.offsetX*i/t,e-=s.offsetY*n/o,i*=s.width/t,n*=s.height/o}const o=this.filmOffset;0!==o&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}gp.prototype.isPerspectiveCamera=!0;const yp=90;class vp extends ld{constructor(t,e,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const i=new gp(yp,1,t,e);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new oh(1,0,0)),this.add(i);const r=new gp(yp,1,t,e);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new oh(-1,0,0)),this.add(r);const s=new gp(yp,1,t,e);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new oh(0,1,0)),this.add(s);const o=new gp(yp,1,t,e);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new oh(0,-1,0)),this.add(o);const a=new gp(yp,1,t,e);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new oh(0,0,1)),this.add(a);const l=new gp(yp,1,t,e);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new oh(0,0,-1)),this.add(l)}update(t,e){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[i,r,s,o,a,l]=this.children,c=t.xr.enabled,u=t.getRenderTarget();t.xr.enabled=!1;const h=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,r),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,o),t.setRenderTarget(n,4),t.render(e,a),n.texture.generateMipmaps=h,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(u),t.xr.enabled=c}}class _p extends th{constructor(t,e,n,i,r,s,o,a,l,c){super(t=void 0!==t?t:[],e=void 0!==e?e:301,n,i,r,s,o=void 0!==o?o:xu,a,l,c),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}_p.prototype.isCubeTexture=!0;class xp extends ih{constructor(t,e,n){Number.isInteger(e)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=n),super(t,t,e),this.texture=new _p(void 0,(e=e||{}).mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:du,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.format=bu,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n=new up(5,5,5),i=new fp({name:"CubemapFromEquirect",uniforms:hp({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:1,blending:0});i.uniforms.tEquirect.value=e;const r=new lp(n,i),s=e.minFilter;return e.minFilter===pu&&(e.minFilter=du),new vp(1,10,this).update(t,r),e.minFilter=s,r.geometry.dispose(),r.material.dispose(),this}clear(t,e,n,i){const r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,i);t.setRenderTarget(r)}}xp.prototype.isWebGLCubeRenderTarget=!0;const bp=new oh,wp=new oh,Cp=new Ju;class Tp{constructor(t=new oh(1,0,0),e=0){this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=bp.subVectors(n,e).cross(wp.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){const n=t.delta(bp),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(n).multiplyScalar(r).add(t.start)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Cp.getNormalMatrix(t),i=this.coplanarPoint(bp).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Tp.prototype.isPlane=!0;const Sp=new Ah,Mp=new oh;class Ep{constructor(t=new Tp,e=new Tp,n=new Tp,i=new Tp,r=new Tp,s=new Tp){this.planes=[t,e,n,i,r,s]}set(t,e,n,i,r,s){const o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){const e=this.planes,n=t.elements,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],d=n[9],p=n[10],f=n[11],m=n[12],g=n[13],y=n[14],v=n[15];return e[0].setComponents(o-i,u-a,f-h,v-m).normalize(),e[1].setComponents(o+i,u+a,f+h,v+m).normalize(),e[2].setComponents(o+r,u+l,f+d,v+g).normalize(),e[3].setComponents(o-r,u-l,f-d,v-g).normalize(),e[4].setComponents(o-s,u-c,f-p,v-y).normalize(),e[5].setComponents(o+s,u+c,f+p,v+y).normalize(),this}intersectsObject(t){const e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Sp.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Sp)}intersectsSprite(t){return Sp.center.set(0,0,0),Sp.radius=.7071067811865476,Sp.applyMatrix4(t.matrixWorld),this.intersectsSphere(Sp)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let r=0;r<6;r++)if(e[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(Mp.x=i.normal.x>0?t.max.x:t.min.x,Mp.y=i.normal.y>0?t.max.y:t.min.y,Mp.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(Mp)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Ap(){let t=null,e=!1,n=null,i=null;function r(e,s){n(e,s),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Dp(t,e){const n=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=i.get(e);n&&(t.deleteBuffer(n.buffer),i.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){const t=i.get(e);return void((!t||t.version<e.version)&&i.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const s=i.get(e);void 0===s?i.set(e,function(e,i){const r=e.array,s=e.usage,o=t.createBuffer();t.bindBuffer(i,o),t.bufferData(i,r,s),e.onUploadCallback();let a=5126;return r instanceof Float32Array?a=5126:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?e.isFloat16BufferAttribute?n?a=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):a=5123:r instanceof Int16Array?a=5122:r instanceof Uint32Array?a=5125:r instanceof Int32Array?a=5124:r instanceof Int8Array?a=5120:(r instanceof Uint8Array||r instanceof Uint8ClampedArray)&&(a=5121),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}(e,r)):s.version<e.version&&(function(e,i,r){const s=i.array,o=i.updateRange;t.bindBuffer(r,e),-1===o.count?t.bufferSubData(r,0,s):(n?t.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):t.bufferSubData(r,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1)}(s.buffer,e,r),s.version=e.version)}}}class Pp extends jd{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,s=e/2,o=Math.floor(n),a=Math.floor(i),l=o+1,c=a+1,u=t/o,h=e/a,d=[],p=[],f=[],m=[];for(let g=0;g<c;g++){const t=g*h-s;for(let e=0;e<l;e++)p.push(e*u-r,-t,0),f.push(0,0,1),m.push(e/o),m.push(1-g/a)}for(let g=0;g<a;g++)for(let t=0;t<o;t++){const e=t+l*(g+1),n=t+1+l*(g+1),i=t+1+l*g;d.push(t+l*g,e,i),d.push(e,n,i)}this.setIndex(d),this.setAttribute("position",new kd(p,3)),this.setAttribute("normal",new kd(f,3)),this.setAttribute("uv",new kd(m,2))}static fromJSON(t){return new Pp(t.width,t.height,t.widthSegments,t.heightSegments)}}const Lp={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotVH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSNMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition.xyz / vWorldPosition.w;\n\tvec3 v = normalize( cameraPosition - pos );\n\tfloat ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );\n\tvec3 transmission = transmissionFactor * getIBLVolumeRefraction(\n\t\tnormal, v, roughnessFactor, material.diffuseColor, totalSpecular,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec4 vWorldPosition;\n\tvec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {\n\t\tvec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length(vec3(modelMatrix[0].xyz));\n\t\tmodelScale.y = length(vec3(modelMatrix[1].xyz));\n\t\tmodelScale.z = length(vec3(modelMatrix[2].xyz));\n\t\treturn normalize(refractionVector) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness(float roughness, float ior) {\n\t\treturn roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);\n\t}\n\tvec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {\n\t\tfloat framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);\n\t\treturn texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;\n\t}\n\tvec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {\n\t\tif (attenuationDistance == 0.0) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;\n\t\t\tvec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec3 getIBLVolumeRefraction(vec3 n, vec3 v, float perceptualRoughness, vec3 baseColor, vec3 specularColor,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);\n\t\tvec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);\n\t\treturn (1.0 - specularColor) * attenuatedColor * baseColor;\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform vec3 attenuationColor;\n\tuniform float attenuationDistance;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#ifdef USE_TRANSMISSION\n\tvarying vec4 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition;\n#endif\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Rp={common:{diffuse:{value:new Ad(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ju},uv2Transform:{value:new Ju},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Xu(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ad(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ad(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ju}},sprite:{diffuse:{value:new Ad(16777215)},opacity:{value:1},center:{value:new Xu(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ju}}},Ip={basic:{uniforms:dp([Rp.common,Rp.specularmap,Rp.envmap,Rp.aomap,Rp.lightmap,Rp.fog]),vertexShader:Lp.meshbasic_vert,fragmentShader:Lp.meshbasic_frag},lambert:{uniforms:dp([Rp.common,Rp.specularmap,Rp.envmap,Rp.aomap,Rp.lightmap,Rp.emissivemap,Rp.fog,Rp.lights,{emissive:{value:new Ad(0)}}]),vertexShader:Lp.meshlambert_vert,fragmentShader:Lp.meshlambert_frag},phong:{uniforms:dp([Rp.common,Rp.specularmap,Rp.envmap,Rp.aomap,Rp.lightmap,Rp.emissivemap,Rp.bumpmap,Rp.normalmap,Rp.displacementmap,Rp.fog,Rp.lights,{emissive:{value:new Ad(0)},specular:{value:new Ad(1118481)},shininess:{value:30}}]),vertexShader:Lp.meshphong_vert,fragmentShader:Lp.meshphong_frag},standard:{uniforms:dp([Rp.common,Rp.envmap,Rp.aomap,Rp.lightmap,Rp.emissivemap,Rp.bumpmap,Rp.normalmap,Rp.displacementmap,Rp.roughnessmap,Rp.metalnessmap,Rp.fog,Rp.lights,{emissive:{value:new Ad(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Lp.meshphysical_vert,fragmentShader:Lp.meshphysical_frag},toon:{uniforms:dp([Rp.common,Rp.aomap,Rp.lightmap,Rp.emissivemap,Rp.bumpmap,Rp.normalmap,Rp.displacementmap,Rp.gradientmap,Rp.fog,Rp.lights,{emissive:{value:new Ad(0)}}]),vertexShader:Lp.meshtoon_vert,fragmentShader:Lp.meshtoon_frag},matcap:{uniforms:dp([Rp.common,Rp.bumpmap,Rp.normalmap,Rp.displacementmap,Rp.fog,{matcap:{value:null}}]),vertexShader:Lp.meshmatcap_vert,fragmentShader:Lp.meshmatcap_frag},points:{uniforms:dp([Rp.points,Rp.fog]),vertexShader:Lp.points_vert,fragmentShader:Lp.points_frag},dashed:{uniforms:dp([Rp.common,Rp.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Lp.linedashed_vert,fragmentShader:Lp.linedashed_frag},depth:{uniforms:dp([Rp.common,Rp.displacementmap]),vertexShader:Lp.depth_vert,fragmentShader:Lp.depth_frag},normal:{uniforms:dp([Rp.common,Rp.bumpmap,Rp.normalmap,Rp.displacementmap,{opacity:{value:1}}]),vertexShader:Lp.normal_vert,fragmentShader:Lp.normal_frag},sprite:{uniforms:dp([Rp.sprite,Rp.fog]),vertexShader:Lp.sprite_vert,fragmentShader:Lp.sprite_frag},background:{uniforms:{uvTransform:{value:new Ju},t2D:{value:null}},vertexShader:Lp.background_vert,fragmentShader:Lp.background_frag},cube:{uniforms:dp([Rp.envmap,{opacity:{value:1}}]),vertexShader:Lp.cube_vert,fragmentShader:Lp.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Lp.equirect_vert,fragmentShader:Lp.equirect_frag},distanceRGBA:{uniforms:dp([Rp.common,Rp.displacementmap,{referencePosition:{value:new oh},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Lp.distanceRGBA_vert,fragmentShader:Lp.distanceRGBA_frag},shadow:{uniforms:dp([Rp.lights,Rp.fog,{color:{value:new Ad(0)},opacity:{value:1}}]),vertexShader:Lp.shadow_vert,fragmentShader:Lp.shadow_frag}};function Np(t,e,n,i,r){const s=new Ad(0);let o,a,l=0,c=null,u=0,h=null;function d(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,r)}return{getClearColor:function(){return s},setClearColor:function(t,e=1){s.set(t),l=e,d(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(t){l=t,d(s,l)},render:function(n,r){let p=!1,f=!0===r.isScene?r.background:null;f&&f.isTexture&&(f=e.get(f));const m=t.xr,g=m.getSession&&m.getSession();g&&"additive"===g.environmentBlendMode&&(f=null),null===f?d(s,l):f&&f.isColor&&(d(f,1),p=!0),(t.autoClear||p)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),f&&(f.isCubeTexture||306===f.mapping)?(void 0===a&&(a=new lp(new up(1,1,1),new fp({name:"BackgroundCubeMaterial",uniforms:hp(Ip.cube.uniforms),vertexShader:Ip.cube.vertexShader,fragmentShader:Ip.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),a.geometry.deleteAttribute("uv"),a.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(a.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(a)),a.material.uniforms.envMap.value=f,a.material.uniforms.flipEnvMap.value=f.isCubeTexture&&f._needsFlipEnvMap?-1:1,c===f&&u===f.version&&h===t.toneMapping||(a.material.needsUpdate=!0,c=f,u=f.version,h=t.toneMapping),n.unshift(a,a.geometry,a.material,0,0,null)):f&&f.isTexture&&(void 0===o&&(o=new lp(new Pp(2,2),new fp({name:"BackgroundMaterial",uniforms:hp(Ip.background.uniforms),vertexShader:Ip.background.vertexShader,fragmentShader:Ip.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(o)),o.material.uniforms.t2D.value=f,!0===f.matrixAutoUpdate&&f.updateMatrix(),o.material.uniforms.uvTransform.value.copy(f.matrix),c===f&&u===f.version&&h===t.toneMapping||(o.material.needsUpdate=!0,c=f,u=f.version,h=t.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null))}}}function kp(t,e,n,i){const r=t.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=d(null);let c=l;function u(e){return i.isWebGL2?t.bindVertexArray(e):s.bindVertexArrayOES(e)}function h(e){return i.isWebGL2?t.deleteVertexArray(e):s.deleteVertexArrayOES(e)}function d(t){const e=[],n=[],i=[];for(let s=0;s<r;s++)e[s]=0,n[s]=0,i[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:i,object:t,attributes:{},index:null}}function p(){const t=c.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function f(t){m(t,0)}function m(n,r){const s=c.enabledAttributes,o=c.attributeDivisors;c.newAttributes[n]=1,0===s[n]&&(t.enableVertexAttribArray(n),s[n]=1),o[n]!==r&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),o[n]=r)}function g(){const e=c.newAttributes,n=c.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function y(e,n,r,s,o,a){!0!==i.isWebGL2||5124!==r&&5125!==r?t.vertexAttribPointer(e,n,r,s,o,a):t.vertexAttribIPointer(e,n,r,o,a)}function v(){_(),c!==l&&(c=l,u(c.object))}function _(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,h,v,_){let x=!1;if(o){const e=function(e,n,r){const o=!0===r.wireframe;let l=a[e.id];void 0===l&&(l={},a[e.id]=l);let c=l[n.id];void 0===c&&(c={},l[n.id]=c);let u=c[o];return void 0===u&&(u=d(i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()),c[o]=u),u}(v,h,l);c!==e&&(c=e,u(c.object)),x=function(t,e){const n=c.attributes,i=t.attributes;let r=0;for(const s in i){const t=n[s],e=i[s];if(void 0===t)return!0;if(t.attribute!==e)return!0;if(t.data!==e.data)return!0;r++}return c.attributesNum!==r||c.index!==e}(v,_),x&&function(t,e){const n={},i=t.attributes;let r=0;for(const s in i){const t=i[s],e={};e.attribute=t,t.data&&(e.data=t.data),n[s]=e,r++}c.attributes=n,c.attributesNum=r,c.index=e}(v,_)}else{const t=!0===l.wireframe;c.geometry===v.id&&c.program===h.id&&c.wireframe===t||(c.geometry=v.id,c.program=h.id,c.wireframe=t,x=!0)}!0===r.isInstancedMesh&&(x=!0),null!==_&&n.update(_,34963),x&&(function(r,s,o,a){if(!1===i.isWebGL2&&(r.isInstancedMesh||a.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;p();const l=a.attributes,c=o.getAttributes(),u=s.defaultAttributeValues;for(const e in c){const i=c[e];if(i>=0){const s=l[e];if(void 0!==s){const e=s.normalized,r=s.itemSize,o=n.get(s);if(void 0===o)continue;const l=o.buffer,c=o.type,u=o.bytesPerElement;if(s.isInterleavedBufferAttribute){const n=s.data,o=n.stride,h=s.offset;n&&n.isInstancedInterleavedBuffer?(m(i,n.meshPerAttribute),void 0===a._maxInstanceCount&&(a._maxInstanceCount=n.meshPerAttribute*n.count)):f(i),t.bindBuffer(34962,l),y(i,r,c,e,o*u,h*u)}else s.isInstancedBufferAttribute?(m(i,s.meshPerAttribute),void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)):f(i),t.bindBuffer(34962,l),y(i,r,c,e,0,0)}else if("instanceMatrix"===e){const e=n.get(r.instanceMatrix);if(void 0===e)continue;const s=e.buffer,o=e.type;m(i+0,1),m(i+1,1),m(i+2,1),m(i+3,1),t.bindBuffer(34962,s),t.vertexAttribPointer(i+0,4,o,!1,64,0),t.vertexAttribPointer(i+1,4,o,!1,64,16),t.vertexAttribPointer(i+2,4,o,!1,64,32),t.vertexAttribPointer(i+3,4,o,!1,64,48)}else if("instanceColor"===e){const e=n.get(r.instanceColor);if(void 0===e)continue;const s=e.buffer,o=e.type;m(i,1),t.bindBuffer(34962,s),t.vertexAttribPointer(i,3,o,!1,12,0)}else if(void 0!==u){const n=u[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(i,n);break;case 3:t.vertexAttrib3fv(i,n);break;case 4:t.vertexAttrib4fv(i,n);break;default:t.vertexAttrib1fv(i,n)}}}}g()}(r,l,h,v),null!==_&&t.bindBuffer(34963,n.get(_).buffer))},reset:v,resetDefaultState:_,dispose:function(){v();for(const t in a){const e=a[t];for(const t in e){const n=e[t];for(const t in n)h(n[t].object),delete n[t];delete e[t]}delete a[t]}},releaseStatesOfGeometry:function(t){if(void 0===a[t.id])return;const e=a[t.id];for(const n in e){const t=e[n];for(const e in t)h(t[e].object),delete t[e];delete e[n]}delete a[t.id]},releaseStatesOfProgram:function(t){for(const e in a){const n=a[e];if(void 0===n[t.id])continue;const i=n[t.id];for(const t in i)h(i[t].object),delete i[t];delete n[t.id]}},initAttributes:p,enableAttribute:f,disableUnusedAttributes:g}}function Op(t,e,n,i){const r=i.isWebGL2;let s;this.setMode=function(t){s=t},this.render=function(e,i){t.drawArrays(s,e,i),n.update(i,s,1)},this.renderInstances=function(i,o,a){if(0===a)return;let l,c;if(r)l=t,c="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](s,i,o,a),n.update(o,s,a)}}function zp(t,e,n){let i;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext;let o=void 0!==n.precision?n.precision:"highp";const a=r(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const l=s||e.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=t.getParameter(34930),h=t.getParameter(35660),d=t.getParameter(3379),p=t.getParameter(34076),f=t.getParameter(34921),m=t.getParameter(36347),g=t.getParameter(36348),y=t.getParameter(36349),v=h>0,_=s||e.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:v,floatFragmentTextures:_,floatVertexTextures:v&&_,maxSamples:s?t.getParameter(36183):0}}function Fp(t){const e=this;let n=null,i=0,r=!1,s=!1;const o=new Tp,a=new Ju,l={value:null,needsUpdate:!1};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(t,n,i,r){const s=null!==t?t.length:0;let c=null;if(0!==s){if(c=l.value,!0!==r||null===c){const e=i+4*s,r=n.matrixWorldInverse;a.getNormalMatrix(r),(null===c||c.length<e)&&(c=new Float32Array(e));for(let n=0,l=i;n!==s;++n,l+=4)o.copy(t[n]).applyMatrix4(r,a),o.normal.toArray(c,l),c[l+3]=o.constant}l.value=c,l.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,s){const o=0!==t.length||e||0!==i||r;return r=e,n=u(t,s,0),i=t.length,o},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(e,o,a){const h=e.clippingPlanes,d=e.clipIntersection,p=e.clipShadows,f=t.get(e);if(!r||null===h||0===h.length||s&&!p)s?u(null):c();else{const t=s?0:i,e=4*t;let r=f.clippingState||null;l.value=r,r=u(h,o,e,a);for(let i=0;i!==e;++i)r[i]=n[i];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function Up(t){let e=new WeakMap;function n(t,e){return 303===e?t.mapping=301:304===e&&(t.mapping=302),t}function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(303===s||304===s){if(e.has(r))return n(e.get(r).texture,r.mapping);{const s=r.image;if(s&&s.height>0){const o=t.getRenderTarget(),a=new xp(s.height/2);return a.fromEquirectangularTexture(t,r),e.set(r,a),t.setRenderTarget(o),r.addEventListener("dispose",i),n(a.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}function Hp(t){const e={};function n(n){if(void 0!==e[n])return e[n];let i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(t){const e=n(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function Bp(t,e,n,i){const r={},s=new WeakMap;function o(t){const a=t.target;null!==a.index&&e.remove(a.index);for(const n in a.attributes)e.remove(a.attributes[n]);a.removeEventListener("dispose",o),delete r[a.id];const l=s.get(a);l&&(e.remove(l),s.delete(a)),i.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,n.memory.geometries--}function a(t){const n=[],i=t.index,r=t.attributes.position;let o=0;if(null!==i){const t=i.array;o=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],r=t[e+1],s=t[e+2];n.push(i,r,r,s,s,i)}}else{o=r.version;for(let t=0,e=r.array.length/3-1;t<e;t+=3){const e=t+0,i=t+1,r=t+2;n.push(e,i,i,r,r,e)}}const a=new(Od(n)>65535?Nd:Id)(n,1);a.version=o;const l=s.get(t);l&&e.remove(l),s.set(t,a)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",o),r[e.id]=!0,n.memory.geometries++),e},update:function(t){const n=t.attributes;for(const r in n)e.update(n[r],34962);const i=t.morphAttributes;for(const r in i){const t=i[r];for(let n=0,i=t.length;n<i;n++)e.update(t[n],34962)}},getWireframeAttribute:function(t){const e=s.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&a(t)}else a(t);return s.get(t)}}}function Vp(t,e,n,i){const r=i.isWebGL2;let s,o,a;this.setMode=function(t){s=t},this.setIndex=function(t){o=t.type,a=t.bytesPerElement},this.render=function(e,i){t.drawElements(s,i,o,e*a),n.update(i,s,1)},this.renderInstances=function(i,l,c){if(0===c)return;let u,h;if(r)u=t,h="drawElementsInstanced";else if(u=e.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](s,l,o,i*a,c),n.update(l,s,c)}}function Gp(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(e.calls++,n){case 4:e.triangles+=i*(t/3);break;case 1:e.lines+=i*(t/2);break;case 3:e.lines+=i*(t-1);break;case 2:e.lines+=i*t;break;case 0:e.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function jp(t,e){return t[0]-e[0]}function Wp(t,e){return Math.abs(e[1])-Math.abs(t[1])}function qp(t){const e={},n=new Float32Array(8),i=[];for(let r=0;r<8;r++)i[r]=[r,0];return{update:function(r,s,o,a){const l=r.morphTargetInfluences,c=void 0===l?0:l.length;let u=e[s.id];if(void 0===u||u.length!==c){u=[];for(let t=0;t<c;t++)u[t]=[t,0];e[s.id]=u}for(let t=0;t<c;t++){const e=u[t];e[0]=t,e[1]=l[t]}u.sort(Wp);for(let t=0;t<8;t++)t<c&&u[t][1]?(i[t][0]=u[t][0],i[t][1]=u[t][1]):(i[t][0]=Number.MAX_SAFE_INTEGER,i[t][1]=0);i.sort(jp);const h=o.morphTargets&&s.morphAttributes.position,d=o.morphNormals&&s.morphAttributes.normal;let p=0;for(let t=0;t<8;t++){const e=i[t],r=e[0],o=e[1];r!==Number.MAX_SAFE_INTEGER&&o?(h&&s.getAttribute("morphTarget"+t)!==h[r]&&s.setAttribute("morphTarget"+t,h[r]),d&&s.getAttribute("morphNormal"+t)!==d[r]&&s.setAttribute("morphNormal"+t,d[r]),n[t]=o,p+=o):(h&&!0===s.hasAttribute("morphTarget"+t)&&s.deleteAttribute("morphTarget"+t),d&&!0===s.hasAttribute("morphNormal"+t)&&s.deleteAttribute("morphNormal"+t),n[t]=0)}const f=s.morphTargetsRelative?1:1-p;a.getUniforms().setValue(t,"morphTargetBaseInfluence",f),a.getUniforms().setValue(t,"morphTargetInfluences",n)}}}function Zp(t,e,n,i){let r=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(t){const o=i.render.frame,a=e.get(t,t.geometry);return r.get(a)!==o&&(e.update(a),r.set(a,o)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",s)&&t.addEventListener("dispose",s),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),a},dispose:function(){r=new WeakMap}}}Ip.physical={uniforms:dp([Ip.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Xu(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Ad(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Xu},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ad(0)}}]),vertexShader:Lp.meshphysical_vert,fragmentShader:Lp.meshphysical_frag};class Yp extends th{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=cu,this.minFilter=cu,this.wrapR=au,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Yp.prototype.isDataTexture2DArray=!0;class Xp extends th{constructor(t=null,e=1,n=1,i=1){super(null),this.image={data:t,width:e,height:n,depth:i},this.magFilter=cu,this.minFilter=cu,this.wrapR=au,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Xp.prototype.isDataTexture3D=!0;const Jp=new th,$p=new Yp,Qp=new Xp,Kp=new _p,tf=[],ef=[],nf=new Float32Array(16),rf=new Float32Array(9),sf=new Float32Array(4);function of(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=tf[r];if(void 0===s&&(s=new Float32Array(r),tf[r]=s),0!==e){i.toArray(s,0);for(let i=1,r=0;i!==e;++i)r+=n,t[i].toArray(s,r)}return s}function af(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function lf(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function cf(t,e){let n=ef[e];void 0===n&&(n=new Int32Array(e),ef[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function uf(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function hf(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(af(n,e))return;t.uniform2fv(this.addr,e),lf(n,e)}}function df(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(af(n,e))return;t.uniform3fv(this.addr,e),lf(n,e)}}function pf(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(af(n,e))return;t.uniform4fv(this.addr,e),lf(n,e)}}function ff(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(af(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),lf(n,e)}else{if(af(n,i))return;sf.set(i),t.uniformMatrix2fv(this.addr,!1,sf),lf(n,i)}}function mf(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(af(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),lf(n,e)}else{if(af(n,i))return;rf.set(i),t.uniformMatrix3fv(this.addr,!1,rf),lf(n,i)}}function gf(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(af(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),lf(n,e)}else{if(af(n,i))return;nf.set(i),t.uniformMatrix4fv(this.addr,!1,nf),lf(n,i)}}function yf(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function vf(t,e){const n=this.cache;af(n,e)||(t.uniform2iv(this.addr,e),lf(n,e))}function _f(t,e){const n=this.cache;af(n,e)||(t.uniform3iv(this.addr,e),lf(n,e))}function xf(t,e){const n=this.cache;af(n,e)||(t.uniform4iv(this.addr,e),lf(n,e))}function bf(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function wf(t,e){const n=this.cache;af(n,e)||(t.uniform2uiv(this.addr,e),lf(n,e))}function Cf(t,e){const n=this.cache;af(n,e)||(t.uniform3uiv(this.addr,e),lf(n,e))}function Tf(t,e){const n=this.cache;af(n,e)||(t.uniform4uiv(this.addr,e),lf(n,e))}function Sf(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(e||Jp,r)}function Mf(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||Qp,r)}function Ef(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(e||Kp,r)}function Af(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||$p,r)}function Df(t,e){t.uniform1fv(this.addr,e)}function Pf(t,e){const n=of(e,this.size,2);t.uniform2fv(this.addr,n)}function Lf(t,e){const n=of(e,this.size,3);t.uniform3fv(this.addr,n)}function Rf(t,e){const n=of(e,this.size,4);t.uniform4fv(this.addr,n)}function If(t,e){const n=of(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Nf(t,e){const n=of(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function kf(t,e){const n=of(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Of(t,e){t.uniform1iv(this.addr,e)}function zf(t,e){t.uniform2iv(this.addr,e)}function Ff(t,e){t.uniform3iv(this.addr,e)}function Uf(t,e){t.uniform4iv(this.addr,e)}function Hf(t,e){t.uniform1uiv(this.addr,e)}function Bf(t,e){t.uniform2uiv(this.addr,e)}function Vf(t,e){t.uniform3uiv(this.addr,e)}function Gf(t,e){t.uniform4uiv(this.addr,e)}function jf(t,e,n){const i=e.length,r=cf(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.safeSetTexture2D(e[s]||Jp,r[s])}function Wf(t,e,n){const i=e.length,r=cf(n,i);t.uniform1iv(this.addr,r);for(let s=0;s!==i;++s)n.safeSetTextureCube(e[s]||Kp,r[s])}function qf(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=function(t){switch(t){case 5126:return uf;case 35664:return hf;case 35665:return df;case 35666:return pf;case 35674:return ff;case 35675:return mf;case 35676:return gf;case 5124:case 35670:return yf;case 35667:case 35671:return vf;case 35668:case 35672:return _f;case 35669:case 35673:return xf;case 5125:return bf;case 36294:return wf;case 36295:return Cf;case 36296:return Tf;case 35678:case 36198:case 36298:case 36306:case 35682:return Sf;case 35679:case 36299:case 36307:return Mf;case 35680:case 36300:case 36308:case 36293:return Ef;case 36289:case 36303:case 36311:case 36292:return Af}}(e.type)}function Zf(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Df;case 35664:return Pf;case 35665:return Lf;case 35666:return Rf;case 35674:return If;case 35675:return Nf;case 35676:return kf;case 5124:case 35670:return Of;case 35667:case 35671:return zf;case 35668:case 35672:return Ff;case 35669:case 35673:return Uf;case 5125:return Hf;case 36294:return Bf;case 36295:return Vf;case 36296:return Gf;case 35678:case 36198:case 36298:case 36306:case 35682:return jf;case 35680:case 36300:case 36308:case 36293:return Wf}}(e.type)}function Yf(t){this.id=t,this.seq=[],this.map={}}Zf.prototype.updateCache=function(t){const e=this.cache;t instanceof Float32Array&&e.length!==t.length&&(this.cache=new Float32Array(t.length)),lf(e,t)},Yf.prototype.setValue=function(t,e,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(t,e[s.id],n)}};const Xf=/(\w+)(\])?(\[|\.)?/g;function Jf(t,e){t.seq.push(e),t.map[e.id]=e}function $f(t,e,n){const i=t.name,r=i.length;for(Xf.lastIndex=0;;){const s=Xf.exec(i),o=Xf.lastIndex;let a=s[1];const l=s[3];if("]"===s[2]&&(a|=0),void 0===l||"["===l&&o+2===r){Jf(n,void 0===l?new qf(a,t,e):new Zf(a,t,e));break}{let t=n.map[a];void 0===t&&(t=new Yf(a),Jf(n,t)),n=t}}}function Qf(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){const n=t.getActiveUniform(e,i);$f(n,t.getUniformLocation(e,n.name),this)}}function Kf(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}Qf.prototype.setValue=function(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)},Qf.prototype.setOptional=function(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)},Qf.upload=function(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){const s=e[r],o=n[s.id];!1!==o.needsUpdate&&s.setValue(t,o.value,i)}},Qf.seqWithValue=function(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const r=t[i];r.id in e&&n.push(r)}return n};let tm=0;function em(t){switch(t){case Pu:return["Linear","( value )"];case Lu:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function nm(t,e,n){const i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();return i&&""===r?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+r+function(t){const e=t.split("\n");for(let n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}(t.getShaderSource(e))}function im(t,e){const n=em(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function rm(t,e){const n=em(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function sm(t,e){let n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function om(t){return""!==t}function am(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function lm(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const cm=/^[ \t]*#include +<([\w\d./]+)>/gm;function um(t){return t.replace(cm,hm)}function hm(t,e){const n=Lp[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return um(n)}const dm=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,pm=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function fm(t){return t.replace(pm,gm).replace(dm,mm)}function mm(t,e,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),gm(0,e,n,i)}function gm(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function ym(t){let e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function vm(t,e,n,i){const r=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:case 307:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),u=function(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 307:e="ENVMAP_MODE_REFRACTION"}return e}(n),h=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),d=t.gammaFactor>0?t.gammaFactor:1,p=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUV||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission>0)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(om).join("\n")}(n),f=function(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(s),m=r.createProgram();let g,y,v=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(g=[f].filter(om).join("\n"),g.length>0&&(g+="\n"),y=[p,f].filter(om).join("\n"),y.length>0&&(y+="\n")):(g=[ym(n),"#define SHADER_NAME "+n.shaderName,f,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(om).join("\n"),y=[p,ym(n),"#define SHADER_NAME "+n.shaderName,f,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+d,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Lp.tonemapping_pars_fragment:"",0!==n.toneMapping?sm("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Lp.encodings_pars_fragment,n.map?im("mapTexelToLinear",n.mapEncoding):"",n.matcap?im("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?im("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?im("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?im("lightMapTexelToLinear",n.lightMapEncoding):"",rm("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(om).join("\n")),o=um(o),o=am(o,n),o=lm(o,n),a=um(a),a=am(a,n),a=lm(a,n),o=fm(o),a=fm(a),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(v="#version 300 es\n",g=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+g,y=["#define varying in",n.glslVersion===ku?"":"out highp vec4 pc_fragColor;",n.glslVersion===ku?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const _=v+y+a,x=Kf(r,35633,v+g+o),b=Kf(r,35632,_);if(r.attachShader(m,x),r.attachShader(m,b),void 0!==n.index0AttributeName?r.bindAttribLocation(m,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(m,0,"position"),r.linkProgram(m),t.debug.checkShaderErrors){const t=r.getProgramInfoLog(m).trim(),e=r.getShaderInfoLog(x).trim(),n=r.getShaderInfoLog(b).trim();let i=!0,s=!0;if(!1===r.getProgramParameter(m,35714)){i=!1;const e=nm(r,x,"vertex"),n=nm(r,b,"fragment");console.error("THREE.WebGLProgram: shader error: ",r.getError(),"35715",r.getProgramParameter(m,35715),"gl.getProgramInfoLog",t,e,n)}else""!==t?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):""!==e&&""!==n||(s=!1);s&&(this.diagnostics={runnable:i,programLog:t,vertexShader:{log:e,prefix:g},fragmentShader:{log:n,prefix:y}})}let w,C;return r.deleteShader(x),r.deleteShader(b),this.getUniforms=function(){return void 0===w&&(w=new Qf(r,m)),w},this.getAttributes=function(){return void 0===C&&(C=function(t,e){const n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r).name;n[i]=t.getAttribLocation(e,i)}return n}(r,m)),C},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(m),this.program=void 0},this.name=n.shaderName,this.id=tm++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=x,this.fragmentShader=b,this}function _m(t,e,n,i,r,s){const o=[],a=i.isWebGL2,l=i.logarithmicDepthBuffer,c=i.floatVertexTextures,u=i.maxVertexUniforms,h=i.vertexTextures;let d=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},f=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmission","transmissionMap","thicknessMap"];function m(t){let e;return t&&t.isTexture?e=t.encoding:t&&t.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=t.texture.encoding):e=Pu,e}return{getParameters:function(r,o,f,g,y){const v=g.fog,_=e.get(r.envMap||(r.isMeshStandardMaterial?g.environment:null)),x=p[r.type],b=y.isSkinnedMesh?function(t){const e=t.skeleton.bones;if(c)return 1024;{const t=Math.floor((u-20)/4),n=Math.min(t,e.length);return n<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+n+"."),0):n}}(y):0;let w,C;if(null!==r.precision&&(d=i.getMaxPrecision(r.precision),d!==r.precision&&console.warn("THREE.WebGLProgram.getParameters:",r.precision,"not supported, using",d,"instead.")),x){const t=Ip[x];w=t.vertexShader,C=t.fragmentShader}else w=r.vertexShader,C=r.fragmentShader;const T=t.getRenderTarget();return{isWebGL2:a,shaderID:x,shaderName:r.type,vertexShader:w,fragmentShader:C,defines:r.defines,isRawShaderMaterial:!0===r.isRawShaderMaterial,glslVersion:r.glslVersion,precision:d,instancing:!0===y.isInstancedMesh,instancingColor:!0===y.isInstancedMesh&&null!==y.instanceColor,supportsVertexTextures:h,outputEncoding:null!==T?m(T.texture):t.outputEncoding,map:!!r.map,mapEncoding:m(r.map),matcap:!!r.matcap,matcapEncoding:m(r.matcap),envMap:!!_,envMapMode:_&&_.mapping,envMapEncoding:m(_),envMapCubeUV:!!_&&(306===_.mapping||307===_.mapping),lightMap:!!r.lightMap,lightMapEncoding:m(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:m(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:1===r.normalMapType,tangentSpaceNormalMap:0===r.normalMapType,clearcoatMap:!!r.clearcoatMap,clearcoatRoughnessMap:!!r.clearcoatRoughnessMap,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,transmission:!!r.transmission,transmissionMap:!!r.transmissionMap,thicknessMap:!!r.thicknessMap,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexAlphas:!0===r.vertexColors&&y.geometry&&y.geometry.attributes.color&&4===y.geometry.attributes.color.itemSize,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatMap||r.clearcoatRoughnessMap||r.clearcoatNormalMap||r.displacementMap||r.transmissionMap||r.thicknessMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||r.transmission||r.transmissionMap||r.thicknessMap||!r.displacementMap),fog:!!v,useFog:r.fog,fogExp2:v&&v.isFogExp2,flatShading:!!r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:l,skinning:!0===y.isSkinnedMesh&&b>0,maxBones:b,useVertexTexture:c,morphTargets:r.morphTargets,morphNormals:r.morphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:r.dithering,shadowMapEnabled:t.shadowMap.enabled&&f.length>0,shadowMapType:t.shadowMap.type,toneMapping:r.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:2===r.side,flipSided:1===r.side,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.fragDepth,extensionDrawBuffers:r.extensions&&r.extensions.drawBuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:a||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:a||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:a||n.has("EXT_shader_texture_lod"),customProgramCacheKey:r.customProgramCacheKey()}},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);if(!1===e.isRawShaderMaterial){for(let t=0;t<f.length;t++)n.push(e[f[t]]);n.push(t.outputEncoding),n.push(t.gammaFactor)}return n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=p[t.type];let n;return n=e?pp.clone(Ip[e].uniforms):t.uniforms,n},acquireProgram:function(e,n){let i;for(let t=0,r=o.length;t<r;t++){const e=o[t];if(e.cacheKey===n){i=e,++i.usedTimes;break}}return void 0===i&&(i=new vm(t,n,e,r),o.push(i)),i},releaseProgram:function(t){if(0==--t.usedTimes){const e=o.indexOf(t);o[e]=o[o.length-1],o.pop(),t.destroy()}},programs:o}}function xm(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function bm(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function wm(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Cm(t){const e=[];let n=0;const i=[],r=[],s=[],o={id:-1};function a(i,r,s,a,l,c){let u=e[n];const h=t.get(s);return void 0===u?(u={id:i.id,object:i,geometry:r,material:s,program:h.program||o,groupOrder:a,renderOrder:i.renderOrder,z:l,group:c},e[n]=u):(u.id=i.id,u.object=i,u.geometry=r,u.material=s,u.program=h.program||o,u.groupOrder=a,u.renderOrder=i.renderOrder,u.z=l,u.group=c),n++,u}return{opaque:i,transmissive:r,transparent:s,init:function(){n=0,i.length=0,r.length=0,s.length=0},push:function(t,e,n,o,l,c){const u=a(t,e,n,o,l,c);n.transmission>0?r.push(u):!0===n.transparent?s.push(u):i.push(u)},unshift:function(t,e,n,o,l,c){const u=a(t,e,n,o,l,c);n.transmission>0?r.unshift(u):!0===n.transparent?s.unshift(u):i.unshift(u)},finish:function(){for(let t=n,i=e.length;t<i;t++){const n=e[t];if(null===n.id)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.program=null,n.group=null}},sort:function(t,e){i.length>1&&i.sort(t||bm),r.length>1&&r.sort(e||wm),s.length>1&&s.sort(e||wm)}}}function Tm(t){let e=new WeakMap;return{get:function(n,i){let r;return!1===e.has(n)?(r=new Cm(t),e.set(n,[r])):i>=e.get(n).length?(r=new Cm(t),e.get(n).push(r)):r=e.get(n)[i],r},dispose:function(){e=new WeakMap}}}function Sm(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new oh,color:new Ad};break;case"SpotLight":n={position:new oh,direction:new oh,color:new Ad,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new oh,color:new Ad,distance:0,decay:0};break;case"HemisphereLight":n={direction:new oh,skyColor:new Ad,groundColor:new Ad};break;case"RectAreaLight":n={color:new Ad,position:new oh,halfWidth:new oh,halfHeight:new oh}}return t[e.id]=n,n}}}let Mm=0;function Em(t,e){return(e.castShadow?1:0)-(t.castShadow?1:0)}function Am(t,e){const n=new Sm,i=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xu};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xu,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let l=0;l<9;l++)r.probe.push(new oh);const s=new oh,o=new zh,a=new zh;return{setup:function(s){let o=0,a=0,l=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let c=0,u=0,h=0,d=0,p=0,f=0,m=0,g=0;s.sort(Em);for(let t=0,e=s.length;t<e;t++){const e=s[t],y=e.color,v=e.intensity,_=e.distance,x=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)o+=y.r*v,a+=y.g*v,l+=y.b*v;else if(e.isLightProbe)for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],v);else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.directionalShadow[c]=n,r.directionalShadowMap[c]=x,r.directionalShadowMatrix[c]=e.shadow.matrix,f++}r.directional[c]=t,c++}else if(e.isSpotLight){const t=n.get(e);if(t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(y).multiplyScalar(v),t.distance=_,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.spotShadow[h]=n,r.spotShadowMap[h]=x,r.spotShadowMatrix[h]=e.shadow.matrix,g++}r.spot[h]=t,h++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(y).multiplyScalar(v),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[d]=t,d++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,r.pointShadow[u]=n,r.pointShadowMap[u]=x,r.pointShadowMatrix[u]=e.shadow.matrix,m++}r.point[u]=t,u++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(v),t.groundColor.copy(e.groundColor).multiplyScalar(v),r.hemi[p]=t,p++}}d>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=Rp.LTC_FLOAT_1,r.rectAreaLTC2=Rp.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Rp.LTC_HALF_1,r.rectAreaLTC2=Rp.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=o,r.ambient[1]=a,r.ambient[2]=l;const y=r.hash;y.directionalLength===c&&y.pointLength===u&&y.spotLength===h&&y.rectAreaLength===d&&y.hemiLength===p&&y.numDirectionalShadows===f&&y.numPointShadows===m&&y.numSpotShadows===g||(r.directional.length=c,r.spot.length=h,r.rectArea.length=d,r.point.length=u,r.hemi.length=p,r.directionalShadow.length=f,r.directionalShadowMap.length=f,r.pointShadow.length=m,r.pointShadowMap.length=m,r.spotShadow.length=g,r.spotShadowMap.length=g,r.directionalShadowMatrix.length=f,r.pointShadowMatrix.length=m,r.spotShadowMatrix.length=g,y.directionalLength=c,y.pointLength=u,y.spotLength=h,y.rectAreaLength=d,y.hemiLength=p,y.numDirectionalShadows=f,y.numPointShadows=m,y.numSpotShadows=g,r.version=Mm++)},setupView:function(t,e){let n=0,i=0,l=0,c=0,u=0;const h=e.matrixWorldInverse;for(let d=0,p=t.length;d<p;d++){const e=t[d];if(e.isDirectionalLight){const t=r.directional[n];t.direction.setFromMatrixPosition(e.matrixWorld),s.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(h),n++}else if(e.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),t.direction.setFromMatrixPosition(e.matrixWorld),s.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(h),l++}else if(e.isRectAreaLight){const t=r.rectArea[c];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),a.identity(),o.copy(e.matrixWorld),o.premultiply(h),a.extractRotation(o),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),t.halfWidth.applyMatrix4(a),t.halfHeight.applyMatrix4(a),c++}else if(e.isPointLight){const t=r.point[i];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(h),i++}else if(e.isHemisphereLight){const t=r.hemi[u];t.direction.setFromMatrixPosition(e.matrixWorld),t.direction.transformDirection(h),t.direction.normalize(),u++}}},state:r}}function Dm(t,e){const n=new Am(t,e),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(){n.setup(i)},setupLightsView:function(t){n.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){r.push(t)}}}function Pm(t,e){let n=new WeakMap;return{get:function(i,r=0){let s;return!1===n.has(i)?(s=new Dm(t,e),n.set(i,[s])):r>=n.get(i).length?(s=new Dm(t,e),n.get(i).push(s)):s=n.get(i)[r],s},dispose:function(){n=new WeakMap}}}class Lm extends bd{constructor(t){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}Lm.prototype.isMeshDepthMaterial=!0;class Rm extends bd{constructor(t){super(),this.type="MeshDistanceMaterial",this.referencePosition=new oh,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function Im(t,e,n){let i=new Ep;const r=new Xu,s=new Xu,o=new nh,a=[],l=[],c={},u=n.maxTextureSize,h={0:1,1:0,2:2},d=new fp({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xu},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new jd;f.setAttribute("position",new Rd(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new lp(f,d),g=this;function y(n,i){const r=e.update(m);d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,r,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,r,p,m,null)}function v(t){const e=t<<0;let n=a[e];return void 0===n&&(n=new Lm({depthPacking:3201,morphTargets:t}),a[e]=n),n}function _(t){const e=t<<0;let n=l[e];return void 0===n&&(n=new Rm({morphTargets:t}),l[e]=n),n}function x(e,n,i,r,s,o,a){let l=null,u=v,d=e.customDepthMaterial;if(!0===r.isPointLight&&(u=_,d=e.customDistanceMaterial),void 0===d){let t=!1;!0===i.morphTargets&&(t=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0),l=u(t)}else l=d;if(t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){const t=l.uuid,e=i.uuid;let n=c[t];void 0===n&&(n={},c[t]=n);let r=n[e];void 0===r&&(r=l.clone(),n[e]=r),l=r}return l.visible=i.visible,l.wireframe=i.wireframe,l.side=3===a?null!==i.shadowSide?i.shadowSide:i.side:null!==i.shadowSide?i.shadowSide:h[i.side],l.clipShadows=i.clipShadows,l.clippingPlanes=i.clippingPlanes,l.clipIntersection=i.clipIntersection,l.wireframeLinewidth=i.wireframeLinewidth,l.linewidth=i.linewidth,!0===r.isPointLight&&!0===l.isMeshDistanceMaterial&&(l.referencePosition.setFromMatrixPosition(r.matrixWorld),l.nearDistance=s,l.farDistance=o),l}function b(n,r,s,o,a){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===a)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=e.update(n),r=n.material;if(Array.isArray(r)){const e=i.groups;for(let l=0,c=e.length;l<c;l++){const c=e[l],u=r[c.materialIndex];if(u&&u.visible){const e=x(n,i,u,o,s.near,s.far,a);t.renderBufferDirect(s,null,i,e,n,c)}}}else if(r.visible){const e=x(n,i,r,o,s.near,s.far,a);t.renderBufferDirect(s,null,i,e,n,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)b(l[t],r,s,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,n,a){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),c=t.getActiveCubeFace(),h=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let p=0,f=e.length;p<f;p++){const l=e[p],c=l.shadow;if(void 0===c){console.warn("THREE.WebGLShadowMap:",l,"has no shadow.");continue}if(!1===c.autoUpdate&&!1===c.needsUpdate)continue;r.copy(c.mapSize);const h=c.getFrameExtents();if(r.multiply(h),s.copy(c.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/h.x),r.x=s.x*h.x,c.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/h.y),r.y=s.y*h.y,c.mapSize.y=s.y)),null===c.map&&!c.isPointLightShadow&&3===this.type){const t={minFilter:du,magFilter:du,format:bu};c.map=new ih(r.x,r.y,t),c.map.texture.name=l.name+".shadowMap",c.mapPass=new ih(r.x,r.y,t),c.camera.updateProjectionMatrix()}null===c.map&&(c.map=new ih(r.x,r.y,{minFilter:cu,magFilter:cu,format:bu}),c.map.texture.name=l.name+".shadowMap",c.camera.updateProjectionMatrix()),t.setRenderTarget(c.map),t.clear();const f=c.getViewportCount();for(let t=0;t<f;t++){const e=c.getViewport(t);o.set(s.x*e.x,s.y*e.y,s.x*e.z,s.y*e.w),d.viewport(o),c.updateMatrices(l,t),i=c.getFrustum(),b(n,a,c.camera,l,this.type)}c.isPointLightShadow||3!==this.type||y(c,a),c.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(l,c,h)}}function Nm(t,e,n){const i=n.isWebGL2,r=new function(){let e=!1;const n=new nh;let i=null;const r=new nh(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,s,o,a){!0===a&&(e*=o,i*=o,s*=o),n.set(e,i,s,o),!1===r.equals(n)&&(t.clearColor(e,i,s,o),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},s=new function(){let e=!1,n=null,i=null,r=null;return{setTest:function(t){t?z(2929):F(2929)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){if(e)switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}},o=new function(){let e=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(t){e||(t?z(2960):F(2960))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,o){i===e&&r===n&&s===o||(t.stencilFunc(e,n,o),i=e,r=n,s=o)},setOp:function(e,n,i){o===e&&a===n&&l===i||(t.stencilOp(e,n,i),o=e,a=n,l=i)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,i=null,r=null,s=null,o=null,a=null,l=null,c=null}}};let a={},l=null,c={},u=null,h=!1,d=null,p=null,f=null,m=null,g=null,y=null,v=null,_=!1,x=null,b=null,w=null,C=null,T=null;const S=t.getParameter(35661);let M=!1,E=0;const A=t.getParameter(7938);-1!==A.indexOf("WebGL")?(E=parseFloat(/^WebGL (\d)/.exec(A)[1]),M=E>=1):-1!==A.indexOf("OpenGL ES")&&(E=parseFloat(/^OpenGL ES (\d)/.exec(A)[1]),M=E>=2);let D=null,P={};const L=t.getParameter(3088),R=t.getParameter(2978),I=(new nh).fromArray(L),N=(new nh).fromArray(R);function k(e,n,i){const r=new Uint8Array(4),s=t.createTexture();t.bindTexture(e,s),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(let o=0;o<i;o++)t.texImage2D(n+o,0,6408,1,1,0,6408,5121,r);return s}const O={};function z(e){!0!==a[e]&&(t.enable(e),a[e]=!0)}function F(e){!1!==a[e]&&(t.disable(e),a[e]=!1)}O[3553]=k(3553,3553,1),O[34067]=k(34067,34069,6),r.setClear(0,0,0,1),s.setClear(1),o.setClear(0),z(2929),s.setFunc(3),V(!1),G(1),z(2884),B(0);const U={[su]:32774,101:32778,102:32779};if(i)U[103]=32775,U[104]=32776;else{const t=e.get("EXT_blend_minmax");null!==t&&(U[103]=t.MIN_EXT,U[104]=t.MAX_EXT)}const H={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function B(e,n,i,r,s,o,a,l){if(0!==e){if(!1===h&&(z(3042),h=!0),5===e)s=s||n,o=o||i,a=a||r,n===p&&s===g||(t.blendEquationSeparate(U[n],U[s]),p=n,g=s),i===f&&r===m&&o===y&&a===v||(t.blendFuncSeparate(H[i],H[r],H[o],H[a]),f=i,m=r,y=o,v=a),d=e,_=null;else if(e!==d||l!==_){if(p===su&&g===su||(t.blendEquation(32774),p=su,g=su),l)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}f=null,m=null,y=null,v=null,d=e,_=l}}else!0===h&&(F(3042),h=!1)}function V(e){x!==e&&(t.frontFace(e?2304:2305),x=e)}function G(e){0!==e?(z(2884),e!==b&&t.cullFace(1===e?1029:2===e?1028:1032)):F(2884),b=e}function j(e,n,i){e?(z(32823),C===n&&T===i||(t.polygonOffset(n,i),C=n,T=i)):F(32823)}function W(e){void 0===e&&(e=33984+S-1),D!==e&&(t.activeTexture(e),D=e)}return{buffers:{color:r,depth:s,stencil:o},enable:z,disable:F,bindFramebuffer:function(e,n){return null===n&&null!==l&&(n=l),c[e]!==n&&(t.bindFramebuffer(e,n),c[e]=n,i&&(36009===e&&(c[36160]=n),36160===e&&(c[36009]=n)),!0)},bindXRFramebuffer:function(e){e!==l&&(t.bindFramebuffer(36160,e),l=e)},useProgram:function(e){return u!==e&&(t.useProgram(e),u=e,!0)},setBlending:B,setMaterial:function(t,e){2===t.side?F(2884):z(2884);let n=1===t.side;e&&(n=!n),V(n),1===t.blending&&!1===t.transparent?B(0):B(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),r.setMask(t.colorWrite);const i=t.stencilWrite;o.setTest(i),i&&(o.setMask(t.stencilWriteMask),o.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),o.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),j(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?z(32926):F(32926)},setFlipSided:V,setCullFace:G,setLineWidth:function(e){e!==w&&(M&&t.lineWidth(e),w=e)},setPolygonOffset:j,setScissorTest:function(t){t?z(3089):F(3089)},activeTexture:W,bindTexture:function(e,n){null===D&&W();let i=P[D];void 0===i&&(i={type:void 0,texture:void 0},P[D]=i),i.type===e&&i.texture===n||(t.bindTexture(e,n||O[e]),i.type=e,i.texture=n)},unbindTexture:function(){const e=P[D];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===I.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),I.copy(e))},viewport:function(e){!1===N.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),N.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===i&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),a={},D=null,P={},l=null,c={},u=null,h=!1,d=null,p=null,f=null,m=null,g=null,y=null,v=null,_=!1,x=null,b=null,w=null,C=null,T=null,I.set(0,0,t.canvas.width,t.canvas.height),N.set(0,0,t.canvas.width,t.canvas.height),r.reset(),s.reset(),o.reset()}}}function km(t,e,n,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=new WeakMap;let p,f=!1;try{f="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(z){}function m(t,e){return f?new OffscreenCanvas(t,e):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function g(t,e,n,i){let r=1;if((t.width>i||t.height>i)&&(r=i/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const i=e?Zu:Math.floor,s=i(r*t.width),o=i(r*t.height);void 0===p&&(p=m(s,o));const a=n?m(s,o):p;return a.width=s,a.height=o,a.getContext("2d").drawImage(t,0,0,s,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+s+"x"+o+")."),a}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function y(t){return Wu(t.width)&&Wu(t.height)}function v(t,e){return t.generateMipmaps&&e&&t.minFilter!==cu&&t.minFilter!==du}function _(e,n,r,s){t.generateMipmap(e),i.get(n).__maxMipLevel=Math.log2(Math.max(r,s))}function x(n,i,r){if(!1===a)return i;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}let s=i;return 6403===i&&(5126===r&&(s=33326),5131===r&&(s=33325),5121===r&&(s=33321)),6407===i&&(5126===r&&(s=34837),5131===r&&(s=34843),5121===r&&(s=32849)),6408===i&&(5126===r&&(s=34836),5131===r&&(s=34842),5121===r&&(s=32856)),33325!==s&&33326!==s&&34842!==s&&34836!==s||e.get("EXT_color_buffer_float"),s}function b(t){return t===cu||t===uu||t===hu?9728:9729}function w(e){const n=e.target;n.removeEventListener("dispose",w),function(e){const n=i.get(e);void 0!==n.__webglInit&&(t.deleteTexture(n.__webglTexture),i.remove(e))}(n),n.isVideoTexture&&d.delete(n),o.memory.textures--}function C(e){const n=e.target;n.removeEventListener("dispose",C),function(e){const n=e.texture,r=i.get(e),s=i.get(n);if(e){if(void 0!==s.__webglTexture&&(t.deleteTexture(s.__webglTexture),o.memory.textures--),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLCubeRenderTarget)for(let e=0;e<6;e++)t.deleteFramebuffer(r.__webglFramebuffer[e]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[e]);else t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer&&t.deleteRenderbuffer(r.__webglColorRenderbuffer),r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer);if(e.isWebGLMultipleRenderTargets)for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);r.__webglTexture&&(t.deleteTexture(r.__webglTexture),o.memory.textures--),i.remove(n[e])}i.remove(n),i.remove(e)}}(n)}let T=0;function S(t,e){const r=i.get(t);if(t.isVideoTexture&&function(t){const e=o.render.frame;d.get(t)!==e&&(d.set(t,e),t.update())}(t),t.version>0&&r.__version!==t.version){const n=t.image;if(void 0===n)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==n.complete)return void L(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+e),n.bindTexture(3553,r.__webglTexture)}function M(e,r){const o=i.get(e);e.version>0&&o.__version!==e.version?function(e,i,r){if(6!==i.image.length)return;P(e,i),n.activeTexture(33984+r),n.bindTexture(34067,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const o=i&&(i.isCompressedTexture||i.image[0].isCompressedTexture),l=i.image[0]&&i.image[0].isDataTexture,u=[];for(let t=0;t<6;t++)u[t]=o||l?l?i.image[t].image:i.image[t]:g(i.image[t],!1,!0,c);const h=u[0],d=y(h)||a,p=s.convert(i.format),f=s.convert(i.type),m=x(i.internalFormat,p,f);let b;if(D(34067,i,d),o){for(let t=0;t<6;t++){b=u[t].mipmaps;for(let e=0;e<b.length;e++){const r=b[e];i.format!==bu&&i.format!==xu?null!==p?n.compressedTexImage2D(34069+t,e,m,r.width,r.height,0,r.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+t,e,m,r.width,r.height,0,p,f,r.data)}}e.__maxMipLevel=b.length-1}else{b=i.mipmaps;for(let t=0;t<6;t++)if(l){n.texImage2D(34069+t,0,m,u[t].width,u[t].height,0,p,f,u[t].data);for(let e=0;e<b.length;e++){const i=b[e].image[t].image;n.texImage2D(34069+t,e+1,m,i.width,i.height,0,p,f,i.data)}}else{n.texImage2D(34069+t,0,m,p,f,u[t]);for(let e=0;e<b.length;e++)n.texImage2D(34069+t,e+1,m,p,f,b[e].image[t])}e.__maxMipLevel=b.length}v(i,d)&&_(34067,i,h.width,h.height),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}(o,e,r):(n.activeTexture(33984+r),n.bindTexture(34067,o.__webglTexture))}const E={[ou]:10497,[au]:33071,[lu]:33648},A={[cu]:9728,[uu]:9984,[hu]:9986,[du]:9729,1007:9985,[pu]:9987};function D(n,s,o){if(o?(t.texParameteri(n,10242,E[s.wrapS]),t.texParameteri(n,10243,E[s.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,E[s.wrapR]),t.texParameteri(n,10240,A[s.magFilter]),t.texParameteri(n,10241,A[s.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),s.wrapS===au&&s.wrapT===au||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,b(s.magFilter)),t.texParameteri(n,10241,b(s.minFilter)),s.minFilter!==cu&&s.minFilter!==du&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const o=e.get("EXT_texture_filter_anisotropic");if(s.type===yu&&!1===e.has("OES_texture_float_linear"))return;if(!1===a&&s.type===vu&&!1===e.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(t.texParameterf(n,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function P(e,n){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",w),e.__webglTexture=t.createTexture(),o.memory.textures++)}function L(e,i,r){let o=3553;i.isDataTexture2DArray&&(o=35866),i.isDataTexture3D&&(o=32879),P(e,i),n.activeTexture(33984+r),n.bindTexture(o,e.__webglTexture),t.pixelStorei(37440,i.flipY),t.pixelStorei(37441,i.premultiplyAlpha),t.pixelStorei(3317,i.unpackAlignment),t.pixelStorei(37443,0);const l=function(t){return!a&&(t.wrapS!==au||t.wrapT!==au||t.minFilter!==cu&&t.minFilter!==du)}(i)&&!1===y(i.image),c=g(i.image,l,!1,u),h=y(c)||a,d=s.convert(i.format);let p,f=s.convert(i.type),m=x(i.internalFormat,d,f);D(o,i,h);const b=i.mipmaps;if(i.isDepthTexture)m=6402,a?m=i.type===yu?36012:i.type===gu?33190:i.type===_u?35056:33189:i.type===yu&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===wu&&6402===m&&i.type!==mu&&i.type!==gu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=mu,f=s.convert(i.type)),i.format===Cu&&6402===m&&(m=34041,i.type!==_u&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=_u,f=s.convert(i.type))),n.texImage2D(3553,0,m,c.width,c.height,0,d,f,null);else if(i.isDataTexture)if(b.length>0&&h){for(let t=0,e=b.length;t<e;t++)p=b[t],n.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data);i.generateMipmaps=!1,e.__maxMipLevel=b.length-1}else n.texImage2D(3553,0,m,c.width,c.height,0,d,f,c.data),e.__maxMipLevel=0;else if(i.isCompressedTexture){for(let t=0,e=b.length;t<e;t++)p=b[t],i.format!==bu&&i.format!==xu?null!==d?n.compressedTexImage2D(3553,t,m,p.width,p.height,0,p.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,t,m,p.width,p.height,0,d,f,p.data);e.__maxMipLevel=b.length-1}else if(i.isDataTexture2DArray)n.texImage3D(35866,0,m,c.width,c.height,c.depth,0,d,f,c.data),e.__maxMipLevel=0;else if(i.isDataTexture3D)n.texImage3D(32879,0,m,c.width,c.height,c.depth,0,d,f,c.data),e.__maxMipLevel=0;else if(b.length>0&&h){for(let t=0,e=b.length;t<e;t++)p=b[t],n.texImage2D(3553,t,m,d,f,p);i.generateMipmaps=!1,e.__maxMipLevel=b.length-1}else n.texImage2D(3553,0,m,d,f,c),e.__maxMipLevel=0;v(i,h)&&_(o,i,c.width,c.height),e.__version=i.version,i.onUpdate&&i.onUpdate(i)}function R(e,r,o,a,l){const c=s.convert(o.format),u=s.convert(o.type),h=x(o.internalFormat,c,u);32879===l||35866===l?n.texImage3D(l,0,h,r.width,r.height,r.depth,0,c,u,null):n.texImage2D(l,0,h,r.width,r.height,0,c,u,null),n.bindFramebuffer(36160,e),t.framebufferTexture2D(36160,a,l,i.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function I(e,n,i){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){let r=33189;if(i){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===yu?r=36012:e.type===gu&&(r=33190));const i=N(n);t.renderbufferStorageMultisample(36161,i,r,n.width,n.height)}else t.renderbufferStorage(36161,r,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){if(i){const e=N(n);t.renderbufferStorageMultisample(36161,e,35056,n.width,n.height)}else t.renderbufferStorage(36161,34041,n.width,n.height);t.framebufferRenderbuffer(36160,33306,36161,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture[0]:n.texture,r=s.convert(e.format),o=s.convert(e.type),a=x(e.internalFormat,r,o);if(i){const e=N(n);t.renderbufferStorageMultisample(36161,e,a,n.width,n.height)}else t.renderbufferStorage(36161,a,n.width,n.height)}t.bindRenderbuffer(36161,null)}function N(t){return a&&t.isWebGLMultisampleRenderTarget?Math.min(h,t.samples):0}let k=!1,O=!1;this.allocateTextureUnit=function(){const t=T;return t>=l&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+l),T+=1,t},this.resetTextureUnits=function(){T=0},this.setTexture2D=S,this.setTexture2DArray=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?L(r,t,e):(n.activeTexture(33984+e),n.bindTexture(35866,r.__webglTexture))},this.setTexture3D=function(t,e){const r=i.get(t);t.version>0&&r.__version!==t.version?L(r,t,e):(n.activeTexture(33984+e),n.bindTexture(32879,r.__webglTexture))},this.setTextureCube=M,this.setupRenderTarget=function(e){const l=e.texture,c=i.get(e),u=i.get(l);e.addEventListener("dispose",C),!0!==e.isWebGLMultipleRenderTargets&&(u.__webglTexture=t.createTexture(),u.__version=l.version,o.memory.textures++);const h=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,p=!0===e.isWebGLMultisampleRenderTarget,f=l.isDataTexture3D||l.isDataTexture2DArray,m=y(e)||a;if(!a||l.format!==xu||l.type!==yu&&l.type!==vu||(l.format=bu,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),h){c.__webglFramebuffer=[];for(let e=0;e<6;e++)c.__webglFramebuffer[e]=t.createFramebuffer()}else if(c.__webglFramebuffer=t.createFramebuffer(),d)if(r.drawBuffers){const n=e.texture;for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);void 0===r.__webglTexture&&(r.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(p)if(a){c.__webglMultisampledFramebuffer=t.createFramebuffer(),c.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const i=s.convert(l.format),r=s.convert(l.type),o=x(l.internalFormat,i,r),a=N(e);t.renderbufferStorageMultisample(36161,a,o,e.width,e.height),n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),e.depthBuffer&&(c.__webglDepthRenderbuffer=t.createRenderbuffer(),I(c.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(h){n.bindTexture(34067,u.__webglTexture),D(34067,l,m);for(let t=0;t<6;t++)R(c.__webglFramebuffer[t],e,l,36064,34069+t);v(l,m)&&_(34067,l,e.width,e.height),n.bindTexture(34067,null)}else if(d){const t=e.texture;for(let r=0,s=t.length;r<s;r++){const s=t[r],o=i.get(s);n.bindTexture(3553,o.__webglTexture),D(3553,s,m),R(c.__webglFramebuffer,e,s,36064+r,3553),v(s,m)&&_(3553,s,e.width,e.height)}n.bindTexture(3553,null)}else{let t=3553;f&&(a?t=l.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),n.bindTexture(t,u.__webglTexture),D(t,l,m),R(c.__webglFramebuffer,e,l,36064,t),v(l,m)&&_(3553,l,e.width,e.height),n.bindTexture(3553,null)}e.depthBuffer&&function(e){const r=i.get(e),s=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),S(r.depthTexture,0);const s=i.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===wu)t.framebufferTexture2D(36160,36096,3553,s,0);else{if(r.depthTexture.format!==Cu)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,s,0)}}(r.__webglFramebuffer,e)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(36160,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=t.createRenderbuffer(),I(r.__webglDepthbuffer[i],e,!1)}else n.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),I(r.__webglDepthbuffer,e,!1);n.bindFramebuffer(36160,null)}(e)},this.updateRenderTargetMipmap=function(t){const e=y(t)||a,r=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let s=0,o=r.length;s<o;s++){const o=r[s];if(v(o,e)){const e=t.isWebGLCubeRenderTarget?34067:3553,r=i.get(o).__webglTexture;n.bindTexture(e,r),_(e,o,t.width,t.height),n.bindTexture(e,null)}}},this.updateMultisampleRenderTarget=function(e){if(e.isWebGLMultisampleRenderTarget)if(a){const r=e.width,s=e.height;let o=16384;e.depthBuffer&&(o|=256),e.stencilBuffer&&(o|=1024);const a=i.get(e);n.bindFramebuffer(36008,a.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,a.__webglFramebuffer),t.blitFramebuffer(0,0,r,s,0,0,r,s,o,9728),n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,a.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(t,e){t&&t.isWebGLRenderTarget&&(!1===k&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),k=!0),t=t.texture),S(t,e)},this.safeSetTextureCube=function(t,e){t&&t.isWebGLCubeRenderTarget&&(!1===O&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),O=!0),t=t.texture),M(t,e)}}function Om(t,e,n){const i=n.isWebGL2;return{convert:function(t){let n;if(t===fu)return 5121;if(1017===t)return 32819;if(1018===t)return 32820;if(1019===t)return 33635;if(1010===t)return 5120;if(1011===t)return 5122;if(t===mu)return 5123;if(1013===t)return 5124;if(t===gu)return 5125;if(t===yu)return 5126;if(t===vu)return i?5131:(n=e.get("OES_texture_half_float"),null!==n?n.HALF_FLOAT_OES:null);if(1021===t)return 6406;if(t===xu)return 6407;if(t===bu)return 6408;if(1024===t)return 6409;if(1025===t)return 6410;if(t===wu)return 6402;if(t===Cu)return 34041;if(1028===t)return 6403;if(1029===t)return 36244;if(1030===t)return 33319;if(1031===t)return 33320;if(1032===t)return 36248;if(1033===t)return 36249;if(33776===t||33777===t||33778===t||33779===t){if(n=e.get("WEBGL_compressed_texture_s3tc"),null===n)return null;if(33776===t)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===t)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===t)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===t)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===t||35841===t||35842===t||35843===t){if(n=e.get("WEBGL_compressed_texture_pvrtc"),null===n)return null;if(35840===t)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===t)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===t)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===t)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===t)return n=e.get("WEBGL_compressed_texture_etc1"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===t||37496===t)&&(n=e.get("WEBGL_compressed_texture_etc"),null!==n)){if(37492===t)return n.COMPRESSED_RGB8_ETC2;if(37496===t)return n.COMPRESSED_RGBA8_ETC2_EAC}return 37808===t||37809===t||37810===t||37811===t||37812===t||37813===t||37814===t||37815===t||37816===t||37817===t||37818===t||37819===t||37820===t||37821===t||37840===t||37841===t||37842===t||37843===t||37844===t||37845===t||37846===t||37847===t||37848===t||37849===t||37850===t||37851===t||37852===t||37853===t?(n=e.get("WEBGL_compressed_texture_astc"),null!==n?t:null):36492===t?(n=e.get("EXT_texture_compression_bptc"),null!==n?t:null):t===_u?i?34042:(n=e.get("WEBGL_depth_texture"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Rm.prototype.isMeshDistanceMaterial=!0;class zm extends gp{constructor(t=[]){super(),this.cameras=t}}zm.prototype.isArrayCamera=!0;class Fm extends ld{constructor(){super(),this.type="Group"}}Fm.prototype.isGroup=!0;const Um={type:"move"};class Hm{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Fm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Fm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new oh,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new oh),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Fm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new oh,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new oh),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState)if(null!==o&&(i=e.getPose(t.targetRaySpace,n),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Um))),l&&t.hand){s=!0;for(const s of t.hand.values()){const t=e.getJointPose(s,n);if(void 0===l.joints[s.jointName]){const t=new Fm;t.matrixAutoUpdate=!1,t.visible=!1,l.joints[s.jointName]=t,l.add(t)}const i=l.joints[s.jointName];null!==t&&(i.matrix.fromArray(t.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.jointRadius=t.radius),i.visible=null!==t}const i=l.joints["index-finger-tip"].position.distanceTo(l.joints["thumb-tip"].position),r=.02,o=.005;l.inputState.pinching&&i>r+o?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&i<=r-o&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==a&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));return null!==o&&(o.visible=null!==i),null!==a&&(a.visible=null!==r),null!==l&&(l.visible=null!==s),this}}class Bm extends Ou{constructor(t,e){super();const n=this,i=t.state;let r=null,s=1,o=null,a="local-floor",l=null,c=null,u=null,h=null;const d=[],p=new Map,f=new gp;f.layers.enable(1),f.viewport=new nh;const m=new gp;m.layers.enable(2),m.viewport=new nh;const g=[f,m],y=new zm;y.layers.enable(1),y.layers.enable(2);let v=null,_=null;function x(t){const e=p.get(t.inputSource);e&&e.dispatchEvent({type:t.type,data:t.inputSource})}function b(){p.forEach(function(t,e){t.disconnect(e)}),p.clear(),v=null,_=null,i.bindXRFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),E.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function w(t){const e=r.inputSources;for(let n=0;n<d.length;n++)p.set(e[n],d[n]);for(let n=0;n<t.removed.length;n++){const e=t.removed[n],i=p.get(e);i&&(i.dispatchEvent({type:"disconnected",data:e}),p.delete(e))}for(let n=0;n<t.added.length;n++){const e=t.added[n],i=p.get(e);i&&i.dispatchEvent({type:"connected",data:e})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=d[t];return void 0===e&&(e=new Hm,d[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=d[t];return void 0===e&&(e=new Hm,d[t]=e),e.getGripSpace()},this.getHand=function(t){let e=d[t];return void 0===e&&(e=new Hm,d[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){s=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(t){a=t,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o},this.getSession=function(){return r},this.setSession=function(){var t=Fs(function*(t){if(r=t,null!==r){r.addEventListener("select",x),r.addEventListener("selectstart",x),r.addEventListener("selectend",x),r.addEventListener("squeeze",x),r.addEventListener("squeezestart",x),r.addEventListener("squeezeend",x),r.addEventListener("end",b),r.addEventListener("inputsourceschange",w);const t=e.getContextAttributes();if(!0!==t.xrCompatible&&(yield e.makeXRCompatible()),void 0===r.renderState.layers){const n=new XRWebGLLayer(r,e,{antialias:t.antialias,alpha:t.alpha,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:s});r.updateRenderState({baseLayer:n})}else{let n=0;t.depth&&(n=t.stencil?34041:6402);const i={colorFormat:t.alpha?6408:6407,depthFormat:n,scaleFactor:s};c=new XRWebGLBinding(r,e),h=c.createProjectionLayer(i),u=e.createFramebuffer(),r.updateRenderState({layers:[h]})}o=yield r.requestReferenceSpace(a),E.setContext(r),E.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(e){return t.apply(this,arguments)}}();const C=new oh,T=new oh;function S(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===r)return;y.near=m.near=f.near=t.near,y.far=m.far=f.far=t.far,v===y.near&&_===y.far||(r.updateRenderState({depthNear:y.near,depthFar:y.far}),v=y.near,_=y.far);const e=t.parent,n=y.cameras;S(y,e);for(let r=0;r<n.length;r++)S(n[r],e);y.matrixWorld.decompose(y.position,y.quaternion,y.scale),t.position.copy(y.position),t.quaternion.copy(y.quaternion),t.scale.copy(y.scale),t.matrix.copy(y.matrix),t.matrixWorld.copy(y.matrixWorld);const i=t.children;for(let r=0,s=i.length;r<s;r++)i[r].updateMatrixWorld(!0);2===n.length?function(t,e,n){C.setFromMatrixPosition(e.matrixWorld),T.setFromMatrixPosition(n.matrixWorld);const i=C.distanceTo(T),r=e.projectionMatrix.elements,s=n.projectionMatrix.elements,o=r[14]/(r[10]-1),a=r[14]/(r[10]+1),l=(r[9]+1)/r[5],c=(r[9]-1)/r[5],u=(r[8]-1)/r[0],h=(s[8]+1)/s[0],d=o*u,p=o*h,f=i/(-u+h),m=f*-u;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=o+f,y=a+f;t.projectionMatrix.makePerspective(d-m,p+(i-m),l*a/y*g,c*a/y*g,g,y)}(y,f,m):y.projectionMatrix.copy(f.projectionMatrix)},this.getCamera=function(){return y};let M=null;const E=new Ap;E.setAnimationLoop(function(t,n){if(l=n.getViewerPose(o),null!==l){const t=l.views,n=r.renderState.baseLayer;void 0===r.renderState.layers&&i.bindXRFramebuffer(n.framebuffer);let s=!1;t.length!==y.cameras.length&&(y.cameras.length=0,s=!0);for(let o=0;o<t.length;o++){const a=t[o];let l=null;if(void 0===r.renderState.layers)l=n.getViewport(a);else{const t=c.getViewSubImage(h,a);e.bindFramebuffer(36160,u),e.framebufferTexture2D(36160,36064,3553,t.colorTexture,0),void 0!==t.depthStencilTexture&&e.framebufferTexture2D(36160,36096,3553,t.depthStencilTexture,0),e.bindFramebuffer(36160,null),i.bindXRFramebuffer(u),l=t.viewport}const d=g[o];d.matrix.fromArray(a.transform.matrix),d.projectionMatrix.fromArray(a.projectionMatrix),d.viewport.set(l.x,l.y,l.width,l.height),0===o&&y.matrix.copy(d.matrix),!0===s&&y.cameras.push(d)}}const s=r.inputSources;for(let e=0;e<d.length;e++)d[e].update(s[e],n,o);M&&M(t,n)}),this.setAnimationLoop=function(t){M=t},this.dispose=function(){}}}function Vm(t){function e(e,n){e.opacity.value=n.opacity,n.color&&e.diffuse.value.copy(n.color),n.emissive&&e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(e.map.value=n.map),n.alphaMap&&(e.alphaMap.value=n.alphaMap),n.specularMap&&(e.specularMap.value=n.specularMap);const i=t.get(n).envMap;if(i){e.envMap.value=i,e.flipEnvMap.value=i.isCubeTexture&&i._needsFlipEnvMap?-1:1,e.reflectivity.value=n.reflectivity,e.refractionRatio.value=n.refractionRatio;const r=t.get(i).__maxMipLevel;void 0!==r&&(e.maxMipLevel.value=r)}let r,s;n.lightMap&&(e.lightMap.value=n.lightMap,e.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(e.aoMap.value=n.aoMap,e.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),n.aoMap?s=n.aoMap:n.lightMap&&(s=n.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),e.uv2Transform.value.copy(s.matrix))}function n(e,n){e.roughness.value=n.roughness,e.metalness.value=n.metalness,n.roughnessMap&&(e.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(e.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(e.emissiveMap.value=n.emissiveMap),n.bumpMap&&(e.bumpMap.value=n.bumpMap,e.bumpScale.value=n.bumpScale,1===n.side&&(e.bumpScale.value*=-1)),n.normalMap&&(e.normalMap.value=n.normalMap,e.normalScale.value.copy(n.normalScale),1===n.side&&e.normalScale.value.negate()),n.displacementMap&&(e.displacementMap.value=n.displacementMap,e.displacementScale.value=n.displacementScale,e.displacementBias.value=n.displacementBias),t.get(n).envMap&&(e.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,i,r,s,o){i.isMeshBasicMaterial?e(t,i):i.isMeshLambertMaterial?(e(t,i),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(t,i)):i.isMeshToonMaterial?(e(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshPhongMaterial?(e(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshStandardMaterial?(e(t,i),i.isMeshPhysicalMaterial?function(t,e,i){n(t,e),t.reflectivity.value=e.reflectivity,t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.sheen&&t.sheen.value.copy(e.sheen),e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate()),t.transmission.value=e.transmission,e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),e.transmission>0&&(t.transmissionSamplerMap.value=i.texture,t.transmissionSamplerSize.value.set(i.width,i.height)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor)}(t,i,o):n(t,i)):i.isMeshMatcapMaterial?(e(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshDepthMaterial?(e(t,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isMeshDistanceMaterial?(e(t,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,i)):i.isMeshNormalMaterial?(e(t,i),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale,1===e.side&&(t.bumpScale.value*=-1)),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale),1===e.side&&t.normalScale.value.negate()),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(t,i)):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,n,i){let r;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?r=e.map:e.alphaMap&&(r=e.alphaMap),void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,i,r,s):i.isSpriteMaterial?function(t,e){let n;t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.map?n=e.map:e.alphaMap&&(n=e.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function Gm(t={}){const e=void 0!==t.canvas?t.canvas:function(){const t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return t.style.display="block",t}(),n=void 0!==t.context?t.context:null,i=void 0!==t.alpha&&t.alpha,r=void 0===t.depth||t.depth,s=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",u=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let h=null,d=null;const p=[],f=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Pu,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const m=this;let g=!1,y=0,v=0,_=null,x=-1,b=null;const w=new nh,C=new nh;let T=null,S=e.width,M=e.height,E=1,A=null,D=null;const P=new nh(0,0,S,M),L=new nh(0,0,S,M);let R=!1;const I=[],N=new Ep;let k=!1,O=!1,z=null;const F=new zh,U=new oh,H={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function B(){return null===_?E:1}let V,G,j,W,q,Z,Y,X,J,$,Q,K,tt,et,nt,it,rt,st,ot,at,lt,ct,ut=n;function ht(t,n){for(let i=0;i<t.length;i++){const r=e.getContext(t[i],n);if(null!==r)return r}return null}try{const t={alpha:i,depth:r,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if(e.addEventListener("webglcontextlost",ft,!1),e.addEventListener("webglcontextrestored",mt,!1),null===ut){const e=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&e.shift(),ut=ht(e,t),null===ut)throw ht(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ut.getShaderPrecisionFormat&&(ut.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Et){throw console.error("THREE.WebGLRenderer: "+Et.message),Et}function dt(){V=new Hp(ut),G=new zp(ut,V,t),V.init(G),lt=new Om(ut,V,G),j=new Nm(ut,V,G),I[0]=1029,W=new Gp(ut),q=new xm,Z=new km(ut,V,j,q,G,lt,W),Y=new Up(m),X=new Dp(ut,G),ct=new kp(ut,V,X,G),J=new Bp(ut,X,W,ct),$=new Zp(ut,J,X,W),st=new qp(ut),nt=new Fp(q),Q=new _m(m,Y,V,G,ct,nt),K=new Vm(q),tt=new Tm(q),et=new Pm(V,G),rt=new Np(m,Y,j,$,a),it=new Im(m,$,G),ot=new Op(ut,V,W,G),at=new Vp(ut,V,W,G),W.programs=Q.programs,m.capabilities=G,m.extensions=V,m.properties=q,m.renderLists=tt,m.shadowMap=it,m.state=j,m.info=W}dt();const pt=new Bm(m,ut);function ft(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function mt(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;const t=W.autoReset,e=it.enabled,n=it.autoUpdate,i=it.needsUpdate,r=it.type;dt(),W.autoReset=t,it.enabled=e,it.autoUpdate=n,it.needsUpdate=i,it.type=r}function gt(t){const e=t.target;e.removeEventListener("dispose",gt),function(t){(function(t){const e=q.get(t).programs;void 0!==e&&e.forEach(function(t){Q.releaseProgram(t)})})(t),q.remove(t)}(e)}this.xr=pt,this.getContext=function(){return ut},this.getContextAttributes=function(){return ut.getContextAttributes()},this.forceContextLoss=function(){const t=V.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=V.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return E},this.setPixelRatio=function(t){void 0!==t&&(E=t,this.setSize(S,M,!1))},this.getSize=function(t){return t.set(S,M)},this.setSize=function(t,n,i){pt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(S=t,M=n,e.width=Math.floor(t*E),e.height=Math.floor(n*E),!1!==i&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(S*E,M*E).floor()},this.setDrawingBufferSize=function(t,n,i){S=t,M=n,E=i,e.width=Math.floor(t*i),e.height=Math.floor(n*i),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(w)},this.getViewport=function(t){return t.copy(P)},this.setViewport=function(t,e,n,i){t.isVector4?P.set(t.x,t.y,t.z,t.w):P.set(t,e,n,i),j.viewport(w.copy(P).multiplyScalar(E).floor())},this.getScissor=function(t){return t.copy(L)},this.setScissor=function(t,e,n,i){t.isVector4?L.set(t.x,t.y,t.z,t.w):L.set(t,e,n,i),j.scissor(C.copy(L).multiplyScalar(E).floor())},this.getScissorTest=function(){return R},this.setScissorTest=function(t){j.setScissorTest(R=t)},this.setOpaqueSort=function(t){A=t},this.setTransparentSort=function(t){D=t},this.getClearColor=function(t){return t.copy(rt.getClearColor())},this.setClearColor=function(){rt.setClearColor.apply(rt,arguments)},this.getClearAlpha=function(){return rt.getClearAlpha()},this.setClearAlpha=function(){rt.setClearAlpha.apply(rt,arguments)},this.clear=function(t,e,n){let i=0;(void 0===t||t)&&(i|=16384),(void 0===e||e)&&(i|=256),(void 0===n||n)&&(i|=1024),ut.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ft,!1),e.removeEventListener("webglcontextrestored",mt,!1),tt.dispose(),et.dispose(),q.dispose(),Y.dispose(),$.dispose(),ct.dispose(),pt.dispose(),pt.removeEventListener("sessionstart",vt),pt.removeEventListener("sessionend",_t),z&&(z.dispose(),z=null),xt.stop()},this.renderBufferImmediate=function(t,e){ct.initAttributes();const n=q.get(t);t.hasPositions&&!n.position&&(n.position=ut.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=ut.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=ut.createBuffer()),t.hasColors&&!n.color&&(n.color=ut.createBuffer());const i=e.getAttributes();t.hasPositions&&(ut.bindBuffer(34962,n.position),ut.bufferData(34962,t.positionArray,35048),ct.enableAttribute(i.position),ut.vertexAttribPointer(i.position,3,5126,!1,0,0)),t.hasNormals&&(ut.bindBuffer(34962,n.normal),ut.bufferData(34962,t.normalArray,35048),ct.enableAttribute(i.normal),ut.vertexAttribPointer(i.normal,3,5126,!1,0,0)),t.hasUvs&&(ut.bindBuffer(34962,n.uv),ut.bufferData(34962,t.uvArray,35048),ct.enableAttribute(i.uv),ut.vertexAttribPointer(i.uv,2,5126,!1,0,0)),t.hasColors&&(ut.bindBuffer(34962,n.color),ut.bufferData(34962,t.colorArray,35048),ct.enableAttribute(i.color),ut.vertexAttribPointer(i.color,3,5126,!1,0,0)),ct.disableUnusedAttributes(),ut.drawArrays(4,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,n,i,r,s){null===e&&(e=H);const o=r.isMesh&&r.matrixWorld.determinant()<0,a=Mt(t,e,i,r);j.setMaterial(i,o);let l=n.index;const c=n.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===i.wireframe&&(l=J.getWireframeAttribute(n),h=2),(i.morphTargets||i.morphNormals)&&st.update(r,n,i,a),ct.setup(r,i,a,n,l);let d=ot;null!==l&&(u=X.get(l),d=at,d.setIndex(u));const p=null!==l?l.count:c.count,f=n.drawRange.start*h,m=n.drawRange.count*h,g=null!==s?s.start*h:0,y=null!==s?s.count*h:1/0,v=Math.max(f,g),_=Math.min(p,f+m,g+y)-1,x=Math.max(0,_-v+1);if(0!==x){if(r.isMesh)!0===i.wireframe?(j.setLineWidth(i.wireframeLinewidth*B()),d.setMode(1)):d.setMode(4);else if(r.isLine){let t=i.linewidth;void 0===t&&(t=1),j.setLineWidth(t*B()),d.setMode(r.isLineSegments?1:r.isLineLoop?2:3)}else r.isPoints?d.setMode(0):r.isSprite&&d.setMode(4);if(r.isInstancedMesh)d.renderInstances(v,x,r.count);else if(n.isInstancedBufferGeometry){const t=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(v,x,t)}else d.render(v,x)}},this.compile=function(t,e){d=et.get(t),d.init(),t.traverseVisible(function(t){t.isLight&&t.layers.test(e.layers)&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))}),d.setupLights(),t.traverse(function(e){const n=e.material;if(n)if(Array.isArray(n))for(let i=0;i<n.length;i++)Tt(n[i],t,e);else Tt(n,t,e)})};let yt=null;function vt(){xt.stop()}function _t(){xt.start()}const xt=new Ap;function bt(t,e,n,i){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||N.intersectsSprite(t)){i&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F);const e=$.update(t),r=t.material;r.visible&&h.push(t,e,r,n,U.z,null)}}else if(t.isImmediateRenderObject)i&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F),h.push(t,null,t.material,n,U.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==W.render.frame&&(t.skeleton.update(),t.skeleton.frame=W.render.frame),!t.frustumCulled||N.intersectsObject(t))){i&&U.setFromMatrixPosition(t.matrixWorld).applyMatrix4(F);const e=$.update(t),r=t.material;if(Array.isArray(r)){const i=e.groups;for(let s=0,o=i.length;s<o;s++){const o=i[s],a=r[o.materialIndex];a&&a.visible&&h.push(t,e,a,n,U.z,o)}}else r.visible&&h.push(t,e,r,n,U.z,null)}const r=t.children;for(let s=0,o=r.length;s<o;s++)bt(r[s],e,n,i)}function wt(t,e,n){const i=!0===e.isScene?e.overrideMaterial:null;for(let r=0,s=t.length;r<s;r++){const s=t[r],o=s.object,a=s.geometry,l=null===i?s.material:i,c=s.group;if(n.isArrayCamera){const t=n.cameras;for(let n=0,i=t.length;n<i;n++){const i=t[n];o.layers.test(i.layers)&&(j.viewport(w.copy(i.viewport)),d.setupLightsView(i),Ct(o,e,i,a,l,c))}}else Ct(o,e,n,a,l,c)}}function Ct(t,e,n,i,r,s){if(t.onBeforeRender(m,e,n,i,r,s),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){const i=Mt(n,e,r,t);j.setMaterial(r),ct.reset(),function(t,e){t.render(function(t){m.renderBufferImmediate(t,e)})}(t,i)}else!0===r.transparent&&2===r.side?(r.side=1,r.needsUpdate=!0,m.renderBufferDirect(n,e,i,r,t,s),r.side=0,r.needsUpdate=!0,m.renderBufferDirect(n,e,i,r,t,s),r.side=2):m.renderBufferDirect(n,e,i,r,t,s);t.onAfterRender(m,e,n,i,r,s)}function Tt(t,e,n){!0!==e.isScene&&(e=H);const i=q.get(t),r=d.state.lights,s=r.state.version,o=Q.getParameters(t,r.state,d.state.shadowsArray,e,n),a=Q.getProgramCacheKey(o);let l=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=Y.get(t.envMap||i.environment),void 0===l&&(t.addEventListener("dispose",gt),l=new Map,i.programs=l);let c=l.get(a);if(void 0!==c){if(i.currentProgram===c&&i.lightsStateVersion===s)return St(t,o),c}else o.uniforms=Q.getUniforms(t),t.onBuild(o,m),t.onBeforeCompile(o,m),c=Q.acquireProgram(o,a),l.set(a,c),i.uniforms=o.uniforms;const u=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(u.clippingPlanes=nt.uniform),St(t,o),i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=s,i.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotShadowMatrix.value=r.state.spotShadowMatrix,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix);const h=c.getUniforms(),p=Qf.seqWithValue(h.seq,u);return i.currentProgram=c,i.uniformsList=p,c}function St(t,e){const n=q.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas}function Mt(t,e,n,i){!0!==e.isScene&&(e=H),Z.resetTextureUnits();const r=e.fog,s=null===_?m.outputEncoding:_.texture.encoding,o=Y.get(n.envMap||(n.isMeshStandardMaterial?e.environment:null)),a=!0===n.vertexColors&&i.geometry&&i.geometry.attributes.color&&4===i.geometry.attributes.color.itemSize,l=q.get(n),c=d.state.lights;!0!==k||!0!==O&&t===b||nt.setState(n,t,t===b&&n.id===x);let u=!1;n.version===l.__version?l.needsLights&&l.lightsStateVersion!==c.state.version||l.outputEncoding!==s||i.isInstancedMesh&&!1===l.instancing?u=!0:i.isInstancedMesh||!0!==l.instancing?i.isSkinnedMesh&&!1===l.skinning?u=!0:i.isSkinnedMesh||!0!==l.skinning?l.envMap!==o||n.fog&&l.fog!==r?u=!0:void 0===l.numClippingPlanes||l.numClippingPlanes===nt.numPlanes&&l.numIntersection===nt.numIntersection?l.vertexAlphas!==a&&(u=!0):u=!0:u=!0:u=!0:(u=!0,l.__version=n.version);let h=l.currentProgram;!0===u&&(h=Tt(n,e,i));let p=!1,f=!1,g=!1;const y=h.getUniforms(),v=l.uniforms;if(j.useProgram(h.program)&&(p=!0,f=!0,g=!0),n.id!==x&&(x=n.id,f=!0),p||b!==t){if(y.setValue(ut,"projectionMatrix",t.projectionMatrix),G.logarithmicDepthBuffer&&y.setValue(ut,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),b!==t&&(b=t,f=!0,g=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){const e=y.map.cameraPosition;void 0!==e&&e.setValue(ut,U.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&y.setValue(ut,"isOrthographic",!0===t.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||i.isSkinnedMesh)&&y.setValue(ut,"viewMatrix",t.matrixWorldInverse)}if(i.isSkinnedMesh){y.setOptional(ut,i,"bindMatrix"),y.setOptional(ut,i,"bindMatrixInverse");const t=i.skeleton;t&&(G.floatVertexTextures?(null===t.boneTexture&&t.computeBoneTexture(),y.setValue(ut,"boneTexture",t.boneTexture,Z),y.setValue(ut,"boneTextureSize",t.boneTextureSize)):y.setOptional(ut,t,"boneMatrices"))}var w,C;return(f||l.receiveShadow!==i.receiveShadow)&&(l.receiveShadow=i.receiveShadow,y.setValue(ut,"receiveShadow",i.receiveShadow)),f&&(y.setValue(ut,"toneMappingExposure",m.toneMappingExposure),l.needsLights&&((w=v).ambientLightColor.needsUpdate=C=g,w.lightProbe.needsUpdate=C,w.directionalLights.needsUpdate=C,w.directionalLightShadows.needsUpdate=C,w.pointLights.needsUpdate=C,w.pointLightShadows.needsUpdate=C,w.spotLights.needsUpdate=C,w.spotLightShadows.needsUpdate=C,w.rectAreaLights.needsUpdate=C,w.hemisphereLights.needsUpdate=C),r&&n.fog&&K.refreshFogUniforms(v,r),K.refreshMaterialUniforms(v,n,E,M,z),Qf.upload(ut,l.uniformsList,v,Z)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Qf.upload(ut,l.uniformsList,v,Z),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&y.setValue(ut,"center",i.center),y.setValue(ut,"modelViewMatrix",i.modelViewMatrix),y.setValue(ut,"normalMatrix",i.normalMatrix),y.setValue(ut,"modelMatrix",i.matrixWorld),h}xt.setAnimationLoop(function(t){yt&&yt(t)}),"undefined"!=typeof window&&xt.setContext(window),this.setAnimationLoop=function(t){yt=t,pt.setAnimationLoop(t),null===t?xt.stop():xt.start()},pt.addEventListener("sessionstart",vt),pt.addEventListener("sessionend",_t),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===g)return;!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),!0===pt.enabled&&!0===pt.isPresenting&&(!0===pt.cameraAutoUpdate&&pt.updateCamera(e),e=pt.getCamera()),!0===t.isScene&&t.onBeforeRender(m,t,e,_),d=et.get(t,f.length),d.init(),f.push(d),F.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),N.setFromProjectionMatrix(F),O=this.localClippingEnabled,k=nt.init(this.clippingPlanes,O,e),h=tt.get(t,p.length),h.init(),p.push(h),bt(t,e,0,m.sortObjects),h.finish(),!0===m.sortObjects&&h.sort(A,D),!0===k&&nt.beginShadows(),it.render(d.state.shadowsArray,t,e),d.setupLights(),d.setupLightsView(e),!0===k&&nt.endShadows(),!0===this.info.autoReset&&this.info.reset(),rt.render(h,t);const n=h.opaque,i=h.transmissive,r=h.transparent;n.length>0&&wt(n,t,e),i.length>0&&function(t,e,n,i){null===z&&(z=new(!0===o&&!0===G.isWebGL2?rh:ih)(1024,1024,{generateMipmaps:!0,type:null!==lt.convert(vu)?vu:fu,minFilter:pu,magFilter:cu,wrapS:au,wrapT:au}));const r=m.getRenderTarget();m.setRenderTarget(z),m.clear();const s=m.toneMapping;m.toneMapping=0,wt(t,n,i),m.toneMapping=s,Z.updateMultisampleRenderTarget(z),Z.updateRenderTargetMipmap(z),m.setRenderTarget(r),wt(e,n,i)}(n,i,t,e),r.length>0&&wt(r,t,e),null!==_&&(Z.updateMultisampleRenderTarget(_),Z.updateRenderTargetMipmap(_)),!0===t.isScene&&t.onAfterRender(m,t,e),j.buffers.depth.setTest(!0),j.buffers.depth.setMask(!0),j.buffers.color.setMask(!0),j.setPolygonOffset(!1),ct.resetDefaultState(),x=-1,b=null,f.pop(),d=f.length>0?f[f.length-1]:null,p.pop(),h=p.length>0?p[p.length-1]:null},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return v},this.getRenderTarget=function(){return _},this.setRenderTarget=function(t,e=0,n=0){_=t,y=e,v=n,t&&void 0===q.get(t).__webglFramebuffer&&Z.setupRenderTarget(t);let i=null,r=!1,s=!1;if(t){const n=t.texture;(n.isDataTexture3D||n.isDataTexture2DArray)&&(s=!0);const o=q.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(i=o[e],r=!0):i=t.isWebGLMultisampleRenderTarget?q.get(t).__webglMultisampledFramebuffer:o,w.copy(t.viewport),C.copy(t.scissor),T=t.scissorTest}else w.copy(P).multiplyScalar(E).floor(),C.copy(L).multiplyScalar(E).floor(),T=R;if(j.bindFramebuffer(36160,i)&&G.drawBuffers){let e=!1;if(t)if(t.isWebGLMultipleRenderTargets){const n=t.texture;if(I.length!==n.length||36064!==I[0]){for(let t=0,e=n.length;t<e;t++)I[t]=36064+t;I.length=n.length,e=!0}}else 1===I.length&&36064===I[0]||(I[0]=36064,I.length=1,e=!0);else 1===I.length&&1029===I[0]||(I[0]=1029,I.length=1,e=!0);e&&(G.isWebGL2?ut.drawBuffers(I):V.get("WEBGL_draw_buffers").drawBuffersWEBGL(I))}if(j.viewport(w),j.scissor(C),j.setScissorTest(T),r){const i=q.get(t.texture);ut.framebufferTexture2D(36160,36064,34069+e,i.__webglTexture,n)}else if(s){const i=q.get(t.texture);ut.framebufferTextureLayer(36160,36064,i.__webglTexture,n||0,e||0)}},this.readRenderTargetPixels=function(t,e,n,i,r,s,o){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=q.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){j.bindFramebuffer(36160,a);try{const o=t.texture,a=o.format,l=o.type;if(a!==bu&&lt.convert(a)!==ut.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===vu&&(V.has("EXT_color_buffer_half_float")||G.isWebGL2&&V.has("EXT_color_buffer_float"));if(!(l===fu||lt.convert(l)===ut.getParameter(35738)||l===yu&&(G.isWebGL2||V.has("OES_texture_float")||V.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ut.checkFramebufferStatus(36160)?e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&ut.readPixels(e,n,i,r,lt.convert(a),lt.convert(l),s):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const t=null!==_?q.get(_).__webglFramebuffer:null;j.bindFramebuffer(36160,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),s=Math.floor(e.image.height*i);let o=lt.convert(e.format);G.isWebGL2&&(6407===o&&(o=32849),6408===o&&(o=32856)),Z.setTexture2D(e,0),ut.copyTexImage2D(3553,n,o,t.x,t.y,r,s,0),j.unbindTexture()},this.copyTextureToTexture=function(t,e,n,i=0){const r=e.image.width,s=e.image.height,o=lt.convert(n.format),a=lt.convert(n.type);Z.setTexture2D(n,0),ut.pixelStorei(37440,n.flipY),ut.pixelStorei(37441,n.premultiplyAlpha),ut.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?ut.texSubImage2D(3553,i,t.x,t.y,r,s,o,a,e.image.data):e.isCompressedTexture?ut.compressedTexSubImage2D(3553,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):ut.texSubImage2D(3553,i,t.x,t.y,o,a,e.image),0===i&&n.generateMipmaps&&ut.generateMipmap(3553),j.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,i,r=0){if(m.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const s=t.max.x-t.min.x+1,o=t.max.y-t.min.y+1,a=t.max.z-t.min.z+1,l=lt.convert(i.format),c=lt.convert(i.type);let u;if(i.isDataTexture3D)Z.setTexture3D(i,0),u=32879;else{if(!i.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Z.setTexture2DArray(i,0),u=35866}ut.pixelStorei(37440,i.flipY),ut.pixelStorei(37441,i.premultiplyAlpha),ut.pixelStorei(3317,i.unpackAlignment);const h=ut.getParameter(3314),d=ut.getParameter(32878),p=ut.getParameter(3316),f=ut.getParameter(3315),g=ut.getParameter(32877),y=n.isCompressedTexture?n.mipmaps[0]:n.image;ut.pixelStorei(3314,y.width),ut.pixelStorei(32878,y.height),ut.pixelStorei(3316,t.min.x),ut.pixelStorei(3315,t.min.y),ut.pixelStorei(32877,t.min.z),n.isDataTexture||n.isDataTexture3D?ut.texSubImage3D(u,r,e.x,e.y,e.z,s,o,a,l,c,y.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ut.compressedTexSubImage3D(u,r,e.x,e.y,e.z,s,o,a,l,y.data)):ut.texSubImage3D(u,r,e.x,e.y,e.z,s,o,a,l,c,y),ut.pixelStorei(3314,h),ut.pixelStorei(32878,d),ut.pixelStorei(3316,p),ut.pixelStorei(3315,f),ut.pixelStorei(32877,g),0===r&&i.generateMipmaps&&ut.generateMipmap(u),j.unbindTexture()},this.initTexture=function(t){Z.setTexture2D(t,0),j.unbindTexture()},this.resetState=function(){y=0,v=0,_=null,j.reset(),ct.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class extends Gm{}).prototype.isWebGL1Renderer=!0;class jm{constructor(t,e=25e-5){this.name="",this.color=new Ad(t),this.density=e}clone(){return new jm(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}jm.prototype.isFogExp2=!0;class Wm{constructor(t,e=1,n=1e3){this.name="",this.color=new Ad(t),this.near=e,this.far=n}clone(){return new Wm(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Wm.prototype.isFog=!0;class qm extends ld{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}qm.prototype.isScene=!0;class Zm{constructor(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.usage=Iu,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Bu()}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Bu()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Bu()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Zm.prototype.isInterleavedBuffer=!0;const Ym=new oh;class Xm{constructor(t,e,n,i=!1){this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)Ym.x=this.getX(e),Ym.y=this.getY(e),Ym.z=this.getZ(e),Ym.applyMatrix4(t),this.setXYZ(e,Ym.x,Ym.y,Ym.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Ym.x=this.getX(e),Ym.y=this.getY(e),Ym.z=this.getZ(e),Ym.applyNormalMatrix(t),this.setXYZ(e,Ym.x,Ym.y,Ym.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Ym.x=this.getX(e),Ym.y=this.getY(e),Ym.z=this.getZ(e),Ym.transformDirection(t),this.setXYZ(e,Ym.x,Ym.y,Ym.z);return this}setX(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,e,n){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,r){return this.data.array[(t=t*this.data.stride+this.offset)+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}clone(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return new Rd(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Xm(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let e=0;e<this.count;e++){const n=e*this.data.stride+this.offset;for(let e=0;e<this.itemSize;e++)t.push(this.data.array[n+e])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Xm.prototype.isInterleavedBufferAttribute=!0;class Jm extends bd{constructor(t){super(),this.type="SpriteMaterial",this.color=new Ad(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this}}let $m;Jm.prototype.isSpriteMaterial=!0;const Qm=new oh,Km=new oh,tg=new oh,eg=new Xu,ng=new Xu,ig=new zh,rg=new oh,sg=new oh,og=new oh,ag=new Xu,lg=new Xu,cg=new Xu;function ug(t,e,n,i,r,s){eg.subVectors(t,n).addScalar(.5).multiply(i),void 0!==r?(ng.x=s*eg.x-r*eg.y,ng.y=r*eg.x+s*eg.y):ng.copy(eg),t.copy(e),t.x+=ng.x,t.y+=ng.y,t.applyMatrix4(ig)}(class extends ld{constructor(t){if(super(),this.type="Sprite",void 0===$m){$m=new jd;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),e=new Zm(t,5);$m.setIndex([0,1,2,0,2,3]),$m.setAttribute("position",new Xm(e,3,0,!1)),$m.setAttribute("uv",new Xm(e,2,3,!1))}this.geometry=$m,this.material=void 0!==t?t:new Jm,this.center=new Xu(.5,.5)}raycast(t,e){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Km.setFromMatrixScale(this.matrixWorld),ig.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),tg.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Km.multiplyScalar(-tg.z);const n=this.material.rotation;let i,r;0!==n&&(r=Math.cos(n),i=Math.sin(n));const s=this.center;ug(rg.set(-.5,-.5,0),tg,s,Km,i,r),ug(sg.set(.5,-.5,0),tg,s,Km,i,r),ug(og.set(.5,.5,0),tg,s,Km,i,r),ag.set(0,0),lg.set(1,0),cg.set(1,1);let o=t.ray.intersectTriangle(rg,sg,og,!1,Qm);if(null===o&&(ug(sg.set(-.5,.5,0),tg,s,Km,i,r),lg.set(0,1),o=t.ray.intersectTriangle(rg,og,sg,!1,Qm),null===o))return;const a=t.ray.origin.distanceTo(Qm);a<t.near||a>t.far||e.push({distance:a,point:Qm.clone(),uv:_d.getUV(Qm,rg,sg,og,ag,lg,cg,new Xu),face:null,object:this})}copy(t){return super.copy(t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}}).prototype.isSprite=!0;const hg=new oh,dg=new nh,pg=new nh,fg=new oh,mg=new zh;class gg extends lp{constructor(t,e){super(t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new zh,this.bindMatrixInverse=new zh}copy(t){return super.copy(t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new nh,e=this.geometry.attributes.skinWeight;for(let n=0,i=e.count;n<i;n++){t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.w=e.getW(n);const i=1/t.manhattanLength();i!==1/0?t.multiplyScalar(i):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,e){const n=this.skeleton,i=this.geometry;dg.fromBufferAttribute(i.attributes.skinIndex,t),pg.fromBufferAttribute(i.attributes.skinWeight,t),hg.fromBufferAttribute(i.attributes.position,t).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let r=0;r<4;r++){const t=pg.getComponent(r);if(0!==t){const i=dg.getComponent(r);mg.multiplyMatrices(n.bones[i].matrixWorld,n.boneInverses[i]),e.addScaledVector(fg.copy(hg).applyMatrix4(mg),t)}}return e.applyMatrix4(this.bindMatrixInverse)}}gg.prototype.isSkinnedMesh=!0;class yg extends ld{constructor(){super(),this.type="Bone"}}yg.prototype.isBone=!0;class vg extends th{constructor(t=null,e=1,n=1,i,r,s,o,a,l=1003,c=1003,u,h){super(null,s,o,a,l,c,i,r,u,h),this.image={data:t,width:e,height:n},this.magFilter=l,this.minFilter=c,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}vg.prototype.isDataTexture=!0;const _g=new zh,xg=new zh;class bg{constructor(t=[],e=[]){this.uuid=Bu(),this.bones=t.slice(0),this.boneInverses=e,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let t=0,e=this.bones.length;t<e;t++)this.boneInverses.push(new zh)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,e=this.bones.length;t<e;t++){const e=new zh;this.bones[t]&&e.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(e)}}pose(){for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&e.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,e=this.bones.length;t<e;t++){const e=this.bones[t];e&&(e.parent&&e.parent.isBone?(e.matrix.copy(e.parent.matrixWorld).invert(),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))}}update(){const t=this.bones,e=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let r=0,s=t.length;r<s;r++)_g.multiplyMatrices(t[r]?t[r].matrixWorld:xg,e[r]),_g.toArray(n,16*r);null!==i&&(i.needsUpdate=!0)}clone(){return new bg(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(4*this.bones.length);t=qu(t),t=Math.max(t,4);const e=new Float32Array(t*t*4);e.set(this.boneMatrices);const n=new vg(e,t,t,bu,yu);return this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}getBoneByName(t){for(let e=0,n=this.bones.length;e<n;e++){const n=this.bones[e];if(n.name===t)return n}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,e){this.uuid=t.uuid;for(let n=0,i=t.bones.length;n<i;n++){const i=t.bones[n];let r=e[i];void 0===r&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),r=new yg),this.bones.push(r),this.boneInverses.push((new zh).fromArray(t.boneInverses[n]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const e=this.bones,n=this.boneInverses;for(let i=0,r=e.length;i<r;i++)t.bones.push(e[i].uuid),t.boneInverses.push(n[i].toArray());return t}}const wg=new zh,Cg=new zh,Tg=[],Sg=new lp;(class extends lp{constructor(t,e,n){super(t,e),this.instanceMatrix=new Rd(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}copy(t){return super.copy(t),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,e){e.fromArray(this.instanceColor.array,3*t)}getMatrixAt(t,e){e.fromArray(this.instanceMatrix.array,16*t)}raycast(t,e){const n=this.matrixWorld,i=this.count;if(Sg.geometry=this.geometry,Sg.material=this.material,void 0!==Sg.material)for(let r=0;r<i;r++){this.getMatrixAt(r,wg),Cg.multiplyMatrices(n,wg),Sg.matrixWorld=Cg,Sg.raycast(t,Tg);for(let t=0,n=Tg.length;t<n;t++){const n=Tg[t];n.instanceId=r,n.object=this,e.push(n)}Tg.length=0}}setColorAt(t,e){null===this.instanceColor&&(this.instanceColor=new Rd(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*t)}setMatrixAt(t,e){e.toArray(this.instanceMatrix.array,16*t)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class Mg extends bd{constructor(t){super(),this.type="LineBasicMaterial",this.color=new Ad(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this}}Mg.prototype.isLineBasicMaterial=!0;const Eg=new oh,Ag=new oh,Dg=new zh,Pg=new Oh,Lg=new Ah;class Rg extends ld{constructor(t=new jd,e=new Mg){super(),this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[0];for(let t=1,i=e.count;t<i;t++)Eg.fromBufferAttribute(e,t-1),Ag.fromBufferAttribute(e,t),n[t]=n[t-1],n[t]+=Eg.distanceTo(Ag);t.setAttribute("lineDistance",new kd(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Lg.copy(n.boundingSphere),Lg.applyMatrix4(i),Lg.radius+=r,!1===t.ray.intersectsSphere(Lg))return;Dg.copy(i).invert(),Pg.copy(t.ray).applyMatrix4(Dg);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new oh,c=new oh,u=new oh,h=new oh,d=this.isLineSegments?2:1;if(n.isBufferGeometry){const i=n.index,r=n.attributes.position;if(null!==i)for(let n=Math.max(0,s.start),o=Math.min(i.count,s.start+s.count)-1;n<o;n+=d){const s=i.getX(n),o=i.getX(n+1);if(l.fromBufferAttribute(r,s),c.fromBufferAttribute(r,o),Pg.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const d=t.ray.origin.distanceTo(h);d<t.near||d>t.far||e.push({distance:d,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}else for(let n=Math.max(0,s.start),o=Math.min(r.count,s.start+s.count)-1;n<o;n+=d){if(l.fromBufferAttribute(r,n),c.fromBufferAttribute(r,n+1),Pg.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const i=t.ray.origin.distanceTo(h);i<t.near||i>t.far||e.push({distance:i,point:u.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Rg.prototype.isLine=!0;const Ig=new oh,Ng=new oh;class kg extends Rg{constructor(t,e){super(t,e),this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const e=t.attributes.position,n=[];for(let t=0,i=e.count;t<i;t+=2)Ig.fromBufferAttribute(e,t),Ng.fromBufferAttribute(e,t+1),n[t]=0===t?0:n[t-1],n[t+1]=n[t]+Ig.distanceTo(Ng);t.setAttribute("lineDistance",new kd(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else t.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}kg.prototype.isLineSegments=!0;class Og extends Rg{constructor(t,e){super(t,e),this.type="LineLoop"}}Og.prototype.isLineLoop=!0;class zg extends bd{constructor(t){super(),this.type="PointsMaterial",this.color=new Ad(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this}}zg.prototype.isPointsMaterial=!0;const Fg=new zh,Ug=new Oh,Hg=new Ah,Bg=new oh;class Vg extends ld{constructor(t=new jd,e=new zg){super(),this.type="Points",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t){return super.copy(t),this.material=t.material,this.geometry=t.geometry,this}raycast(t,e){const n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold,s=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Hg.copy(n.boundingSphere),Hg.applyMatrix4(i),Hg.radius+=r,!1===t.ray.intersectsSphere(Hg))return;Fg.copy(i).invert(),Ug.copy(t.ray).applyMatrix4(Fg);const o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(n.isBufferGeometry){const r=n.index,o=n.attributes.position;if(null!==r)for(let n=Math.max(0,s.start),l=Math.min(r.count,s.start+s.count);n<l;n++){const s=r.getX(n);Bg.fromBufferAttribute(o,s),Gg(Bg,s,a,i,t,e,this)}else for(let n=Math.max(0,s.start),l=Math.min(o.count,s.start+s.count);n<l;n++)Bg.fromBufferAttribute(o,n),Gg(Bg,n,a,i,t,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const t=this.geometry;if(t.isBufferGeometry){const e=t.morphAttributes,n=Object.keys(e);if(n.length>0){const t=e[n[0]];if(void 0!==t){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,n=t.length;e<n;e++){const n=t[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}}}else{const e=t.morphTargets;void 0!==e&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function Gg(t,e,n,i,r,s,o){const a=Ug.distanceSqToPoint(t);if(a<n){const n=new oh;Ug.closestPointToPoint(t,n),n.applyMatrix4(i);const l=r.ray.origin.distanceTo(n);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:n,index:e,face:null,object:o})}}Vg.prototype.isPoints=!0,class extends th{constructor(t,e,n,i,r,s,o,a,l){super(t,e,n,i,r,s,o,a,l),this.format=void 0!==o?o:xu,this.minFilter=void 0!==s?s:du,this.magFilter=void 0!==r?r:du,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function e(){c.needsUpdate=!0,t.requestVideoFrameCallback(e)})}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;0=="requestVideoFrameCallback"in t&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class extends th{constructor(t,e,n,i,r,s,o,a,l,c,u,h){super(null,s,o,a,l,c,i,r,u,h),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isCompressedTexture=!0,class extends th{constructor(t,e,n,i,r,s,o,a,l){super(t,e,n,i,r,s,o,a,l),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0,class extends th{constructor(t,e,n,i,r,s,o,a,l,c){if((c=void 0!==c?c:wu)!==wu&&c!==Cu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&c===wu&&(n=mu),void 0===n&&c===Cu&&(n=_u),super(null,i,r,s,o,a,c,n,l),this.image={width:t,height:e},this.magFilter=void 0!==o?o:cu,this.minFilter=void 0!==a?a:cu,this.flipY=!1,this.generateMipmaps=!1}}.prototype.isDepthTexture=!0,new oh,new oh,new oh,new _d;class jg{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let i=0;const r=n.length;let s;s=e||t*n[r-1];let o,a=0,l=r-1;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),o=n[i]-s,o<0)a=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(i=l,n[i]===s)return i/(r-1);const c=n[i];return(i+(s-c)/(n[i+1]-c))/(r-1)}getTangent(t,e){const n=1e-4;let i=t-n,r=t+n;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),o=this.getPoint(r),a=e||(s.isVector2?new Xu:new oh);return a.copy(o).sub(s).normalize(),a}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new oh,i=[],r=[],s=[],o=new oh,a=new zh;for(let d=0;d<=t;d++)i[d]=this.getTangentAt(d/t,new oh),i[d].normalize();r[0]=new oh,s[0]=new oh;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),u<=l&&(l=u,n.set(0,1,0)),h<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=t;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(i[d-1],i[d]),o.length()>Number.EPSILON){o.normalize();const t=Math.acos(Vu(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,t))}s[d].crossVectors(i[d],r[d])}if(!0===e){let e=Math.acos(Vu(r[0].dot(r[t]),-1,1));e/=t,i[0].dot(o.crossVectors(r[0],r[t]))>0&&(e=-e);for(let n=1;n<=t;n++)r[n].applyMatrix4(a.makeRotationAxis(i[n],e*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Wg extends jg{constructor(t=0,e=0,n=1,i=1,r=0,s=2*Math.PI,o=!1,a=0){super(),this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(t,e){const n=e||new Xu,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),!0!==this.aClockwise||s||(r===i?r=-i:r-=i);const o=this.aStartAngle+t*r;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=a-this.aX,i=l-this.aY;a=n*t-i*e+this.aX,l=n*e+i*t+this.aY}return n.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}Wg.prototype.isEllipseCurve=!0;class qg extends Wg{constructor(t,e,n,i,r,s){super(t,e,n,n,i,r,s),this.type="ArcCurve"}}function Zg(){let t=0,e=0,n=0,i=0;function r(r,s,o,a){t=r,e=o,n=-3*r+3*s-2*o-a,i=2*r-2*s+o+a}return{initCatmullRom:function(t,e,n,i,s){r(e,n,s*(n-t),s*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,s,o,a){let l=(e-t)/s-(n-t)/(s+o)+(n-e)/o,c=(n-e)/o-(i-e)/(o+a)+(i-n)/a;l*=o,c*=o,r(e,n,l,c)},calc:function(r){const s=r*r;return t+e*r+n*s+i*(s*r)}}}qg.prototype.isArcCurve=!0;const Yg=new oh,Xg=new Zg,Jg=new Zg,$g=new Zg;class Qg extends jg{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new oh){const n=e,i=this.points,r=i.length,s=(r-(this.closed?0:1))*t;let o,a,l=Math.floor(s),c=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===c&&l===r-1&&(l=r-2,c=1),this.closed||l>0?o=i[(l-1)%r]:(Yg.subVectors(i[0],i[1]).add(i[0]),o=Yg);const u=i[l%r],h=i[(l+1)%r];if(this.closed||l+2<r?a=i[(l+2)%r]:(Yg.subVectors(i[r-1],i[r-2]).add(i[r-1]),a=Yg),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(o.distanceToSquared(u),t),n=Math.pow(u.distanceToSquared(h),t),i=Math.pow(h.distanceToSquared(a),t);n<1e-4&&(n=1),e<1e-4&&(e=n),i<1e-4&&(i=n),Xg.initNonuniformCatmullRom(o.x,u.x,h.x,a.x,e,n,i),Jg.initNonuniformCatmullRom(o.y,u.y,h.y,a.y,e,n,i),$g.initNonuniformCatmullRom(o.z,u.z,h.z,a.z,e,n,i)}else"catmullrom"===this.curveType&&(Xg.initCatmullRom(o.x,u.x,h.x,a.x,this.tension),Jg.initCatmullRom(o.y,u.y,h.y,a.y,this.tension),$g.initCatmullRom(o.z,u.z,h.z,a.z,this.tension));return n.set(Xg.calc(c),Jg.calc(c),$g.calc(c)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new oh).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Kg(t,e,n,i,r){const s=.5*(i-e),o=.5*(r-n),a=t*t;return(2*n-2*i+s+o)*(t*a)+(-3*n+3*i-2*s-o)*a+s*t+n}function ty(t,e,n,i){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}function ey(t,e,n,i,r){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}Qg.prototype.isCatmullRomCurve3=!0;class ny extends jg{constructor(t=new Xu,e=new Xu,n=new Xu,i=new Xu){super(),this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new Xu){const n=e,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(ey(t,i.x,r.x,s.x,o.x),ey(t,i.y,r.y,s.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}ny.prototype.isCubicBezierCurve=!0;class iy extends jg{constructor(t=new oh,e=new oh,n=new oh,i=new oh){super(),this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new oh){const n=e,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(ey(t,i.x,r.x,s.x,o.x),ey(t,i.y,r.y,s.y,o.y),ey(t,i.z,r.z,s.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}iy.prototype.isCubicBezierCurve3=!0;class ry extends jg{constructor(t=new Xu,e=new Xu){super(),this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Xu){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){const n=e||new Xu;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}ry.prototype.isLineCurve=!0;class sy extends jg{constructor(t=new Xu,e=new Xu,n=new Xu){super(),this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Xu){const n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(ty(t,i.x,r.x,s.x),ty(t,i.y,r.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}sy.prototype.isQuadraticBezierCurve=!0;class oy extends jg{constructor(t=new oh,e=new oh,n=new oh){super(),this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new oh){const n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(ty(t,i.x,r.x,s.x),ty(t,i.y,r.y,s.y),ty(t,i.z,r.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}oy.prototype.isQuadraticBezierCurve3=!0;class ay extends jg{constructor(t=[]){super(),this.type="SplineCurve",this.points=t}getPoint(t,e=new Xu){const n=e,i=this.points,r=(i.length-1)*t,s=Math.floor(r),o=r-s,a=i[0===s?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],u=i[s>i.length-3?i.length-1:s+2];return n.set(Kg(o,a.x,l.x,c.x,u.x),Kg(o,a.y,l.y,c.y,u.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++)this.points.push(t.points[e].clone());return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++)t.points.push(this.points[e].toArray());return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Xu).fromArray(n))}return this}}ay.prototype.isSplineCurve=!0;var ly=Object.freeze({__proto__:null,ArcCurve:qg,CatmullRomCurve3:Qg,CubicBezierCurve:ny,CubicBezierCurve3:iy,EllipseCurve:Wg,LineCurve:ry,LineCurve3:class extends jg{constructor(t=new oh,e=new oh){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=t,this.v2=e}getPoint(t,e=new oh){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},QuadraticBezierCurve:sy,QuadraticBezierCurve3:oy,SplineCurve:ay});function cy(t,e,n,i,r){let s,o;if(r===function(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}(t,e,n,i)>0)for(s=e;s<n;s+=i)o=Py(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=Py(s,t[s],t[s+1],o);return o&&Ty(o,o.next)&&(Ly(o),o=o.next),o}function uy(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!Ty(i,i.next)&&0!==Cy(i.prev,i,i.next))i=i.next;else{if(Ly(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function hy(t,e,n,i,r,s,o){if(!t)return;!o&&s&&function(t,e,n,i){let r=t;do{null===r.z&&(r.z=_y(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,n,i,r,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ,i);e++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1)}(r)}(t,i,r,s);let a,l,c=t;for(;t.prev!==t.next;)if(a=t.prev,l=t.next,s?py(t,i,r,s):dy(t))e.push(a.i/n),e.push(t.i/n),e.push(l.i/n),Ly(t),t=l.next,c=l.next;else if((t=l)===c){o?1===o?hy(t=fy(uy(t),e,n),e,n,i,r,s,2):2===o&&my(t,e,n,i,r,s):hy(uy(t),e,n,i,r,s,1);break}}function dy(t){const e=t.prev,n=t,i=t.next;if(Cy(e,n,i)>=0)return!1;let r=t.next.next;for(;r!==t.prev;){if(by(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Cy(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function py(t,e,n,i){const r=t.prev,s=t,o=t.next;if(Cy(r,s,o)>=0)return!1;const a=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,l=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,c=_y(r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,e,n,i),u=_y(a,l,e,n,i);let h=t.prevZ,d=t.nextZ;for(;h&&h.z>=c&&d&&d.z<=u;){if(h!==t.prev&&h!==t.next&&by(r.x,r.y,s.x,s.y,o.x,o.y,h.x,h.y)&&Cy(h.prev,h,h.next)>=0)return!1;if(h=h.prevZ,d!==t.prev&&d!==t.next&&by(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&Cy(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;h&&h.z>=c;){if(h!==t.prev&&h!==t.next&&by(r.x,r.y,s.x,s.y,o.x,o.y,h.x,h.y)&&Cy(h.prev,h,h.next)>=0)return!1;h=h.prevZ}for(;d&&d.z<=u;){if(d!==t.prev&&d!==t.next&&by(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&Cy(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function fy(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!Ty(r,s)&&Sy(r,i,i.next,s)&&Ay(r,s)&&Ay(s,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(s.i/n),Ly(i),Ly(i.next),i=t=s),i=i.next}while(i!==t);return uy(i)}function my(t,e,n,i,r,s){let o=t;do{let t=o.next.next;for(;t!==o.prev;){if(o.i!==t.i&&wy(o,t)){let a=Dy(o,t);return o=uy(o,o.next),a=uy(a,a.next),hy(o,e,n,i,r,s),void hy(a,e,n,i,r,s)}t=t.next}o=o.next}while(o!==t)}function gy(t,e){return t.x-e.x}function yy(t,e){if(e=function(t,e){let n=e;const i=t.x,r=t.y;let s,o=-1/0;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const t=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=i&&t>o){if(o=t,t===i){if(r===n.y)return n;if(r===n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!s)return null;if(i===o)return s;const a=s,l=s.x,c=s.y;let u,h=1/0;n=s;do{i>=n.x&&n.x>=l&&i!==n.x&&by(r<c?i:o,r,l,c,r<c?o:i,r,n.x,n.y)&&(u=Math.abs(r-n.y)/(i-n.x),Ay(n,t)&&(u<h||u===h&&(n.x>s.x||n.x===s.x&&vy(s,n)))&&(s=n,h=u)),n=n.next}while(n!==a);return s}(t,e)){const n=Dy(e,t);uy(e,e.next),uy(n,n.next)}}function vy(t,e){return Cy(t.prev,t,e.prev)<0&&Cy(e.next,t,t.next)<0}function _y(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function xy(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function by(t,e,n,i,r,s,o,a){return(r-o)*(e-a)-(t-o)*(s-a)>=0&&(t-o)*(i-a)-(n-o)*(e-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function wy(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Sy(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Ay(t,e)&&Ay(e,t)&&function(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Cy(t.prev,t,e.prev)||Cy(t,e.prev,e))||Ty(t,e)&&Cy(t.prev,t,t.next)>0&&Cy(e.prev,e,e.next)>0)}function Cy(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Ty(t,e){return t.x===e.x&&t.y===e.y}function Sy(t,e,n,i){const r=Ey(Cy(t,e,n)),s=Ey(Cy(t,e,i)),o=Ey(Cy(n,i,t)),a=Ey(Cy(n,i,e));return r!==s&&o!==a||!(0!==r||!My(t,n,e))||!(0!==s||!My(t,i,e))||!(0!==o||!My(n,t,i))||!(0!==a||!My(n,e,i))}function My(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ey(t){return t>0?1:t<0?-1:0}function Ay(t,e){return Cy(t.prev,t,t.next)<0?Cy(t,e,t.next)>=0&&Cy(t,t.prev,e)>=0:Cy(t,e,t.prev)<0||Cy(t,t.next,e)<0}function Dy(t,e){const n=new Ry(t.i,t.x,t.y),i=new Ry(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Py(t,e,n,i){const r=new Ry(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Ly(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ry(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Iy{static area(t){const e=t.length;let n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n}static isClockWise(t){return Iy.area(t)<0}static triangulateShape(t,e){const n=[],i=[],r=[];Ny(t),ky(n,t);let s=t.length;e.forEach(Ny);for(let a=0;a<e.length;a++)i.push(s),s+=e[a].length,ky(n,e[a]);const o=function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=cy(t,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,p;if(i&&(s=function(t,e,n,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,c=cy(t,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(xy(c));for(r.sort(gy),s=0;s<r.length;s++)yy(r[s],n),n=uy(n,n.next);return n}(t,e,s,n)),t.length>80*n){a=c=t[0],l=u=t[1];for(let e=n;e<r;e+=n)h=t[e],d=t[e+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-a,u-l),p=0!==p?1/p:0}return hy(s,o,n,a,l,p),o}(n,i);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}}function Ny(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function ky(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class Oy extends jd{constructor(t,e){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,i=[],r=[];for(let o=0,a=t.length;o<a;o++)s(t[o]);function s(t){const s=[],o=void 0!==e.curveSegments?e.curveSegments:12,a=void 0!==e.steps?e.steps:1;let l=void 0!==e.depth?e.depth:100,c=void 0===e.bevelEnabled||e.bevelEnabled,u=void 0!==e.bevelThickness?e.bevelThickness:6,h=void 0!==e.bevelSize?e.bevelSize:u-2,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const f=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:zy;void 0!==e.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=e.amount);let g,y,v,_,x,b=!1;f&&(g=f.getSpacedPoints(a),b=!0,c=!1,y=f.computeFrenetFrames(a,!1),v=new oh,_=new oh,x=new oh),c||(p=0,u=0,h=0,d=0);const w=t.extractPoints(o);let C=w.shape;const T=w.holes;if(!Iy.isClockWise(C)){C=C.reverse();for(let t=0,e=T.length;t<e;t++){const e=T[t];Iy.isClockWise(e)&&(T[t]=e.reverse())}}const S=Iy.triangulateShape(C,T),M=C;for(let e=0,n=T.length;e<n;e++)C=C.concat(T[e]);function E(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}const A=C.length,D=S.length;function P(t,e,n){let i,r,s;const o=t.x-e.x,a=t.y-e.y,l=n.x-t.x,c=n.y-t.y,u=o*o+a*a;if(Math.abs(o*c-a*l)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),p=e.x-a/h,f=e.y+o/h,m=((n.x-c/d-p)*c-(n.y+l/d-f)*l)/(o*c-a*l);i=p+o*m-t.x,r=f+a*m-t.y;const g=i*i+r*r;if(g<=2)return new Xu(i,r);s=Math.sqrt(g/2)}else{let t=!1;o>Number.EPSILON?l>Number.EPSILON&&(t=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(a)===Math.sign(c)&&(t=!0),t?(i=-a,r=o,s=Math.sqrt(u)):(i=o,r=a,s=Math.sqrt(u/2))}return new Xu(i/s,r/s)}const L=[];for(let e=0,n=M.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),L[e]=P(M[e],M[i],M[r]);const R=[];let I,N=L.concat();for(let e=0,n=T.length;e<n;e++){const t=T[e];I=[];for(let e=0,n=t.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),I[e]=P(t[e],t[i],t[r]);R.push(I),N=N.concat(I)}for(let e=0;e<p;e++){const t=e/p,n=u*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,r=M.length;e<r;e++){const t=E(M[e],L[e],i);z(t.x,t.y,-n)}for(let e=0,r=T.length;e<r;e++){const t=T[e];I=R[e];for(let e=0,r=t.length;e<r;e++){const r=E(t[e],I[e],i);z(r.x,r.y,-n)}}}const k=h+d;for(let e=0;e<A;e++){const t=c?E(C[e],N[e],k):C[e];b?(_.copy(y.normals[0]).multiplyScalar(t.x),v.copy(y.binormals[0]).multiplyScalar(t.y),x.copy(g[0]).add(_).add(v),z(x.x,x.y,x.z)):z(t.x,t.y,0)}for(let e=1;e<=a;e++)for(let t=0;t<A;t++){const n=c?E(C[t],N[t],k):C[t];b?(_.copy(y.normals[e]).multiplyScalar(n.x),v.copy(y.binormals[e]).multiplyScalar(n.y),x.copy(g[e]).add(_).add(v),z(x.x,x.y,x.z)):z(n.x,n.y,l/a*e)}for(let e=p-1;e>=0;e--){const t=e/p,n=u*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,r=M.length;e<r;e++){const t=E(M[e],L[e],i);z(t.x,t.y,l+n)}for(let e=0,r=T.length;e<r;e++){const t=T[e];I=R[e];for(let e=0,r=t.length;e<r;e++){const r=E(t[e],I[e],i);b?z(r.x,r.y+g[a-1].y,g[a-1].x+n):z(r.x,r.y,l+n)}}}function O(t,e){let n=t.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=t.length-1);for(let t=0,n=a+2*p;t<n;t++){const n=A*t,s=A*(t+1);U(e+i+n,e+r+n,e+r+s,e+i+s)}}}function z(t,e,n){s.push(t),s.push(e),s.push(n)}function F(t,e,r){H(t),H(e),H(r);const s=i.length/3,o=m.generateTopUV(n,i,s-3,s-2,s-1);B(o[0]),B(o[1]),B(o[2])}function U(t,e,r,s){H(t),H(e),H(s),H(e),H(r),H(s);const o=i.length/3,a=m.generateSideWallUV(n,i,o-6,o-3,o-2,o-1);B(a[0]),B(a[1]),B(a[3]),B(a[1]),B(a[2]),B(a[3])}function H(t){i.push(s[3*t+0]),i.push(s[3*t+1]),i.push(s[3*t+2])}function B(t){r.push(t.x),r.push(t.y)}!function(){const t=i.length/3;if(c){let t=0,e=A*t;for(let n=0;n<D;n++){const t=S[n];F(t[2]+e,t[1]+e,t[0]+e)}t=a+2*p,e=A*t;for(let n=0;n<D;n++){const t=S[n];F(t[0]+e,t[1]+e,t[2]+e)}}else{for(let t=0;t<D;t++){const e=S[t];F(e[2],e[1],e[0])}for(let t=0;t<D;t++){const e=S[t];F(e[0]+A*a,e[1]+A*a,e[2]+A*a)}}n.addGroup(t,i.length/3-t,0)}(),function(){const t=i.length/3;let e=0;O(M,e),e+=M.length;for(let n=0,i=T.length;n<i;n++){const t=T[n];O(t,e),e+=t.length}n.addGroup(t,i.length/3-t,1)}()}this.setAttribute("position",new kd(i,3)),this.setAttribute("uv",new kd(r,2)),this.computeVertexNormals()}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++)n.shapes.push(t[i].uuid);else n.shapes.push(t.uuid);return void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON()),n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let r=0,s=t.shapes.length;r<s;r++)n.push(e[t.shapes[r]]);const i=t.options.extrudePath;return void 0!==i&&(t.options.extrudePath=(new ly[i.type]).fromJSON(i)),new Oy(n,t.options)}}const zy={generateTopUV:function(t,e,n,i,r){const s=e[3*i],o=e[3*i+1],a=e[3*r],l=e[3*r+1];return[new Xu(e[3*n],e[3*n+1]),new Xu(s,o),new Xu(a,l)]},generateSideWallUV:function(t,e,n,i,r,s){const o=e[3*n],a=e[3*n+1],l=e[3*n+2],c=e[3*i],u=e[3*i+1],h=e[3*i+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*s],g=e[3*s+1],y=e[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new Xu(o,1-l),new Xu(c,1-h),new Xu(d,1-f),new Xu(m,1-y)]:[new Xu(a,1-l),new Xu(u,1-h),new Xu(p,1-f),new Xu(g,1-y)]}};class Fy extends jd{constructor(t,e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const n=[],i=[],r=[],s=[];let o=0,a=0;if(!1===Array.isArray(t))l(t);else for(let c=0;c<t.length;c++)l(t[c]),this.addGroup(o,a,c),o+=a,a=0;function l(t){const o=i.length/3,l=t.extractPoints(e);let c=l.shape;const u=l.holes;!1===Iy.isClockWise(c)&&(c=c.reverse());for(let e=0,n=u.length;e<n;e++){const t=u[e];!0===Iy.isClockWise(t)&&(u[e]=t.reverse())}const h=Iy.triangulateShape(c,u);for(let e=0,n=u.length;e<n;e++)c=c.concat(u[e]);for(let e=0,n=c.length;e<n;e++){const t=c[e];i.push(t.x,t.y,0),r.push(0,0,1),s.push(t.x,t.y)}for(let e=0,i=h.length;e<i;e++){const t=h[e];n.push(t[0]+o,t[1]+o,t[2]+o),a+=3}}this.setIndex(n),this.setAttribute("position",new kd(i,3)),this.setAttribute("normal",new kd(r,3)),this.setAttribute("uv",new kd(s,2))}toJSON(){const t=super.toJSON();return function(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++)e.shapes.push(t[n].uuid);else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}static fromJSON(t,e){const n=[];for(let i=0,r=t.shapes.length;i<r;i++)n.push(e[t.shapes[i]]);return new Fy(n,t.curveSegments)}}class Uy extends Oy{constructor(t,e={}){const n=e.font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new jd;const i=n.generateShapes(t,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),super(i,e),this.type="TextGeometry"}}(class extends bd{constructor(t){super(),this.type="ShadowMaterial",this.color=new Ad(0),this.transparent=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this}}).prototype.isShadowMaterial=!0,class extends fp{constructor(t){super(t),this.type="RawShaderMaterial"}}.prototype.isRawShaderMaterial=!0;class Hy extends bd{constructor(t){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ad(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ad(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Xu(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this.vertexTangents=t.vertexTangents,this}}Hy.prototype.isMeshStandardMaterial=!0;class By extends Hy{constructor(t){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Xu(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(t){this.reflectivity=Vu(2.5*(t-1)/(t+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ad(1,1,1),this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new Ad).copy(t.sheen):null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this}}By.prototype.isMeshPhysicalMaterial=!0;class Vy extends bd{constructor(t){super(),this.type="MeshPhongMaterial",this.color=new Ad(16777215),this.specular=new Ad(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ad(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Xu(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}Vy.prototype.isMeshPhongMaterial=!0,class extends bd{constructor(t){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ad(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ad(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Xu(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}.prototype.isMeshToonMaterial=!0,class extends bd{constructor(t){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Xu(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}.prototype.isMeshNormalMaterial=!0;class Gy extends bd{constructor(t){super(),this.type="MeshLambertMaterial",this.color=new Ad(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ad(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this}}Gy.prototype.isMeshLambertMaterial=!0,class extends bd{constructor(t){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ad(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Xu(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.flatShading=t.flatShading,this}}.prototype.isMeshMatcapMaterial=!0,class extends Mg{constructor(t){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}.prototype.isLineDashedMaterial=!0;const jy={arraySlice:function(t,e,n){return jy.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const e=t.length,n=new Array(e);for(let i=0;i!==e;++i)n[i]=i;return n.sort(function(e,n){return t[e]-t[n]}),n},sortedArray:function(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,o=0;o!==i;++s){const i=n[s]*e;for(let n=0;n!==e;++n)r[o++]=t[i+n]}return r},flattenJSON:function(t,e,n,i){let r=1,s=t[0];for(;void 0!==s&&void 0===s[i];)s=t[r++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(e.push(s.time),n.push.apply(n,o)),s=t[r++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(e.push(s.time),o.toArray(n,n.length)),s=t[r++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(e.push(s.time),n.push(o)),s=t[r++]}while(void 0!==s)},subclip:function(t,e,n,i,r=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const t=s.tracks[l],e=t.getValueSize(),a=[],c=[];for(let s=0;s<t.times.length;++s){const o=t.times[s]*r;if(!(o<n||o>=i)){a.push(t.times[s]);for(let n=0;n<e;++n)c.push(t.values[s*e+n])}}0!==a.length&&(t.times=jy.convertArray(a,t.times.constructor),t.values=jy.convertArray(c,t.values.constructor),o.push(t))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let o=0;o<r;++o){const e=n.tracks[o],i=e.ValueTypeName;if("bool"===i||"string"===i)continue;const r=t.tracks.find(function(t){return t.name===e.name&&t.ValueTypeName===i});if(void 0===r)continue;let a=0;const l=e.getValueSize();e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=e.times.length-1;let d;if(s<=e.times[0])d=jy.arraySlice(e.values,a,l-a);else if(s>=e.times[h]){const t=h*l+a;d=jy.arraySlice(e.values,t,t+l-a)}else{const t=e.createInterpolant(),n=a,i=l-a;t.evaluate(s),d=jy.arraySlice(t.resultBuffer,n,i)}"quaternion"===i&&(new sh).fromArray(d).normalize().conjugate().toArray(d);const p=r.times.length;for(let t=0;t<p;++t){const e=t*u+c;if("quaternion"===i)sh.multiplyQuaternionsFlat(r.values,e,d,0,r.values,e);else{const t=u-2*c;for(let n=0;n<t;++n)r.values[e+n]-=d[n]}}}return t.blendMode=2501,t}};class Wy{constructor(t,e,n,i){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new e.constructor(n),this.sampleValues=e,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(t){const e=this.parameterPositions;let n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{let s;n:{i:if(!(t<i)){for(let s=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,r)}if(n===s)break;if(r=i,i=e[++n],t<i)break e}s=e.length;break n}if(t>=r)break t;{const o=e[1];t<o&&(n=2,r=o);for(let s=n-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(n===s)break;if(i=r,r=e[--n-1],t>=r)break e}s=n,n=0}}for(;n<s;){const i=n+s>>>1;t<e[i]?s=i:n=i+1}if(i=e[n],r=e[n-1],void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,i);if(void 0===i)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,r,t)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i;for(let s=0;s!==i;++s)e[s]=n[r+s];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Wy.prototype.beforeStart_=Wy.prototype.copySampleValue_,Wy.prototype.afterEnd_=Wy.prototype.copySampleValue_;class qy extends Wy{constructor(t,e,n,i){super(t,e,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Eu,endingEnd:Eu}}intervalChanged_(t,e,n){const i=this.parameterPositions;let r=t-2,s=t+1,o=i[r],a=i[s];if(void 0===o)switch(this.getSettings_().endingStart){case Au:r=t,o=2*e-n;break;case Du:r=i.length-2,o=e+i[r]-i[r+1];break;default:r=t,o=n}if(void 0===a)switch(this.getSettings_().endingEnd){case Au:s=t,a=2*n-e;break;case Du:s=1,a=n+i[1]-i[0];break;default:s=t-1,a=e}const l=.5*(n-e),c=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(a-n),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(n-e)/(i-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,y=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,v=(-1-d)*m+(1.5+d)*f+.5*p,_=d*m-d*f;for(let x=0;x!==o;++x)r[x]=g*s[c+x]+y*s[l+x]+v*s[a+x]+_*s[u+x];return r}}class Zy extends Wy{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=t*o,l=a-o,c=(n-e)/(i-e),u=1-c;for(let h=0;h!==o;++h)r[h]=s[l+h]*u+s[a+h]*c;return r}}class Yy extends Wy{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t){return this.copySampleValue_(t-1)}}class Xy{constructor(t,e,n,i){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=jy.convertArray(e,this.TimeBufferType),this.values=jy.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(t){const e=t.constructor;let n;if(e.toJSON!==this.toJSON)n=e.toJSON(t);else{n={name:t.name,times:jy.convertArray(t.times,Array),values:jy.convertArray(t.values,Array)};const e=t.getInterpolation();e!==t.DefaultInterpolation&&(n.interpolation=e)}return n.type=t.ValueTypeName,n}InterpolantFactoryMethodDiscrete(t){return new Yy(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new Zy(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new qy(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case Tu:e=this.InterpolantFactoryMethodDiscrete;break;case Su:e=this.InterpolantFactoryMethodLinear;break;case Mu:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){const e="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(e);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",e),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Tu;case this.InterpolantFactoryMethodLinear:return Su;case this.InterpolantFactoryMethodSmooth:return Mu}}getValueSize(){return this.values.length/this.times.length}shift(t){if(0!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]+=t}return this}scale(t){if(1!==t){const e=this.times;for(let n=0,i=e.length;n!==i;++n)e[n]*=t}return this}trim(t,e){const n=this.times,i=n.length;let r=0,s=i-1;for(;r!==i&&n[r]<t;)++r;for(;-1!==s&&n[s]>e;)--s;if(++s,0!==r||s!==i){r>=s&&(s=Math.max(s,1),r=s-1);const t=this.getValueSize();this.times=jy.arraySlice(n,r,s),this.values=jy.arraySlice(this.values,r*t,s*t)}return this}validate(){let t=!0;const e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let s=null;for(let o=0;o!==r;o++){const e=n[o];if("number"==typeof e&&isNaN(e)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,e),t=!1;break}if(null!==s&&s>e){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,e,s),t=!1;break}s=e}if(void 0!==i&&jy.isTypedArray(i))for(let o=0,a=i.length;o!==a;++o){const e=i[o];if(isNaN(e)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,e),t=!1;break}}return t}optimize(){const t=jy.arraySlice(this.times),e=jy.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===Mu,r=t.length-1;let s=1;for(let o=1;o<r;++o){let r=!1;const a=t[o];if(a!==t[o+1]&&(1!==o||a!==t[0]))if(i)r=!0;else{const t=o*n,i=t-n,s=t+n;for(let o=0;o!==n;++o){const n=e[t+o];if(n!==e[i+o]||n!==e[s+o]){r=!0;break}}}if(r){if(o!==s){t[s]=t[o];const i=o*n,r=s*n;for(let t=0;t!==n;++t)e[r+t]=e[i+t]}++s}}if(r>0){t[s]=t[r];for(let t=r*n,i=s*n,o=0;o!==n;++o)e[i+o]=e[t+o];++s}return s!==t.length?(this.times=jy.arraySlice(t,0,s),this.values=jy.arraySlice(e,0,s*n)):(this.times=t,this.values=e),this}clone(){const t=jy.arraySlice(this.times,0),e=jy.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}Xy.prototype.TimeBufferType=Float32Array,Xy.prototype.ValueBufferType=Float32Array,Xy.prototype.DefaultInterpolation=Su;class Jy extends Xy{}Jy.prototype.ValueTypeName="bool",Jy.prototype.ValueBufferType=Array,Jy.prototype.DefaultInterpolation=Tu,Jy.prototype.InterpolantFactoryMethodLinear=void 0,Jy.prototype.InterpolantFactoryMethodSmooth=void 0;class $y extends Xy{}$y.prototype.ValueTypeName="color";class Qy extends Xy{}Qy.prototype.ValueTypeName="number";class Ky extends Wy{constructor(t,e,n,i){super(t,e,n,i)}interpolate_(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(n-e)/(i-e);let l=t*o;for(let c=l+o;l!==c;l+=4)sh.slerpFlat(r,0,s,l-o,s,l,a);return r}}class tv extends Xy{InterpolantFactoryMethodLinear(t){return new Ky(this.times,this.values,this.getValueSize(),t)}}tv.prototype.ValueTypeName="quaternion",tv.prototype.DefaultInterpolation=Su,tv.prototype.InterpolantFactoryMethodSmooth=void 0;class ev extends Xy{}ev.prototype.ValueTypeName="string",ev.prototype.ValueBufferType=Array,ev.prototype.DefaultInterpolation=Tu,ev.prototype.InterpolantFactoryMethodLinear=void 0,ev.prototype.InterpolantFactoryMethodSmooth=void 0;class nv extends Xy{}nv.prototype.ValueTypeName="vector";class iv{constructor(t,e=-1,n,i=2500){this.name=t,this.tracks=n,this.duration=e,this.blendMode=i,this.uuid=Bu(),this.duration<0&&this.resetDuration()}static parse(t){const e=[],n=t.tracks,i=1/(t.fps||1);for(let s=0,o=n.length;s!==o;++s)e.push(rv(n[s]).scale(i));const r=new this(t.name,t.duration,e,t.blendMode);return r.uuid=t.uuid,r}static toJSON(t){const e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode};for(let r=0,s=n.length;r!==s;++r)e.push(Xy.toJSON(n[r]));return i}static CreateFromMorphTargetSequence(t,e,n,i){const r=e.length,s=[];for(let o=0;o<r;o++){let t=[],a=[];t.push((o+r-1)%r,o,(o+1)%r),a.push(0,1,0);const l=jy.getKeyframeOrder(t);t=jy.sortedArray(t,1,l),a=jy.sortedArray(a,1,l),i||0!==t[0]||(t.push(r),a.push(a[0])),s.push(new Qy(".morphTargetInfluences["+e[o].name+"]",t,a).scale(1/n))}return new this(t,-1,s)}static findByName(t,e){let n=t;if(!Array.isArray(t)){const e=t;n=e.geometry&&e.geometry.animations||e.animations}for(let i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null}static CreateClipsFromMorphTargetSequences(t,e,n){const i={},r=/^([\w-]*?)([\d]+)$/;for(let o=0,a=t.length;o<a;o++){const e=t[o],n=e.name.match(r);if(n&&n.length>1){const t=n[1];let r=i[t];r||(i[t]=r=[]),r.push(e)}}const s=[];for(const o in i)s.push(this.CreateFromMorphTargetSequence(o,i[o],e,n));return s}static parseAnimation(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(t,e,n,i,r){if(0!==n.length){const s=[],o=[];jy.flattenJSON(n,s,o,i),0!==s.length&&r.push(new t(e,s,o))}},i=[],r=t.name||"default",s=t.fps||30,o=t.blendMode;let a=t.length||-1;const l=t.hierarchy||[];for(let c=0;c<l.length;c++){const t=l[c].keys;if(t&&0!==t.length)if(t[0].morphTargets){const e={};let n;for(n=0;n<t.length;n++)if(t[n].morphTargets)for(let i=0;i<t[n].morphTargets.length;i++)e[t[n].morphTargets[i]]=-1;for(const r in e){const e=[],s=[];for(let i=0;i!==t[n].morphTargets.length;++i){const i=t[n];e.push(i.time),s.push(i.morphTarget===r?1:0)}i.push(new Qy(".morphTargetInfluence["+r+"]",e,s))}a=e.length*(s||1)}else{const r=".bones["+e[c].name+"]";n(nv,r+".position",t,"pos",i),n(tv,r+".quaternion",t,"rot",i),n(nv,r+".scale",t,"scl",i)}}return 0===i.length?null:new this(r,a,i,o)}resetDuration(){let t=0;for(let e=0,n=this.tracks.length;e!==n;++e){const n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}return this.duration=t,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function rv(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Qy;case"vector":case"vector2":case"vector3":case"vector4":return nv;case"color":return $y;case"quaternion":return tv;case"bool":case"boolean":return Jy;case"string":return ev}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){const e=[],n=[];jy.flattenJSON(t.keys,e,n,"value"),t.times=e,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const sv={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},ov=new class{constructor(t,e,n){const i=this;let r,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===s&&void 0!==i.onStart&&i.onStart(t,o,a),s=!0},this.itemEnd=function(t){o++,void 0!==i.onProgress&&i.onProgress(t,o,a),o===a&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}};class av{constructor(t){this.manager=void 0!==t?t:ov,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise(function(i,r){n.load(t,i,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const lv={};class cv extends av{constructor(t){super(t)}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=sv.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;if(void 0!==lv[t])return void lv[t].push({onLoad:e,onProgress:n,onError:i});const o=t.match(/^data:(.*?)(;base64)?,(.*)$/);let a;if(o){const n=o[1],s=!!o[2];let a=o[3];a=decodeURIComponent(a),s&&(a=atob(a));try{let i;const s=(this.responseType||"").toLowerCase();switch(s){case"arraybuffer":case"blob":const t=new Uint8Array(a.length);for(let n=0;n<a.length;n++)t[n]=a.charCodeAt(n);i="blob"===s?new Blob([t.buffer],{type:n}):t.buffer;break;case"document":const e=new DOMParser;i=e.parseFromString(a,n);break;case"json":i=JSON.parse(a);break;default:i=a}setTimeout(function(){e&&e(i),r.manager.itemEnd(t)},0)}catch(l){setTimeout(function(){i&&i(l),r.manager.itemError(t),r.manager.itemEnd(t)},0)}}else{lv[t]=[],lv[t].push({onLoad:e,onProgress:n,onError:i}),a=new XMLHttpRequest,a.open("GET",t,!0),a.addEventListener("load",function(e){const n=this.response,i=lv[t];if(delete lv[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),sv.add(t,n);for(let t=0,e=i.length;t<e;t++){const e=i[t];e.onLoad&&e.onLoad(n)}r.manager.itemEnd(t)}else{for(let t=0,n=i.length;t<n;t++){const n=i[t];n.onError&&n.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)}},!1),a.addEventListener("progress",function(e){const n=lv[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onProgress&&i.onProgress(e)}},!1),a.addEventListener("error",function(e){const n=lv[t];delete lv[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),a.addEventListener("abort",function(e){const n=lv[t];delete lv[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}r.manager.itemError(t),r.manager.itemEnd(t)},!1),void 0!==this.responseType&&(a.responseType=this.responseType),void 0!==this.withCredentials&&(a.withCredentials=this.withCredentials),a.overrideMimeType&&a.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const t in this.requestHeader)a.setRequestHeader(t,this.requestHeader[t]);a.send(null)}return r.manager.itemStart(t),a}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class uv extends av{constructor(t){super(t)}load(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=sv.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;const o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function a(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1),sv.add(t,this),e&&e(this),r.manager.itemEnd(t)}function l(e){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1),i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o}}class hv extends av{constructor(t){super(t)}load(t,e,n,i){const r=new _p,s=new uv(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(n){s.load(t[n],function(t){r.images[n]=t,o++,6===o&&(r.needsUpdate=!0,e&&e(r))},void 0,i)}for(let l=0;l<t.length;++l)a(l);return r}}class dv extends av{constructor(t){super(t)}load(t,e,n,i){const r=new th,s=new uv(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,function(n){r.image=n;const i=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);r.format=i?xu:bu,r.needsUpdate=!0,void 0!==e&&e(r)},n,i),r}}class pv extends jg{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new ry(e,t))}getPoint(t){const e=t*this.getLength(),n=this.getCurveLengths();let i=0;for(;i<n.length;){if(n[i]>=e){const t=n[i]-e,r=this.curves[i],s=r.getLength();return r.getPointAt(0===s?0:1-t/s)}i++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],o=s.getPoints(s&&s.isEllipseCurve?2*t:s&&(s.isLineCurve||s.isLineCurve3)?1:s&&s.isSplineCurve?t*s.points.length:t);for(let t=0;t<o.length;t++){const i=o[t];n&&n.equals(i)||(e.push(i),n=i)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++)this.curves.push(t.curves[e].clone());return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++)t.curves.push(this.curves[e].toJSON());return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new ly[n.type]).fromJSON(n))}return this}}class fv extends pv{constructor(t){super(),this.type="Path",this.currentPoint=new Xu,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new ry(this.currentPoint.clone(),new Xu(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){const r=new sy(this.currentPoint.clone(),new Xu(t,e),new Xu(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,s){const o=new ny(this.currentPoint.clone(),new Xu(t,e),new Xu(n,i),new Xu(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new ay(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,s){return this.absarc(t+this.currentPoint.x,e+this.currentPoint.y,n,i,r,s),this}absarc(t,e,n,i,r,s){return this.absellipse(t,e,n,n,i,r,s),this}ellipse(t,e,n,i,r,s,o,a){return this.absellipse(t+this.currentPoint.x,e+this.currentPoint.y,n,i,r,s,o,a),this}absellipse(t,e,n,i,r,s,o,a){const l=new Wg(t,e,n,i,r,s,o,a);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class mv extends fv{constructor(t){super(t),this.uuid=Bu(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++)this.holes.push(t.holes[e].clone());return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++)t.holes.push(this.holes[e].toJSON());return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new fv).fromJSON(n))}return this}}class gv extends ld{constructor(t,e=1){super(),this.type="Light",this.color=new Ad(t),this.intensity=e}dispose(){}copy(t){return super.copy(t),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}gv.prototype.isLight=!0;class yv extends gv{constructor(t,e,n){super(t,n),this.type="HemisphereLight",this.position.copy(ld.DefaultUp),this.updateMatrix(),this.groundColor=new Ad(e)}copy(t){return gv.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}yv.prototype.isHemisphereLight=!0;const vv=new zh,_v=new oh,xv=new oh;class bv{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Xu(512,512),this.map=null,this.mapPass=null,this.matrix=new zh,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ep,this._frameExtents=new Xu(1,1),this._viewportCount=1,this._viewports=[new nh(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;_v.setFromMatrixPosition(t.matrixWorld),e.position.copy(_v),xv.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(xv),e.updateMatrixWorld(),vv.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(vv),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(e.projectionMatrix),n.multiply(e.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class wv extends bv{constructor(){super(new gp(50,1,.5,500)),this.focus=1}updateMatrices(t){const e=this.camera,n=2*Hu*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}wv.prototype.isSpotLightShadow=!0;class Cv extends gv{constructor(t,e,n=0,i=Math.PI/3,r=0,s=1){super(t,e),this.type="SpotLight",this.position.copy(ld.DefaultUp),this.updateMatrix(),this.target=new ld,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.shadow=new wv}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Cv.prototype.isSpotLight=!0;const Tv=new zh,Sv=new oh,Mv=new oh;class Ev extends bv{constructor(){super(new gp(90,1,.5,500)),this._frameExtents=new Xu(4,2),this._viewportCount=6,this._viewports=[new nh(2,1,1,1),new nh(0,1,1,1),new nh(3,1,1,1),new nh(1,1,1,1),new nh(3,0,1,1),new nh(1,0,1,1)],this._cubeDirections=[new oh(1,0,0),new oh(-1,0,0),new oh(0,0,1),new oh(0,0,-1),new oh(0,1,0),new oh(0,-1,0)],this._cubeUps=[new oh(0,1,0),new oh(0,1,0),new oh(0,1,0),new oh(0,1,0),new oh(0,0,1),new oh(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Sv.setFromMatrixPosition(t.matrixWorld),n.position.copy(Sv),Mv.copy(n.position),Mv.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Mv),n.updateMatrixWorld(),i.makeTranslation(-Sv.x,-Sv.y,-Sv.z),Tv.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Tv)}}Ev.prototype.isPointLightShadow=!0;class Av extends gv{constructor(t,e,n=0,i=1){super(t,e),this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Ev}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}Av.prototype.isPointLight=!0;class Dv extends mp{constructor(t=-1,e=1,n=1,i=-1,r=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,s=n+t,o=i+e,a=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,s=r+t*this.view.width,o-=e*this.view.offsetY,a=o-e*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}Dv.prototype.isOrthographicCamera=!0;class Pv extends bv{constructor(){super(new Dv(-5,5,5,-5,.5,500))}}Pv.prototype.isDirectionalLightShadow=!0;class Lv extends gv{constructor(t,e){super(t,e),this.type="DirectionalLight",this.position.copy(ld.DefaultUp),this.updateMatrix(),this.target=new ld,this.shadow=new Pv}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}Lv.prototype.isDirectionalLight=!0,class extends gv{constructor(t,e){super(t,e),this.type="AmbientLight"}}.prototype.isAmbientLight=!0,class extends gv{constructor(t,e,n=10,i=10){super(t,e),this.type="RectAreaLight",this.width=n,this.height=i}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const e=super.toJSON(t);return e.object.width=this.width,e.object.height=this.height,e}}.prototype.isRectAreaLight=!0;class Rv{constructor(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new oh)}set(t){for(let e=0;e<9;e++)this.coefficients[e].copy(t[e]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,e){const n=t.x,i=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.282095),e.addScaledVector(s[1],.488603*i),e.addScaledVector(s[2],.488603*r),e.addScaledVector(s[3],.488603*n),e.addScaledVector(s[4],n*i*1.092548),e.addScaledVector(s[5],i*r*1.092548),e.addScaledVector(s[6],.315392*(3*r*r-1)),e.addScaledVector(s[7],n*r*1.092548),e.addScaledVector(s[8],.546274*(n*n-i*i)),e}getIrradianceAt(t,e){const n=t.x,i=t.y,r=t.z,s=this.coefficients;return e.copy(s[0]).multiplyScalar(.886227),e.addScaledVector(s[1],1.023328*i),e.addScaledVector(s[2],1.023328*r),e.addScaledVector(s[3],1.023328*n),e.addScaledVector(s[4],.858086*n*i),e.addScaledVector(s[5],.858086*i*r),e.addScaledVector(s[6],.743125*r*r-.247708),e.addScaledVector(s[7],.858086*n*r),e.addScaledVector(s[8],.429043*(n*n-i*i)),e}add(t){for(let e=0;e<9;e++)this.coefficients[e].add(t.coefficients[e]);return this}addScaledSH(t,e){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(t.coefficients[n],e);return this}scale(t){for(let e=0;e<9;e++)this.coefficients[e].multiplyScalar(t);return this}lerp(t,e){for(let n=0;n<9;n++)this.coefficients[n].lerp(t.coefficients[n],e);return this}equals(t){for(let e=0;e<9;e++)if(!this.coefficients[e].equals(t.coefficients[e]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(t,e+3*i);return this}toArray(t=[],e=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(t,e+3*i);return t}static getBasisAt(t,e){const n=t.x,i=t.y,r=t.z;e[0]=.282095,e[1]=.488603*i,e[2]=.488603*r,e[3]=.488603*n,e[4]=1.092548*n*i,e[5]=1.092548*i*r,e[6]=.315392*(3*r*r-1),e[7]=1.092548*n*r,e[8]=.546274*(n*n-i*i)}}Rv.prototype.isSphericalHarmonics3=!0;class Iv extends gv{constructor(t=new Rv,e=1){super(void 0,e),this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const e=super.toJSON(t);return e.object.sh=this.sh.toArray(),e}}Iv.prototype.isLightProbe=!0;class Nv{static decodeText(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);let e="";for(let i=0,r=t.length;i<r;i++)e+=String.fromCharCode(t[i]);try{return decodeURIComponent(escape(e))}catch(n){return e}}static extractUrlBase(t){const e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}}(class extends jd{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}).prototype.isInstancedBufferGeometry=!0,class extends Rd{constructor(t,e,n,i=1){"number"==typeof n&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,e,n),this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}.prototype.isInstancedBufferAttribute=!0;class kv extends av{constructor(t){super(t),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=sv.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout(function(){e&&e(s),r.manager.itemEnd(t)},0),s;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(t,o).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(n){sv.add(t,n),e&&e(n),r.manager.itemEnd(t)}).catch(function(e){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}),r.manager.itemStart(t)}}kv.prototype.isImageBitmapLoader=!0;class Ov{constructor(){this.type="ShapePath",this.color=new Ad,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new fv,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,i){return this.currentPath.quadraticCurveTo(t,e,n,i),this}bezierCurveTo(t,e,n,i,r,s){return this.currentPath.bezierCurveTo(t,e,n,i,r,s),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t,e){function n(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n],r=new mv;r.curves=i.curves,e.push(r)}return e}function i(t,e){const n=e.length;let i=!1;for(let r=n-1,s=0;s<n;r=s++){let n=e[r],o=e[s],a=o.x-n.x,l=o.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=e[s],a=-a,o=e[r],l=-l),t.y<n.y||t.y>o.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=l*(t.x-n.x)-a*(t.y-n.y);if(0===e)return!0;if(e<0)continue;i=!i}}else{if(t.y!==n.y)continue;if(o.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=o.x)return!0}}return i}const r=Iy.isClockWise,s=this.subPaths;if(0===s.length)return[];if(!0===e)return n(s);let o,a,l;const c=[];if(1===s.length)return a=s[0],l=new mv,l.curves=a.curves,c.push(l),c;let u=!r(s[0].getPoints());u=t?!u:u;const h=[],d=[];let p,f,m=[],g=0;d[g]=void 0,m[g]=[];for(let y=0,v=s.length;y<v;y++)a=s[y],p=a.getPoints(),o=r(p),o=t?!o:o,o?(!u&&d[g]&&g++,d[g]={s:new mv,p:p},d[g].s.curves=a.curves,u&&g++,m[g]=[]):m[g].push({h:a,p:p[0]});if(!d[0])return n(s);if(d.length>1){let t=!1;const e=[];for(let n=0,i=d.length;n<i;n++)h[n]=[];for(let n=0,r=d.length;n<r;n++){const r=m[n];for(let s=0;s<r.length;s++){const o=r[s];let a=!0;for(let r=0;r<d.length;r++)i(o.p,d[r].p)&&(n!==r&&e.push({froms:n,tos:r,hole:s}),a?(a=!1,h[r].push(o)):t=!0);a&&h[n].push(o)}}e.length>0&&(t||(m=h))}for(let y=0,v=d.length;y<v;y++){l=d[y].s,c.push(l),f=m[y];for(let t=0,e=f.length;t<e;t++)l.holes.push(f[t].h)}return c}}class zv{constructor(t){this.type="Font",this.data=t}generateShapes(t,e=100){const n=[],i=function(t,e,n){const i=Array.from(t),r=e/n.resolution,s=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,o=[];let a=0,l=0;for(let c=0;c<i.length;c++){const t=i[c];if("\n"===t)a=0,l-=s;else{const e=Fv(t,r,a,l,n);a+=e.offsetX,o.push(e.path)}}return o}(t,e,this.data);for(let r=0,s=i.length;r<s;r++)Array.prototype.push.apply(n,i[r].toShapes());return n}}function Fv(t,e,n,i,r){const s=r.glyphs[t]||r.glyphs["?"];if(!s)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+r.familyName+".");const o=new Ov;let a,l,c,u,h,d,p,f;if(s.o){const t=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let r=0,s=t.length;r<s;)switch(t[r++]){case"m":a=t[r++]*e+n,l=t[r++]*e+i,o.moveTo(a,l);break;case"l":a=t[r++]*e+n,l=t[r++]*e+i,o.lineTo(a,l);break;case"q":c=t[r++]*e+n,u=t[r++]*e+i,h=t[r++]*e+n,d=t[r++]*e+i,o.quadraticCurveTo(h,d,c,u);break;case"b":c=t[r++]*e+n,u=t[r++]*e+i,h=t[r++]*e+n,d=t[r++]*e+i,p=t[r++]*e+n,f=t[r++]*e+i,o.bezierCurveTo(h,d,p,f,c,u)}}return{offsetX:s.ha*e,path:o}}zv.prototype.isFont=!0;class Uv extends av{constructor(t){super(t)}load(t,e,n,i){const r=this,s=new cv(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(t){let n;try{n=JSON.parse(t)}catch(s){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}const i=r.parse(n);e&&e(i)},n,i)}parse(t){return new zv(t)}}let Hv;class Bv extends av{constructor(t){super(t)}load(t,e,n,i){const r=this,s=new cv(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,function(n){try{const t=n.slice(0);(void 0===Hv&&(Hv=new(window.AudioContext||window.webkitAudioContext)),Hv).decodeAudioData(t,function(t){e(t)})}catch(s){i?i(s):console.error(s),r.manager.itemError(t)}},n,i)}}(class extends Iv{constructor(t,e,n=1){super(void 0,n);const i=(new Ad).set(t),r=(new Ad).set(e),s=new oh(i.r,i.g,i.b),o=new oh(r.r,r.g,r.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(s).sub(o).multiplyScalar(l)}}).prototype.isHemisphereLightProbe=!0,class extends Iv{constructor(t,e=1){super(void 0,e);const n=(new Ad).set(t);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class Vv{constructor(t,e,n){let i,r,s;switch(this.binding=t,this.valueSize=n,e){case"quaternion":i=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*n),this._workIndex=5;break;case"string":case"bool":i=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*n);break;default:i=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*n)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,e){const n=this.buffer,i=this.valueSize,r=t*i+i;let s=this.cumulativeWeight;if(0===s){for(let t=0;t!==i;++t)n[r+t]=n[t];s=e}else s+=e,this._mixBufferRegion(n,r,0,e/s,i);this.cumulativeWeight=s}accumulateAdditive(t){const e=this.buffer,n=this.valueSize,i=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(e,i,0,t,n),this.cumulativeWeightAdditive+=t}apply(t){const e=this.valueSize,n=this.buffer,i=t*e+e,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1&&this._mixBufferRegion(n,i,e*this._origIndex,1-r,e),s>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*e,1,e);for(let a=e,l=e+e;a!==l;++a)if(n[a]!==n[a+e]){o.setValue(n,i);break}}saveOriginalState(){const t=this.buffer,e=this.valueSize,n=e*this._origIndex;this.binding.getValue(t,n);for(let i=e,r=n;i!==r;++i)t[i]=t[n+i%e];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,e=t+this.valueSize;for(let n=t;n<e;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,e=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[e+n]=this.buffer[t+n]}_select(t,e,n,i,r){if(i>=.5)for(let s=0;s!==r;++s)t[e+s]=t[n+s]}_slerp(t,e,n,i){sh.slerpFlat(t,e,t,e,t,n,i)}_slerpAdditive(t,e,n,i,r){const s=this._workIndex*r;sh.multiplyQuaternionsFlat(t,s,t,e,t,n),sh.slerpFlat(t,e,t,e,t,s,i)}_lerp(t,e,n,i,r){const s=1-i;for(let o=0;o!==r;++o){const r=e+o;t[r]=t[r]*s+t[n+o]*i}}_lerpAdditive(t,e,n,i,r){for(let s=0;s!==r;++s){const r=e+s;t[r]=t[r]+t[n+s]*i}}}const Gv=new RegExp("[\\[\\]\\.:\\/]","g"),jv="[^\\[\\]\\.:\\/]",Wv="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",qv=/((?:WC+[\/:])*)/.source.replace("WC",jv),Zv=/(WCOD+)?/.source.replace("WCOD",Wv),Yv=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",jv),Xv=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",jv),Jv=new RegExp("^"+qv+Zv+Yv+Xv+"$"),$v=["material","materials","bones"];class Qv{constructor(t,e,n){this.path=e,this.parsedPath=n||Qv.parseTrackName(e),this.node=Qv.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,n){return t&&t.isAnimationObjectGroup?new Qv.Composite(t,e,n):new Qv(t,e,n)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(Gv,"")}static parseTrackName(t){const e=Jv.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const t=n.nodeName.substring(i+1);-1!==$v.indexOf(t)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=t)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}static findNode(t,e){if(!e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){const n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){const n=function(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.name===e||r.uuid===e)return r;const s=n(r.children);if(s)return s}return null},i=n(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.node[this.propertyName]}_getValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)t[e++]=n[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const n=this.resolvedProperty;for(let i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,n=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(t||(t=Qv.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){let i=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let e=0;e<t.length;e++)if(t[e].name===i){i=e;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==i){if(void 0===t[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[i]}}const s=t[i];if(void 0===s)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+e.nodeName+"."+i+" but it wasn't found.",t);let o=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===i){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[r]&&(r=t.morphTargetDictionary[r])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Qv.Composite=class{constructor(t,e,n){const i=n||Qv.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const n=this._bindings[this._targetGroup.nCachedObjects_];void 0!==n&&n.getValue(t,e)}setValue(t,e){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}},Qv.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Qv.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Qv.prototype.GetterByBindingType=[Qv.prototype._getValue_direct,Qv.prototype._getValue_array,Qv.prototype._getValue_arrayElement,Qv.prototype._getValue_toArray],Qv.prototype.SetterByBindingTypeAndVersioning=[[Qv.prototype._setValue_direct,Qv.prototype._setValue_direct_setNeedsUpdate,Qv.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Qv.prototype._setValue_array,Qv.prototype._setValue_array_setNeedsUpdate,Qv.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Qv.prototype._setValue_arrayElement,Qv.prototype._setValue_arrayElement_setNeedsUpdate,Qv.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Qv.prototype._setValue_fromArray,Qv.prototype._setValue_fromArray_setNeedsUpdate,Qv.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Kv{constructor(t,e,n=null,i=e.blendMode){this._mixer=t,this._clip=e,this._localRoot=n,this.blendMode=i;const r=e.tracks,s=r.length,o=new Array(s),a={endingStart:Eu,endingEnd:Eu};for(let l=0;l!==s;++l){const t=r[l].createInterpolant(null);o[l]=t,t.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,e){return this.loop=t,this.repetitions=e,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){const n=this._clip.duration,i=t._clip.duration,r=n/i;t.warp(1,i/n,e),this.warp(r,1,e)}return this}crossFadeTo(t,e,n){return t.crossFadeFrom(this,e,n)}stopFading(){const t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,e,n){const i=this._mixer,r=i.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=r,a[1]=r+n,l[0]=t/s,l[1]=e/s,this}stopWarping(){const t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,e,n,i){if(!this.enabled)return void this._updateWeight(t);const r=this._startTime;if(null!==r){const i=(t-r)*n;if(i<0||0===n)return;this._startTime=null,e=n*i}e*=this._updateTimeScale(t);const s=this._updateTime(e),o=this._updateWeight(t);if(o>0){const t=this._interpolants,e=this._propertyBindings;switch(this.blendMode){case 2501:for(let n=0,i=t.length;n!==i;++n)t[n].evaluate(s),e[n].accumulateAdditive(o);break;case 2500:default:for(let n=0,r=t.length;n!==r;++n)t[n].evaluate(s),e[n].accumulate(i,o)}}}_updateWeight(t){let e=0;if(this.enabled){e=this.weight;const n=this._weightInterpolant;if(null!==n){const i=n.evaluate(t)[0];e*=i,t>n.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=e,e}_updateTimeScale(t){let e=0;if(!this.paused){e=this.timeScale;const n=this._timeScaleInterpolant;null!==n&&(e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e}_updateTime(t){const e=this._clip.duration,n=this.loop;let i=this.time+t,r=this._loopCount;const s=2202===n;if(0===t)return-1===r?i:s&&1==(1&r)?e-i:i;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(i>=e)i=e;else{if(!(i<0)){this.time=i;break t}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=e||i<0){const n=Math.floor(i/e);i-=e*n,r+=Math.abs(n);const o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=t>0?e:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===o){const e=t<0;this._setEndings(e,!e,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:n})}}else this.time=i;if(s&&1==(1&r))return e-i}return i}_setEndings(t,e,n){const i=this._interpolantSettings;n?(i.endingStart=Au,i.endingEnd=Au):(i.endingStart=t?this.zeroSlopeAtStart?Au:Eu:Du,i.endingEnd=e?this.zeroSlopeAtEnd?Au:Eu:Du)}_scheduleFading(t,e,n){const i=this._mixer,r=i.time;let s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=r,a[0]=e,o[1]=r+t,a[1]=n,this}}(class extends Ou{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,e){const n=t._localRoot||this._root,i=t._clip.tracks,r=i.length,s=t._propertyBindings,o=t._interpolants,a=n.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let u=0;u!==r;++u){const t=i[u],r=t.name;let l=c[r];if(void 0!==l)s[u]=l;else{if(l=s[u],void 0!==l){null===l._cacheIndex&&(++l.referenceCount,this._addInactiveBinding(l,a,r));continue}l=new Vv(Qv.create(n,r,e&&e._propertyBindings[u].binding.parsedPath),t.ValueTypeName,t.getValueSize()),++l.referenceCount,this._addInactiveBinding(l,a,r),s[u]=l}o[u].resultBuffer=l.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const e=(t._localRoot||this._root).uuid,n=t._clip.uuid,i=this._actionsByClip[n];this._bindAction(t,i&&i.knownActions[0]),this._addInactiveAction(t,n,e)}const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==n.useCount++&&(this._lendBinding(n),n.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const e=t._propertyBindings;for(let t=0,n=e.length;t!==n;++t){const n=e[t];0==--n.useCount&&(n.restoreOriginalState(),this._takeBackBinding(n))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const e=t._cacheIndex;return null!==e&&e<this._nActiveActions}_addInactiveAction(t,e,n){const i=this._actions,r=this._actionsByClip;let s=r[e];if(void 0===s)s={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=s;else{const e=s.knownActions;t._byClipCacheIndex=e.length,e.push(t)}t._cacheIndex=i.length,i.push(t),s.actionByRoot[n]=t}_removeInactiveAction(t){const e=this._actions,n=e[e.length-1],i=t._cacheIndex;n._cacheIndex=i,e[i]=n,e.pop(),t._cacheIndex=null;const r=t._clip.uuid,s=this._actionsByClip,o=s[r],a=o.knownActions,l=a[a.length-1],c=t._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===a.length&&delete s[r],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const e=t._propertyBindings;for(let n=0,i=e.length;n!==i;++n){const t=e[n];0==--t.referenceCount&&this._removeInactiveBinding(t)}}_lendAction(t){const e=this._actions,n=t._cacheIndex,i=this._nActiveActions++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackAction(t){const e=this._actions,n=t._cacheIndex,i=--this._nActiveActions,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_addInactiveBinding(t,e,n){const i=this._bindingsByRootAndName,r=this._bindings;let s=i[e];void 0===s&&(s={},i[e]=s),s[n]=t,t._cacheIndex=r.length,r.push(t)}_removeInactiveBinding(t){const e=this._bindings,n=t.binding,i=n.rootNode.uuid,r=n.path,s=this._bindingsByRootAndName,o=s[i],a=e[e.length-1],l=t._cacheIndex;a._cacheIndex=l,e[l]=a,e.pop(),delete o[r],0===Object.keys(o).length&&delete s[i]}_lendBinding(t){const e=this._bindings,n=t._cacheIndex,i=this._nActiveBindings++,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_takeBackBinding(t){const e=this._bindings,n=t._cacheIndex,i=--this._nActiveBindings,r=e[i];t._cacheIndex=i,e[i]=t,r._cacheIndex=n,e[n]=r}_lendControlInterpolant(){const t=this._controlInterpolants,e=this._nActiveControlInterpolants++;let n=t[e];return void 0===n&&(n=new Zy(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n}_takeBackControlInterpolant(t){const e=this._controlInterpolants,n=t.__cacheIndex,i=--this._nActiveControlInterpolants,r=e[i];t.__cacheIndex=i,e[i]=t,r.__cacheIndex=n,e[n]=r}clipAction(t,e,n){const i=e||this._root,r=i.uuid;let s="string"==typeof t?iv.findByName(i,t):t;const o=null!==s?s.uuid:t,a=this._actionsByClip[o];let l=null;if(void 0===n&&(n=null!==s?s.blendMode:2500),void 0!==a){const t=a.actionByRoot[r];if(void 0!==t&&t.blendMode===n)return t;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new Kv(this,s,e,n);return this._bindAction(c,l),this._addInactiveAction(c,o,r),c}existingAction(t,e){const n=e||this._root,i=n.uuid,r="string"==typeof t?iv.findByName(n,t):t,s=this._actionsByClip[r?r.uuid:t];return void 0!==s&&s.actionByRoot[i]||null}stopAllAction(){const t=this._actions;for(let e=this._nActiveActions-1;e>=0;--e)t[e].stop();return this}update(t){const e=this._actions,n=this._nActiveActions,i=this.time+=t*=this.timeScale,r=Math.sign(t),s=this._accuIndex^=1;for(let l=0;l!==n;++l)e[l]._update(i,t,r,s);const o=this._bindings,a=this._nActiveBindings;for(let l=0;l!==a;++l)o[l].apply(s);return this}setTime(t){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const e=this._actions,n=t.uuid,i=this._actionsByClip,r=i[n];if(void 0!==r){const t=r.knownActions;for(let n=0,i=t.length;n!==i;++n){const i=t[n];this._deactivateAction(i);const r=i._cacheIndex,s=e[e.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=r,e[r]=s,e.pop(),this._removeInactiveBindingsForAction(i)}delete i[n]}}uncacheRoot(t){const e=t.uuid,n=this._actionsByClip;for(const r in n){const t=n[r].actionByRoot[e];void 0!==t&&(this._deactivateAction(t),this._removeInactiveAction(t))}const i=this._bindingsByRootAndName[e];if(void 0!==i)for(const r in i){const t=i[r];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(t,e){const n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class t_{constructor(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new t_(void 0===this.value.clone?this.value:this.value.clone())}}(class extends Zm{constructor(t,e,n=1){super(t,e),this.meshPerAttribute=n}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const e=super.clone(t);return e.meshPerAttribute=this.meshPerAttribute,e}toJSON(t){const e=super.toJSON(t);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}).prototype.isInstancedInterleavedBuffer=!0;class e_{constructor(t,e,n=0,i=1/0){this.ray=new Oh(t,e),this.near=n,this.far=i,this.camera=null,this.layers=new Yh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!1,n=[]){return i_(t,this,n,e),n.sort(n_),n}intersectObjects(t,e=!1,n=[]){for(let i=0,r=t.length;i<r;i++)i_(t[i],this,n,e);return n.sort(n_),n}}function n_(t,e){return t.distance-e.distance}function i_(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===i){const i=t.children;for(let t=0,r=i.length;t<r;t++)i_(i[t],e,n,!0)}}class r_{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){const t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(Vu(e/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const s_=new Xu;class o_{constructor(t=new Xu(1/0,1/0),e=new Xu(-1/0,-1/0)){this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=s_.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return s_.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}o_.prototype.isBox2=!0,class extends ld{constructor(t){super(),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}.prototype.isImmediateRenderObject=!0;const a_=new oh,l_=new zh,c_=new zh;function u_(t){const e=[];t&&t.isBone&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,u_(t.children[n]));return e}const h_=new Float32Array(1);new Int32Array(h_.buffer),Math.pow(2,8);const d_=new Dd({side:1,depthWrite:!1,depthTest:!1});new lp(new up,d_),Math.sqrt(5),jg.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(jg.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},fv.prototype.fromPoints=function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)},class extends kg{constructor(t=10,e=10,n=4473924,i=8947848){n=new Ad(n),i=new Ad(i);const r=e/2,s=t/e,o=t/2,a=[],l=[];for(let u=0,h=0,d=-o;u<=e;u++,d+=s){a.push(-o,0,d,o,0,d),a.push(d,0,-o,d,0,o);const t=u===r?n:i;t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3,t.toArray(l,h),h+=3}const c=new jd;c.setAttribute("position",new kd(a,3)),c.setAttribute("color",new kd(l,3)),super(c,new Mg({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class extends kg{constructor(t){const e=u_(t),n=new jd,i=[],r=[],s=new Ad(0,0,1),o=new Ad(0,1,0);for(let a=0;a<e.length;a++){const t=e[a];t.parent&&t.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(s.r,s.g,s.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new kd(i,3)),n.setAttribute("color",new kd(r,3)),super(n,new Mg({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const e=this.bones,n=this.geometry,i=n.getAttribute("position");c_.copy(this.root.matrixWorld).invert();for(let r=0,s=0;r<e.length;r++){const t=e[r];t.parent&&t.parent.isBone&&(l_.multiplyMatrices(c_,t.matrixWorld),a_.setFromMatrixPosition(l_),i.setXYZ(s,a_.x,a_.y,a_.z),l_.multiplyMatrices(c_,t.parent.matrixWorld),a_.setFromMatrixPosition(l_),i.setXYZ(s+1,a_.x,a_.y,a_.z),s+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},av.prototype.extractUrlBase=function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Nv.extractUrlBase(t)},av.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},o_.prototype.center=function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},o_.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},o_.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},o_.prototype.size=function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)},ch.prototype.center=function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ch.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ch.prototype.isIntersectionBox=function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},ch.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},ch.prototype.size=function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)},Ah.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ep.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Ju.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},Ju.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Ju.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Ju.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},Ju.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Ju.prototype.getInverse=function(t){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},zh.prototype.extractPosition=function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},zh.prototype.flattenToArrayOffset=function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},zh.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new oh).setFromMatrixColumn(this,3)},zh.prototype.setRotationFromQuaternion=function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},zh.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},zh.prototype.multiplyVector3=function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},zh.prototype.multiplyVector4=function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},zh.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},zh.prototype.rotateAxis=function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},zh.prototype.crossVector=function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},zh.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},zh.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},zh.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},zh.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},zh.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},zh.prototype.applyToBufferAttribute=function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},zh.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},zh.prototype.makeFrustum=function(t,e,n,i,r,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,i,n,r,s)},zh.prototype.getInverse=function(t){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(t).invert()},Tp.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},sh.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},sh.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Oh.prototype.isIntersectionBox=function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},Oh.prototype.isIntersectionPlane=function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},Oh.prototype.isIntersectionSphere=function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},_d.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},_d.prototype.barycoordFromPoint=function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},_d.prototype.midpoint=function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},_d.prototypenormal=function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},_d.prototype.plane=function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)},_d.barycoordFromPoint=function(t,e,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),_d.getBarycoord(t,e,n,i,r)},_d.normal=function(t,e,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),_d.getNormal(t,e,n,i)},mv.prototype.extractAllPoints=function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},mv.prototype.extrude=function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Oy(this,t)},mv.prototype.makeGeometry=function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Fy(this,t)},Xu.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},Xu.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},Xu.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},oh.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},oh.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},oh.prototype.getPositionFromMatrix=function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},oh.prototype.getScaleFromMatrix=function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},oh.prototype.getColumnFromMatrix=function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},oh.prototype.applyProjection=function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},oh.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},oh.prototype.distanceToManhattan=function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},oh.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},nh.prototype.fromAttribute=function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},nh.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ld.prototype.getChildByName=function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},ld.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},ld.prototype.translate=function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},ld.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},ld.prototype.applyMatrix=function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(ld.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),lp.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(lp.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),gg.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},gp.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(gv.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Rd.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Nu},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Nu)}}}),Rd.prototype.setDynamic=function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Nu:Iu),this},Rd.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Rd.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},jd.prototype.addIndex=function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},jd.prototype.addAttribute=function(t,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(t,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Rd(arguments[1],arguments[2])))},jd.prototype.addDrawCall=function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},jd.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},jd.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},jd.prototype.removeAttribute=function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},jd.prototype.applyMatrix=function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)},Object.defineProperties(jd.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Zm.prototype.setDynamic=function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Nu:Iu),this},Zm.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Oy.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Oy.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Oy.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},qm.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},t_.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(bd.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ad}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===t}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(fp.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Gm.prototype.clearTarget=function(t,e,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(e,n,i)},Gm.prototype.animate=function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},Gm.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Gm.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Gm.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Gm.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Gm.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Gm.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Gm.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Gm.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Gm.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Gm.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Gm.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Gm.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Gm.prototype.enableScissorTest=function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},Gm.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Gm.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Gm.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Gm.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Gm.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Gm.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Gm.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Gm.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Gm.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Gm.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Gm.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?Lu:Pu}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Im.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ih.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),class extends ld{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const e=this.context.createBufferSource();return e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),!0===this._connected?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Bv).load(t,function(t){e.setBuffer(t)}),this},vp.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)},vp.prototype.clear=function(t,e,n,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(t,e,n,i)},Qu.crossOrigin=void 0,Qu.loadTexture=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new dv;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s},Qu.loadTextureCube=function(t,e,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new hv;r.setCrossOrigin(this.crossOrigin);const s=r.load(t,n,void 0,i);return e&&(s.mapping=e),s},Qu.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Qu.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"130"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="130");const p_={type:"change"},f_={type:"start"},m_={type:"end"};class g_ extends Ou{constructor(t,e){super(),void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=e,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new oh,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.listenToKeyEvents=function(t){t.addEventListener("keydown",G),this._domElementKeyEvents=t},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(p_),n.update(),r=i.NONE},this.update=function(){const e=new oh,h=(new sh).setFromUnitVectors(t.up,new oh(0,1,0)),d=h.clone().invert(),p=new oh,f=new sh,m=2*Math.PI;return function(){const t=n.object.position;e.copy(t).sub(n.target),e.applyQuaternion(h),o.setFromVector3(e),n.autoRotate&&r===i.NONE&&C(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(o.theta+=a.theta*n.dampingFactor,o.phi+=a.phi*n.dampingFactor):(o.theta+=a.theta,o.phi+=a.phi);let g=n.minAzimuthAngle,y=n.maxAzimuthAngle;return isFinite(g)&&isFinite(y)&&(g<-Math.PI?g+=m:g>Math.PI&&(g-=m),y<-Math.PI?y+=m:y>Math.PI&&(y-=m),o.theta=g<=y?Math.max(g,Math.min(y,o.theta)):o.theta>(g+y)/2?Math.max(g,o.theta):Math.min(y,o.theta)),o.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,o.phi)),o.makeSafe(),o.radius*=l,o.radius=Math.max(n.minDistance,Math.min(n.maxDistance,o.radius)),!0===n.enableDamping?n.target.addScaledVector(c,n.dampingFactor):n.target.add(c),e.setFromSpherical(o),e.applyQuaternion(d),t.copy(n.target).add(e),n.object.lookAt(n.target),!0===n.enableDamping?(a.theta*=1-n.dampingFactor,a.phi*=1-n.dampingFactor,c.multiplyScalar(1-n.dampingFactor)):(a.set(0,0,0),c.set(0,0,0)),l=1,!!(u||p.distanceToSquared(n.object.position)>s||8*(1-f.dot(n.object.quaternion))>s)&&(n.dispatchEvent(p_),p.copy(n.object.position),f.copy(n.object.quaternion),u=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",j),n.domElement.removeEventListener("pointerdown",F),n.domElement.removeEventListener("pointercancel",B),n.domElement.removeEventListener("wheel",V),n.domElement.ownerDocument.removeEventListener("pointermove",U),n.domElement.ownerDocument.removeEventListener("pointerup",H),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",G)};const n=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let r=i.NONE;const s=1e-6,o=new r_,a=new r_;let l=1;const c=new oh;let u=!1;const h=new Xu,d=new Xu,p=new Xu,f=new Xu,m=new Xu,g=new Xu,y=new Xu,v=new Xu,_=new Xu,x=[],b={};function w(){return Math.pow(.95,n.zoomSpeed)}function C(t){a.theta-=t}function T(t){a.phi-=t}const S=function(){const t=new oh;return function(e,n){t.setFromMatrixColumn(n,0),t.multiplyScalar(-e),c.add(t)}}(),M=function(){const t=new oh;return function(e,i){!0===n.screenSpacePanning?t.setFromMatrixColumn(i,1):(t.setFromMatrixColumn(i,0),t.crossVectors(n.object.up,t)),t.multiplyScalar(e),c.add(t)}}(),E=function(){const t=new oh;return function(e,i){const r=n.domElement;if(n.object.isPerspectiveCamera){t.copy(n.object.position).sub(n.target);let s=t.length();s*=Math.tan(n.object.fov/2*Math.PI/180),S(2*e*s/r.clientHeight,n.object.matrix),M(2*i*s/r.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(S(e*(n.object.right-n.object.left)/n.object.zoom/r.clientWidth,n.object.matrix),M(i*(n.object.top-n.object.bottom)/n.object.zoom/r.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function A(t){n.object.isPerspectiveCamera?l/=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*t)),n.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function D(t){n.object.isPerspectiveCamera?l*=t:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/t)),n.object.updateProjectionMatrix(),u=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function P(t){h.set(t.clientX,t.clientY)}function L(t){f.set(t.clientX,t.clientY)}function R(){1===x.length?h.set(x[0].pageX,x[0].pageY):h.set(.5*(x[0].pageX+x[1].pageX),.5*(x[0].pageY+x[1].pageY))}function I(){1===x.length?f.set(x[0].pageX,x[0].pageY):f.set(.5*(x[0].pageX+x[1].pageX),.5*(x[0].pageY+x[1].pageY))}function N(){const t=x[0].pageX-x[1].pageX,e=x[0].pageY-x[1].pageY,n=Math.sqrt(t*t+e*e);y.set(0,n)}function k(t){if(1==x.length)d.set(t.pageX,t.pageY);else{const e=Z(t);d.set(.5*(t.pageX+e.x),.5*(t.pageY+e.y))}p.subVectors(d,h).multiplyScalar(n.rotateSpeed);const e=n.domElement;C(2*Math.PI*p.x/e.clientHeight),T(2*Math.PI*p.y/e.clientHeight),h.copy(d)}function O(t){if(1===x.length)m.set(t.pageX,t.pageY);else{const e=Z(t);m.set(.5*(t.pageX+e.x),.5*(t.pageY+e.y))}g.subVectors(m,f).multiplyScalar(n.panSpeed),E(g.x,g.y),f.copy(m)}function z(t){const e=Z(t),i=t.pageX-e.x,r=t.pageY-e.y,s=Math.sqrt(i*i+r*r);v.set(0,s),_.set(0,Math.pow(v.y/y.y,n.zoomSpeed)),A(_.y),y.copy(v)}function F(t){!1!==n.enabled&&(0===x.length&&(n.domElement.ownerDocument.addEventListener("pointermove",U),n.domElement.ownerDocument.addEventListener("pointerup",H)),function(t){x.push(t)}(t),"touch"===t.pointerType?function(t){switch(q(t),x.length){case 1:switch(n.touches.ONE){case 0:if(!1===n.enableRotate)return;R(),r=i.TOUCH_ROTATE;break;case 1:if(!1===n.enablePan)return;I(),r=i.TOUCH_PAN;break;default:r=i.NONE}break;case 2:switch(n.touches.TWO){case 2:if(!1===n.enableZoom&&!1===n.enablePan)return;n.enableZoom&&N(),n.enablePan&&I(),r=i.TOUCH_DOLLY_PAN;break;case 3:if(!1===n.enableZoom&&!1===n.enableRotate)return;n.enableZoom&&N(),n.enableRotate&&R(),r=i.TOUCH_DOLLY_ROTATE;break;default:r=i.NONE}break;default:r=i.NONE}r!==i.NONE&&n.dispatchEvent(f_)}(t):function(t){let e;switch(t.button){case 0:e=n.mouseButtons.LEFT;break;case 1:e=n.mouseButtons.MIDDLE;break;case 2:e=n.mouseButtons.RIGHT;break;default:e=-1}switch(e){case 1:if(!1===n.enableZoom)return;!function(t){y.set(t.clientX,t.clientY)}(t),r=i.DOLLY;break;case 0:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enablePan)return;L(t),r=i.PAN}else{if(!1===n.enableRotate)return;P(t),r=i.ROTATE}break;case 2:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===n.enableRotate)return;P(t),r=i.ROTATE}else{if(!1===n.enablePan)return;L(t),r=i.PAN}break;default:r=i.NONE}r!==i.NONE&&n.dispatchEvent(f_)}(t))}function U(t){!1!==n.enabled&&("touch"===t.pointerType?function(t){switch(q(t),r){case i.TOUCH_ROTATE:if(!1===n.enableRotate)return;k(t),n.update();break;case i.TOUCH_PAN:if(!1===n.enablePan)return;O(t),n.update();break;case i.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(t){n.enableZoom&&z(t),n.enablePan&&O(t)}(t),n.update();break;case i.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(t){n.enableZoom&&z(t),n.enableRotate&&k(t)}(t),n.update();break;default:r=i.NONE}}(t):function(t){if(!1!==n.enabled)switch(r){case i.ROTATE:if(!1===n.enableRotate)return;!function(t){d.set(t.clientX,t.clientY),p.subVectors(d,h).multiplyScalar(n.rotateSpeed);const e=n.domElement;C(2*Math.PI*p.x/e.clientHeight),T(2*Math.PI*p.y/e.clientHeight),h.copy(d),n.update()}(t);break;case i.DOLLY:if(!1===n.enableZoom)return;!function(t){v.set(t.clientX,t.clientY),_.subVectors(v,y),_.y>0?A(w()):_.y<0&&D(w()),y.copy(v),n.update()}(t);break;case i.PAN:if(!1===n.enablePan)return;!function(t){m.set(t.clientX,t.clientY),g.subVectors(m,f).multiplyScalar(n.panSpeed),E(g.x,g.y),f.copy(m),n.update()}(t)}}(t))}function H(t){!1!==n.enabled&&(n.dispatchEvent(m_),r=i.NONE,W(t),0===x.length&&(n.domElement.ownerDocument.removeEventListener("pointermove",U),n.domElement.ownerDocument.removeEventListener("pointerup",H)))}function B(t){W(t)}function V(t){!1===n.enabled||!1===n.enableZoom||r!==i.NONE&&r!==i.ROTATE||(t.preventDefault(),n.dispatchEvent(f_),function(t){t.deltaY<0?D(w()):t.deltaY>0&&A(w()),n.update()}(t),n.dispatchEvent(m_))}function G(t){!1!==n.enabled&&!1!==n.enablePan&&function(t){let e=!1;switch(t.code){case n.keys.UP:E(0,n.keyPanSpeed),e=!0;break;case n.keys.BOTTOM:E(0,-n.keyPanSpeed),e=!0;break;case n.keys.LEFT:E(n.keyPanSpeed,0),e=!0;break;case n.keys.RIGHT:E(-n.keyPanSpeed,0),e=!0}e&&(t.preventDefault(),n.update())}(t)}function j(t){!1!==n.enabled&&t.preventDefault()}function W(t){delete b[t.pointerId];for(let e=0;e<x.length;e++)if(x[e].pointerId==t.pointerId)return void x.splice(e,1)}function q(t){let e=b[t.pointerId];void 0===e&&(e=new Xu,b[t.pointerId]=e),e.set(t.pageX,t.pageY)}function Z(t){return b[(t.pointerId===x[0].pointerId?x[1]:x[0]).pointerId]}n.domElement.addEventListener("contextmenu",j),n.domElement.addEventListener("pointerdown",F),n.domElement.addEventListener("pointercancel",B),n.domElement.addEventListener("wheel",V,{passive:!1}),this.update()}}class y_ extends av{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new w_(t)}),this.register(function(t){return new T_(t)}),this.register(function(t){return new S_(t)}),this.register(function(t){return new C_(t)}),this.register(function(t){return new x_(t)}),this.register(function(t){return new M_(t)})}load(t,e,n,i){const r=this;let s;s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Nv.extractUrlBase(t),this.manager.itemStart(t);const o=function(e){i?i(e):console.error(e),r.manager.itemError(t),r.manager.itemEnd(t)},a=new cv(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(t,function(n){try{r.parse(n,s,function(n){e(n),r.manager.itemEnd(t)},o)}catch(i){o(i)}},n,o)}setDRACOLoader(t){return this.dracoLoader=t,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this}unregister(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,e,n,i){let r;const s={},o={};if("string"==typeof t)r=t;else if(Nv.decodeText(new Uint8Array(t,0,4))===E_){try{s[__.KHR_BINARY_GLTF]=new A_(t)}catch(c){return void(i&&i(c))}r=s[__.KHR_BINARY_GLTF].content}else r=Nv.decodeText(new Uint8Array(t));const a=JSON.parse(r);if(void 0===a.asset||a.asset.version[0]<2)return void(i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new X_(a,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let u=0;u<this.pluginCallbacks.length;u++){const t=this.pluginCallbacks[u](l);o[t.name]=t,s[t.name]=!0}if(a.extensionsUsed)for(let u=0;u<a.extensionsUsed.length;++u){const t=a.extensionsUsed[u],e=a.extensionsRequired||[];switch(t){case __.KHR_MATERIALS_UNLIT:s[t]=new b_;break;case __.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[t]=new R_;break;case __.KHR_DRACO_MESH_COMPRESSION:s[t]=new D_(a,this.dracoLoader);break;case __.KHR_TEXTURE_TRANSFORM:s[t]=new P_;break;case __.KHR_MESH_QUANTIZATION:s[t]=new I_;break;default:e.indexOf(t)>=0&&void 0===o[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(s),l.setPlugins(o),l.parse(n,i)}}function v_(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const __={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class x_{constructor(t){this.parser=t,this.name=__.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,e=this.parser.json.nodes||[];for(let n=0,i=e.length;n<i;n++){const i=e[n];i.extensions&&i.extensions[this.name]&&void 0!==i.extensions[this.name].light&&t._addNodeRef(this.cache,i.extensions[this.name].light)}}_loadLight(t){const e=this.parser,n="light:"+t;let i=e.cache.get(n);if(i)return i;const r=e.json,s=((r.extensions&&r.extensions[this.name]||{}).lights||[])[t];let o;const a=new Ad(16777215);void 0!==s.color&&a.fromArray(s.color);const l=void 0!==s.range?s.range:0;switch(s.type){case"directional":o=new Lv(a),o.target.position.set(0,0,-1),o.add(o.target);break;case"point":o=new Av(a),o.distance=l;break;case"spot":o=new Cv(a),o.distance=l,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,o.angle=s.spot.outerConeAngle,o.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return o.position.set(0,0,0),o.decay=2,void 0!==s.intensity&&(o.intensity=s.intensity),o.name=e.createUniqueName(s.name||"light_"+t),i=Promise.resolve(o),e.cache.add(n,i),i}createNodeAttachment(t){const e=this,n=this.parser,i=n.json.nodes[t],r=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===r?null:this._loadLight(r).then(function(t){return n._getNodeRef(e.cache,r,t)})}}class b_{constructor(){this.name=__.KHR_MATERIALS_UNLIT}getMaterialType(){return Dd}extendParams(t,e,n){const i=[];t.color=new Ad(1,1,1),t.opacity=1;const r=e.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const e=r.baseColorFactor;t.color.fromArray(e),t.opacity=e[3]}void 0!==r.baseColorTexture&&i.push(n.assignTexture(t,"map",r.baseColorTexture))}return Promise.all(i)}}class w_{constructor(t){this.parser=t,this.name=__.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?By:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];if(void 0!==s.clearcoatFactor&&(e.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&r.push(n.assignTexture(e,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(e.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&r.push(n.assignTexture(e,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(r.push(n.assignTexture(e,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){const t=s.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new Xu(t,-t)}return Promise.all(r)}}class C_{constructor(t){this.parser=t,this.name=__.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?By:null}extendMaterialParams(t,e){const n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const r=[],s=i.extensions[this.name];return void 0!==s.transmissionFactor&&(e.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&r.push(n.assignTexture(e,"transmissionMap",s.transmissionTexture)),Promise.all(r)}}class T_{constructor(t){this.parser=t,this.name=__.KHR_TEXTURE_BASISU}loadTexture(t){const e=this.parser,n=e.json,i=n.textures[t];if(!i.extensions||!i.extensions[this.name])return null;const r=n.images[i.extensions[this.name].source],s=e.options.ktx2Loader;if(!s){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,r,s)}}class S_{constructor(t){this.parser=t,this.name=__.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(t){const e=this.name,n=this.parser,i=n.json,r=i.textures[t];if(!r.extensions||!r.extensions[e])return null;const s=i.images[r.extensions[e].source];let o=n.textureLoader;if(s.uri){const t=n.options.manager.getHandler(s.uri);null!==t&&(o=t)}return this.detectSupport().then(function(r){if(r)return n.loadTextureImage(t,s,o);if(i.extensionsRequired&&i.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(t){const e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}})),this.isSupported}}class M_{constructor(t){this.name=__.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){const t=n.extensions[this.name],i=this.parser.getDependency("buffer",t.buffer),r=this.parser.options.meshoptDecoder;if(!r||!r.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([i,r.ready]).then(function(e){const n=t.byteOffset||0,i=t.byteLength||0,s=t.count,o=t.byteStride,a=new ArrayBuffer(s*o),l=new Uint8Array(e[0],n,i);return r.decodeGltfBuffer(new Uint8Array(a),s,o,l,t.mode,t.filter),a})}return null}}const E_="glTF";class A_{constructor(t){this.name=__.KHR_BINARY_GLTF,this.content=null,this.body=null;const e=new DataView(t,0,12);if(this.header={magic:Nv.decodeText(new Uint8Array(t.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==E_)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,i=new DataView(t,12);let r=0;for(;r<n;){const e=i.getUint32(r,!0);r+=4;const n=i.getUint32(r,!0);if(r+=4,1313821514===n){const n=new Uint8Array(t,12+r,e);this.content=Nv.decodeText(n)}else if(5130562===n){const n=12+r;this.body=t.slice(n,n+e)}r+=e}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class D_{constructor(t,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=__.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(t,e){const n=this.json,i=this.dracoLoader,r=t.extensions[this.name].bufferView,s=t.extensions[this.name].attributes,o={},a={},l={};for(const c in s){const t=U_[c]||c.toLowerCase();o[t]=s[c]}for(const c in t.attributes){const e=U_[c]||c.toLowerCase();if(void 0!==s[c]){const i=n.accessors[t.attributes[c]];l[e]=k_[i.componentType],a[e]=!0===i.normalized}}return e.getDependency("bufferView",r).then(function(t){return new Promise(function(e){i.decodeDracoFile(t,function(t){for(const e in t.attributes){const n=t.attributes[e],i=a[e];void 0!==i&&(n.normalized=i)}e(t)},o,l)})})}}class P_{constructor(){this.name=__.KHR_TEXTURE_TRANSFORM}extendTexture(t,e){return void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===e.offset&&void 0===e.rotation&&void 0===e.scale||(t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),t.needsUpdate=!0),t}}class L_ extends Hy{constructor(t){super(),this.isGLTFSpecularGlossinessMaterial=!0;const e=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),r=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),o={specular:{value:(new Ad).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=o,this.onBeforeCompile=function(t){for(const e in o)t.uniforms[e]=o[e];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",e).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",r).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return o.specular.value},set:function(t){o.specular.value=t}},specularMap:{get:function(){return o.specularMap.value},set:function(t){o.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return o.glossiness.value},set:function(t){o.glossiness.value=t}},glossinessMap:{get:function(){return o.glossinessMap.value},set:function(t){o.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}copy(t){return super.copy(t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class R_{constructor(){this.name=__.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return L_}extendParams(t,e,n){const i=e.extensions[this.name];t.color=new Ad(1,1,1),t.opacity=1;const r=[];if(Array.isArray(i.diffuseFactor)){const e=i.diffuseFactor;t.color.fromArray(e),t.opacity=e[3]}if(void 0!==i.diffuseTexture&&r.push(n.assignTexture(t,"map",i.diffuseTexture)),t.emissive=new Ad(0,0,0),t.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,t.specular=new Ad(1,1,1),Array.isArray(i.specularFactor)&&t.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){const e=i.specularGlossinessTexture;r.push(n.assignTexture(t,"glossinessMap",e)),r.push(n.assignTexture(t,"specularMap",e))}return Promise.all(r)}createMaterial(t){const e=new L_(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=0,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}class I_{constructor(){this.name=__.KHR_MESH_QUANTIZATION}}class N_ extends Wy{constructor(t,e,n,i){super(t,e,n,i)}copySampleValue_(t){const e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i*3+i;for(let s=0;s!==i;s++)e[s]=n[r+s];return e}}N_.prototype.beforeStart_=N_.prototype.copySampleValue_,N_.prototype.afterEnd_=N_.prototype.copySampleValue_,N_.prototype.interpolate_=function(t,e,n,i){const r=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=i-e,u=(n-e)/c,h=u*u,d=h*u,p=t*l,f=p-l,m=-2*d+3*h,g=d-h,y=1-m,v=g-h+u;for(let _=0;_!==o;_++)r[_]=y*s[f+_+o]+v*(s[f+_+a]*c)+m*s[p+_+o]+g*(s[p+_]*c);return r};const k_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},O_={9728:cu,9729:du,9984:uu,9985:1007,9986:hu,9987:pu},z_={33071:au,33648:lu,10497:ou},F_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},U_={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},H_={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},B_={CUBICSPLINE:void 0,LINEAR:Su,STEP:Tu};function V_(t,e){return"string"!=typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}function G_(t,e,n){for(const i in n.extensions)void 0===t[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=n.extensions[i])}function j_(t,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function W_(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(let n=0,i=e.weights.length;n<i;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let e=0,i=n.length;e<i;e++)t.morphTargetDictionary[n[e]]=e}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function q_(t){const e=t.extensions&&t.extensions[__.KHR_DRACO_MESH_COMPRESSION];let n;return n=e?"draco:"+e.bufferView+":"+e.indices+":"+Z_(e.attributes):t.indices+":"+Z_(t.attributes)+":"+t.mode,n}function Z_(t){let e="";const n=Object.keys(t).sort();for(let i=0,r=n.length;i<r;i++)e+=n[i]+":"+t[n[i]]+";";return e}function Y_(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class X_{constructor(t={},e={}){this.json=t,this.extensions={},this.plugins={},this.options=e,this.cache=new v_,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},this.textureLoader="undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?new kv(this.options.manager):new dv(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new cv(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,e){const n=this,i=this.json,r=this.extensions;this.cache.removeAll(),this._invokeAll(function(t){return t._markDefs&&t._markDefs()}),Promise.all(this._invokeAll(function(t){return t.beforeRoot&&t.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(e){const s={scene:e[0][i.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:i.asset,parser:n,userData:{}};G_(r,s,i),j_(s,i),Promise.all(n._invokeAll(function(t){return t.afterRoot&&t.afterRoot(s)})).then(function(){t(s)})}).catch(e)}_markDefs(){const t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[];for(let i=0,r=e.length;i<r;i++){const n=e[i].joints;for(let e=0,i=n.length;e<i;e++)t[n[e]].isBone=!0}for(let i=0,r=t.length;i<r;i++){const e=t[i];void 0!==e.mesh&&(this._addNodeRef(this.meshCache,e.mesh),void 0!==e.skin&&(n[e.mesh].isSkinnedMesh=!0)),void 0!==e.camera&&this._addNodeRef(this.cameraCache,e.camera)}}_addNodeRef(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)}_getNodeRef(t,e,n){if(t.refs[e]<=1)return n;const i=n.clone();return i.name+="_instance_"+t.uses[e]++,i}_invokeOne(t){const e=Object.values(this.plugins);e.push(this);for(let n=0;n<e.length;n++){const i=t(e[n]);if(i)return i}return null}_invokeAll(t){const e=Object.values(this.plugins);e.unshift(this);const n=[];for(let i=0;i<e.length;i++){const r=t(e[i]);r&&n.push(r)}return n}getDependency(t,e){const n=t+":"+e;let i=this.cache.get(n);if(!i){switch(t){case"scene":i=this.loadScene(e);break;case"node":i=this.loadNode(e);break;case"mesh":i=this._invokeOne(function(t){return t.loadMesh&&t.loadMesh(e)});break;case"accessor":i=this.loadAccessor(e);break;case"bufferView":i=this._invokeOne(function(t){return t.loadBufferView&&t.loadBufferView(e)});break;case"buffer":i=this.loadBuffer(e);break;case"material":i=this._invokeOne(function(t){return t.loadMaterial&&t.loadMaterial(e)});break;case"texture":i=this._invokeOne(function(t){return t.loadTexture&&t.loadTexture(e)});break;case"skin":i=this.loadSkin(e);break;case"animation":i=this.loadAnimation(e);break;case"camera":i=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,i)}return i}getDependencies(t){let e=this.cache.get(t);if(!e){const n=this;e=Promise.all((this.json[t+("mesh"===t?"es":"s")]||[]).map(function(e,i){return n.getDependency(t,i)})),this.cache.add(t,e)}return e}loadBuffer(t){const e=this.json.buffers[t],n=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[__.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(t,r){n.load(V_(e.uri,i.path),t,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))})})}loadBufferView(t){const e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then(function(t){const n=e.byteOffset||0;return t.slice(n,n+(e.byteLength||0))})}loadAccessor(t){const e=this,n=this.json,i=this.json.accessors[t];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);const r=[];return r.push(void 0!==i.bufferView?this.getDependency("bufferView",i.bufferView):null),void 0!==i.sparse&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then(function(t){const r=t[0],s=F_[i.type],o=k_[i.componentType],a=o.BYTES_PER_ELEMENT,l=i.byteOffset||0,c=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,u=!0===i.normalized;let h,d;if(c&&c!==a*s){const t=Math.floor(l/c),n="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+t+":"+i.count;let p=e.cache.get(n);p||(h=new o(r,t*c,i.count*c/a),p=new Zm(h,c/a),e.cache.add(n,p)),d=new Xm(p,s,l%c/a,u)}else h=null===r?new o(i.count*s):new o(r,l,i.count*s),d=new Rd(h,s,u);if(void 0!==i.sparse){const e=i.sparse.values.byteOffset||0,n=new(0,k_[i.sparse.indices.componentType])(t[1],i.sparse.indices.byteOffset||0,i.sparse.count*F_.SCALAR),a=new o(t[2],e,i.sparse.count*s);null!==r&&(d=new Rd(d.array.slice(),d.itemSize,d.normalized));for(let t=0,i=n.length;t<i;t++){const e=n[t];if(d.setX(e,a[t*s]),s>=2&&d.setY(e,a[t*s+1]),s>=3&&d.setZ(e,a[t*s+2]),s>=4&&d.setW(e,a[t*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return d})}loadTexture(t){const e=this.json,n=e.images[e.textures[t].source];let i=this.textureLoader;if(n.uri){const t=this.options.manager.getHandler(n.uri);null!==t&&(i=t)}return this.loadTextureImage(t,n,i)}loadTextureImage(t,e,n){const i=this,r=this.json,s=this.options,o=r.textures[t],a=(e.uri||e.bufferView)+":"+o.sampler;if(this.textureCache[a])return this.textureCache[a];const l=self.URL||self.webkitURL;let c=e.uri||"",u=!1,h=!0;const d=c.search(/\.jpe?g($|\?)/i)>0||0===c.search(/^data\:image\/jpeg/);if(("image/jpeg"===e.mimeType||d)&&(h=!1),void 0!==e.bufferView)c=i.getDependency("bufferView",e.bufferView).then(function(t){if("image/png"===e.mimeType){const e=new DataView(t,25,1).getUint8(0,!1);h=6===e||4===e||3===e}u=!0;const n=new Blob([t],{type:e.mimeType});return c=l.createObjectURL(n),c});else if(void 0===e.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const p=Promise.resolve(c).then(function(t){return new Promise(function(e,i){let r=e;!0===n.isImageBitmapLoader&&(r=function(t){const n=new th(t);n.needsUpdate=!0,e(n)}),n.load(V_(t,s.path),r,void 0,i)})}).then(function(e){!0===u&&l.revokeObjectURL(c),e.flipY=!1,o.name&&(e.name=o.name),h||(e.format=xu);const n=(r.samplers||{})[o.sampler]||{};return e.magFilter=O_[n.magFilter]||du,e.minFilter=O_[n.minFilter]||pu,e.wrapS=z_[n.wrapS]||ou,e.wrapT=z_[n.wrapT]||ou,i.associations.set(e,{type:"textures",index:t}),e}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",c),null});return this.textureCache[a]=p,p}assignTexture(t,e,n){const i=this;return this.getDependency("texture",n.index).then(function(r){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===e&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+e+" not yet supported."),i.extensions[__.KHR_TEXTURE_TRANSFORM]){const t=void 0!==n.extensions?n.extensions[__.KHR_TEXTURE_TRANSFORM]:void 0;if(t){const e=i.associations.get(r);r=i.extensions[__.KHR_TEXTURE_TRANSFORM].extendTexture(r,t),i.associations.set(r,e)}}t[e]=r})}assignFinalMaterial(t){const e=t.geometry;let n=t.material;const i=void 0!==e.attributes.tangent,r=void 0!==e.attributes.color,s=void 0===e.attributes.normal,o=Object.keys(e.morphAttributes).length>0,a=o&&void 0!==e.morphAttributes.normal;if(t.isPoints){const t="PointsMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new zg,bd.prototype.copy.call(e,n),e.color.copy(n.color),e.map=n.map,e.sizeAttenuation=!1,this.cache.add(t,e)),n=e}else if(t.isLine){const t="LineBasicMaterial:"+n.uuid;let e=this.cache.get(t);e||(e=new Mg,bd.prototype.copy.call(e,n),e.color.copy(n.color),this.cache.add(t,e)),n=e}if(i||r||s||o){let t="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(t+="specular-glossiness:"),i&&(t+="vertex-tangents:"),r&&(t+="vertex-colors:"),s&&(t+="flat-shading:"),o&&(t+="morph-targets:"),a&&(t+="morph-normals:");let e=this.cache.get(t);e||(e=n.clone(),r&&(e.vertexColors=!0),s&&(e.flatShading=!0),o&&(e.morphTargets=!0),a&&(e.morphNormals=!0),i&&(e.vertexTangents=!0,e.normalScale&&(e.normalScale.y*=-1),e.clearcoatNormalScale&&(e.clearcoatNormalScale.y*=-1)),this.cache.add(t,e),this.associations.set(e,this.associations.get(n))),n=e}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=n}getMaterialType(){return Hy}loadMaterial(t){const e=this,n=this.extensions,i=this.json.materials[t];let r;const s={},o=i.extensions||{},a=[];if(o[__.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const t=n[__.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];r=t.getMaterialType(),a.push(t.extendParams(s,i,e))}else if(o[__.KHR_MATERIALS_UNLIT]){const t=n[__.KHR_MATERIALS_UNLIT];r=t.getMaterialType(),a.push(t.extendParams(s,i,e))}else{const n=i.pbrMetallicRoughness||{};if(s.color=new Ad(1,1,1),s.opacity=1,Array.isArray(n.baseColorFactor)){const t=n.baseColorFactor;s.color.fromArray(t),s.opacity=t[3]}void 0!==n.baseColorTexture&&a.push(e.assignTexture(s,"map",n.baseColorTexture)),s.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,s.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(a.push(e.assignTexture(s,"metalnessMap",n.metallicRoughnessTexture)),a.push(e.assignTexture(s,"roughnessMap",n.metallicRoughnessTexture))),r=this._invokeOne(function(e){return e.getMaterialType&&e.getMaterialType(t)}),a.push(Promise.all(this._invokeAll(function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,s)})))}!0===i.doubleSided&&(s.side=2);const l=i.alphaMode||"OPAQUE";return"BLEND"===l?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,"MASK"===l&&(s.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&r!==Dd&&(a.push(e.assignTexture(s,"normalMap",i.normalTexture)),s.normalScale=new Xu(1,-1),void 0!==i.normalTexture.scale&&s.normalScale.set(i.normalTexture.scale,-i.normalTexture.scale)),void 0!==i.occlusionTexture&&r!==Dd&&(a.push(e.assignTexture(s,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(s.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&r!==Dd&&(s.emissive=(new Ad).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&r!==Dd&&a.push(e.assignTexture(s,"emissiveMap",i.emissiveTexture)),Promise.all(a).then(function(){let o;return o=r===L_?n[__.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new r(s),i.name&&(o.name=i.name),o.map&&(o.map.encoding=Lu),o.emissiveMap&&(o.emissiveMap.encoding=Lu),j_(o,i),e.associations.set(o,{type:"materials",index:t}),i.extensions&&G_(n,o,i),o})}createUniqueName(t){const e=Qv.sanitizeNodeName(t||"");let n=e;for(let i=1;this.nodeNamesUsed[n];++i)n=e+"_"+i;return this.nodeNamesUsed[n]=!0,n}loadGeometries(t){const e=this,n=this.extensions,i=this.primitiveCache;function r(t){return n[__.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then(function(n){return $_(n,t,e)})}const s=[];for(let o=0,a=t.length;o<a;o++){const n=t[o],a=q_(n),l=i[a];if(l)s.push(l.promise);else{let t;t=n.extensions&&n.extensions[__.KHR_DRACO_MESH_COMPRESSION]?r(n):$_(new jd,n,e),i[a]={primitive:n,promise:t},s.push(t)}}return Promise.all(s)}loadMesh(t){const e=this,n=this.extensions,i=this.json.meshes[t],r=i.primitives,s=[];for(let a=0,l=r.length;a<l;a++){const t=void 0===r[a].material?(void 0===(o=this.cache).DefaultMaterial&&(o.DefaultMaterial=new Hy({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),o.DefaultMaterial):this.getDependency("material",r[a].material);s.push(t)}var o;return s.push(e.loadGeometries(r)),Promise.all(s).then(function(s){const o=s.slice(0,s.length-1),a=s[s.length-1],l=[];for(let u=0,h=a.length;u<h;u++){const s=a[u],c=r[u];let h;const d=o[u];if(4===c.mode||5===c.mode||6===c.mode||void 0===c.mode)h=!0===i.isSkinnedMesh?new gg(s,d):new lp(s,d),!0!==h.isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),5===c.mode?h.geometry=Q_(h.geometry,1):6===c.mode&&(h.geometry=Q_(h.geometry,2));else if(1===c.mode)h=new kg(s,d);else if(3===c.mode)h=new Rg(s,d);else if(2===c.mode)h=new Og(s,d);else{if(0!==c.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);h=new Vg(s,d)}Object.keys(h.geometry.morphAttributes).length>0&&W_(h,i),h.name=e.createUniqueName(i.name||"mesh_"+t),j_(h,i),c.extensions&&G_(n,h,c),e.assignFinalMaterial(h),l.push(h)}if(1===l.length)return l[0];const c=new Fm;for(let t=0,e=l.length;t<e;t++)c.add(l[t]);return c})}loadCamera(t){let e;const n=this.json.cameras[t],i=n[n.type];if(i)return"perspective"===n.type?e=new gp(Yu.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(e=new Dv(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),j_(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(t){const e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then(function(t){return n.inverseBindMatrices=t,n})}loadAnimation(t){const e=this.json.animations[t],n=[],i=[],r=[],s=[],o=[];for(let a=0,l=e.channels.length;a<l;a++){const t=e.channels[a],l=e.samplers[t.sampler],c=t.target,u=void 0!==e.parameters?e.parameters[l.input]:l.input,h=void 0!==e.parameters?e.parameters[l.output]:l.output;n.push(this.getDependency("node",void 0!==c.node?c.node:c.id)),i.push(this.getDependency("accessor",u)),r.push(this.getDependency("accessor",h)),s.push(l),o.push(c)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(r),Promise.all(s),Promise.all(o)]).then(function(n){const i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=[];for(let t=0,e=i.length;t<e;t++){const e=i[t],n=r[t],c=s[t],u=o[t],h=a[t];if(void 0===e)continue;let d;switch(e.updateMatrix(),e.matrixAutoUpdate=!0,H_[h.path]){case H_.weights:d=Qy;break;case H_.rotation:d=tv;break;case H_.position:case H_.scale:default:d=nv}const p=e.name?e.name:e.uuid,f=void 0!==u.interpolation?B_[u.interpolation]:Su,m=[];H_[h.path]===H_.weights?e.traverse(function(t){!0===t.isMesh&&t.morphTargetInfluences&&m.push(t.name?t.name:t.uuid)}):m.push(p);let g=c.array;if(c.normalized){const t=Y_(g.constructor),e=new Float32Array(g.length);for(let n=0,i=g.length;n<i;n++)e[n]=g[n]*t;g=e}for(let t=0,i=m.length;t<i;t++){const e=new d(m[t]+"."+H_[h.path],n.array,g,f);"CUBICSPLINE"===u.interpolation&&(e.createInterpolant=function(t){return new N_(this.times,this.values,this.getValueSize()/3,t)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(e)}}return new iv(e.name?e.name:"animation_"+t,void 0,l)})}createNodeMesh(t){const e=this,n=this.json.nodes[t];return void 0===n.mesh?null:e.getDependency("mesh",n.mesh).then(function(t){const i=e._getNodeRef(e.meshCache,n.mesh,t);return void 0!==n.weights&&i.traverse(function(t){if(t.isMesh)for(let e=0,i=n.weights.length;e<i;e++)t.morphTargetInfluences[e]=n.weights[e]}),i})}loadNode(t){const e=this.extensions,n=this,i=this.json.nodes[t],r=i.name?n.createUniqueName(i.name):"";return function(){const e=[],r=n._invokeOne(function(e){return e.createNodeMesh&&e.createNodeMesh(t)});return r&&e.push(r),void 0!==i.camera&&e.push(n.getDependency("camera",i.camera).then(function(t){return n._getNodeRef(n.cameraCache,i.camera,t)})),n._invokeAll(function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)}).forEach(function(t){e.push(t)}),Promise.all(e)}().then(function(s){let o;if(o=!0===i.isBone?new yg:s.length>1?new Fm:1===s.length?s[0]:new ld,o!==s[0])for(let t=0,e=s.length;t<e;t++)o.add(s[t]);if(i.name&&(o.userData.name=i.name,o.name=r),j_(o,i),i.extensions&&G_(e,o,i),void 0!==i.matrix){const t=new zh;t.fromArray(i.matrix),o.applyMatrix4(t)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);return n.associations.set(o,{type:"nodes",index:t}),o})}loadScene(t){const e=this.json,n=this.extensions,i=this.json.scenes[t],r=this,s=new Fm;i.name&&(s.name=r.createUniqueName(i.name)),j_(s,i),i.extensions&&G_(n,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(J_(o[l],s,e,r));return Promise.all(a).then(function(){return s})}}function J_(t,e,n,i){const r=n.nodes[t];return i.getDependency("node",t).then(function(t){if(void 0===r.skin)return t;let e;return i.getDependency("skin",r.skin).then(function(t){e=t;const n=[];for(let r=0,s=e.joints.length;r<s;r++)n.push(i.getDependency("node",e.joints[r]));return Promise.all(n)}).then(function(n){return t.traverse(function(t){if(!t.isMesh)return;const i=[],r=[];for(let s=0,o=n.length;s<o;s++){const t=n[s];if(t){i.push(t);const n=new zh;void 0!==e.inverseBindMatrices&&n.fromArray(e.inverseBindMatrices.array,16*s),r.push(n)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[s])}t.bind(new bg(i,r),t.matrixWorld)}),t})}).then(function(t){e.add(t);const s=[];if(r.children){const e=r.children;for(let r=0,o=e.length;r<o;r++)s.push(J_(e[r],t,n,i))}return Promise.all(s)})}function $_(t,e,n){const i=e.attributes,r=[];function s(e,i){return n.getDependency("accessor",e).then(function(e){t.setAttribute(i,e)})}for(const o in i){const e=U_[o]||o.toLowerCase();e in t.attributes||r.push(s(i[o],e))}if(void 0!==e.indices&&!t.index){const i=n.getDependency("accessor",e.indices).then(function(e){t.setIndex(e)});r.push(i)}return j_(t,e),function(t,e,n){const i=e.attributes,r=new ch;if(void 0===i.POSITION)return;{const t=n.json.accessors[i.POSITION],e=t.min,s=t.max;if(void 0===e||void 0===s)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new oh(e[0],e[1],e[2]),new oh(s[0],s[1],s[2])),t.normalized){const e=Y_(k_[t.componentType]);r.min.multiplyScalar(e),r.max.multiplyScalar(e)}}const s=e.targets;if(void 0!==s){const t=new oh,e=new oh;for(let i=0,r=s.length;i<r;i++){const r=s[i];if(void 0!==r.POSITION){const i=n.json.accessors[r.POSITION],s=i.min,o=i.max;if(void 0!==s&&void 0!==o){if(e.setX(Math.max(Math.abs(s[0]),Math.abs(o[0]))),e.setY(Math.max(Math.abs(s[1]),Math.abs(o[1]))),e.setZ(Math.max(Math.abs(s[2]),Math.abs(o[2]))),i.normalized){const t=Y_(k_[i.componentType]);e.multiplyScalar(t)}t.max(e)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(t)}t.boundingBox=r;const o=new Ah;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,t.boundingSphere=o}(t,e,n),Promise.all(r).then(function(){return void 0!==e.targets?function(t,e,n){let i=!1,r=!1;for(let a=0,l=e.length;a<l;a++){const t=e[a];if(void 0!==t.POSITION&&(i=!0),void 0!==t.NORMAL&&(r=!0),i&&r)break}if(!i&&!r)return Promise.resolve(t);const s=[],o=[];for(let a=0,l=e.length;a<l;a++){const l=e[a];if(i){const e=void 0!==l.POSITION?n.getDependency("accessor",l.POSITION):t.attributes.position;s.push(e)}if(r){const e=void 0!==l.NORMAL?n.getDependency("accessor",l.NORMAL):t.attributes.normal;o.push(e)}}return Promise.all([Promise.all(s),Promise.all(o)]).then(function(e){const n=e[1];return i&&(t.morphAttributes.position=e[0]),r&&(t.morphAttributes.normal=n),t.morphTargetsRelative=!0,t})}(t,e.targets,n):t})}function Q_(t,e){let n=t.getIndex();if(null===n){const e=[],i=t.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(let t=0;t<i.count;t++)e.push(t);t.setIndex(e),n=t.getIndex()}const i=n.count-2,r=[];if(2===e)for(let o=1;o<=i;o++)r.push(n.getX(0)),r.push(n.getX(o)),r.push(n.getX(o+1));else for(let o=0;o<i;o++)o%2==0?(r.push(n.getX(o)),r.push(n.getX(o+1)),r.push(n.getX(o+2))):(r.push(n.getX(o+2)),r.push(n.getX(o+1)),r.push(n.getX(o)));r.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=t.clone();return s.setIndex(r),s}class K_{constructor(){this.meshName="",this.zhCityName="",this.enCityName="",this.zhDistrictName="",this.enDistrictName="",this.mesh3d=new lp,this.rgbColor={r:0,g:0,b:0},this.tone=0,this.height=0}construstor(t){Object.assign(this,t)}}const tx={apiKey:"AIzaSyChT9tx82H7b5j1DLIX_COmuddY7e4BEys",authDomain:"districtgraphic-tw-c9fd8.firebaseapp.com",databaseURL:"https://districtgraphic-tw-c9fd8-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"districtgraphic-tw-c9fd8",storageBucket:"districtgraphic-tw-c9fd8.appspot.com",messagingSenderId:"437268358720",appId:"1:437268358720:web:288a46cab25c1d982ba1a5",measurementId:"G-BHCP91SRB0"};var ex=n(2056);function nx(...t){if(1===t.length){const e=t[0];if((0,Xe.k)(e))return ix(e,null);if((0,ex.K)(e)&&Object.getPrototypeOf(e)===Object.prototype){const t=Object.keys(e);return ix(t.map(t=>e[t]),t)}}if("function"==typeof t[t.length-1]){const e=t.pop();return ix(t=1===t.length&&(0,Xe.k)(t[0])?t[0]:t,null).pipe((0,he.U)(t=>e(...t)))}return ix(t,null)}function ix(t,e){return new re.y(n=>{const i=t.length;if(0===i)return void n.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=(0,je.D)(t[a]);let c=!1;n.add(l.subscribe({next:t=>{c||(c=!0,o++),r[a]=t},error:t=>n.error(t),complete:()=>{s++,s!==i&&c||(o===i&&n.next(e?e.reduce((t,e,n)=>(t[e]=r[n],t),{}):r),n.complete())}}))}})}const rx=[{enDistrict:"Songshan",zhDistrict:"\u677e\u5c71\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Xinyi",zhDistrict:"\u4fe1\u7fa9\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Daan",zhDistrict:"\u5927\u5b89\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Zhongshan",zhDistrict:"\u4e2d\u5c71\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Zhongzheng",zhDistrict:"\u4e2d\u6b63\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Datong",zhDistrict:"\u5927\u540c\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Wanhua",zhDistrict:"\u842c\u83ef\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Wenshan",zhDistrict:"\u6587\u5c71\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Nangang",zhDistrict:"\u5357\u6e2f\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Neihu",zhDistrict:"\u5167\u6e56\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Shilin",zhDistrict:"\u58eb\u6797\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Beitou",zhDistrict:"\u5317\u6295\u5340",enCity:"Taipei_City",zhCity:"\u81fa\u5317\u5e02"},{enDistrict:"Banqiao",zhDistrict:"\u677f\u6a4b\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Sanchong",zhDistrict:"\u4e09\u91cd\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Zhonghe",zhDistrict:"\u4e2d\u548c\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Yonghe",zhDistrict:"\u6c38\u548c\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Xinzhuang",zhDistrict:"\u65b0\u838a\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Xindian",zhDistrict:"\u65b0\u5e97\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Tucheng",zhDistrict:"\u571f\u57ce\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Luzhou",zhDistrict:"\u8606\u6d32\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Xizhi",zhDistrict:"\u6c50\u6b62\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Shulin",zhDistrict:"\u6a39\u6797\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Tamsui",zhDistrict:"\u6de1\u6c34\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Yingge",zhDistrict:"\u9daf\u6b4c\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Sanxia",zhDistrict:"\u4e09\u5cfd\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Ruifang",zhDistrict:"\u745e\u82b3\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Wugu",zhDistrict:"\u4e94\u80a1\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Taishan",zhDistrict:"\u6cf0\u5c71\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Linkou",zhDistrict:"\u6797\u53e3\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Shenkeng",zhDistrict:"\u6df1\u5751\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Shiding",zhDistrict:"\u77f3\u7887\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Pinglin",zhDistrict:"\u576a\u6797\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Sanzhi",zhDistrict:"\u4e09\u829d\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Shimen",zhDistrict:"\u77f3\u9580\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Bali",zhDistrict:"\u516b\u91cc\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Pingxi",zhDistrict:"\u5e73\u6eaa\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Shuangxi",zhDistrict:"\u96d9\u6eaa\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Gongliao",zhDistrict:"\u8ca2\u5bee\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Jinshan",zhDistrict:"\u91d1\u5c71\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Wanli",zhDistrict:"\u842c\u91cc\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Wulai",zhDistrict:"\u70cf\u4f86\u5340",enCity:"New_Taipei_City",zhCity:"\u65b0\u5317\u5e02"},{enDistrict:"Taoyuan",zhDistrict:"\u6843\u5712\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Zhongli",zhDistrict:"\u4e2d\u58e2\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Daxi",zhDistrict:"\u5927\u6eaa\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Yangmei",zhDistrict:"\u694a\u6885\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Luzhu",zhDistrict:"\u8606\u7af9\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Dayuan",zhDistrict:"\u5927\u5712\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Guishan",zhDistrict:"\u9f9c\u5c71\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Bade",zhDistrict:"\u516b\u5fb7\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Longtan",zhDistrict:"\u9f8d\u6f6d\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Pingzhen",zhDistrict:"\u5e73\u93ae\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Xinwu",zhDistrict:"\u65b0\u5c4b\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Guanyin",zhDistrict:"\u89c0\u97f3\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Fuxing",zhDistrict:"\u5fa9\u8208\u5340",enCity:"Taoyuan_City",zhCity:"\u6843\u5712\u5e02"},{enDistrict:"Central",zhDistrict:"\u4e2d\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"East",zhDistrict:"\u6771\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"South",zhDistrict:"\u5357\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"West",zhDistrict:"\u897f\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"North",zhDistrict:"\u5317\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Xitun",zhDistrict:"\u897f\u5c6f\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Nantun",zhDistrict:"\u5357\u5c6f\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Beitun",zhDistrict:"\u5317\u5c6f\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Fengyuan",zhDistrict:"\u8c50\u539f\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Dongshi",zhDistrict:"\u6771\u52e2\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Dajia",zhDistrict:"\u5927\u7532\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Qingshui",zhDistrict:"\u6e05\u6c34\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Shalu",zhDistrict:"\u6c99\u9e7f\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Wuqi",zhDistrict:"\u68a7\u68f2\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Houli",zhDistrict:"\u540e\u91cc\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Shengang",zhDistrict:"\u795e\u5ca1\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Tanzi",zhDistrict:"\u6f6d\u5b50\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Daya",zhDistrict:"\u5927\u96c5\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Xinshe",zhDistrict:"\u65b0\u793e\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Shigang",zhDistrict:"\u77f3\u5ca1\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Waipu",zhDistrict:"\u5916\u57d4\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Daan",zhDistrict:"\u5927\u5b89\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Wuri",zhDistrict:"\u70cf\u65e5\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Dadu",zhDistrict:"\u5927\u809a\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Longjing",zhDistrict:"\u9f8d\u4e95\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Wufeng",zhDistrict:"\u9727\u5cf0\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Taiping",zhDistrict:"\u592a\u5e73\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Dali",zhDistrict:"\u5927\u91cc\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Heping",zhDistrict:"\u548c\u5e73\u5340",enCity:"Taichung_City",zhCity:"\u81fa\u4e2d\u5e02"},{enDistrict:"Xinying",zhDistrict:"\u65b0\u71df\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Yanshui",zhDistrict:"\u9e7d\u6c34\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Baihe",zhDistrict:"\u767d\u6cb3\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Liuying",zhDistrict:"\u67f3\u71df\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Houbi",zhDistrict:"\u5f8c\u58c1\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Dongshan",zhDistrict:"\u6771\u5c71\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Madou",zhDistrict:"\u9ebb\u8c46\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Xiaying",zhDistrict:"\u4e0b\u71df\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Liujia",zhDistrict:"\u516d\u7532\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Guantian",zhDistrict:"\u5b98\u7530\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Danei",zhDistrict:"\u5927\u5167\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Jiali",zhDistrict:"\u4f73\u91cc\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Xuejia",zhDistrict:"\u5b78\u7532\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Xigang",zhDistrict:"\u897f\u6e2f\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Qigu",zhDistrict:"\u4e03\u80a1\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Jiangjun",zhDistrict:"\u5c07\u8ecd\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Beimen",zhDistrict:"\u5317\u9580\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Xinhua",zhDistrict:"\u65b0\u5316\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Shanhua",zhDistrict:"\u5584\u5316\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Xinshi",zhDistrict:"\u65b0\u5e02\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Anding",zhDistrict:"\u5b89\u5b9a\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Shanshang",zhDistrict:"\u5c71\u4e0a\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Yujing",zhDistrict:"\u7389\u4e95\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Nanxi",zhDistrict:"\u6960\u897f\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Nanhua",zhDistrict:"\u5357\u5316\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Zuozhen",zhDistrict:"\u5de6\u93ae\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Rende",zhDistrict:"\u4ec1\u5fb7\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Guiren",zhDistrict:"\u6b78\u4ec1\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Guanmiao",zhDistrict:"\u95dc\u5edf\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Longqi",zhDistrict:"\u9f8d\u5d0e\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Yongkang",zhDistrict:"\u6c38\u5eb7\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"East",zhDistrict:"\u6771\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"South",zhDistrict:"\u5357\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"North",zhDistrict:"\u5317\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Annan",zhDistrict:"\u5b89\u5357\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Anping",zhDistrict:"\u5b89\u5e73\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"West_Central",zhDistrict:"\u4e2d\u897f\u5340",enCity:"Tainan_City",zhCity:"\u81fa\u5357\u5e02"},{enDistrict:"Yancheng",zhDistrict:"\u9e7d\u57d5\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Gushan",zhDistrict:"\u9f13\u5c71\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Zuoying",zhDistrict:"\u5de6\u71df\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Nanzi",zhDistrict:"\u6960\u6893\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Sanmin",zhDistrict:"\u4e09\u6c11\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Xinxing",zhDistrict:"\u65b0\u8208\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Qianjin",zhDistrict:"\u524d\u91d1\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Lingya",zhDistrict:"\u82d3\u96c5\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Qianzhen",zhDistrict:"\u524d\u93ae\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Qijin",zhDistrict:"\u65d7\u6d25\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Xiaogang",zhDistrict:"\u5c0f\u6e2f\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Fengshan",zhDistrict:"\u9cf3\u5c71\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Linyuan",zhDistrict:"\u6797\u5712\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Daliao",zhDistrict:"\u5927\u5bee\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Dashu",zhDistrict:"\u5927\u6a39\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Dashe",zhDistrict:"\u5927\u793e\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Renwu",zhDistrict:"\u4ec1\u6b66\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Niaosong",zhDistrict:"\u9ce5\u677e\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Gangshan",zhDistrict:"\u5ca1\u5c71\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Qiaotou",zhDistrict:"\u6a4b\u982d\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Yanchao",zhDistrict:"\u71d5\u5de2\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Tianliao",zhDistrict:"\u7530\u5bee\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Alian",zhDistrict:"\u963f\u84ee\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Luzhu",zhDistrict:"\u8def\u7af9\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Hunei",zhDistrict:"\u6e56\u5167\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Qieding",zhDistrict:"\u8304\u8423\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Yongan",zhDistrict:"\u6c38\u5b89\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Mituo",zhDistrict:"\u5f4c\u9640\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Ziguan",zhDistrict:"\u6893\u5b98\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Qishan",zhDistrict:"\u65d7\u5c71\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Meinong",zhDistrict:"\u7f8e\u6fc3\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Liugui",zhDistrict:"\u516d\u9f9c\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Jiaxian",zhDistrict:"\u7532\u4ed9\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Shanlin",zhDistrict:"\u6749\u6797\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Neimen",zhDistrict:"\u5167\u9580\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Maolin",zhDistrict:"\u8302\u6797\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Taoyuan",zhDistrict:"\u6843\u6e90\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Namaxia",zhDistrict:"\u90a3\u746a\u590f\u5340",enCity:"Kaohsiung_City",zhCity:"\u9ad8\u96c4\u5e02"},{enDistrict:"Yilan",zhDistrict:"\u5b9c\u862d\u5e02",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Luodong",zhDistrict:"\u7f85\u6771\u93ae",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Suao",zhDistrict:"\u8607\u6fb3\u93ae",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Toucheng",zhDistrict:"\u982d\u57ce\u93ae",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Jiaoxi",zhDistrict:"\u7901\u6eaa\u9109",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Zhuangwei",zhDistrict:"\u58ef\u570d\u9109",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Yuanshan",zhDistrict:"\u54e1\u5c71\u9109",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Dongshan",zhDistrict:"\u51ac\u5c71\u9109",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Wujie",zhDistrict:"\u4e94\u7d50\u9109",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Sanxing",zhDistrict:"\u4e09\u661f\u9109",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Datong",zhDistrict:"\u5927\u540c\u9109",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Nanao",zhDistrict:"\u5357\u6fb3\u9109",enCity:"Yilan_County",zhCity:"\u5b9c\u862d\u7e23"},{enDistrict:"Zhubei",zhDistrict:"\u7af9\u5317\u5e02",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Zhudong",zhDistrict:"\u7af9\u6771\u93ae",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Xinpu",zhDistrict:"\u65b0\u57d4\u93ae",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Hukou",zhDistrict:"\u6e56\u53e3\u9109",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Xinfeng",zhDistrict:"\u65b0\u8c50\u9109",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Qionglin",zhDistrict:"\u828e\u6797\u9109",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Hengshan",zhDistrict:"\u6a6b\u5c71\u9109",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Beipu",zhDistrict:"\u5317\u57d4\u9109",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Baoshan",zhDistrict:"\u5bf6\u5c71\u9109",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Guanxi",zhDistrict:"\u95dc\u897f\u93ae",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Emei",zhDistrict:"\u5ce8\u7709\u9109",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Jianshi",zhDistrict:"\u5c16\u77f3\u9109",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Wufeng",zhDistrict:"\u4e94\u5cf0\u9109",enCity:"Hsinchu_County",zhCity:"\u65b0\u7af9\u7e23"},{enDistrict:"Miaoli",zhDistrict:"\u82d7\u6817\u5e02",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Yuanli",zhDistrict:"\u82d1\u88e1\u93ae",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Tongxiao",zhDistrict:"\u901a\u9704\u93ae",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Zhunan",zhDistrict:"\u7af9\u5357\u93ae",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Toufen",zhDistrict:"\u982d\u4efd\u5e02",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Houlong",zhDistrict:"\u5f8c\u9f8d\u93ae",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Zhuolan",zhDistrict:"\u5353\u862d\u93ae",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Dahu",zhDistrict:"\u5927\u6e56\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Gongguan",zhDistrict:"\u516c\u9928\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Tongluo",zhDistrict:"\u9285\u947c\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Nanzhuang",zhDistrict:"\u5357\u5e84\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Touwu",zhDistrict:"\u982d\u5c4b\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Sanyi",zhDistrict:"\u4e09\u7fa9\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Xihu",zhDistrict:"\u897f\u6e56\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Zaoqiao",zhDistrict:"\u9020\u6a4b\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Sanwan",zhDistrict:"\u4e09\u7063\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Shitan",zhDistrict:"\u7345\u6f6d\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Taian",zhDistrict:"\u6cf0\u5b89\u9109",enCity:"Miaoli_County",zhCity:"\u82d7\u6817\u7e23"},{enDistrict:"Changhua",zhDistrict:"\u5f70\u5316\u5e02",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Lukang",zhDistrict:"\u9e7f\u6e2f\u93ae",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Hemei",zhDistrict:"\u548c\u7f8e\u93ae",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Xianxi",zhDistrict:"\u7dda\u897f\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Shengang",zhDistrict:"\u4f38\u6e2f\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Fuxing",zhDistrict:"\u798f\u8208\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Xiushui",zhDistrict:"\u79c0\u6c34\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Huatan",zhDistrict:"\u82b1\u58c7\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Fenyuan",zhDistrict:"\u82ac\u5712\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Yuanlin",zhDistrict:"\u54e1\u6797\u5e02",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Xihu",zhDistrict:"\u6eaa\u6e56\u93ae",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Tianzhong",zhDistrict:"\u7530\u4e2d\u93ae",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Dacun",zhDistrict:"\u5927\u6751\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Puyan",zhDistrict:"\u57d4\u9e7d\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Puxin",zhDistrict:"\u57d4\u5fc3\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Yongjing",zhDistrict:"\u6c38\u9756\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Shetou",zhDistrict:"\u793e\u982d\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Ershui",zhDistrict:"\u4e8c\u6c34\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Beidou",zhDistrict:"\u5317\u6597\u93ae",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Erlin",zhDistrict:"\u4e8c\u6797\u93ae",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Tianwei",zhDistrict:"\u7530\u5c3e\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Pitou",zhDistrict:"\u57e4\u982d\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Fangyuan",zhDistrict:"\u82b3\u82d1\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Dacheng",zhDistrict:"\u5927\u57ce\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Zhutang",zhDistrict:"\u7af9\u5858\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Xizhou",zhDistrict:"\u6eaa\u5dde\u9109",enCity:"Changhua_County",zhCity:"\u5f70\u5316\u7e23"},{enDistrict:"Nantou",zhDistrict:"\u5357\u6295\u5e02",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Puli",zhDistrict:"\u57d4\u91cc\u93ae",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Caotun",zhDistrict:"\u8349\u5c6f\u93ae",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Zhushan",zhDistrict:"\u7af9\u5c71\u93ae",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Jiji",zhDistrict:"\u96c6\u96c6\u93ae",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Mingjian",zhDistrict:"\u540d\u9593\u9109",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Lugu",zhDistrict:"\u9e7f\u8c37\u9109",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Zhongliao",zhDistrict:"\u4e2d\u5bee\u9109",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Yuchi",zhDistrict:"\u9b5a\u6c60\u9109",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Guoxing",zhDistrict:"\u570b\u59d3\u9109",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Shuili",zhDistrict:"\u6c34\u91cc\u9109",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Xinyi",zhDistrict:"\u4fe1\u7fa9\u9109",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Renai",zhDistrict:"\u4ec1\u611b\u9109",enCity:"Nantou_County",zhCity:"\u5357\u6295\u7e23"},{enDistrict:"Douliu",zhDistrict:"\u6597\u516d\u5e02",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Dounan",zhDistrict:"\u6597\u5357\u93ae",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Huwei",zhDistrict:"\u864e\u5c3e\u93ae",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Xiluo",zhDistrict:"\u897f\u87ba\u93ae",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Tuku",zhDistrict:"\u571f\u5eab\u93ae",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Beigang",zhDistrict:"\u5317\u6e2f\u93ae",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Gukeng",zhDistrict:"\u53e4\u5751\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Dapi",zhDistrict:"\u5927\u57e4\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Citong",zhDistrict:"\u83bf\u6850\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Linnei",zhDistrict:"\u6797\u5167\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Erlun",zhDistrict:"\u4e8c\u5d19\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Lunbei",zhDistrict:"\u5d19\u80cc\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Mailiao",zhDistrict:"\u9ea5\u5bee\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Dongshi",zhDistrict:"\u6771\u52e2\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Baozhong",zhDistrict:"\u8912\u5fe0\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Taixi",zhDistrict:"\u81fa\u897f\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Yuanchang",zhDistrict:"\u5143\u9577\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Sihu",zhDistrict:"\u56db\u6e56\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Kouhu",zhDistrict:"\u53e3\u6e56\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Shuilin",zhDistrict:"\u6c34\u6797\u9109",enCity:"Yunlin_County",zhCity:"\u96f2\u6797\u7e23"},{enDistrict:"Taibao",zhDistrict:"\u592a\u4fdd\u5e02",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Puzi",zhDistrict:"\u6734\u5b50\u5e02",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Budai",zhDistrict:"\u5e03\u888b\u93ae",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Dalin",zhDistrict:"\u5927\u6797\u93ae",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Minxiong",zhDistrict:"\u6c11\u96c4\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Xikou",zhDistrict:"\u6eaa\u53e3\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Xingang",zhDistrict:"\u65b0\u6e2f\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Liujiao",zhDistrict:"\u516d\u8173\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Dongshi",zhDistrict:"\u6771\u77f3\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Yizhu",zhDistrict:"\u7fa9\u7af9\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Lucao",zhDistrict:"\u9e7f\u8349\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Shuishang",zhDistrict:"\u6c34\u4e0a\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Zhongpu",zhDistrict:"\u4e2d\u57d4\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Zhuqi",zhDistrict:"\u7af9\u5d0e\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Meishan",zhDistrict:"\u6885\u5c71\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Fanlu",zhDistrict:"\u756a\u8def\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Dapu",zhDistrict:"\u5927\u57d4\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Alishan",zhDistrict:"\u963f\u91cc\u5c71\u9109",enCity:"Chiayi_County",zhCity:"\u5609\u7fa9\u7e23"},{enDistrict:"Pingtung",zhDistrict:"\u5c4f\u6771\u5e02",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Chaozhou",zhDistrict:"\u6f6e\u5dde\u93ae",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Donggang",zhDistrict:"\u6771\u6e2f\u93ae",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Hengchun",zhDistrict:"\u6046\u6625\u93ae",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Wandan",zhDistrict:"\u842c\u4e39\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Changzhi",zhDistrict:"\u9577\u6cbb\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Linluo",zhDistrict:"\u9e9f\u6d1b\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Jiuru",zhDistrict:"\u4e5d\u5982\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Ligang",zhDistrict:"\u91cc\u6e2f\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Yanpu",zhDistrict:"\u9e7d\u57d4\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Gaoshu",zhDistrict:"\u9ad8\u6a39\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Wanluan",zhDistrict:"\u842c\u5dd2\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Neipu",zhDistrict:"\u5167\u57d4\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Zhutian",zhDistrict:"\u7af9\u7530\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Xinpi",zhDistrict:"\u65b0\u57e4\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Fangliao",zhDistrict:"\u678b\u5bee\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Xinyuan",zhDistrict:"\u65b0\u5712\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Kanding",zhDistrict:"\u5d01\u9802\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Linbian",zhDistrict:"\u6797\u908a\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Nanzhou",zhDistrict:"\u5357\u5dde\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Jiadong",zhDistrict:"\u4f73\u51ac\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Liuqiu",zhDistrict:"\u7409\u7403\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Checheng",zhDistrict:"\u8eca\u57ce\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Manzhou",zhDistrict:"\u6eff\u5dde\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Fangshan",zhDistrict:"\u678b\u5c71\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Sandimen",zhDistrict:"\u4e09\u5730\u9580\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Wutai",zhDistrict:"\u9727\u81fa\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Majia",zhDistrict:"\u746a\u5bb6\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Taiwu",zhDistrict:"\u6cf0\u6b66\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Laiyi",zhDistrict:"\u4f86\u7fa9\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Chunri",zhDistrict:"\u6625\u65e5\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Shizi",zhDistrict:"\u7345\u5b50\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Mudan",zhDistrict:"\u7261\u4e39\u9109",enCity:"Pingtung_County",zhCity:"\u5c4f\u6771\u7e23"},{enDistrict:"Taitung",zhDistrict:"\u81fa\u6771\u5e02",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Chenggong",zhDistrict:"\u6210\u529f\u93ae",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Guanshan",zhDistrict:"\u95dc\u5c71\u93ae",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Beinan",zhDistrict:"\u5351\u5357\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Luye",zhDistrict:"\u9e7f\u91ce\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Chishang",zhDistrict:"\u6c60\u4e0a\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Donghe",zhDistrict:"\u6771\u6cb3\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Changbin",zhDistrict:"\u9577\u6ff1\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Taimali",zhDistrict:"\u592a\u9ebb\u91cc\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Dawu",zhDistrict:"\u5927\u6b66\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Ludao",zhDistrict:"\u7da0\u5cf6\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Haiduan",zhDistrict:"\u6d77\u7aef\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Yanping",zhDistrict:"\u5ef6\u5e73\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Jinfeng",zhDistrict:"\u91d1\u5cf0\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Daren",zhDistrict:"\u9054\u4ec1\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Lanyu",zhDistrict:"\u862d\u5dbc\u9109",enCity:"Taitung_County",zhCity:"\u81fa\u6771\u7e23"},{enDistrict:"Hualien",zhDistrict:"\u82b1\u84ee\u5e02",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Fenglin",zhDistrict:"\u9cf3\u6797\u93ae",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Yuli",zhDistrict:"\u7389\u91cc\u93ae",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Xincheng",zhDistrict:"\u65b0\u57ce\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Jian",zhDistrict:"\u5409\u5b89\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Shoufeng",zhDistrict:"\u58fd\u8c50\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Guangfu",zhDistrict:"\u5149\u5fa9\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Fengbin",zhDistrict:"\u8c50\u6ff1\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Ruisui",zhDistrict:"\u745e\u7a57\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Fuli",zhDistrict:"\u5bcc\u91cc\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Xiulin",zhDistrict:"\u79c0\u6797\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Wanrong",zhDistrict:"\u842c\u69ae\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Zhuoxi",zhDistrict:"\u5353\u6eaa\u9109",enCity:"Hualien_County",zhCity:"\u82b1\u84ee\u7e23"},{enDistrict:"Magong",zhDistrict:"\u99ac\u516c\u5e02",enCity:"Penghu_County",zhCity:"\u6f8e\u6e56\u7e23"},{enDistrict:"Huxi",zhDistrict:"\u6e56\u897f\u9109",enCity:"Penghu_County",zhCity:"\u6f8e\u6e56\u7e23"},{enDistrict:"Baisha",zhDistrict:"\u767d\u6c99\u9109",enCity:"Penghu_County",zhCity:"\u6f8e\u6e56\u7e23"},{enDistrict:"Xiyu",zhDistrict:"\u897f\u5dbc\u9109",enCity:"Penghu_County",zhCity:"\u6f8e\u6e56\u7e23"},{enDistrict:"Wangan",zhDistrict:"\u671b\u5b89\u9109",enCity:"Penghu_County",zhCity:"\u6f8e\u6e56\u7e23"},{enDistrict:"Qimei",zhDistrict:"\u4e03\u7f8e\u9109",enCity:"Penghu_County",zhCity:"\u6f8e\u6e56\u7e23"},{enDistrict:"Zhongzheng",zhDistrict:"\u4e2d\u6b63\u5340",enCity:"Keelung_City",zhCity:"\u57fa\u9686\u5e02"},{enDistrict:"Qidu",zhDistrict:"\u4e03\u5835\u5340",enCity:"Keelung_City",zhCity:"\u57fa\u9686\u5e02"},{enDistrict:"Nuannuan",zhDistrict:"\u6696\u6696\u5340",enCity:"Keelung_City",zhCity:"\u57fa\u9686\u5e02"},{enDistrict:"Renai",zhDistrict:"\u4ec1\u611b\u5340",enCity:"Keelung_City",zhCity:"\u57fa\u9686\u5e02"},{enDistrict:"Zhongshan",zhDistrict:"\u4e2d\u5c71\u5340",enCity:"Keelung_City",zhCity:"\u57fa\u9686\u5e02"},{enDistrict:"Anle",zhDistrict:"\u5b89\u6a02\u5340",enCity:"Keelung_City",zhCity:"\u57fa\u9686\u5e02"},{enDistrict:"Xinyi",zhDistrict:"\u4fe1\u7fa9\u5340",enCity:"Keelung_City",zhCity:"\u57fa\u9686\u5e02"},{enDistrict:"East",zhDistrict:"\u6771\u5340",enCity:"Hsinchu_City",zhCity:"\u65b0\u7af9\u5e02"},{enDistrict:"North",zhDistrict:"\u5317\u5340",enCity:"Hsinchu_City",zhCity:"\u65b0\u7af9\u5e02"},{enDistrict:"Xiangshan",zhDistrict:"\u9999\u5c71\u5340",enCity:"Hsinchu_City",zhCity:"\u65b0\u7af9\u5e02"},{enDistrict:"East",zhDistrict:"\u6771\u5340",enCity:"Chiayi_City",zhCity:"\u5609\u7fa9\u5e02"},{enDistrict:"West",zhDistrict:"\u897f\u5340",enCity:"Chiayi_City",zhCity:"\u5609\u7fa9\u5e02"},{enDistrict:"Nangan",zhDistrict:"\u5357\u7aff\u9109",enCity:"Lienchiang_County",zhCity:"\u9023\u6c5f\u7e23"},{enDistrict:"Beigan",zhDistrict:"\u5317\u7aff\u9109",enCity:"Lienchiang_County",zhCity:"\u9023\u6c5f\u7e23"},{enDistrict:"Juguang",zhDistrict:"\u8392\u5149\u9109",enCity:"Lienchiang_County",zhCity:"\u9023\u6c5f\u7e23"},{enDistrict:"Dongyin",zhDistrict:"\u6771\u5f15\u9109",enCity:"Lienchiang_County",zhCity:"\u9023\u6c5f\u7e23"},{enDistrict:"Jincheng",zhDistrict:"\u91d1\u57ce\u93ae",enCity:"Kinmen_County",zhCity:"\u91d1\u9580\u7e23"},{enDistrict:"Jinhu",zhDistrict:"\u91d1\u6e56\u93ae",enCity:"Kinmen_County",zhCity:"\u91d1\u9580\u7e23"},{enDistrict:"Jinsha",zhDistrict:"\u91d1\u6c99\u93ae",enCity:"Kinmen_County",zhCity:"\u91d1\u9580\u7e23"},{enDistrict:"Jinning",zhDistrict:"\u91d1\u5be7\u9109",enCity:"Kinmen_County",zhCity:"\u91d1\u9580\u7e23"},{enDistrict:"Lieyu",zhDistrict:"\u70c8\u5dbc\u9109",enCity:"Kinmen_County",zhCity:"\u91d1\u9580\u7e23"},{enDistrict:"Wuqiu",zhDistrict:"\u70cf\u5775\u9109",enCity:"Kinmen_County",zhCity:"\u91d1\u9580\u7e23"}];var sx=n(8569),ox=n(1906),ax=n(1055);class lx{constructor(t,e){this.compare=t,this.keySelector=e}call(t,e){return e.subscribe(new cx(t,this.compare,this.keySelector))}}class cx extends ae.L{constructor(t,e,n){super(t),this.keySelector=n,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}compare(t,e){return t===e}_next(t){let e;try{const{keySelector:n}=this;e=n?n(t):t}catch(i){return this.destination.error(i)}let n=!1;if(this.hasKey)try{const{compare:t}=this;n=t(this.key,e)}catch(i){return this.destination.error(i)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))}}class ux{constructor(t,e){this.observables=t,this.project=e}call(t,e){return e.subscribe(new hx(t,this.observables,this.project))}}class hx extends Je{constructor(t,e,n){super(t),this.observables=e,this.project=n,this.toRespond=[];const i=e.length;this.values=new Array(i);for(let r=0;r<i;r++)this.toRespond.push(r);for(let r=0;r<i;r++)this.add(Ke(this,e[r],void 0,r))}notifyNext(t,e,n){this.values[n]=e;const i=this.toRespond;if(i.length>0){const t=i.indexOf(n);-1!==t&&i.splice(t,1)}}notifyComplete(){}_next(t){if(0===this.toRespond.length){const e=[t,...this.values];this.project?this._tryProject(e):this.destination.next(e)}}_tryProject(t){let e;try{e=this.project.apply(this,t)}catch(n){return void this.destination.error(n)}this.destination.next(e)}}class dx{constructor(t){this.predicate=t}call(t,e){return e.subscribe(new px(t,this.predicate))}}class px extends ae.L{constructor(t,e){super(t),this.predicate=e,this.skipping=!0,this.index=0}_next(t){const e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)}tryCallPredicate(t){try{const e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(e){this.destination.error(e)}}}var fx=n(2346),mx=(n(2107),n(9098)),gx=n(8489),yx=n(9291);class vx extends We.xQ{constructor(t=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,n){super(),this.scheduler=n,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e,e===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(t){if(!this.isStopped){const e=this._events;e.push(t),e.length>this._bufferSize&&e.shift()}super.next(t)}nextTimeWindow(t){this.isStopped||(this._events.push(new _x(this._getNow(),t)),this._trimBufferThenGetEvents()),super.next(t)}_subscribe(t){const e=this._infiniteTimeWindow,n=e?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,r=n.length;let s;if(this.closed)throw new qe.N;if(this.isStopped||this.hasError?s=Un.w.EMPTY:(this.observers.push(t),s=new yx.W(this,t)),i&&t.add(t=new mx.ht(t,i)),e)for(let o=0;o<r&&!t.closed;o++)t.next(n[o]);else for(let o=0;o<r&&!t.closed;o++)t.next(n[o].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),s}_getNow(){return(this.scheduler||gx.c).now()}_trimBufferThenGetEvents(){const t=this._getNow(),e=this._bufferSize,n=this._windowTime,i=this._events,r=i.length;let s=0;for(;s<r&&!(t-i[s].time<n);)s++;return r>e&&(s=Math.max(s,r-e)),s>0&&i.splice(0,s),i}}class _x{constructor(t,e){this.time=t,this.value=e}}function xx(t,e,n){let i;return i=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},t=>t.lift(function({bufferSize:t=Number.POSITIVE_INFINITY,windowTime:e=Number.POSITIVE_INFINITY,refCount:n,scheduler:i}){let r,s,o=0,a=!1,l=!1;return function(c){let u;o++,!r||a?(a=!1,r=new vx(t,e,i),u=r.subscribe(this),s=c.subscribe({next(t){r.next(t)},error(t){a=!0,r.error(t)},complete(){l=!0,s=void 0,r.complete()}}),l&&(s=void 0)):u=r.subscribe(this),this.add(()=>{o--,u.unsubscribe(),u=void 0,s&&!l&&n&&0===o&&(s.unsubscribe(),s=void 0,r=void 0)})}}(i))}function bx(t,e){return e?dn(()=>t,e):dn(()=>t)}var wx=n(4187);const Cx=new i.OlP("angularfire2.auth.use-emulator"),Tx=new i.OlP("angularfire2.auth.settings"),Sx=new i.OlP("angularfire2.auth.tenant-id"),Mx=new i.OlP("angularfire2.auth.langugage-code"),Ex=new i.OlP("angularfire2.auth.use-device-language"),Ax=new i.OlP("angularfire.auth.persistence");let Dx=(()=>{class t{constructor(t,e,i,r,s,o,a,l,c,u){const h=new fx.HU(r),d=(0,fx.ss)(h),p=new We.xQ,f=(0,ie.of)(void 0).pipe((0,mx.QV)(h.outsideAngular),dn(()=>r.runOutsideAngular(()=>n.e(420).then(n.bind(n,7420)))),(0,he.U)(()=>(0,fx.on)(t,r,e)),(0,he.U)(t=>r.runOutsideAngular(()=>{const e=s,n=o;return(0,fx.sI)(`${t.name}.auth`,"AngularFireAuth",t,()=>{const i=r.runOutsideAngular(()=>t.auth());if(e&&i.useEmulator(`http://${e.join(":")}`),a&&(i.tenantId=a),i.languageCode=l,c&&i.useDeviceLanguage(),n)for(const[t,e]of Object.entries(n))i.settings[t]=e;return u&&i.setPersistence(u),i},[e,a,l,c,n,u])})),xx({bufferSize:1,refCount:!1}));if(function(t){return"server"===t}(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=(0,ie.of)(null);else{f.pipe(On()).subscribe();const t=f.pipe(dn(t=>t.getRedirectResult().then(t=>t,()=>null)),d,xx({bufferSize:1,refCount:!1})),e=t=>new re.y(e=>({unsubscribe:r.runOutsideAngular(()=>t(e))})),n=f.pipe(dn(t=>e(t.onAuthStateChanged.bind(t)))),i=f.pipe(dn(t=>e(t.onIdTokenChanged.bind(t))));this.authState=t.pipe(bx(n),(0,wx.R)(h.outsideAngular),(0,mx.QV)(h.insideAngular)),this.user=t.pipe(bx(i),(0,wx.R)(h.outsideAngular),(0,mx.QV)(h.insideAngular)),this.idToken=this.user.pipe(dn(t=>t?(0,je.D)(t.getIdToken()):(0,ie.of)(null))),this.idTokenResult=this.user.pipe(dn(t=>t?(0,je.D)(t.getIdTokenResult()):(0,ie.of)(null))),this.credential=(0,ox.T)(t,p,this.authState.pipe(le(t=>!t))).pipe((0,he.U)(t=>(null==t?void 0:t.user)?t:null),(0,wx.R)(h.outsideAngular),(0,mx.QV)(h.insideAngular))}return(0,fx.pX)(this,f,r,{spy:{apply:(t,e,n)=>{(t.startsWith("signIn")||t.startsWith("createUser"))&&n.then(t=>p.next(t))}}})}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(fx.Dh),i.LFG(fx.xv,8),i.LFG(i.Lbi),i.LFG(i.R0b),i.LFG(Cx,8),i.LFG(Tx,8),i.LFG(Sx,8),i.LFG(Mx,8),i.LFG(Ex,8),i.LFG(Ax,8))},t.\u0275prov=i.Yz7({factory:function(){return new t(i.LFG(fx.Dh),i.LFG(fx.xv,8),i.LFG(i.Lbi),i.LFG(i.R0b),i.LFG(Cx,8),i.LFG(Tx,8),i.LFG(Sx,8),i.LFG(Mx,8),i.LFG(Ex,8),i.LFG(Ax,8))},token:t,providedIn:"any"}),t})();(0,fx.GT)(Dx,[{app:null,applyActionCode:null,checkActionCode:null,confirmPasswordReset:null,createUserWithEmailAndPassword:null,currentUser:null,fetchSignInMethodsForEmail:null,isSignInWithEmailLink:null,getRedirectResult:null,languageCode:null,settings:null,onAuthStateChanged:null,onIdTokenChanged:null,sendSignInLinkToEmail:null,sendPasswordResetEmail:null,setPersistence:null,signInAndRetrieveDataWithCredential:null,signInAnonymously:null,signInWithCredential:null,signInWithCustomToken:null,signInWithEmailAndPassword:null,signInWithPhoneNumber:null,signInWithEmailLink:null,signInWithPopup:null,signInWithRedirect:null,signOut:null,tenantId:null,updateCurrentUser:null,useDeviceLanguage:null,useEmulator:null,verifyPasswordResetCode:null}]);var Px=n(1858);function Lx(t){return null==t}function Rx(t){return"function"==typeof t.set}function Ix(t,e){return Rx(e)?e:t.ref(e)}function Nx(t,e){if("string"==typeof t)return e.stringCase();if(Rx(t))return e.firebaseCase();if("function"==typeof t.exportVal)return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof t)}function kx(t,e,n="on",i=sx.z){return new re.y(r=>{let s=null;return s=t[n](e,(t,e)=>{i.schedule(()=>{r.next({snapshot:t,prevKey:e})}),"once"===n&&i.schedule(()=>r.complete())},t=>{i.schedule(()=>r.error(t))}),"on"===n?{unsubscribe(){null!=s&&t.off(e,s)}}:{unsubscribe(){}}}).pipe((0,he.U)(t=>{const{snapshot:n,prevKey:i}=t;let r=null;return n.exists()&&(r=n.key),{type:e,payload:n,prevKey:i,key:r}}),(0,ax.B)())}function Ox(t,e){const n=t.length;for(let i=0;i<n;i++)if(t[i].payload.key===e)return i;return-1}function zx(t,e){const{payload:n,prevKey:i,key:r}=e,s=Ox(t,r),o=function(t,e){if(Lx(e))return 0;{const n=Ox(t,e);return-1===n?t.length:n+1}}(t,i);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let n=null;e.payload.forEach(e=>{const i={payload:e,type:"value",prevKey:n,key:e.key};return n=e.key,t=[...t,i],!1})}return t;case"child_added":if(s>-1){const r=t[s-1];(r&&r.key||null)!==i&&(t=t.filter(t=>t.payload.key!==n.key)).splice(o,0,e)}else{if(null==i)return[e,...t];(t=t.slice()).splice(o,0,e)}return t;case"child_removed":return t.filter(t=>t.payload.key!==n.key);case"child_changed":return t.map(t=>t.payload.key===r?e:t);case"child_moved":if(s>-1){const e=t.splice(s,1)[0];return(t=t.slice()).splice(o,0,e),t}return t;default:return t}}function Fx(t){return(Lx(t)||0===t.length)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function Ux(t,e,n){return function(t,e,n){return kx(t,"value","once",n).pipe(dn(i=>{const r=[(0,ie.of)(i)];return e.forEach(e=>r.push(kx(t,e,"on",n))),(0,ox.T)(...r).pipe(_n(zx,[]))}),t=>t.lift(new lx(void 0,void 0)))}(t,e=Fx(e),n)}function Hx(t,e,n){const i=(e=Fx(e)).map(e=>kx(t,e,"on",n));return(0,ox.T)(...i)}function Bx(t,e){return function(n,i){return Nx(n,{stringCase:()=>t.child(n)[e](i),firebaseCase:()=>n[e](i),snapshotCase:()=>n.ref[e](i)})}}function Vx(t,e){return function(){return kx(t,"value","on",e)}}const Gx=new i.OlP("angularfire2.realtimeDatabaseURL"),jx=new i.OlP("angularfire2.database.use-emulator");let Wx=(()=>{class t{constructor(t,e,n,i,r,s,o){this.schedulers=new fx.HU(r),this.keepUnstableUntilFirst=(0,fx.ss)(this.schedulers);const a=s,l=(0,fx.on)(t,r,e);!Px.Z.auth&&o&&(0,fx.yq)(),this.database=(0,fx.sI)(`${l.name}.database.${n}`,"AngularFireDatabase",l,()=>{const t=r.runOutsideAngular(()=>l.database(n||void 0));return a&&t.useEmulator(...a),t},[a])}list(t,e){const n=this.schedulers.ngZone.runOutsideAngular(()=>Ix(this.database,t));let i=n;return e&&(i=e(n)),function(t,e){const n=e.schedulers.outsideAngular,i=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:Bx(i,"update"),set:Bx(i,"set"),push:t=>i.push(t),remove:(r=i,function(t){return t?Nx(t,{stringCase:()=>r.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):r.remove()}),snapshotChanges:i=>Ux(t,i,n).pipe(e.keepUnstableUntilFirst),stateChanges:i=>Hx(t,i,n).pipe(e.keepUnstableUntilFirst),auditTrail:i=>function(t,e,n){return function(t,e,n){return function(t,e){return kx(t,"value","on",e).pipe((0,he.U)(t=>{let e;return t.payload.forEach(t=>(e=t.key,!1)),{data:t,lastKeyToLoad:e}}))}(t,n).pipe(function(...t){return e=>{let n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new ux(t,n))}}(e),(0,he.U)(([t,e])=>{const n=t.lastKeyToLoad,i=e.map(t=>t.key);return{actions:e,lastKeyToLoad:n,loadedKeys:i}}),(i=t=>-1===t.loadedKeys.indexOf(t.lastKeyToLoad),t=>t.lift(new dx(i))),(0,he.U)(t=>t.actions));var i}(t,Hx(t,e).pipe(_n((t,e)=>[...t,e],[])),n)}(t,i,n).pipe(e.keepUnstableUntilFirst),valueChanges:(i,r)=>Ux(t,i,n).pipe((0,he.U)(t=>t.map(t=>r&&r.idField?Object.assign(Object.assign({},t.payload.val()),{[r.idField]:t.key}):t.payload.val())),e.keepUnstableUntilFirst)};var r}(i,this)}object(t){const e=this.schedulers.ngZone.runOutsideAngular(()=>Ix(this.database,t));return i=this,{query:n=e,snapshotChanges:()=>Vx(n,i.schedulers.outsideAngular)().pipe(i.keepUnstableUntilFirst),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>Vx(n,i.schedulers.outsideAngular)().pipe(i.keepUnstableUntilFirst,(0,he.U)(t=>t.payload.exists()?t.payload.val():null))};var n,i}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(fx.Dh),i.LFG(fx.xv,8),i.LFG(Gx,8),i.LFG(i.Lbi),i.LFG(i.R0b),i.LFG(jx,8),i.LFG(Cx,8))},t.\u0275prov=i.Yz7({factory:function(){return new t(i.LFG(fx.Dh),i.LFG(fx.xv,8),i.LFG(Gx,8),i.LFG(i.Lbi),i.LFG(i.R0b),i.LFG(jx,8),i.LFG(Cx,8))},token:t,providedIn:"any"}),t})(),qx=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({providers:[Wx]}),t})(),Zx=(()=>{class t{constructor(t,e,n,i){this.httpclient=t,this.location=e,this.db=n,this.route=i,this.districtsEnZhMap=rx,this.googleSheetId="",this.addBaseUrl=t=>this.location.prepareExternalUrl(t),this.getGoogleSheetIdFromUrl=t=>t.replace("https://docs.google.com/spreadsheets","").split("/")[2]+"",this.pushMapToFirebase=(t,e,n)=>(console.log(t,t.requireHeightDimension,t.requireToneDimension),this.db.list("maps").push({mapName:t.mapTitle,mapDescription:t.mapDescriptionInput,HeightDimensionTitle:t.heightTitle,HeightDimensionUnit:t.heightUnit,ToneDimensionTitle:t.toneTitle,ToneDimensionUnit:t.toneUnit,MaxToneHex:e.endColor,MinToneHex:e.startColor,author:t.authorName,authorEmail:t.authorEmail,sourceUrl:n.urlLink,sourceData:"",createDate:(new Date).toString(),mapUrl:"null",requireHeightDimension:t.requireHeightDimension.toString(),requireToneDimension:t.requireToneDimension.toString()})),this.setMapRefAsUrlToFirebase=(t,e)=>{t.child("mapUrl").set(e,()=>{console.log("window.location.origin, window.location",window.location.origin,window.location,this.addBaseUrl(""))})},this.findWeatherValue=(t,e)=>{const n=t.weatherElement.find(t=>t.elementName===e);return n?n.elementValue:(console.error("No weather element found!"),"-99")},this.findLocationValue=(t,e)=>{const n=t.parameter.find(t=>t.parameterName===e);return n?n.parameterValue:(console.log("No location parameter found!"),"")},this.getWeatherInfo=()=>{const t=(new ve).append("Authorization","CWB-58C1E113-D5B9-45A0-9295-BB080D302D68").append("elementName","H_24R").append("elementName","D_TX");return this.httpclient.get("https://opendata.cwb.gov.tw/api/v1/rest/datastore/O-A0001-001",{params:t}).pipe(this.convertWeatherApiToDistrictGraphData,this.filterMalfunctionStation,this.averageHeightInDuplicateDistrict,this.averageToneInDuplicateDistrict,this.filterDuplicatedDistrict)},this.getWeatherForcast=()=>nx([this.getCityForcast("003"),this.getCityForcast("007"),this.getCityForcast("011"),this.getCityForcast("015"),this.getCityForcast("019"),this.getCityForcast("023"),this.getCityForcast("027"),this.getCityForcast("031"),this.getCityForcast("035"),this.getCityForcast("039"),this.getCityForcast("043"),this.getCityForcast("047"),this.getCityForcast("051"),this.getCityForcast("055"),this.getCityForcast("059"),this.getCityForcast("063"),this.getCityForcast("067"),this.getCityForcast("071"),this.getCityForcast("075"),this.getCityForcast("079"),this.getCityForcast("083"),this.getCityForcast("087")]).pipe((0,he.U)(t=>t.flat())),this.getCityForcast=t=>{const e=`https://opendata.cwb.gov.tw/api/v1/rest/datastore/F-D0047-${t}`,n=(new ve).append("Authorization","CWB-58C1E113-D5B9-45A0-9295-BB080D302D68").append("elementName","WeatherDescription");return this.httpclient.get(e,{params:n}).pipe(this.convertCloudForcastToDistrictGraphData)},this.convertCloudForcastToDistrictGraphData=(0,he.U)(t=>this.converForcastLocations(t.records.locations[0].location).map(e=>{const n=(e.weatherElement[0].elementValue.match(/\u964d\u96e8\u6a5f\u7387 \d+/g)||["-99"])[0].replace("\u964d\u96e8\u6a5f\u7387 ",""),i=(e.weatherElement[0].elementValue.match(/\u7d1a\(\u6bcf\u79d2\d+/g)||["-99"])[0].replace("\u7d1a(\u6bcf\u79d2","");return{cityName:t.records.locations[0].locationsName,districtName:e.locationName,height:+i,tone:+n}})),this.converForcastLocations=t=>t.map(t=>({lat:t.lat,locationName:t.locationName,lon:t.lon,parameter:[{parameterName:"datasetDescription",parameterValue:"String"}],stationId:"0",time:{},weatherElement:[{elementName:t.weatherElement[0].time[0].elementValue[0].measures,elementValue:t.weatherElement[0].time[0].elementValue[0].value}]})),this.averageHeightInDuplicateDistrict=(0,he.U)(t=>{const e=[];return t.map(t=>{const n=e.filter(e=>e.districtName===t.districtName&&e.cityName===t.cityName);if(void 0!==n){const i=this.getAverageHeight([...n,t]);n.forEach(t=>{t.height=i}),t.height=i,e.push(t)}else e.push(t)}),e}),this.averageToneInDuplicateDistrict=(0,he.U)(t=>{const e=[];return t.map(t=>{const n=e.filter(e=>e.districtName===t.districtName&&e.cityName===t.cityName);if(void 0!==n){const i=this.getAverageTone([...n,t]);n.forEach(t=>{t.tone=i}),t.tone=i,e.push(t)}else e.push(t)}),e}),this.filterDuplicatedDistrict=(0,he.U)(t=>{let e=[];return t.forEach(t=>{!e.some(e=>e.cityName===t.cityName&&e.districtName===t.districtName)&&e.push(t)}),e}),this.getGoogleSheetInfo=(t="1ydqYElUX25OfRwThdtlFLFN_Opww7tAUebjIcj_bX1Q")=>(console.log("googeSheetId: ",t),this.httpclient.get(`https://docs.google.com/spreadsheets/d/${t}/gviz/tq?`).pipe(this.convertGoogleSheetToDistrictGraphData,this.filterMalfunctionStation,this.averageHeightInDuplicateDistrict,this.averageToneInDuplicateDistrict,this.filterDuplicatedDistrict)),this.getMapDataFromFirebase=t=>this.db.list("maps").valueChanges().pipe(this.addWeatherMap(),this.addCloudMap(),(0,he.U)(e=>e.filter(e=>e.mapUrl===t)[0])),this.getAllMapsFromFirebase=()=>this.db.list("maps").valueChanges().pipe(this.addWeatherMap(),this.addCloudMap()),this.addWeatherMap=()=>(0,he.U)(t=>{const e={HeightDimensionTitle:"\u4eca\u65e5\u964d\u96e8\u91cf",HeightDimensionUnit:"\u6beb\u7c73",MaxToneHex:"EEF588",MinToneHex:"70a7f3",ToneDimensionTitle:"\u672c\u65e5\u6700\u9ad8\u6eab",ToneDimensionUnit:"\u5ea6C",author:"\u4f0d\u746a\u65af",authorEmail:"fareastsunflower@gmail.com",mapName:"\u53f0\u7063\u5929\u6c23\u8cc7\u8a0a\u5730\u5716",mapUrl:"weather",sourceData:"https://opendata.cwb.gov.tw/dist/opendata-swagger.html",sourceUrl:"https://opendata.cwb.gov.tw/dist/opendata-swagger.html",createDate:new Date,requireHeightDimension:"true",requireToneDimension:"true",mapDescription:"\u900f\u904e\u6c23\u8c61\u5c40Opendata\uff0c\u80fd\u5920\u53d6\u5f97\u6bcf\u5c0f\u6642\u66f4\u65b0\u4e00\u6b21\u7684\u6c23\u8c61\u8cc7\u6599\n\u984f\u8272\u4ee3\u8868\u6bcf\u5c0f\u6642\u6700\u9ad8\u6eab\u5ea6\uff0c\u9ad8\u5ea6\u4ee3\u8868\u6bcf\u5c0f\u6642\u964d\u96e8\u91cf\n\u8cc7\u6599\u4f86\u6e90\u662f\u6c23\u8c61\u5c40\u63d0\u4f9b\u7684\u8cc7\u6599\u5537\uff01",liveStream:"true"};return t.push(e),t}),this.addCloudMap=()=>(0,he.U)(t=>{const e={HeightDimensionTitle:"\u98a8\u901f",HeightDimensionUnit:"\u516c\u5c3a/\u79d2",MaxToneHex:"EEF588",MinToneHex:"70a7f3",ToneDimensionTitle:"\u964d\u96e8\u6a5f\u7387",ToneDimensionUnit:"%",author:"\u4f0d\u746a\u65af",authorEmail:"fareastsunflower@gmail.com",mapName:"\u53f0\u7063\u5373\u6642\u96f2\u5716",mapUrl:"cloud",sourceData:"https://opendata.cwb.gov.tw/dist/opendata-swagger.html",sourceUrl:"https://opendata.cwb.gov.tw/dist/opendata-swagger.html",createDate:new Date,requireHeightDimension:"true",requireToneDimension:"true",mapDescription:"\u900f\u904e\u6c23\u8c61\u5c40Opendata\uff0c\u80fd\u5920\u53d6\u5f97\u6bcf\u5c0f\u6642\u66f4\u65b0\u4e00\u6b21\u7684\u6c23\u8c61\u8cc7\u6599\n\u984f\u8272\u4ee3\u8868\u6bcf\u5c0f\u6642\u6700\u9ad8\u6eab\u5ea6\uff0c\u9ad8\u5ea6\u4ee3\u8868\u6bcf\u5c0f\u6642\u964d\u96e8\u91cf\n\u8cc7\u6599\u4f86\u6e90\u662f\u6c23\u8c61\u5c40\u63d0\u4f9b\u7684\u8cc7\u6599\u5537\uff01",liveStream:"true"};return t.push(e),t}),this.convertWeatherApiToDistrictGraphData=(0,he.U)(t=>t.records.location.map(t=>{const e=this.findWeatherValue(t,"H_24R"),n=this.findWeatherValue(t,"D_TX"),i=this.findLocationValue(t,"TOWN");return{cityName:this.findLocationValue(t,"CITY"),districtName:i,height:+e,tone:+n,meshText:void 0}})),this.convertCloudReportToDistrictGraphData=(0,he.U)(t=>t.records.location.map(t=>{const e=this.findWeatherValue(t,"Weather"),n=e.includes("\u6674")?3:e.includes("\u591a\u96f2")?2:e.includes("\u9670")?1:0,i=(this.findWeatherValue(t,"H_UVI"),this.findLocationValue(t,"TOWN"));return{cityName:this.findLocationValue(t,"CITY"),districtName:i,height:0,tone:+n,meshText:void 0}})),this.convertGoogleSheetToDistrictGraphData=(0,he.U)(t=>{console.log("Google Sheet Rawdata",t);const e=t.table.rows.filter((t,e)=>"\u7e23\u5e02"!==t.c[0].v).map((t,e)=>{let n="",i="",r=0,s=0;return t.c?(t.c[0]?t.c[0].v&&"#N/A"!==t.c[0].v?(n=t.c[0].v,n=n.replace("\u53f0","\u81fa"),"\u6843\u5712\u7e23"===n&&(n="\u6843\u5712\u5e02",console.warn("\u6843\u5712\u7e23\u5df2\u5347\u683c\u70ba\u76f4\u8f44\u5e02\uff0c\u6545\u4fee\u6539\u70ba\u6843\u5712\u5e02")),"\u81fa\u5317\u7e23"===n&&(n="\u65b0\u5317\u5e02",console.warn("\u81fa\u5317\u7e23\u5df2\u5347\u683c\u70ba\u76f4\u8f44\u5e02\uff0c\u6545\u4fee\u6539\u70ba\u65b0\u5317\u5e02"))):alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e+1}\u884c\u7684\u7e23\u5e02\u540d\u7a31\u51fa\u73fe\u932f\u8aa4\uff01`):alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e+1}\u884c\u7684\u7e23\u5e02\u540d\u7a31\u51fa\u73fe\u932f\u8aa4\uff01\u8acb\u78ba\u5b9a\u6709\u586b\u4e0a\u503c`),t.c[1]?t.c[0].v&&"#N/A"!==t.c[0].v?(i=t.c[1].v,i=i.replace("\u53f0","\u81fa"),"\u982d\u4efd\u93ae"===i&&(i="\u982d\u4efd\u5e02",console.warn("\u6843\u5712\u7e23\u5df2\u5347\u683c\u70ba\u76f4\u8f44\u5e02\uff0c\u6545\u4fee\u6539\u70ba\u6843\u5712\u5e02")),"\u54e1\u6797\u93ae"===i&&(i="\u54e1\u6797\u5e02",console.warn("\u54e1\u6797\u93ae\u5df2\u5347\u683c\u70ba\u7e23\u8f44\u5e02\uff0c\u6545\u4fee\u6539\u70ba\u54e1\u6797\u5e02")),"\u5ce8\u5d4b\u9109"===i&&(i="\u5ce8\u7709\u9109",console.warn("\u5ce8\u5d4b\u9109\u70ba\u5ce8\u7709\u9109\u7684\u5225\u7a31\uff0c\u7d71\u4e00\u6539\u6210\u5ce8\u7709\u9109")),"\u901a\u5bb5\u93ae"===i&&(i="\u901a\u9704\u93ae",console.warn("\u901a\u5bb5\u93ae\u70ba\u901a\u9704\u93ae\u7684\u5225\u7a31\uff0c\u7d71\u4e00\u6539\u6210\u901a\u9704\u93ae")),"\u6eaa\u6d32\u9109"===i&&(i="\u6eaa\u5dde\u9109",console.warn("\u6eaa\u5dde\u9109\u70ba\u6eaa\u6d32\u9109\u7684\u5225\u7a31\uff0c\u7d71\u4e00\u6539\u6210\u6eaa\u5dde\u9109")),i.includes("\u6771\u6c99")&&alert("\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u6709\u6771\u6c99\u74b0\u7901\uff0c\u76ee\u524d\u4e0d\u652f\u63f4\u6771\u6c99\u74b0\u7901\u7684\u8cc7\u6599\u5448\u73fe\uff0c\u8acb\u5728Google\u8868\u55ae\u8acb\u79fb\u9664\u8a72\u7b46\u8cc7\u6599"),"\u5357\u6c99"===i&&alert("\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u6709\u5357\u6c99\u74b0\u7901\uff0c\u76ee\u524d\u4e0d\u652f\u63f4\u6771\u6c99\u74b0\u7901\u7684\u8cc7\u6599\u5448\u73fe\uff0c\u8acb\u5728Google\u8868\u55ae\u8acb\u79fb\u9664\u8a72\u7b46\u8cc7\u6599")):alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e+1}\u884c\u7684\u9109\u93ae\u5e02\u5340\u540d\u7a31\u51fa\u73fe\u932f\u8aa4\uff01`):alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e+1}\u884c\u7684\u9109\u93ae\u5e02\u5340\u540d\u7a31\u51fa\u73fe\u932f\u8aa4\uff01\u8acb\u78ba\u5b9a\u6709\u586b\u4e0a\u503c`),t.c[2]?void 0!==t.c[2].v?isNaN(parseFloat(t.c[2].v))?(r=-99,alert(`\u532f\u5165\u8868\u55ae\u6642\u767c\u73fe${t.c[0].v}${t.c[1].v}\u7684\u9ad8\u5ea6\u8cc7\u6599\u4e0d\u662f\u6578\u5b57`)):r=+t.c[2].v:alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e+1}\u884c\u7684\u9ad8\u5ea6\u8cc7\u6599\u51fa\u73fe\u932f\u8aa4\uff01`):alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e+1}\u884c\u7684\u9ad8\u5ea6\u8cc7\u6599\u51fa\u73fe\u932f\u8aa4\uff01\u8acb\u78ba\u5b9a\u6709\u586b\u4e0a\u503c`),t.c[3]?void 0!==t.c[3].v?isNaN(parseFloat(t.c[3].v))?(s=-99,alert(`\u532f\u5165\u8868\u55ae\u6642\u767c\u73fe${t.c[0].v}${t.c[1].v}\u7684\u8272\u8abf\u8cc7\u6599\u4e0d\u662f\u6578\u5b57`)):s=+t.c[3].v:alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e+1}\u884c\u7684\u8272\u8abf\u8cc7\u6599\u51fa\u73fe\u932f\u8aa4\uff01`):alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e+1}\u884c\u7684\u8272\u8abf\u8cc7\u6599\u51fa\u73fe\u932f\u8aa4\uff01\u8acb\u78ba\u5b9a\u6709\u586b\u4e0a\u503c`),t.c[4]?t.c[4].v||alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e}\u884c\u7684\u7e23\u5e02\u540d\u7a31\u51fa\u73fe\u932f\u8aa4\uff01`):alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e}\u884c\u7684\u7e23\u5e02\u540d\u7a31\u51fa\u73fe\u932f\u8aa4\uff01\u8acb\u78ba\u5b9a\u6709\u586b\u4e0a\u503c`)):alert(`\u532f\u5165\u8868\u55ae\u6642\uff0c\u767c\u73fe\u7b2c${e}\u884c\u51fa\u73fe\u932f\u8aa4\uff01`),{cityName:n,districtName:i,height:r,tone:s,meshText:{title:"",subtitle:"",description:""}}});return console.log(e),e}),this.filterMalfunctionStation=(0,he.U)(t=>t.filter(t=>{const e=-99===t.tone||-99===t.height;return e&&console.log(`\u7ad9\u53f0 ${JSON.stringify(t)} \u904b\u4f5c\u4e0d\u6b63\u5e38`),!e})),this.getAverageHeight=t=>{let e=0;return t.forEach(t=>{e+=+t.height}),e/t.length},this.getAverageTone=t=>{let e=0;return t.forEach(t=>{e+=+t.tone}),e/t.length}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Pe),i.LFG(b),i.LFG(Wx),i.LFG(Xi))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Yx=(()=>{class t{constructor(){this.convert0to1ToHex=(t={r:.4,g:.4,b:.4})=>Math.floor(256*t.r).toString(16)+Math.floor(256*t.g).toString(16)+Math.floor(256*t.b).toString(16),this.convertHexTo0to1=t=>({r:parseInt(t.slice(0,2),16)/255,g:parseInt(t.slice(2,4),16)/255,b:parseInt(t.slice(4,6),16)/255}),this.blendHexColors=(t,e,n)=>{var i=parseInt(t.slice(1),16),r=parseInt(e.slice(1),16),s=i>>16,o=i>>8&255,a=255&i,l=r>>8&255,c=255&r;return""+(16777216+65536*(Math.round(((r>>16)-s)*n)+s)+256*(Math.round((l-o)*n)+o)+(Math.round((c-a)*n)+a)).toString(16).slice(1)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Xx=(()=>{class t{constructor(){this.createCanvasContext=()=>{const t=document.createElement("canvas");t.width=572,t.height=572;const e=t.getContext("2d");if(e)return e;throw new Error("canvas context not created")},this.normalize=(t,e)=>{for(let n=0;n<t.data.length;n++){const i=Math.floor(255/(255-e.bottom)*(t.data[n]-e.bottom));t.data[n]=i}return t},this.shrinkImageData=(t,e)=>{const n=[],i=(e,i)=>{const r=e*t.width+i;t.data[4*r]<=0||(t.data[4*(r+t.width)]<=0||t.data[4*(r+1)]<=0||t.data[4*(r-1)]<=0||t.data[4*(r-t.width)]<=0)&&n.push(4*r+0,4*r+1,4*r+2)},r=t=>{for(let e=0;e<t.height;e++)for(let n=0;n<t.width;n++)i(e,n)};for(let s=0;s<e;s++)r(t),n.forEach(e=>t.data[e]=0);return t},this.filterDarkness=(t,e)=>{for(let n=0;n<t.data.length;n+=4)t.data[n]<e&&(t.data[n]=0,t.data[n+1]=0,t.data[n+2]=0);return t}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Jx=(()=>{class t{constructor(t,e,n,i){var r=this;this.httpclient=t,this.weatherService=e,this.imageProcess=n,this.colorUtil=i,this.getCloudImage=()=>this.httpclient.get("https://us-central1-fluid-mote-320807.cloudfunctions.net/retriveCloudImage?type=realtime",{headers:{},responseType:"arraybuffer"}),this.getCloudLastUpdate=()=>this.httpclient.get("https://us-central1-fluid-mote-320807.cloudfunctions.net/retriveCloudImage?type=time"),this.initCloudMesh=Fs(function*(){return new Promise(function(){var t=Fs(function*(t){const e=yield r.getCloudImage().toPromise(),n=new Uint8ClampedArray(e);let i="";for(let r=0;r<n.length;r++)i+=String.fromCharCode(n[r]);const s=btoa(i),o=new Image,a=r.imageProcess.createCanvasContext();o.onload=()=>{if(!a)throw new Error("No context found");a.drawImage(o,0,0);const e=r.setupCloudMaterial(a),n=r.setupCloudGeo(),i=new lp(n,e);i.name="cloud",t(i)},o.src="data:image/jpeg;base64,"+s});return function(e){return t.apply(this,arguments)}}())}),this.initSkeletionCloudMmesh=()=>{const t=new Hy({color:16777215,transparent:!0,wireframe:!0}),e=this.setupCloudGeo(),n=new lp(e,t);return this.animateSkeleton(n,t),n},this.animateSkeleton=(t,e)=>{const n={opacity:.2};ru.to(n,{opacity:.7,onUpdate:()=>{e.opacity=n.opacity}}).delay(1).play().yoyo(!0).repeat(999)},this.setupCloudMaterial=t=>{const e=t.getImageData(0,0,572,572),n=e.data;this.imageProcess.filterDarkness(e,100),this.imageProcess.normalize(e,{bottom:100});let i=Uint8ClampedArray.from(n),r=Uint8ClampedArray.from(n);r=this.imageProcess.shrinkImageData(e,1).data;const s=new vg(i,e.width,e.height),o=new vg(r,e.width,e.height);return new Hy({color:16777215,transparent:!0,alphaMap:s,displacementMap:o,displacementScale:-.4,side:2,depthWrite:!1})},this.setupCloudGeo=()=>{const t=new Pp(17.4,17.4,572,572);return t.rotateY(Math.PI),t.rotateZ(.993*Math.PI),t.rotateX(.5*-Math.PI),t.translate(3.7,2,.4),t}}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(Pe),i.LFG(Zx),i.LFG(Xx),i.LFG(Yx))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),$x=(()=>{class t{constructor(){this.defaultMeshColor={r:1,g:1,b:1},this.findMeshFromIndex=(t,e,n)=>{let i=new lp;if(t.traverse(t=>{t.name===`${e[n].enDistrictName}+${e[n].enCityName}`&&(i=t)}),i)return i;throw new Error("can't traverse to get mesh info")},this.findDataByMeshName=(t,e)=>t.find(t=>`${t.enDistrictName}_${t.enCityName}`===e.name),this.transparentMeshes=(t,e=.6)=>{t.traverse(t=>this.transparentMesh(t,e))},this.transparentMesh=(t,e=.6)=>{if(t.isMesh){const n=t.material;1===e?n.transparent=!1:(n.transparent=!0,n.color=this.defaultMeshColor,n.opacity=e)}},this.paintMesh=(t,e)=>{t.material.color=e},this.resetMeshGeometry=t=>{t.scale.setY(1),t.position.setY(.5)},this.setDefaultMeshColor=t=>{this.defaultMeshColor=t}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Qx=(()=>{class t{constructor(t,e,n){this.meshUtilService=t,this.weatherService=e,this.colorUtil=n,this.enableDimension={height:!0,tone:!0},this.paintMapTextFromMesh=t=>{const e=this.textsMeshAndColor.filter(e=>e.textMesh.name.includes(t.name));0!==e.length&&e.forEach(t=>t.textMesh.material.color=this.colorUtil.convertHexTo0to1(t.textHexColor))},this.paintColorOnMapText=()=>{this.textsMeshAndColor.forEach(({textMesh:t,textHexColor:e})=>{t.material.color=this.colorUtil.convertHexTo0to1(e)})},this.transparentTextMesh=()=>{this.textsMeshAndColor.forEach(t=>this.meshUtilService.transparentMesh(t.textMesh))},this.enableDimensionText=t=>{t?(this.enableDimension.height="true"===t.requireHeightDimension,this.enableDimension.tone="true"===t.requireToneDimension):(this.enableDimension.height=!0,this.enableDimension.tone=!0)},this.setupAndAnimateTexts=(t,e,n,i,r)=>{const s=this.getExtremumMesh(i,"max","tone",r),o=this.getExtremumMesh(i,"min","tone",r),a=this.getExtremumMesh(i,"max","height",r);this.getExtremumMesh(i,"min","height",r),(new Uv).load(this.weatherService.addBaseUrl("/assets/jf-openhuninn-1.1_Regular_districts_words.json"),i=>{let l,c,u;if(0!==this.textsMeshAndColor.length&&(this.textsMeshAndColor.forEach(t=>t.textMesh.removeFromParent()),this.textsMeshAndColor=[]),this.enableDimension.height){const t=this.createTextMesh(i,a.mesh3d,a.zhDistrictName,a.rgbColor),e=this.createTextMesh(i,a.mesh3d,"\u6700\u9ad8 "+Math.round(10*+a.height)/10,a.rgbColor);n.add(t),n.add(e),l=this.createTextMeshGroup(t,e),n.add(l),this.animateText(l,a,r)}if(this.enableDimension.tone){const t=this.createTextMesh(i,s.mesh3d,s.zhDistrictName,s.rgbColor),e=this.createTextMesh(i,o.mesh3d,o.zhDistrictName,o.rgbColor),a=this.createTextMesh(i,s.mesh3d,"\u6700\u9ad8 "+Math.round(10*+s.tone)/10,s.rgbColor),l=this.createTextMesh(i,o.mesh3d,"\u6700\u4f4e "+Math.round(10*+o.tone)/10,o.rgbColor);n.add(t),n.add(e),n.add(a),n.add(l),c=this.createTextMeshGroup(t,a),u=this.createTextMeshGroup(e,l),n.add(c),n.add(u),this.animateText(c,s,r),this.animateText(u,o,r)}e.addEventListener("change",()=>{c&&c.children.forEach(e=>e.lookAt(t.position)),u&&u.children.forEach(e=>e.lookAt(t.position)),l&&l.children.forEach(e=>e.lookAt(t.position))})})},this.animateText=(t,e,n)=>{const[i,r]=this.getHeightRange(n),s={scaleY:1};ru.to(s,Object.assign(Object.assign({},{scaleY:20*((+e.height-r)/(i-r)||0)+1}),{duration:1.5,onUpdate:()=>{t.position.setY(s.scaleY/9)},ease:Xl.easeInOut})).delay(1).play()},this.getHeightRange=t=>{const e=t.sort((t,e)=>+t.height-+e.height);return[+e[e.length-1].height,+e[0].height]},this.getExtremumMesh=(t,e,n,i)=>{let r,s;if("tone"===n){const n=i.sort((t,e)=>+e.tone-+t.tone),o=this.getArrayIndexBy(e,n);r=this.meshUtilService.findMeshFromIndex(t,n,o),s=n[o]}else if("height"===n){const n=i.sort((t,e)=>+e.height-+t.height),o=this.getArrayIndexBy(e,n);r=this.meshUtilService.findMeshFromIndex(t,n,o),s=n[o]}if(s)return s;throw new Error(`cannot get the ${n} mesh`)},this.getArrayIndexBy=(t,e)=>{let n;return"max"===t?n=0:"min"===t&&(n=e.length-1),n||0},this.createTextMeshGroup=(t,e)=>{const n=new Fm;return e.scale.set(.6,.6,.6),e.translateY(1.7),e.name=e.name+" subtitle",t.translateY(1),t.name=t.name+" subtitle",n.add(t).add(e),n},this.createTextMesh=(t,e,n,i,r={size:.3,height:0})=>{let s;const o=new Uy(n,{font:t,height:r.height,size:r.size,curveSegments:1,bevelEnabled:!1}),a=this.colorUtil.blendHexColors("#"+this.colorUtil.convert0to1ToHex(i),"#000000",.3),l=new Vy({color:+("0x"+a),transparent:!0});return s=new lp(o,l),s.position.set(.1*e.position.x,.1*e.position.y,.1*e.position.z),s.name=`${e.name} text`,this.textsMeshAndColor.push({textMesh:s,districtMesh:e,textHexColor:a+""}),s},this.textsMeshAndColor=[]}}return t.\u0275fac=function(e){return new(e||t)(i.LFG($x),i.LFG(Zx),i.LFG(Yx))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Kx=(()=>{class t{constructor(t,e){this._renderer=t,this._elementRef=e,this.onChange=t=>{},this.onTouched=()=>{}}setProperty(t,e){this._renderer.setProperty(this._elementRef.nativeElement,t,e)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.Qsj),i.Y36(i.SBq))},t.\u0275dir=i.lG2({type:t}),t})(),tb=(()=>{class t extends Kx{}return t.\u0275fac=function(){let e;return function(n){return(e||(e=i.n5z(t)))(n||t)}}(),t.\u0275dir=i.lG2({type:t,features:[i.qOj]}),t})();const eb=new i.OlP("NgValueAccessor"),nb={provide:eb,useExisting:(0,i.Gpc)(()=>ib),multi:!0};let ib=(()=>{class t extends tb{writeValue(t){this.setProperty("checked",t)}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=i.n5z(t)))(n||t)}}(),t.\u0275dir=i.lG2({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(t,e){1&t&&i.NdJ("change",function(t){return e.onChange(t.target.checked)})("blur",function(){return e.onTouched()})},features:[i._Bn([nb]),i.qOj]}),t})();const rb={provide:eb,useExisting:(0,i.Gpc)(()=>ob),multi:!0},sb=new i.OlP("CompositionEventMode");let ob=(()=>{class t extends Kx{constructor(t,e,n){super(t,e),this._compositionMode=n,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const t=s()?s().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.Qsj),i.Y36(i.SBq),i.Y36(sb,8))},t.\u0275dir=i.lG2({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,e){1&t&&i.NdJ("input",function(t){return e._handleInput(t.target.value)})("blur",function(){return e.onTouched()})("compositionstart",function(){return e._compositionStart()})("compositionend",function(t){return e._compositionEnd(t.target.value)})},features:[i._Bn([rb]),i.qOj]}),t})();function ab(t){return null==t||0===t.length}const lb=new i.OlP("NgValidators"),cb=new i.OlP("NgAsyncValidators"),ub=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function hb(t){return null}function db(t){return null!=t}function pb(t){const e=(0,i.QGY)(t)?(0,je.D)(t):t;return(0,i.CqO)(e),e}function fb(t){let e={};return t.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function mb(t,e){return e.map(e=>e(t))}function gb(t){return t.map(t=>function(t){return!t.validate}(t)?t:e=>t.validate(e))}function yb(t){return null!=t?function(t){if(!t)return null;const e=t.filter(db);return 0==e.length?null:function(t){return fb(mb(t,e))}}(gb(t)):null}function vb(t){return null!=t?function(t){if(!t)return null;const e=t.filter(db);return 0==e.length?null:function(t){return nx(mb(t,e).map(pb)).pipe((0,he.U)(fb))}}(gb(t)):null}function _b(t,e){return null===t?[e]:Array.isArray(t)?[...t,e]:[t,e]}let xb=(()=>{class t{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=yb(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=vb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t}),t})(),bb=(()=>{class t extends xb{get formDirective(){return null}get path(){return null}}return t.\u0275fac=function(){let e;return function(n){return(e||(e=i.n5z(t)))(n||t)}}(),t.\u0275dir=i.lG2({type:t,features:[i.qOj]}),t})();class wb extends xb{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Cb{constructor(t){this._cd=t}is(t){var e,n;return!!(null===(n=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===n?void 0:n[t])}}let Tb=(()=>{class t extends Cb{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(wb,2))},t.\u0275dir=i.lG2({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,e){2&t&&i.ekj("ng-untouched",e.is("untouched"))("ng-touched",e.is("touched"))("ng-pristine",e.is("pristine"))("ng-dirty",e.is("dirty"))("ng-valid",e.is("valid"))("ng-invalid",e.is("invalid"))("ng-pending",e.is("pending"))},features:[i.qOj]}),t})(),Sb=(()=>{class t extends Cb{constructor(t){super(t)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(bb,10))},t.\u0275dir=i.lG2({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(t,e){2&t&&i.ekj("ng-untouched",e.is("untouched"))("ng-touched",e.is("touched"))("ng-pristine",e.is("pristine"))("ng-dirty",e.is("dirty"))("ng-valid",e.is("valid"))("ng-invalid",e.is("invalid"))("ng-pending",e.is("pending"))},features:[i.qOj]}),t})();function Mb(t,e){Ab(t,e),e.valueAccessor.writeValue(t.value),function(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Db(t,e)})}(t,e),function(t,e){const n=(t,n)=>{e.valueAccessor.writeValue(t),n&&e.viewToModelUpdate(t)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}(t,e),function(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Db(t,e),"submit"!==t.updateOn&&t.markAsTouched()})}(t,e),function(t,e){if(e.valueAccessor.setDisabledState){const n=t=>{e.valueAccessor.setDisabledState(t)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}(t,e)}function Eb(t,e){t.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function Ab(t,e){const n=function(t){return t._rawValidators}(t);null!==e.validator?t.setValidators(_b(n,e.validator)):"function"==typeof n&&t.setValidators([n]);const i=function(t){return t._rawAsyncValidators}(t);null!==e.asyncValidator?t.setAsyncValidators(_b(i,e.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();Eb(e._rawValidators,r),Eb(e._rawAsyncValidators,r)}function Db(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function Pb(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Lb="VALID",Rb="INVALID",Ib="PENDING",Nb="DISABLED";function kb(t){return(Ub(t)?t.validators:t)||null}function Ob(t){return Array.isArray(t)?yb(t):t||null}function zb(t,e){return(Ub(e)?e.asyncValidators:t)||null}function Fb(t){return Array.isArray(t)?vb(t):t||null}function Ub(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class Hb{constructor(t,e){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=Ob(this._rawValidators),this._composedAsyncValidatorFn=Fb(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Lb}get invalid(){return this.status===Rb}get pending(){return this.status==Ib}get disabled(){return this.status===Nb}get enabled(){return this.status!==Nb}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=Ob(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=Fb(t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Ib,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Nb,this.errors=null,this._forEachChild(e=>{e.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Lb,this._forEachChild(e=>{e.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(t=>t(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),this.status!==Lb&&this.status!==Ib||this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Nb:Lb}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Ib,this._hasOwnPendingAsyncValidator=!0;const e=pb(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(e=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(e,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function(t,e,n){if(null==e)return null;if(Array.isArray(e)||(e=e.split(".")),Array.isArray(e)&&0===e.length)return null;let i=t;return e.forEach(t=>{i=i instanceof Vb?i.controls.hasOwnProperty(t)?i.controls[t]:null:i instanceof Gb&&i.at(t)||null}),i}(this,t)}getError(t,e){const n=e?this.get(e):this;return n&&n.errors?n.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new i.vpe,this.statusChanges=new i.vpe}_calculateStatus(){return this._allControlsDisabled()?Nb:this.errors?Rb:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ib)?Ib:this._anyControlsHaveStatus(Rb)?Rb:Lb}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Ub(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class Bb extends Hb{constructor(t=null,e,n){super(kb(e),zb(n,e)),this._onChange=[],this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(t=>t(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=null,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){Pb(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){Pb(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class Vb extends Hb{constructor(t,e,n){super(kb(e),zb(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,n={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){this._checkAllValuesPresent(t),Object.keys(t).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(t[n],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((n,i)=>{n.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,n)=>(t[n]=e instanceof Bb?e.value:e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(t,e)=>!!e._syncPendingControls()||t);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[t])throw new Error(`Cannot find form control with name: ${t}.`)}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const n=this.controls[e];n&&t(n,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const n=this.controls[e];if(this.contains(e)&&t(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,n)=>((e.enabled||this.disabled)&&(t[n]=e.value),t))}_reduceChildren(t,e){let n=t;return this._forEachChild((t,i)=>{n=e(n,t,i)}),n}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class Gb extends Hb{constructor(t,e,n){super(kb(e),zb(n,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,n={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,n={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){this._checkAllValuesPresent(t),t.forEach((t,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((t,n)=>{this.at(n)&&this.at(n).patchValue(t,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((n,i)=>{n.reset(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t instanceof Bb?t.value:t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((t,e)=>!!e._syncPendingControls()||t,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_throwIfControlMissing(t){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(t))throw new Error(`Cannot find form control at index ${t}`)}_forEachChild(t){this.controls.forEach((e,n)=>{t(e,n)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_checkAllValuesPresent(t){this._forEachChild((e,n)=>{if(void 0===t[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const jb={provide:bb,useExisting:(0,i.Gpc)(()=>qb)},Wb=(()=>Promise.resolve(null))();let qb=(()=>{class t extends bb{constructor(t,e){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new i.vpe,this.form=new Vb({},yb(t),vb(e))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Wb.then(()=>{const e=this._findContainer(t.path);t.control=e.registerControl(t.name,t.control),Mb(t.control,t),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Wb.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name),Pb(this._directives,t)})}addFormGroup(t){Wb.then(()=>{const e=this._findContainer(t.path),n=new Vb({});(function(t,e){Ab(t,e)})(n,t),e.registerControl(t.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Wb.then(()=>{const e=this._findContainer(t.path);e&&e.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,e){Wb.then(()=>{this.form.get(t.path).setValue(e)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,e=this._directives,this.form._syncPendingControls(),e.forEach(t=>{const e=t.control;"submit"===e.updateOn&&e._pendingChange&&(t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1)}),this.ngSubmit.emit(t),!1;var e}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(lb,10),i.Y36(cb,10))},t.\u0275dir=i.lG2({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,e){1&t&&i.NdJ("submit",function(t){return e.onSubmit(t)})("reset",function(){return e.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[i._Bn([jb]),i.qOj]}),t})();const Zb={provide:wb,useExisting:(0,i.Gpc)(()=>Xb)},Yb=(()=>Promise.resolve(null))();let Xb=(()=>{class t extends wb{constructor(t,e,n,r){super(),this.control=new Bb,this._registered=!1,this.update=new i.vpe,this._parent=t,this._setValidators(e),this._setAsyncValidators(n),this.valueAccessor=function(t,e){if(!e)return null;let n,i,r;return Array.isArray(e),e.forEach(t=>{t.constructor===ob?n=t:Object.getPrototypeOf(t.constructor)===tb?i=t:r=t}),r||i||n||null}(0,r)}ngOnChanges(t){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in t&&this._updateDisabled(t),function(t,e){if(!t.hasOwnProperty("model"))return!1;const n=t.model;return!!n.isFirstChange()||!Object.is(e,n.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?[...this._parent.path,this.name]:[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Mb(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){Yb.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1})})}_updateDisabled(t){const e=t.isDisabled.currentValue,n=""===e||e&&"false"!==e;Yb.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(bb,9),i.Y36(lb,10),i.Y36(cb,10),i.Y36(eb,10))},t.\u0275dir=i.lG2({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[i._Bn([Zb]),i.qOj,i.TTD]}),t})(),Jb=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})(),$b=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({}),t})();const Qb={provide:lb,useExisting:(0,i.Gpc)(()=>Kb),multi:!0};let Kb=(()=>{class t{constructor(){this._required=!1}get required(){return this._required}set required(t){this._required=null!=t&&!1!==t&&"false"!=`${t}`,this._onChange&&this._onChange()}validate(t){return this.required?function(t){return ab(t.value)?{required:!0}:null}(t):null}registerOnValidatorChange(t){this._onChange=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(t,e){2&t&&i.uIk("required",e.required?"":null)},inputs:{required:"required"},features:[i._Bn([Qb])]}),t})();const tw={provide:lb,useExisting:(0,i.Gpc)(()=>ew),multi:!0};let ew=(()=>{class t{constructor(){this._enabled=!1}set email(t){this._enabled=""===t||!0===t||"true"===t,this._onChange&&this._onChange()}validate(t){return this._enabled?function(t){return ab(t.value)||ub.test(t.value)?null:{email:!0}}(t):null}registerOnValidatorChange(t){this._onChange=t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t,selectors:[["","email","","formControlName",""],["","email","","formControl",""],["","email","","ngModel",""]],inputs:{email:"email"},features:[i._Bn([tw])]}),t})();const nw={provide:lb,useExisting:(0,i.Gpc)(()=>iw),multi:!0};let iw=(()=>{class t{constructor(){this._validator=hb}ngOnChanges(t){"pattern"in t&&(this._createValidator(),this._onChange&&this._onChange())}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}_createValidator(){this._validator=function(t){if(!t)return hb;let e,n;return"string"==typeof t?(n="","^"!==t.charAt(0)&&(n+="^"),n+=t,"$"!==t.charAt(t.length-1)&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),t=>{if(ab(t.value))return null;const i=t.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}(this.pattern)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=i.lG2({type:t,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(t,e){2&t&&i.uIk("pattern",e.pattern?e.pattern:null)},inputs:{pattern:"pattern"},features:[i._Bn([nw]),i.TTD]}),t})(),rw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[$b]]}),t})(),sw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[rw]}),t})(),ow=(()=>{class t{transform(t,...e){const n=t.split("-");return`${n[1]}\u6708${n[2]}\u65e5${n[3]}\u9ede${n[4].slice(0,2)}\u5206`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=i.Yjl({name:"dashDate",type:t,pure:!0}),t})();function aw(t,e){1&t&&(i.TgZ(0,"p",114),i._uU(1),i.ALo(2,"dashDate"),i.qZA()),2&t&&(i.xp6(1),i.hij("",i.lcZ(2,1,"2021-10-06-19-30"),"\u524d\u66f4\u65b0\u96f2\u5716"))}function lw(t,e){if(1&t&&(i.TgZ(0,"div",118),i.TgZ(1,"h3",8),i._uU(2),i.qZA(),i.TgZ(3,"h3",14),i._uU(4),i.qZA(),i.qZA()),2&t){const t=i.oxw(2);i.xp6(2),i.Oqu(t.meshDataOnHtml.zhCityName),i.xp6(2),i.Oqu(t.meshDataOnHtml.enCityName.split("_").join(" "))}}function cw(t,e){if(1&t&&(i.TgZ(0,"div",53),i.TgZ(1,"h2",115),i._uU(2),i.qZA(),i.TgZ(3,"h2",116),i._uU(4),i.qZA(),i.YNc(5,lw,5,2,"div",117),i.qZA()),2&t){const t=i.oxw();i.xp6(2),i.Oqu(t.meshDataOnHtml.zhDistrictName),i.xp6(2),i.Oqu(t.meshDataOnHtml.enDistrictName),i.xp6(1),i.Q6J("ngIf",t.meshDataOnHtml)}}function uw(t,e){if(1&t&&(i.TgZ(0,"span"),i._uU(1),i.qZA()),2&t){const t=i.oxw(2);i.xp6(1),i.Oqu(t.interpretWind())}}function hw(t,e){if(1&t&&(i.TgZ(0,"div",119),i.TgZ(1,"div",120),i.TgZ(2,"small",8),i._uU(3),i.YNc(4,uw,2,1,"span",121),i.qZA(),i.TgZ(5,"div",122),i.TgZ(6,"h3",123),i._uU(7),i.ALo(8,"number"),i.qZA(),i.TgZ(9,"small",8),i._uU(10),i.qZA(),i.qZA(),i.qZA(),i.TgZ(11,"div",120),i.TgZ(12,"small",8),i._uU(13),i.qZA(),i.TgZ(14,"div",122),i.TgZ(15,"h3",123),i._uU(16),i.ALo(17,"number"),i.qZA(),i.TgZ(18,"small",8),i._uU(19),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&t){const t=i.oxw();i.xp6(1),i.Q6J("ngClass",t.requireHeightDimension?"":"d-none"),i.xp6(2),i.hij(" ",t.heightDimensionTitle," "),i.xp6(1),i.Q6J("ngIf","cloud"===t.mapId),i.xp6(3),i.Oqu(i.xi3(8,9,t.meshDataOnHtml.height,"1.1-1")),i.xp6(3),i.Oqu(t.heightDimensionUnit),i.xp6(1),i.Q6J("ngClass",t.requireToneDimension?"":"d-none"),i.xp6(2),i.Oqu(t.toneDimensionTitle),i.xp6(3),i.Oqu(i.xi3(17,12,t.meshDataOnHtml.tone,"1.1-1")),i.xp6(3),i.Oqu(t.toneDimensionUnit)}}const dw=function(t){return{color:t}};function pw(t,e){if(1&t&&(i.TgZ(0,"p",124),i._uU(1),i.ALo(2,"number"),i.ALo(3,"number"),i.qZA()),2&t){const t=i.oxw();i.Q6J("ngStyle",i.VKq(9,dw,t.isWeatherMap?"#0088DC":"#"+t.toneGradient.endColor)),i.xp6(1),i.AsE(" ",i.xi3(2,3,t.toneExtremum.min,"1.1-1")," ~ ",i.xi3(3,6,t.toneExtremum.max,"1.1-1")," ")}}function fw(t,e){if(1&t&&(i.TgZ(0,"p",125),i._uU(1),i.qZA()),2&t){const t=i.oxw();i.Q6J("ngStyle",i.VKq(3,dw,t.isWeatherMap?"#0088DC":"#"+t.toneGradient.endColor)),i.xp6(1),i.AsE(" ",t.toneDimensionTitle,"\u7bc4\u570d\uff08",t.toneDimensionUnit,"\uff09 ")}}function mw(t,e){if(1&t&&(i.TgZ(0,"p",124),i._uU(1),i.ALo(2,"number"),i.qZA()),2&t){const t=i.oxw();i.Q6J("ngStyle",i.VKq(5,dw,t.isWeatherMap?"#0088DC":"#"+t.toneGradient.endColor)),i.xp6(1),i.hij(" ",i.xi3(2,2,t.sumHeight,"1.1-1")," ")}}function gw(t,e){if(1&t&&(i.TgZ(0,"p",125),i._uU(1),i.qZA()),2&t){const t=i.oxw();i.Q6J("ngStyle",i.VKq(3,dw,t.isWeatherMap?"#0088DC":"#"+t.toneGradient.endColor)),i.xp6(1),i.AsE(" ",t.heightDimensionTitle,"\u52a0\u7e3d\uff08",t.heightDimensionUnit,"\uff09 ")}}function yw(t,e){1&t&&(i.TgZ(0,"span"),i._uU(1,"\u6b64\u70ba\u5fc5\u586b"),i.qZA())}function vw(t,e){1&t&&(i.TgZ(0,"span"),i._uU(1,"\u8acb\u8cbc\u4e0a\u6b63\u78ba\u7684Google\u8868\u55ae\u8d85\u9023\u7d50"),i.qZA())}function _w(t,e){if(1&t&&(i.TgZ(0,"p",126),i.YNc(1,yw,2,0,"span",121),i.YNc(2,vw,2,0,"span",121),i.qZA()),2&t){i.oxw();const t=i.MAs(79);i.xp6(1),i.Q6J("ngIf",null==t.errors?null:t.errors.required),i.xp6(1),i.Q6J("ngIf",null==t.errors?null:t.errors.pattern)}}function xw(t,e){1&t&&(i.TgZ(0,"span",127),i._uU(1,"\u6b64\u70ba\u5fc5\u586b"),i.qZA())}function bw(t,e){1&t&&(i.TgZ(0,"span"),i._uU(1,"\u8acb\u8cbc\u4e0a\u6b63\u78ba\u7684Email"),i.qZA())}function ww(t,e){if(1&t&&(i.TgZ(0,"p",126),i.YNc(1,bw,2,0,"span",121),i.qZA()),2&t){i.oxw();const t=i.MAs(106);i.xp6(1),i.Q6J("ngIf",null==t.errors?null:t.errors.email)}}function Cw(t,e){1&t&&(i.TgZ(0,"span",127),i._uU(1,"\u6b64\u70ba\u5fc5\u586b"),i.qZA())}function Tw(t,e){1&t&&(i.TgZ(0,"span",128),i._uU(1,"\u82e5\u4f7f\u7528\u4ed6\u4eba\u8cc7\u6599\u8a18\u5f97\u7559\u4e0b\u51fa\u8655\u5537\uff01"),i.qZA())}function Sw(t,e){1&t&&(i.TgZ(0,"span",127),i._uU(1,"\u81f3\u5c11\u8981\u6709\u4e00\u500b\u7dad\u5ea6"),i.qZA())}function Mw(t,e){1&t&&(i.TgZ(0,"span",127),i._uU(1,"\u6b64\u70ba\u5fc5\u586b"),i.qZA())}function Ew(t,e){1&t&&(i.TgZ(0,"span",127),i._uU(1,"\u6b64\u70ba\u5fc5\u586b"),i.qZA())}function Aw(t,e){1&t&&(i.TgZ(0,"span",127),i._uU(1,"\u6b64\u70ba\u5fc5\u586b"),i.qZA())}function Dw(t,e){1&t&&(i.TgZ(0,"span",127),i._uU(1,"\u6b64\u70ba\u5fc5\u586b"),i.qZA())}const Pw=function(t){return{"background-image":t}};function Lw(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"input",129),i.NdJ("click",function(){const e=i.CHM(t).index;return i.oxw().gradientSelectedIndex=e}),i.qZA()}if(2&t){const t=e.$implicit,n=e.index,r=i.oxw();i.Q6J("ngClass",r.gradientSelectedIndex==n?"gradient-selected":"")("ngStyle",i.VKq(2,Pw,"linear-gradient(to right,#"+t.startColor+", #"+t.endColor+")"))}}function Rw(t,e){1&t&&(i.TgZ(0,"span",140),i._uU(1," \u5373\u6642\u66f4\u65b0 "),i.O4$(),i.TgZ(2,"svg",141),i._UZ(3,"circle",142),i._UZ(4,"polygon",143),i.qZA(),i.qZA())}function Iw(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"a",130),i.NdJ("click",function(){const e=i.CHM(t).$implicit;return i.oxw().clickMapLink(e.mapUrl)}),i._UZ(1,"div",131),i.TgZ(2,"div",132),i.TgZ(3,"p",133),i._uU(4),i.YNc(5,Rw,5,0,"span",134),i.qZA(),i.TgZ(6,"p",135),i._uU(7),i.qZA(),i.qZA(),i.TgZ(8,"div",136),i.TgZ(9,"p",135),i._uU(10),i.qZA(),i.TgZ(11,"p",135),i._uU(12),i.ALo(13,"date"),i.qZA(),i.qZA(),i.TgZ(14,"div",137),i.O4$(),i.TgZ(15,"svg",138),i._UZ(16,"path",139),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=e.$implicit;i.xp6(1),i.Q6J("ngStyle",i.VKq(10,Pw,"linear-gradient(to top,#"+t.MaxToneHex+", #"+t.MinToneHex+")")),i.xp6(3),i.hij(" ",t.mapName," "),i.xp6(1),i.Q6J("ngIf",t.liveStream),i.xp6(2),i.AsE("\u5305\u542b ",t.ToneDimensionTitle?t.ToneDimensionTitle+"\u3001":""," ",t.HeightDimensionTitle," \u8cc7\u6599"),i.xp6(3),i.hij("",t.author," \u88fd\u4f5c"),i.xp6(2),i.Oqu(i.xi3(13,7,t.createDate,"MM/dd/yy"))}}const Nw=function(t,e){return{color:t,display:e}},kw=function(t){return{color:"#666666",display:t}};let Ow=(()=>{class t{constructor(t,e,n,r){this.weatherService=t,this.router=e,this.route=n,this.cloudService=r,this.showEditMapPopup=!1,this.showLinkPopup=!1,this.shareLink="",this.showCreateMapPopup=!1,this.showBrowseMapsPopup=!1,this.mapName="\u53f0\u7063\u5929\u6c23\u8cc7\u8a0a\u5730\u5716",this.author="\u4f0d\u746a\u65af",this.heightDimensionTitle="\u4eca\u65e5\u964d\u96e8\u91cf",this.heightDimensionUnit="\u6beb\u7c73",this.toneDimensionTitle="\u672c\u65e5\u6700\u9ad8\u6eab",this.toneDimensionUnit="\u5ea6C",this.requireToneDimension=!0,this.requireHeightDimension=!0,this.mapDescription="\u900f\u904e\u6c23\u8c61\u5c40Opendata\uff0c\u80fd\u5920\u53d6\u5f97\u6bcf\u5c0f\u6642\u66f4\u65b0\u4e00\u6b21\u7684\u6c23\u8c61\u8cc7\u6599\n\u984f\u8272\u4ee3\u8868\u6bcf\u5c0f\u6642\u6700\u9ad8\u6eab\u5ea6\uff0c\u9ad8\u5ea6\u4ee3\u8868\u6bcf\u5c0f\u6642\u964d\u96e8\u91cf\n\u8cc7\u6599\u4f86\u6e90\u662f\u6c23\u8c61\u5c40\u63d0\u4f9b\u7684\u8cc7\u6599\u5537\uff01",this.sourceUrl="https://docs.google.com/spreadsheets/d/1ydqYElUX25OfRwThdtlFLFN_Opww7tAUebjIcj_bX1Q/edit?usp=sharing",this.toneGradient={startColor:"70a7f3",endColor:"EEF588"},this.isWeatherMap=!0,this.gradientPickers=[{startColor:"F8FF8B",endColor:"F38461"},{startColor:"EEF588",endColor:"70A7F3"},{startColor:"FFB9D2",endColor:"88B4EF"},{startColor:"BF4A4A",endColor:"DC7EC7"},{startColor:"94F9C8",endColor:"89BBFF"}],this.gradientSelectedIndex=0,this.allMaps=[],this.mapId="weather",this.cloudLastUpdate="",this.htmlTextColor="",this.mouseHoverDetalessMesh=!1,this.mouseHoveAnyMesh=!1,this.toneExtremum={max:0,min:0},this.sumHeight=0,this.onMapChanged=new i.vpe,this.blurGraph=new i.vpe,this.openBrowseMaps=t=>{this.blurGraph.emit(!0),this.showBrowseMapsPopup=!this.showBrowseMapsPopup,t.blur(),this.weatherService.getAllMapsFromFirebase().subscribe(t=>{t=this.appendDate(t),t=this.sortMapByDate(t),this.allMaps=t})},this.appendDate=t=>t.map(t=>(t.createDate=new Date(t.createDate),t)),this.sortMapByDate=t=>t.sort((t,e)=>{const n=new Date(t.createDate);return new Date(e.createDate).getTime()-n.getTime()}),this.clickMapLink=t=>{this.router.navigate(["/maps",t]),this.onMapChanged.emit(t),this.blurGraph.emit(!1),this.showBrowseMapsPopup=!this.showBrowseMapsPopup},this.openCreateProcess=t=>{this.blurGraph.emit(!0),this.showCreateMapPopup=!this.showCreateMapPopup,t.blur()},this.submitUrl=t=>{this.showCreateMapPopup=!this.showCreateMapPopup,this.showEditMapPopup=!this.showEditMapPopup},this.clickSubmit=(t,e)=>{t.preventDefault(),e.click()},this.submitEditingMap=(t,e,n)=>{this.showEditMapPopup=!this.showEditMapPopup,this.showLinkPopup=!this.showLinkPopup,this.mapName=t.mapTitle,this.author=t.authorName,console.log(t),t.heightTitle||(t.heightTitle=""),t.toneTitle||(t.toneTitle=""),t.heightUnit||(t.heightUnit=""),t.toneUnit||(t.toneUnit="");const i=this.weatherService.pushMapToFirebase(t,e,n);if(i.key){const t=i.key;this.router.navigate(["/maps",t]),this.weatherService.setMapRefAsUrlToFirebase(i,t),this.shareLink=window.location.origin+this.weatherService.addBaseUrl("")+"maps/"+t,this.onMapChanged.emit(t)}},this.copyShareLink=(t,e)=>{t.children[1].innerHTML="\u8907\u88fd\u6210\u529f\uff01",navigator.clipboard.writeText(e)},this.interpretWind=()=>{if(!this.meshDataOnHtml)return"\u8b80\u53d6\u4e2d";const t=this.meshDataOnHtml.height;return t<.2?"0\u7d1a\u98a8(\u7159\u76f4\u4e0a)":t<1.5?"1\u7d1a\u98a8(\u7159\u793a\u98a8\u5411)":t<3.3?"2\u7d1a\u98a8(\u611f\u89ba\u6709\u98a8)":t<5.4?"3\u7d1a\u98a8(\u65cc\u65d7\u5c55\u958b)":t<7.9?"4\u7d1a\u98a8(\u5439\u8d77\u5875\u571f)":t<10.7?"5\u7d1a\u98a8(\u5c0f\u6a39\u6416\u64fa)":t<13.8?"6\u7d1a\u98a8(\u96fb\u7dda\u6709\u8072)":t<17.1?"7\u7d1a\u98a8(\u6b65\u884c\u56f0\u96e3)":t<20.7?"8\u7d1a\u98a8(\u6298\u6bc0\u6a39\u679d)":t<24.4?"9\u7d1a\u98a8(\u5c0f\u640d\u623f\u5c4b)":t<28.4?"10\u7d1a\u98a8(\u62d4\u8d77\u6a39\u6728)":t<32.6?"11\u7d1a\u98a8(\u640d\u6bc0\u666e\u904d)":"12\u7d1a\u98a8(\u6467\u6bc0\u5de8\u5927)"}}ngOnInit(){this.route.paramMap.subscribe(t=>{const e=t.get("id")||"";this.mapId=e,this.weatherService.getMapDataFromFirebase(e).subscribe(t=>{this.author=t.author,this.mapName=t.mapName,this.heightDimensionTitle=t.HeightDimensionTitle,this.heightDimensionUnit=t.HeightDimensionUnit,this.toneDimensionTitle=t.ToneDimensionTitle,this.toneDimensionUnit=t.ToneDimensionUnit,this.requireHeightDimension="true"===t.requireHeightDimension,this.requireToneDimension="true"===t.requireToneDimension,this.mapDescription=t.mapDescription,this.sourceUrl=t.sourceUrl,this.toneGradient={startColor:t.MinToneHex,endColor:t.MaxToneHex},this.isWeatherMap=!1}),"cloud"===this.mapId&&this.cloudService.getCloudLastUpdate().subscribe(t=>{this.cloudLastUpdate=t.cloudLastUpdate})})}ngAfterViewInit(){return Fs(function*(){})()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Zx),i.Y36(ys),i.Y36(Xi),i.Y36(Jx))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-graph-info"]],inputs:{htmlTextColor:["districtColor","htmlTextColor"],mouseHoverDetalessMesh:"mouseHoverDetalessMesh",mouseHoveAnyMesh:"mouseHoveAnyMesh",meshDataOnHtml:"meshDataOnHtml",toneExtremum:"toneExtremum",sumHeight:"sumHeight"},outputs:{onMapChanged:"onMapChanged",blurGraph:"blurGraph"},decls:200,vars:51,consts:[[1,"w-100","position-absolute","intercation-area","d-flex",3,"ngClass"],[1,"col-6","d-flex","flex-column"],[1,"overview-info","pb-5"],[1,"zh","mb-4","theme-font","font-size-s"],[1,"zh","pb-0","theme-font","font-size-m",2,"font-size","1.5rem"],["class","zh theme-font font-size-s",4,"ngIf"],[1,"zh","theme-font","d-flex"],[1,"zh","pe-2","font-size-s"],[1,"zh","font-size-s"],[1,"district-info","flex-grow-1","justify-content-around",3,"ngStyle"],["class","d-flex flex-column",4,"ngIf"],["class","",4,"ngIf"],[1,"flex-column",3,"ngStyle"],[1,"zh","font-size-m"],[1,"en","font-size-s"],[1,"mt-auto","d-flex","flex-column"],[1,"btn-secondary","px-4","py-2","mb-3","btn-secondary","theme-font","bg-transparent",3,"click"],[1,"btn","btn-primary","px-4","py-2","btn-primary",3,"click"],["openBtn",""],[1,"col-6","d-flex","flex-column","align-items-end","justify-content-end",3,"ngClass"],[1,"d-none","d-sm-flex","flex-column","flex-grow-1","align-items-end","ms-auto"],["type","button",1,"mb-2","legend","tone-gradient",3,"ngStyle"],["class","en theme-font font-size-m",3,"ngStyle",4,"ngIf"],["class","mb-2 theme-font-s-zh",3,"ngStyle",4,"ngIf"],[1,"text-end","map-description","theme-font-s-zh","mt-auto","d-flex"],["target","_blank",1,"py-2","d-flex","align-items-center",2,"pointer-events","all",3,"href"],[1,"pe-1","theme-font-s-zh"],["width","15","height","15","viewBox","0 0 15 15","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M11.25 8.125V11.875C11.25 12.2065 11.1183 12.5245 10.8839 12.7589C10.6495 12.9933 10.3315 13.125 10 13.125H3.125C2.79348 13.125 2.47554 12.9933 2.24112 12.7589C2.0067 12.5245 1.875 12.2065 1.875 11.875V5C1.875 4.66848 2.0067 4.35054 2.24112 4.11612C2.47554 3.8817 2.79348 3.75 3.125 3.75H6.875","stroke","#0088DC","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],["stroke","#0088DC","d","M9.375 1.875H13.125V5.625","stroke-linecap","round","stroke-width","1","stroke-linejoin","round"],["stroke","#0088DC","d","M6.25 8.75L13.125 1.875","stroke-linecap","round","stroke-width","1","stroke-linejoin","round"],[1,"h-100","w-100","position-fixed","popup-bg","min-height-70",3,"ngClass"],[1,"rounded-theme","justify-content-between","popup","m-auto","d-flex","flex-column",3,"ngSubmit"],["urlForm","ngForm"],[1,"pb-4","d-flex","justify-content-between","align-items-stretch"],[1,"zh","font-size-m","theme-font"],[1,"btn","bg-transparent","border-0",3,"click"],["closeUrlForm",""],["width","24","height","25","viewBox","0 0 24 25","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M18 6.5L6 18.5","stroke","#0088DC","stroke-opacity","0.69","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M6 6.5L18 18.5","stroke","#0088DC","stroke-opacity","0.69","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"d-flex","flex-column","justify-content-between","align-items-stretch"],[1,"mb-4","step-1","d-flex","flex-column"],[1,"text-center","w-100","d-flex","rounded-theme","btn-primary","btn-primary","my-auto"],["href","https://docs.google.com/spreadsheets/d/1ydqYElUX25OfRwThdtlFLFN_Opww7tAUebjIcj_bX1Q/copy","target","_blank",1,"justify-content-center","d-flex","align-items-center","w-100","text-white","p-2"],["width","18","height","18","viewBox","0 0 15 15","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M11.25 8.125V11.875C11.25 12.2065 11.1183 12.5245 10.8839 12.7589C10.6495 12.9933 10.3315 13.125 10 13.125H3.125C2.79348 13.125 2.47554 12.9933 2.24112 12.7589C2.0067 12.5245 1.875 12.2065 1.875 11.875V5C1.875 4.66848 2.0067 4.35054 2.24112 4.11612C2.47554 3.8817 2.79348 3.75 3.125 3.75H6.875","stroke","white","stroke-width","1","stroke-linecap","round","stroke-linejoin","round"],["stroke","white","d","M9.375 1.875H13.125V5.625","stroke-linecap","round","stroke-width","1","stroke-linejoin","round"],["stroke","white","d","M6.25 8.75L13.125 1.875","stroke-linecap","round","stroke-width","1","stroke-linejoin","round"],[1,"mb-4","d-flex","flex-column"],[1,"theme-font-s-zh","mb-2"],[1,"d-flex"],[1,"flex-grow-1","rounded-theme","bg-white","p-2",3,"src","srcset"],[1,"d-flex","flex-column"],[1,"flex-wrap","rounded-theme","d-flex","bg-white","p-2","input-container"],[1,"d-flex","flex-column","flex-grow-1"],["type","url","pattern","https://docs\\.google\\.com/spreadsheets/d/.+","placeholder","https://docs.google.com/spreadsheets/d/1ydqYElUX25OfRwThdtlFLFN_Opww7tAUebjIcj_bX1Q/edit?usp=sharing","name","urlLink","ngModel","","required","","pattern","https://docs\\.google\\.com/spreadsheets/d/.+",1,"p-2","m-2",3,"keydown.enter"],["urlLink","ngModel","urlLinkNativeTag",""],["class","text-danger theme-font-s-zh d-invisible",4,"ngIf"],["type","submit","name","goNextPopup","ngModel","\u88fd\u4f5c\u5730\u5716",1,"flex-grow-1","rounded-theme","btn-primary","py-2","m-2","px-4",3,"disabled"],["submitUrlForm",""],[1,"rounded-theme","popup","m-auto","d-flex","flex-column",3,"ngSubmit"],["editMapForm","ngForm"],[1,"pb-4","d-flex","justify-content-between","align-items-center"],[1,"zh","font-size-m","m-0aawsertyuuz","theme-font"],[1,"overflow-auto","vh-70","rounded-theme","pe-0","pe-sm-4","d-flex","flex-column","flex-sm-row"],[1,"pe-0","pe-sm-4"],[1,"rounded-theme","flex-column","d-flex","bg-white","p-4","pt-3","mb-4","input-container"],[1,"theme-font-s-zh","ps-2"],["type","url","placeholder","\u715e\u6c23\u7684\u738b\u5c0f\u660e","name","authorName","ngModel","","required","",1,"p-2"],["authorName","ngModel"],["class","text-danger theme-font-s-zh d-invisible m-0",4,"ngIf"],["value","","type","url","placeholder","1234@email.com","name","authorEmail","ngModel","","email","","pattern","[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$",1,"p-2"],["emailInput","ngModel"],["type","url","placeholder","\u715e\u6c23\u7684\u5730\u5716","name","mapTitle","ngModel","","required","",1,"p-2"],["mapTitle","ngModel"],["type","","placeholder","\u53ef\u8a3b\u660e\u51fa\u8655\u3001\u8072\u660e","name","mapDescriptionInput","ngModel","","value","",1,"p-2"],["mapDescriptionInput","ngModel"],["class","theme-font-s-zh theme-font-s-zh d-invisible m-0",4,"ngIf"],[1,"rounded-theme","flex-column","d-flex","bg-white","p-4","pt-3","mb-4"],[1,"form-check","pt-2","p-0","m-0"],["type","checkbox","ngModel","true","name","requireHeightDimension","id","requireHeightDimension",1,"ms-2","border-2","border","p-2","form-check-input"],["requireHeightInput","ngModel"],["for","requireHeightDimension",1,"p-1","theme-font-s-zh","d-flex","form-check-label"],["type","checkbox","ngModel","true","name","requireToneDimension","id","requireToneDimension",1,"ms-2","border-2","border","p-2","form-check-input"],["requireToneInput","ngModel"],["for","requireToneDimension",1,"p-1","theme-font-s-zh","d-flex","form-check-label"],["type","text","placeholder","\u5982\uff1a\u964d\u96e8\u91cf","name","heightTitle","ngModel","",1,"p-2",3,"disabled"],["heightTitle","ngModel"],["type","text","placeholder","\u5982\uff1a\u6beb\u7c73","name","heightUnit","ngModel","",1,"p-2",3,"disabled"],["heightUnit","ngModel"],["value","","type","text","placeholder","\u5982\uff1a\u6eab\u5ea6","name","toneTitle","ngModel","",1,"p-2",3,"disabled"],["toneTitle","ngModel"],["type","text","placeholder","\u5982\uff1a\u5ea6C","name","toneUnit","ngModel","",1,"p-2",3,"disabled"],["toneUnit","ngModel"],["type","button","class","mt-3 gradient-picker",3,"ngClass","ngStyle","click",4,"ngFor","ngForOf"],["type","submit","name","uploadBtn","ngModel","\u5efa\u7acb\u5730\u5716",1,"w-100","rounded-theme","btn-primary","px-4","py-2","btn-primary",3,"disabled"],[1,"h-100","w-100","position-fixed","popup-bg",3,"ngClass"],[1,"rounded-theme","justify-content-between","popup","m-auto","d-flex","flex-column"],["uploadedForm","ngForm"],[1,"pb-5","d-flex","justify-content-between","align-items-center"],[1,"rounded-theme","d-flex","bg-white","px-4","pt-4","input-container"],["type","text","value","q221e","name","mapLink",1,"share-link","h-100","p-2","me-3","d-flex","flex-column","flex-grow-1",3,"ngModel","ngModelChange"],["mapLink","ngModel"],[1,"d-flex","rounded-theme","btn-primary","px-3","py-2","mb-3",3,"click"],["copyLink",""],["width","20","height","20","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M20 9H11C9.89543 9 9 9.89543 9 11V20C9 21.1046 9.89543 22 11 22H20C21.1046 22 22 21.1046 22 20V11C22 9.89543 21.1046 9 20 9Z","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["d","M5 15H4C3.46957 15 2.96086 14.7893 2.58579 14.4142C2.21071 14.0391 2 13.5304 2 13V4C2 3.46957 2.21071 2.96086 2.58579 2.58579C2.96086 2.21071 3.46957 2 4 2H13C13.5304 2 14.0391 2.21071 14.4142 2.58579C14.7893 2.96086 15 3.46957 15 4V5","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"ps-2","font-size-s","text-white"],[1,"map-list","h-100","w-100","position-fixed","popup-bg","min-height-70",3,"ngClass"],[1,"pb-0","rounded-theme","rounded-theme","justify-content-between","popup","m-auto","d-flex","flex-column"],[1,"pe-0","pe-sm-4","list-container"],["class","mb-4 border-0 align-items-stretch rounded-theme d-flex flex-column flex-sm-row bg-white p-4","style","text-decoration: none; cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[1,"zh","theme-font","font-size-s"],[1,"zh","font-size-l"],[1,"en","font-size-l"],["class","d-flex flex-column pt-1",4,"ngIf"],[1,"d-flex","flex-column","pt-1"],[1,""],[3,"ngClass"],[4,"ngIf"],[1,"align-items-baseline","d-flex"],[1,"en","font-size-l","pe-1"],[1,"en","theme-font","font-size-m",3,"ngStyle"],[1,"mb-2","theme-font-s-zh",3,"ngStyle"],[1,"text-danger","theme-font-s-zh","d-invisible"],[1,"text-danger","theme-font-s-zh","d-invisible","m-0"],[1,"theme-font-s-zh","theme-font-s-zh","d-invisible","m-0"],["type","button",1,"mt-3","gradient-picker",3,"ngClass","ngStyle","click"],[1,"mb-4","border-0","align-items-stretch","rounded-theme","d-flex","flex-column","flex-sm-row","bg-white","p-4",2,"text-decoration","none","cursor","pointer",3,"click"],["type","button",1,"me-3","tone-gradient","gradient-selected",3,"ngStyle"],[1,"d-flex","flex-column","me-auto"],[1,"theme-font-m-zh","d-flex","align-items-center"],["class","badge live-badge font-size-s d-flex align-items-center ms-2",4,"ngIf"],[1,"theme-font-s-zh"],[1,"d-flex","flex-column","justify-content-end","text-start","text-sm-end"],[1,"align-items-center","px-2","d-none","d-sm-flex"],["width","25","height","25","viewBox","0 0 25 25","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M9.84131 18.9644L15.8413 12.9644L9.84131 6.96439","stroke","#0088DC","stroke-opacity","0.69","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"badge","live-badge","font-size-s","d-flex","align-items-center","ms-2"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","white","stroke-width","2","stroke-linecap","round","stroke-linejoin","round",1,"ms-2"],["cx","12","cy","12","r","10"],["points","10 8 16 12 10 16 10 8"]],template:function(t,e){if(1&t){const t=i.EpF();i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"p",3),i._uU(4,"\u53f0\u7063\u8cc7\u8a0a\u5716\u50cf\u5316 v1.1"),i.qZA(),i.TgZ(5,"h5",4),i._uU(6),i.qZA(),i.YNc(7,aw,3,3,"p",5),i.TgZ(8,"div",6),i.TgZ(9,"p",7),i._uU(10,"\u5730\u5716\u4f5c\u8005"),i.qZA(),i.TgZ(11,"p",8),i._uU(12),i.qZA(),i.qZA(),i.qZA(),i.TgZ(13,"div",9),i.YNc(14,cw,6,3,"div",10),i.YNc(15,hw,20,15,"div",11),i.qZA(),i.TgZ(16,"div",12),i.TgZ(17,"h3",13),i._uU(18,"\u7121\u89c0\u6e2c\u7ad9\u8cc7\u6599"),i.qZA(),i.TgZ(19,"h3",14),i._uU(20,"No Information In This District."),i.qZA(),i.qZA(),i.TgZ(21,"div",12),i.TgZ(22,"h3",13),i._uU(23,"\u79fb\u52d5\u6ed1\u9f20\u4ee5\u63a2\u7d22\u5404\u5340\u8cc7\u8a0a"),i.qZA(),i.TgZ(24,"h3",14),i._uU(25,"Explore by moving your mouse."),i.qZA(),i.qZA(),i.TgZ(26,"div",15),i.TgZ(27,"button",16),i.NdJ("click",function(){i.CHM(t);const n=i.MAs(30);return e.openBrowseMaps(n)}),i._uU(28,"\u700f\u89bd\u6240\u6709\u5730\u5716"),i.qZA(),i.TgZ(29,"button",17,18),i.NdJ("click",function(){i.CHM(t);const n=i.MAs(30);return e.openCreateProcess(n)}),i._uU(31,"\u5275\u5efa\u4f60\u7684\u5730\u5716\uff01"),i.qZA(),i.qZA(),i.qZA(),i.TgZ(32,"div",19),i.TgZ(33,"div",20),i._UZ(34,"div",21),i.YNc(35,pw,4,11,"p",22),i.YNc(36,fw,2,5,"p",23),i.YNc(37,mw,3,7,"p",22),i.YNc(38,gw,2,5,"p",23),i.TgZ(39,"p",24),i._uU(40),i.qZA(),i.qZA(),i.TgZ(41,"a",25),i.TgZ(42,"p",26),i._uU(43,"\u5730\u5716\u539f\u59cb\u8cc7\u6599"),i.qZA(),i.O4$(),i.TgZ(44,"svg",27),i._UZ(45,"path",28),i._UZ(46,"path",29),i._UZ(47,"path",30),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.kcU(),i.TgZ(48,"div",31),i.TgZ(49,"form",32,33),i.NdJ("ngSubmit",function(){i.CHM(t);const n=i.MAs(50);return e.submitUrl(n.value)}),i.TgZ(51,"div",34),i.TgZ(52,"h1",35),i._uU(53,"\u5efa\u7acb\u4f60\u7684\u5730\u5716"),i.qZA(),i.TgZ(54,"button",36,37),i.NdJ("click",function(){return e.blurGraph.emit(!1),e.showCreateMapPopup=!e.showCreateMapPopup}),i.O4$(),i.TgZ(56,"svg",38),i._UZ(57,"path",39),i._UZ(58,"path",40),i.qZA(),i.qZA(),i.qZA(),i.kcU(),i.TgZ(59,"div",41),i.TgZ(60,"div",42),i.TgZ(61,"div",43),i.TgZ(62,"a",44),i._uU(63," \u7b2c\u4e00\u6b65\uff1a\u8907\u88fd\u9019\u500b\u8868\u55ae "),i.O4$(),i.TgZ(64,"svg",45),i._UZ(65,"path",46),i._UZ(66,"path",47),i._UZ(67,"path",48),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.kcU(),i.TgZ(68,"div",49),i.TgZ(69,"p",50),i._uU(70,"\u7b2c\u4e8c\u6b65\uff1a\u5728\u8868\u55ae\u586b\u4e0a\u6578\u64da\u8cc7\u6599\uff0c\u4e26\u8907\u88fd\u516c\u958b\u8d85\u9023\u7d50"),i.qZA(),i.TgZ(71,"div",51),i._UZ(72,"img",52),i.qZA(),i.qZA(),i.TgZ(73,"div",53),i.TgZ(74,"p",50),i._uU(75,"\u7b2c\u4e09\u6b65\uff1a\u8cbc\u4e0a\u8868\u55ae\u7684\u8d85\u9023\u7d50"),i.qZA(),i.TgZ(76,"div",54),i.TgZ(77,"div",55),i.TgZ(78,"input",56,57),i.NdJ("keydown.enter",function(n){i.CHM(t);const r=i.MAs(83);return e.clickSubmit(n,r)}),i.qZA(),i.YNc(81,_w,3,2,"p",58),i.qZA(),i._UZ(82,"input",59,60),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(84,"div",31),i.TgZ(85,"form",61,62),i.NdJ("ngSubmit",function(){i.CHM(t);const n=i.MAs(86),r=i.MAs(50);return e.submitEditingMap(n.value,e.gradientPickers[e.gradientSelectedIndex],r.value)}),i.TgZ(87,"div",63),i.TgZ(88,"h1",64),i._uU(89,"\u7de8\u8f2f\u5730\u5716"),i.qZA(),i.TgZ(90,"button",36),i.NdJ("click",function(){return e.blurGraph.emit(!1),e.showEditMapPopup=!e.showEditMapPopup}),i.O4$(),i.TgZ(91,"svg",38),i._UZ(92,"path",39),i._UZ(93,"path",40),i.qZA(),i.qZA(),i.qZA(),i.kcU(),i.TgZ(94,"div",65),i.TgZ(95,"div",66),i.TgZ(96,"div",67),i.TgZ(97,"p",68),i._uU(98,"\u4f5c\u8005\u540d\u7a31"),i.qZA(),i._UZ(99,"input",69,70),i.YNc(101,xw,2,0,"span",71),i.qZA(),i.TgZ(102,"div",67),i.TgZ(103,"p",68),i._uU(104,"\u806f\u7d61\u7528\u96fb\u5b50\u90f5\u4ef6"),i.qZA(),i._UZ(105,"input",72,73),i.YNc(107,ww,2,1,"p",58),i.qZA(),i.TgZ(108,"div",67),i.TgZ(109,"p",68),i._uU(110,"\u5730\u5716\u6a19\u984c"),i.qZA(),i._UZ(111,"input",74,75),i.YNc(113,Cw,2,0,"span",71),i.qZA(),i.TgZ(114,"div",67),i.TgZ(115,"p",68),i._uU(116,"\u5730\u5716\u4ecb\u7d39"),i.qZA(),i.TgZ(117,"textarea",76,77),i._uU(119,"                    "),i.qZA(),i.YNc(120,Tw,2,0,"span",78),i.qZA(),i.TgZ(121,"div",79),i.TgZ(122,"p",68),i._uU(123,"\u8981\u7528\u5230\u7684\u8cc7\u6599\u7dad\u5ea6\uff1f"),i.qZA(),i.TgZ(124,"div",80),i._UZ(125,"input",81,82),i.TgZ(127,"label",83),i._uU(128," \u9ad8\u5ea6 "),i.qZA(),i.qZA(),i.TgZ(129,"div",80),i._UZ(130,"input",84,85),i.TgZ(132,"label",86),i._uU(133," \u8272\u8abf "),i.qZA(),i.qZA(),i.YNc(134,Sw,2,0,"span",71),i.qZA(),i.qZA(),i.TgZ(135,"div",53),i.TgZ(136,"div",67),i.TgZ(137,"p",68),i._uU(138,"\u9ad8\u5ea6\u4ee3\u8868\u4f55\u7a2e\u8cc7\u6599\uff1f"),i.qZA(),i._UZ(139,"input",87,88),i.YNc(141,Mw,2,0,"span",71),i.qZA(),i.TgZ(142,"div",67),i.TgZ(143,"p",68),i._uU(144,"\u9ad8\u5ea6\u55ae\u4f4d"),i.qZA(),i._UZ(145,"input",89,90),i.YNc(147,Ew,2,0,"span",71),i.qZA(),i.TgZ(148,"div",67),i.TgZ(149,"p",68),i._uU(150,"\u8272\u8abf\u4ee3\u8868\u4f55\u7a2e\u8cc7\u6599\uff1f"),i.qZA(),i._UZ(151,"input",91,92),i.YNc(153,Aw,2,0,"span",71),i.qZA(),i.TgZ(154,"div",67),i.TgZ(155,"p",68),i._uU(156,"\u8272\u8abf\u55ae\u4f4d"),i.qZA(),i._UZ(157,"input",93,94),i.YNc(159,Dw,2,0,"span",71),i.qZA(),i.TgZ(160,"div",79),i.TgZ(161,"p",68),i._uU(162,"\u6311\u9078\u5730\u5716\u8272\u8abf"),i.qZA(),i.YNc(163,Lw,1,4,"input",95),i.qZA(),i._UZ(164,"input",96),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(165,"div",97),i.TgZ(166,"form",98,99),i.TgZ(168,"div",100),i.TgZ(169,"h1",64),i._uU(170,"\u5efa\u7acb\u6210\u529f\uff01"),i.qZA(),i.TgZ(171,"button",36),i.NdJ("click",function(){return e.blurGraph.emit(!1),e.showLinkPopup=!e.showLinkPopup}),i.O4$(),i.TgZ(172,"svg",38),i._UZ(173,"path",39),i._UZ(174,"path",40),i.qZA(),i.qZA(),i.qZA(),i.kcU(),i.TgZ(175,"div",53),i.TgZ(176,"p",50),i._uU(177,"\u4f60\u7684\u5730\u5716\u7db2\u5740\u70ba\uff1a"),i.qZA(),i.TgZ(178,"div",101),i.TgZ(179,"input",102,103),i.NdJ("ngModelChange",function(t){return e.shareLink=t}),i.qZA(),i.TgZ(181,"button",104,105),i.NdJ("click",function(){i.CHM(t);const n=i.MAs(182);return e.copyShareLink(n,e.shareLink)}),i.O4$(),i.TgZ(183,"svg",106),i._UZ(184,"path",107),i._UZ(185,"path",108),i.qZA(),i.kcU(),i.TgZ(186,"p",109),i._uU(187,"\u8907\u88fd\u5230\u526a\u8cbc\u7c3f"),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.TgZ(188,"div",110),i.TgZ(189,"div",111),i.TgZ(190,"div",34),i.TgZ(191,"h1",35),i._uU(192,"\u5176\u4ed6\u7db2\u53cb\u88fd\u4f5c\u7684\u5730\u5716"),i.qZA(),i.TgZ(193,"button",36,37),i.NdJ("click",function(){return e.blurGraph.emit(!1),e.showBrowseMapsPopup=!e.showBrowseMapsPopup}),i.O4$(),i.TgZ(195,"svg",38),i._UZ(196,"path",39),i._UZ(197,"path",40),i.qZA(),i.qZA(),i.qZA(),i.kcU(),i.TgZ(198,"div",112),i.YNc(199,Iw,17,12,"a",113),i.qZA(),i.qZA(),i.qZA()}if(2&t){const t=i.MAs(50),n=i.MAs(79),r=i.MAs(86),s=i.MAs(100),o=i.MAs(106),a=i.MAs(112),l=i.MAs(118),c=i.MAs(126),u=i.MAs(131),h=i.MAs(140),d=i.MAs(146),p=i.MAs(152),f=i.MAs(158);i.Q6J("ngClass",e.showCreateMapPopup?"blur":""),i.xp6(6),i.Oqu(e.mapName),i.xp6(1),i.Q6J("ngIf","cloud"===e.mapId),i.xp6(5),i.Oqu(e.author),i.xp6(1),i.Q6J("ngStyle",i.WLB(42,Nw,e.htmlTextColor,e.mouseHoveAnyMesh&&!e.mouseHoverDetalessMesh?"flex":"none")),i.xp6(1),i.Q6J("ngIf",e.meshDataOnHtml),i.xp6(1),i.Q6J("ngIf",e.meshDataOnHtml),i.xp6(1),i.Q6J("ngStyle",i.VKq(45,kw,e.mouseHoverDetalessMesh&&e.mouseHoveAnyMesh?"flex":"none")),i.xp6(5),i.Q6J("ngStyle",i.VKq(47,kw,e.mouseHoveAnyMesh?"none":"flex")),i.xp6(11),i.Q6J("ngClass",e.showCreateMapPopup?"blur":""),i.xp6(2),i.Q6J("ngStyle",i.VKq(49,Pw,"linear-gradient(to right,#"+e.toneGradient.startColor+", #"+e.toneGradient.endColor+")")),i.xp6(1),i.Q6J("ngIf",e.requireToneDimension),i.xp6(1),i.Q6J("ngIf",e.requireToneDimension),i.xp6(1),i.Q6J("ngIf",e.requireHeightDimension),i.xp6(1),i.Q6J("ngIf",e.requireHeightDimension),i.xp6(2),i.Oqu(e.mapDescription),i.xp6(1),i.Q6J("href",e.sourceUrl,i.LSH),i.xp6(7),i.Q6J("ngClass",e.showCreateMapPopup?"d-flex":"d-none"),i.xp6(24),i.Q6J("src",e.weatherService.addBaseUrl("/assets/imgs/step-2.gif"),i.LSH)("srcset",e.weatherService.addBaseUrl("/assets/imgs/step-2@1.5x.gif 1.5x")+" , "+e.weatherService.addBaseUrl("/assets/imgs/step-2@2x.gif 2x")+", "+e.weatherService.addBaseUrl("/assets/imgs/step-2@3x.gif 3x")+", ",i.LSH),i.xp6(9),i.Q6J("ngIf",n.touched),i.xp6(1),i.Q6J("disabled",!t.valid),i.xp6(2),i.Q6J("ngClass",e.showEditMapPopup?"d-flex":"d-none"),i.xp6(17),i.Q6J("ngIf",s.touched&&(null==s.errors?null:s.errors.required)),i.xp6(6),i.Q6J("ngIf",o.touched),i.xp6(6),i.Q6J("ngIf",a.touched&&(null==a.errors?null:a.errors.required)),i.xp6(7),i.Q6J("ngIf",l.touched),i.xp6(14),i.Q6J("ngIf",!u.value&&!c.value),i.xp6(5),i.Q6J("disabled",!c.value),i.xp6(2),i.Q6J("ngIf",h.touched&&c&&""==h.value),i.xp6(4),i.Q6J("disabled",!c.value),i.xp6(2),i.Q6J("ngIf",d.touched&&c&&""==d.value),i.xp6(4),i.Q6J("disabled",!u.value),i.xp6(2),i.Q6J("ngIf",p.touched&&u.value&&""==p.value),i.xp6(4),i.Q6J("disabled",!u.value),i.xp6(2),i.Q6J("ngIf",f.touched&&u&&""==f.value),i.xp6(4),i.Q6J("ngForOf",e.gradientPickers),i.xp6(1),i.Q6J("disabled",!r.valid||c.value&&""==h.value||u.value&&""==p.value),i.xp6(1),i.Q6J("ngClass",e.showLinkPopup?"d-flex":"d-none"),i.xp6(14),i.Q6J("ngModel",e.shareLink),i.xp6(9),i.Q6J("ngClass",e.showBrowseMapsPopup?"d-flex":"d-none"),i.xp6(11),i.Q6J("ngForOf",e.allMaps)}},directives:[ht,mt,vt,Jb,Sb,qb,ob,iw,Tb,Xb,Kb,ew,ib,pt],pipes:[ow,bt,xt],styles:['@import url("https://fonts.googleapis.com/css2?family=Open+Sans&family=Quicksand:wght@300&display=swap");.intercation-area[_ngcontent-%COMP%]   .overview-info[_ngcontent-%COMP%]   .author-area[_ngcontent-%COMP%], .intercation-area[_ngcontent-%COMP%]   .overview-info[_ngcontent-%COMP%]   .map-title[_ngcontent-%COMP%], .intercation-area[_ngcontent-%COMP%]   .overview-info[_ngcontent-%COMP%]   .web-title[_ngcontent-%COMP%], .theme-font[_ngcontent-%COMP%], .theme-font-m-zh[_ngcontent-%COMP%], .theme-font-s-zh[_ngcontent-%COMP%]{color:#0088dc;opacity:69%}.en[_ngcontent-%COMP%]{text-shadow:0 0 22px #fff;font-family:Quicksand,sans-serif}.theme-font-m-zh[_ngcontent-%COMP%], .theme-font-s-zh[_ngcontent-%COMP%], .zh[_ngcontent-%COMP%]{text-shadow:0 0 22px #fff;font-family:Open Sans,sans-serif}h2[_ngcontent-%COMP%]{font-size:3rem}h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{margin:0;padding:0 1rem 0 0}h3[_ngcontent-%COMP%]{font-size:1rem}p[_ngcontent-%COMP%]{font-size:1.5rem;margin:0}a[_ngcontent-%COMP%]{color:#126fac}.font-size-s[_ngcontent-%COMP%], .theme-font-s-zh[_ngcontent-%COMP%]{font-size:.875rem}.font-size-m[_ngcontent-%COMP%], .theme-font-m-zh[_ngcontent-%COMP%]{font-size:1.5rem}.font-size-l[_ngcontent-%COMP%]{font-size:3rem}.blur[_ngcontent-%COMP%]{filter:blur(15px)}.rounded-theme[_ngcontent-%COMP%]{border-radius:10px}.btn-secondary[_ngcontent-%COMP%]{stroke:solid 2px #0088dc;border-radius:4px}.btn-primary[_ngcontent-%COMP%]{background-color:#0088dc;opacity:69%}.btn[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;border-radius:6px;border:2px solid #0088dc}input.form-check-input[_ngcontent-%COMP%]:checked{background-color:#0088dc;opacity:69%}.vh-70[_ngcontent-%COMP%]{height:70vh}img[_ngcontent-%COMP%]{width:100%}@media (min-width:768px){img[_ngcontent-%COMP%]{width:auto}}.intercation-area[_ngcontent-%COMP%]{padding:5vh 5%;height:100vh;pointer-events:none;z-index:1}.intercation-area[_ngcontent-%COMP%]   .district-info[_ngcontent-%COMP%]{flex-direction:column;height:inherit;filter:saturate(1.3) brightness(.8) contrast(1.6)}.intercation-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{pointer-events:all}.popup-bg[_ngcontent-%COMP%]{background-color:#153e6778;z-index:1}.popup[_ngcontent-%COMP%]{padding:4rem;background-color:#e3f2ffc7}.popup[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:none;border-bottom:2px solid #0088dcad}.popup[_ngcontent-%COMP%]   .input-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#0088dc36}.popup[_ngcontent-%COMP%]   .share-link[_ngcontent-%COMP%]{max-width:50vw;width:40ch;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.popup[_ngcontent-%COMP%]   input.gradient-picker[_ngcontent-%COMP%]{width:100%;height:20px;border-radius:10em;border:5px solid #fff}.popup[_ngcontent-%COMP%]   input.gradient-selected[_ngcontent-%COMP%]{height:30px;box-shadow:0 0 10px 0 #00000014}.map-list[_ngcontent-%COMP%]   div.tone-gradient[_ngcontent-%COMP%]{width:5px;height:auto;border-radius:10em;background-image:linear-gradient(0deg,#70a7f3,#eef588)}.legend.tone-gradient[_ngcontent-%COMP%]{width:40%;height:5px;border-radius:10em;background-image:linear-gradient(90deg,#f8ff8b,#f38461)}.min-height-70[_ngcontent-%COMP%]{min-height:70vh}.list-container[_ngcontent-%COMP%]{height:70vh;overflow:auto}textarea[_ngcontent-%COMP%]{border:none;border-bottom:2px solid #0088dcad}textarea[_ngcontent-%COMP%]::placeholder{color:#0088dc36}.map-description[_ngcontent-%COMP%]{white-space:pre-line;overflow-wrap:anywhere;display:flex;max-width:70%}img[_ngcontent-%COMP%]{max-height:35vh}.live-badge[_ngcontent-%COMP%]{background-color:#ff3d00;text-shadow:none}']}),t})();const zw=["canvas"],Fw=function(t){return{"mix-blend-mode":t}};let Uw=(()=>{class t{constructor(t,e,n,i,r,s,o){this.weatherService=t,this.db=e,this.route=n,this.colorUtil=i,this.cloudService=r,this.meshUtilService=s,this.textMeshService=o,this.htmlTextColor="#666666",this.mouseHoverDetalessMesh=!1,this.showPopup=!1,this.toneColor={maxHex:"EEF588",minHex:"70a7f3"},this.units={tone:"\u6eab",height:"\u964d\u96e8\u91cf"},this.toneExtremum={max:0,min:0},this.measureRenderTime=0,this.blurCanvas=()=>{this.showPopup=!this.showPopup,this.animate()},this.initCloud=()=>{const t=this.cloudService.initSkeletionCloudMmesh();this.scene.add(t),this.cloudService.initCloudMesh().then(e=>{this.scene.remove(t),this.cloud=e,this.scene.add(e)})},this.paintMeshFrom=(t,e,n={r:1,g:1,b:1})=>{const i=this.meshUtilService.findDataByMeshName(t,e);i&&i.rgbColor&&(e.material.color=i&&i.rgbColor?i.rgbColor:n)},this.toggleCloud=t=>{const e=this.scene.children.find(t=>{var e;return t.name===(null===(e=this.cloud)||void 0===e?void 0:e.name)});this.cloud&&(t&&!e?this.scene.add(this.cloud):!t&&e&&this.scene.remove(e))},this.onMousemove=t=>{t.preventDefault(),this.mouse=this.updateMousePosiion(t),this.raycaster.setFromCamera(this.mouse,this.camera);const e=this.taiwanMap.children[0];if(e){const t=this.raycaster.intersectObjects(e.children,!0);t.length>0?(this.mouseHoverAnyMesh=!0,this.onMouseHoveringLand(e,t)):this.mouseHoverAnyMesh&&(this.mouseHoverAnyMesh=!1,this.onMouseLeavingLand(e))}},this.onMouseHoveringLand=(t,e)=>{var n;this.meshUtilService.transparentMeshes(t),this.toggleCloud(!1),this.textMeshService.transparentTextMesh();const i=e.sort((t,e)=>t.distance-e.distance)[0].object;this.paintMeshFrom(this.meshesData,i),i.material.opacity=1;const r=null===(n=this.meshUtilService.findDataByMeshName(this.meshesData,i))||void 0===n?void 0:n.rgbColor;r?(this.htmlTextColor="#"+this.colorUtil.convert0to1ToHex(r),this.mouseHoverDetalessMesh=!1):this.mouseHoverDetalessMesh=!0,this.textMeshService.paintMapTextFromMesh(i),this.updateTextOnHtml(e)},this.onMouseLeavingLand=t=>{this.toggleCloud(!0),t.traverse(e=>{e.isMesh&&(this.meshUtilService.transparentMeshes(t,1),this.paintMeshFrom(this.meshesData,e))}),this.textMeshService.paintColorOnMapText()},this.updateTextOnHtml=t=>{const e=t.sort((t,e)=>t.distance-e.distance)[0];this.meshDataOnHtml=this.meshUtilService.findDataByMeshName(this.meshesData,e.object)},this.updateMousePosiion=t=>({x:t.offsetX/this.canvas.nativeElement.offsetWidth*2-1,y:t.offsetY/this.canvas.nativeElement.offsetHeight*-2+1}),this.setupRenderer=()=>{this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this.canvas.nativeElement.offsetWidth,this.canvas.nativeElement.offsetHeight),this.canvas.nativeElement.appendChild(this.renderer.domElement),this.animate()},this.setupCamera=()=>{this.camera.aspect=this.canvas.nativeElement.offsetWidth/this.canvas.nativeElement.offsetHeight,this.camera.position.set(5,16,1),this.camera.position.set(0,16,0),this.camera.lookAt(4,0,0),this.camera.lookAt(0,0,0),this.animateCamera()},this.animateCamera=()=>{const t={px:5,py:16,pz:1,lx:4,ly:0,lz:0};ru.to(t,Object.assign(Object.assign({},{px:3,py:9,pz:8,lx:2,ly:-3,lz:0}),{duration:1.5,ease:Xl.easeInOut,onUpdate:()=>{this.camera.position.set(t.px,t.py,t.pz),this.camera.lookAt(t.lx,t.ly,t.lz)}})).delay(1.5).play()},this.setupBoxForTest=()=>{const t=new up(2,2,2),e=new Gy({color:16777215,opacity:.8,transparent:!0});this.box=new lp(t,e),this.box.traverse(t=>{t.isMesh&&(t.castShadow=!0,t.receiveShadow=!0)}),this.box2=new lp(t,e),this.box2.traverse(t=>{t.isMesh&&(t.receiveShadow=!0)}),this.box2.position.set(1,-2,1),this.scene.add(this.box2),this.scene.add(this.box)},this.setupScene=()=>{this.scene.background=new Ad(15658734)},this.setupShadowTexture=(t,e)=>{t.shadow.camera.near=8,t.shadow.camera.far=18,t.shadow.camera.left=-8,t.shadow.camera.right=6,t.shadow.camera.top=6,t.shadow.camera.bottom=0,t.shadow.mapSize.width=e,t.shadow.mapSize.height=e},this.setupLight=()=>{this.hemisphereLight.intensity=.8,this.hemisphereLight.color=new Ad(16777215),this.scene.add(this.hemisphereLight),this.setupShadowTexture(this.directionalLight,512),this.directionalLight.intensity=.35,this.directionalLight.color=new Ad(16777215),this.directionalLight.position.set(-7,7,-5),this.directionalLight.castShadow=!0,this.scene.add(this.directionalLight),this.pointLight.intensity=.1,this.pointLight.color=new Ad(16777215),this.pointLight.position.set(5,6,-2),this.scene.add(this.pointLight)},this.createMeshesData=t=>t.map(t=>{const e=new K_;return e.tone=t.tone,e.height=t.height,e.zhCityName=t.cityName,e.zhDistrictName=t.districtName,e}),this.assignMeshesdEnName=t=>t.map(t=>{const e=this.weatherService.districtsEnZhMap.find(e=>e.zhCity===t.zhCityName&&e.zhDistrict===t.zhDistrictName);if(e)return t.enCityName=e.enCity,t.enDistrictName=e.enDistrict,t;throw console.error(t),alert(`\u532f\u5165\u8868\u55ae\u8cc7\u6599\u6642\uff0c\u627e\u4e0d\u5230\u9019\u500b\u9109\u93ae\u5e02\u5340\u57283D\u6a21\u578b\u4e0a\u5c0d\u61c9\u7684\u7269\u4ef6\uff1a${t.zhCityName}${t.zhDistrictName}`),new Error("A Mesh Has No English Name")}),this.getToneRange=t=>{const e=t.sort((t,e)=>+t.tone-+e.tone);return[+e[e.length-1].tone,+e[0].tone]},this.getMaterialColorByRate=(t,e,n)=>{const i=this.colorUtil.blendHexColors("#"+this.toneColor.maxHex,"#"+this.toneColor.minHex,(n-t)/(e-t));return this.colorUtil.convertHexTo0to1(i)},this.animateDistrictsHeight=()=>{const[t,e]=this.textMeshService.getHeightRange(this.meshesData);for(let n=0;n<this.meshesData.length;n++){const i=this.meshesData[n].height||0,r={scaleY:1};ru.to(r,Object.assign(Object.assign({},{scaleY:20*((+i-e)/(t-e)||0)+1}),{duration:1,onStart:()=>{0!==i&&(this.meshesData[n].mesh3d.castShadow=!0)},onUpdate:()=>{this.meshesData[n].mesh3d.scale.setY(r.scaleY),this.meshesData[n].mesh3d.position.setY(r.scaleY/2)},ease:Xl.easeInOut})).delay(1).play()}},this.setUpTaiwan3dModel=()=>(new y_).loadAsync(this.weatherService.addBaseUrl("/assets/taiwam15.gltf")),this.setupMap=t=>{if(console.log(t),!t)throw new Error("no mapId");switch(this.resetTone(),t){case"weather":this.weatherService.getWeatherInfo().subscribe(t=>{this.textMeshService.enableDimensionText(),this.generateMap(t)});break;case"cloud":this.weatherService.getWeatherForcast().subscribe(t=>{this.initCloud(),this.initCloud(),this.textMeshService.enableDimensionText(),this.generateMap(t)});break;default:this.weatherService.getMapDataFromFirebase(t).subscribe(t=>{this.setupTone(t),this.textMeshService.enableDimensionText(t);const e=this.weatherService.getGoogleSheetIdFromUrl(t.sourceUrl);this.weatherService.getGoogleSheetInfo(e).subscribe(t=>{this.generateMap(t)})})}},this.setupTone=t=>{this.toneColor.maxHex=t.MaxToneHex,this.toneColor.minHex=t.MinToneHex,this.units.height=t.HeightDimensionUnit,this.units.tone=t.ToneDimensionUnit},this.resetTone=()=>{this.toneColor={maxHex:"EEF588",minHex:"70a7f3"},this.units={tone:"\u6eab",height:"\u964d\u96e8\u91cf"}},this.generateMap=t=>{console.log(t);const e=this.mapGltf;this.taiwanMap&&this.taiwanMap.removeFromParent(),this.setupMeshData(t),this.toneExtremum=this.getToneExtremum(this.meshesData),this.sumHeight=this.getSumHeight(this.meshesData),this.setupMapMesh(e.scene),this.textMeshService.setupAndAnimateTexts(this.camera,this.orbitcontrols,this.scene,this.taiwanMap,this.meshesData),this.animateDistrictsHeight(),this.scene.add(e.scene)},this.setupMeshData=t=>{this.resetMeshAppearence(this.meshesData),this.meshesData=this.createMeshesData(t),this.meshesData=this.assignMeshesdEnName(this.meshesData)},this.resetMeshAppearence=t=>{t.map(t=>{t.height=0,t.tone=0})},this.setupMapMesh=t=>{const e=new Vy({opacity:1,transparent:!1}),[n,i]=this.getToneRange(this.meshesData);console.log(n,i),this.taiwanMap=t,t.traverse(t=>{const r=t;if(r.isMesh){r.material=e.clone(),r.receiveShadow=!0;const t=this.meshUtilService.findDataByMeshName(this.meshesData,r);t?(t.rgbColor=this.getMaterialColorByRate(n,i,t.tone),this.meshUtilService.paintMesh(r,t.rgbColor),t.mesh3d=r):(this.meshUtilService.resetMeshGeometry(r),this.meshUtilService.paintMesh(r,this.meshUtilService.defaultMeshColor))}})},this.getToneExtremum=t=>{const e=t.sort((t,e)=>+e.tone-+t.tone);return{max:e[0].tone,min:e[e.length-1].tone}},this.getSumHeight=t=>{let e=0;return t.forEach(t=>e+=t.height),e},this.animate=()=>{this.showPopup||(requestAnimationFrame(this.animate),this.renderer.render(this.scene,this.camera))},this.dbList=this.db.list("maps"),this.scene=new qm,this.camera=new gp(75,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new Gm({precision:"lowp",antialias:!0}),this.directionalLight=new Lv,this.pointLight=new Av,this.hemisphereLight=new yv,this.spotlight=new Cv,this.raycaster=new e_,this.mouse={x:0,y:0},this.taiwanMap=new ld,this.mouseHoverAnyMesh=!1,this.orbitcontrols=new g_(this.camera,this.renderer.domElement),this.meshesData=[],this.box=new lp,this.box2=new lp,this.light=new Av,this.sumHeight=0}ngOnInit(){}ngAfterViewInit(){var t=this;return Fs(function*(){t.setupRenderer(),t.setupCamera(),t.setupScene(),t.setupLight(),t.setUpTaiwan3dModel().then(e=>{t.mapGltf=e;const n=t.route.snapshot.paramMap.get("id")||void 0;e.scene.scale.set(.1,.1,.1),t.setupMap(n)}),t.dbList.snapshotChanges(["child_added"]).subscribe(t=>{t.forEach(t=>{})}),setTimeout(()=>{let e=t.renderer.info.render.frame/30,n=e>10,i=e<4;if(console.log(e,n),n){const e=new Lv;t.setupShadowTexture(e,1024),e.intensity=.35,e.color=new Ad(16777215),e.position.set(-7,7,-5),e.castShadow=!0,t.directionalLight.removeFromParent(),t.scene.add(e)}if(i){const e=new Lv;e.castShadow=!1,e.intensity=.35,e.color=new Ad(16777215),e.position.set(-7,7,-5),t.directionalLight.removeFromParent(),t.scene.add(e)}},6e3)})()}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(Zx),i.Y36(Wx),i.Y36(Xi),i.Y36(Yx),i.Y36(Jx),i.Y36($x),i.Y36(Qx))},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-graphic"]],viewQuery:function(t,e){if(1&t&&i.Gf(zw,5),2&t){let t;i.iGM(t=i.CRH())&&(e.canvas=t.first)}},decls:3,vars:10,consts:[[3,"districtColor","mouseHoverDetalessMesh","mouseHoveAnyMesh","meshDataOnHtml","toneExtremum","sumHeight","ngStyle","onMapChanged","blurGraph"],[2,"width","100%","height","100vh",3,"ngClass","mousemove"],["canvas",""]],template:function(t,e){1&t&&(i.TgZ(0,"app-graph-info",0),i.NdJ("onMapChanged",function(t){return e.setupMap(t)})("blurGraph",function(){return e.blurCanvas()}),i.qZA(),i.TgZ(1,"div",1,2),i.NdJ("mousemove",function(t){return e.onMousemove(t)}),i.qZA()),2&t&&(i.Q6J("districtColor",e.htmlTextColor)("mouseHoverDetalessMesh",e.mouseHoverDetalessMesh)("mouseHoveAnyMesh",e.mouseHoverAnyMesh)("meshDataOnHtml",e.meshDataOnHtml)("toneExtremum",e.toneExtremum)("sumHeight",e.sumHeight)("ngStyle",i.VKq(8,Fw,e.showPopup?"unset":"darken")),i.xp6(1),i.Q6J("ngClass",e.showPopup?"blur":""))},directives:[Ow,vt,ht],styles:['@import url("https://fonts.googleapis.com/css2?family=Open+Sans&family=Quicksand:wght@300&display=swap");.theme-font[_ngcontent-%COMP%], .theme-font-m-zh[_ngcontent-%COMP%], .theme-font-s-zh[_ngcontent-%COMP%]{color:#0088dc;opacity:69%}.en[_ngcontent-%COMP%]{text-shadow:0 0 22px #fff;font-family:Quicksand,sans-serif}.theme-font-m-zh[_ngcontent-%COMP%], .theme-font-s-zh[_ngcontent-%COMP%], .zh[_ngcontent-%COMP%]{text-shadow:0 0 22px #fff;font-family:Open Sans,sans-serif}h2[_ngcontent-%COMP%]{font-size:3rem}h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{margin:0;padding:0 1rem 0 0}h3[_ngcontent-%COMP%]{font-size:1rem}p[_ngcontent-%COMP%]{font-size:1.5rem;margin:0}a[_ngcontent-%COMP%]{color:#126fac}.font-size-s[_ngcontent-%COMP%], .theme-font-s-zh[_ngcontent-%COMP%]{font-size:.875rem}.font-size-m[_ngcontent-%COMP%], .theme-font-m-zh[_ngcontent-%COMP%]{font-size:1.5rem}.font-size-l[_ngcontent-%COMP%]{font-size:3rem}.blur[_ngcontent-%COMP%]{filter:blur(15px)}.rounded-theme[_ngcontent-%COMP%]{border-radius:10px}.btn-secondary[_ngcontent-%COMP%]{stroke:solid 2px #0088dc;border-radius:4px}.btn-primary[_ngcontent-%COMP%]{background-color:#0088dc;opacity:69%}.btn[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;border-radius:6px;border:2px solid #0088dc}input.form-check-input[_ngcontent-%COMP%]:checked{background-color:#0088dc;opacity:69%}.vh-70[_ngcontent-%COMP%]{height:70vh}img[_ngcontent-%COMP%]{width:100%}@media (min-width:768px){img[_ngcontent-%COMP%]{width:auto}}']}),t})();const Hw=[{path:"",redirectTo:"maps/weather",pathMatch:"full"},{path:"maps/:id",component:Uw},{path:"**",component:Uw}];let Bw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[[As.forRoot(Hw,{enableTracing:!0})],As]}),t})(),Vw=(()=>{class t{constructor(){this.title="districtgraphic-tw"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Xpm({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(t,e){1&t&&i._UZ(0,"router-outlet")},directives:[vs],styles:["app-taiwan-map-infographic[_ngcontent-%COMP%]{height:100vh;width:100%;display:flex;flex-direction:column}body[_ngcontent-%COMP%]{margin:0}"]}),t})();const Gw=[{provide:Re,useClass:(()=>{class t{constructor(){this.removeExtraText=t=>t.replace("/*O_o*/\ngoogle.visualization.Query.setResponse(","").replace(");","")}intercept(t,e){return e.handle(t).pipe(wn(t=>{if(console.log(t),200===t.status&&t.error.text.includes("/*O_o*/\ngoogle.visualization.Query.setResponse(")){const e=new Ee({body:JSON.parse(this.removeExtraText(t.error.text)),headers:t.headers,status:t.status,statusText:t.statusText,url:t.url||""});return(0,ie.of)(e)}return(0,ie.of)(t)}))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac}),t})(),multi:!0}];let jw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t,bootstrap:[Vw]}),t.\u0275inj=i.cJS({providers:[Gw],imports:[[ne,fx.hO.initializeApp(tx),qx,Bw,Ge,sw]]}),t})();(0,i.G48)(),te().bootstrapModule(jw).catch(t=>console.error(t))},4762:(t,e,n)=>{"use strict";n.d(e,{ZT:()=>r,pi:()=>s,mG:()=>o,Jh:()=>a,XA:()=>l,CR:()=>c,ev:()=>u});var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var s=function(){return(s=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function o(t,e,n,i){return new(n||(n=Promise))(function(r,s){function o(t){try{l(i.next(t))}catch(e){s(e)}}function a(t){try{l(i.throw(t))}catch(e){s(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(o,a)}l((i=i.apply(t,e||[])).next())})}function a(t,e){var n,i,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&s[0]?i.return:s[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,s[1])).done)return r;switch(i=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,i=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((r=(r=o.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(a){s=[6,a],i=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function l(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,s=n.call(t),o=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return o}function u(t,e,n){if(n||2===arguments.length)for(var i,r=0,s=e.length;r<s;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||e)}}},t=>{"use strict";t(t.s=4395)}]);